#!/usr/bin/env php
<?php

$oa = require dirname(__DIR__) . '/admin/src/start.php';

$c = $oa->console();

$script = $c->getArg(1) ?: null;

if ($script == 'help'){
    $c->println("Précisez un nom de script situé dans le répertoire code");

    return;
}


// Obtenir les arguments sans manipuler les quotes
$args = array_slice($argv, 1);

// On va forcer manuellement l'ajout des quotes autour des arguments ayant des signes comme '='
foreach ($args as &$arg) {
    if (strpos($arg, '=') !== false && strpos($arg, "'") === false) {
        $arg = preg_replace('/^([^=]+)=(.+)$/', '$1=\'$2\'', $arg);
    }
}

// Reconstruire la commande avec les arguments correctement formatés
$args = implode(' ', $args);


$command = 'clear;php '.dirname(__DIR__)."/public/index.php UnicaenCode $args";

passthru($command);