import{c as a,o as i,t as u,a as e,w as S,v as j,b as c,F as p,r as g,d as h,n as D,e as f,f as b,g as E,h as C,p as q,i as L,j as O,k as F,l as U,m as Q,q as X,s as Z,u as K,x as ee,y as te}from"./vendor-2e5f87a4.js";const k=(n,s)=>{const t=n.__vccOpts||n;for(const[_,l]of s)t[_]=l;return t},se={props:{valeur:{required:!0,type:Number}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},ne=["innerHTML"];function re(n,s,t,_,l,r){return i(),a("span",{class:"heures",innerHTML:r.affichage},null,8,ne)}const ie=k(se,[["render",re]]),ae=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),oe={name:"Utilisateur",props:{nom:String,mail:String}},le=["href"];function de(n,s,t,_,l,r){return i(),a("a",{href:`mailto:${t.mail}`},u(t.nom),9,le)}const ue=k(oe,[["render",de]]),ce=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),he={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(n){this.formatted=this.formatage(n)}},methods:{formatage(n){if(n===void 0)return;let s=new Date(n);const t=s.getFullYear(),_=(s.getMonth()+1).toString().padStart(2,"0"),l=s.getDate().toString().padStart(2,"0"),r=s.getHours().toString().padStart(2,"0"),o=s.getMinutes().toString().padStart(2,"0"),d=s.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${l}/${_}/${t} à ${r}:${o}`;case"time":return`${r}:${o}:${d}`}return`${l}/${_}/${t}`}}};function me(n,s,t,_,l,r){return u(l.formatted)}const R=k(he,[["render",me]]),_e={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(n){this.searchTerm=n.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(n){return unicaenVue.url("intervenant/code:"+n+"/voir")},reload(){var n=document.getElementById("term");n.focus(),this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(s=>{let t=s.data,_=[];for(const l in t){if(t[l].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){_.push(t[l]);continue}if(t[l].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){_.push(t[l]);continue}if(t[l].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){_.push(t[l]);continue}}this.intervenants=_,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(s=>{console.log(s.message)})},800)}}},fe=e("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1),pe={class:"intervenant-recherche"},ve={class:"critere"},be=e("br",null,null,-1),ge=e("span",{class:"fw-bold"},"Types d'intervenant : ",-1),ye=e("br",null,null,-1),xe={key:0,class:"table table-bordered table-hover"},ke=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),Ce=["title"],Ve={style:{}},Pe=["href"],Ee=e("i",{class:"fas fa-eye"},null,-1),De={key:1,class:"table table-bordered table-hover"},Te=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),Se=e("tbody",null,[e("tr",null,[e("td",{colspan:"8",style:{"text-align":"center"}},"Aucun intervenant trouvé")])],-1),Me=[Te,Se];function Re(n,s,t,_,l,r){const o=R;return i(),a(p,null,[fe,e("div",pe,[e("div",ve,[e("div",null,[e("input",{id:"term",autofocus:"",class:"form-control input",placeholder:"votre recherche...",type:"text",onKeyup:s[0]||(s[0]=(...d)=>r.rechercher&&r.rechercher(...d))},null,32),be]),e("div",null,[ge,S(e("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"permanent",onChange:s[2]||(s[2]=d=>r.reload())},null,544),[[j,l.checkedTypes]]),c(" Permanent "),S(e("input",{"onUpdate:modelValue":s[3]||(s[3]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"vacataire",onChange:s[4]||(s[4]=d=>r.reload())},null,544),[[j,l.checkedTypes]]),c(" Vacataire "),S(e("input",{"onUpdate:modelValue":s[5]||(s[5]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"etudiant",onChange:s[6]||(s[6]=d=>r.reload())},null,544),[[j,l.checkedTypes]]),c(" Etudiant ")]),ye])]),l.intervenants.length>0?(i(),a("table",xe,[ke,e("tbody",null,[(i(!0),a(p,null,g(l.intervenants,(d,m)=>(i(),a("tr",{class:D({"bg-danger":d.destruction!==null}),title:d.destruction!==null?"Fiche historisé":""},[e("td",Ve,[e("a",{href:r.urlFiche(d.code)},[Ee,c(" Fiche")],8,Pe)]),e("td",null,u(d.civilite),1),e("td",null,u(d.nom),1),e("td",null,u(d.prenom),1),e("td",null,u(d.structure),1),e("td",null,u(d.statut),1),e("td",null,[f(o,{value:d["date-naissance"]},null,8,["value"])]),e("td",null,u(d["numero-personnel"]),1)],10,Ce))),256))])])):h("",!0),l.intervenants.length==0&&l.noResult==1?(i(),a("table",De,Me)):h("",!0)],64)}const we=k(_e,[["render",Re]]),$e=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"}));const je={name:"Structure",props:{structure:{required:!0}},data(){return{saisieUrl:unicaenVue.url("structure/voir/:structure",{structure:this.structure.id})+"?tab=edition",deleteUrl:unicaenVue.url("structure/delete/:structure",{structure:this.structure.id}),liste:this.$parent.liste}},computed:{hasSousStructures:function(){return this.structure.structures.length>0}},methods:{saisie(n){modAjax(n.currentTarget,s=>{this.refresh()})},supprimer(n){popConfirm(n.currentTarget,s=>{this.refresh()})},refresh(){this.liste.reload()}}},T=n=>(q("data-v-a94dbf9e"),n=n(),L(),n),Ae={class:"accordion-item"},Ue={class:"accordion-header"},Ie=["data-bs-target","aria-controls"],He=["href"],qe=T(()=>e("i",{class:"fas fa-pen-to-square"},null,-1)),Le=[qe],Oe=["href"],Fe=T(()=>e("i",{class:"fas fa-trash-can"},null,-1)),Be=[Fe],Ne=["id"],ze={class:"accordion-body"},Ge={class:"row"},Ye=T(()=>e("div",{class:"col-md-5"},[e("strong",null,"Code"),c(" : ")],-1)),Je={class:"col-md-5"},We={class:"row"},Qe=T(()=>e("div",{class:"col-md-5"},[e("strong",null,"Source"),c(" : ")],-1)),Xe={class:"col-md-5"},Ze={class:"row"},Ke=T(()=>e("div",{class:"col-md-5"},[e("strong",null,"Composante d'enseignement"),c(" : ")],-1)),et={class:"col-md-5"},tt={key:0,class:"fas fa-check text-success"},st={key:1,class:"fas fa-xmark text-danger"},nt={class:"row"},rt=T(()=>e("div",{class:"col-md-5"},[e("strong",null,"Affichage de l'adresse sur le contrat de travail"),c(" : ")],-1)),it={class:"col-md-5"},at={key:0,class:"fas fa-check text-success"},ot={key:1,class:"fas fa-xmark text-danger"},lt={class:"row"},dt=T(()=>e("div",{class:"col-md-5"},[e("strong",null,"Adresse"),c(" : ")],-1)),ut={class:"col-md-5"},ct={key:0,class:"sous-structures"},ht=T(()=>e("h4",null,"Sous-structures",-1)),mt={class:"accordion"};function _t(n,s,t,_,l,r){const o=E("structure",!0);return i(),a("div",Ae,[e("h2",Ue,[e("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":`#str${t.structure.id}`,"aria-expanded":"true","aria-controls":t.structure.id},[t.structure.canEdit?(i(),a("a",{key:0,title:"Modifier la structure",href:l.saisieUrl,class:"btn btn-primary btn-sm",onClick:s[0]||(s[0]=b((...d)=>r.saisie&&r.saisie(...d),["prevent"]))},Le,8,He)):h("",!0),t.structure.canDelete?(i(),a("a",{key:1,title:"Supprimer la structure",href:l.deleteUrl,class:"btn btn-danger btn-sm","data-content":"Êtes-vous sûr de vouloir supprimer la structure ?","data-title":"Suppression de la structure",onClick:s[1]||(s[1]=b((...d)=>r.supprimer&&r.supprimer(...d),["prevent"]))},Be,8,Oe)):h("",!0),c("   "+u(t.structure.libelleLong)+" ("+u(t.structure.libelleCourt)+") ",1)],8,Ie)]),e("div",{id:`str${t.structure.id}`,class:"accordion-collapse collapse show"},[e("div",ze,[e("div",Ge,[Ye,e("div",Je,u(t.structure.code),1)]),e("div",We,[Qe,e("div",Xe,u(t.structure.source.libelle),1)]),e("div",Ze,[Ke,e("div",et,[t.structure.enseignement?(i(),a("i",tt)):t.structure.enseignement?h("",!0):(i(),a("i",st))])]),e("div",nt,[rt,e("div",it,[t.structure.affAdresseContrat?(i(),a("i",at)):t.structure.affAdresseContrat?h("",!0):(i(),a("i",ot))])]),e("div",lt,[dt,e("div",ut,[e("pre",null,u(t.structure.adresse),1)])]),r.hasSousStructures?(i(),a("div",ct,[ht,e("div",mt,[(i(!0),a(p,null,g(t.structure.structures,d=>(i(),C(o,{onRefresh:r.refresh,key:d.id,structure:d},null,8,["onRefresh","structure"]))),128))])])):h("",!0)])],8,Ne)])}const B=k(je,[["render",_t],["__scopeId","data-v-a94dbf9e"]]),ft=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"})),pt={components:{structure:B},props:{canAdd:{type:Boolean,required:!0}},data(){return{structures:[],ajoutUrl:unicaenVue.url("structure/saisie"),liste:this}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,s=>{console.log("coucou"),this.reload()})},reload(){unicaenVue.axios.get(unicaenVue.url("structure/liste")).then(n=>{this.structures=n.data})}}},vt=e("h1",null,"Administration des structures",-1),bt={class:"accordion"},gt=["href"],yt=e("i",{class:"fas fa-pen-to-square"},null,-1);function xt(n,s,t,_,l,r){const o=E("structure");return i(),a(p,null,[vt,e("div",bt,[(i(!0),a(p,null,g(l.structures,d=>(i(),C(o,{key:d.id,structure:d},null,8,["structure"]))),128))]),t.canAdd?(i(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:s[0]||(s[0]=b((...d)=>r.ajout&&r.ajout(...d),["prevent"])),title:"Ajouter une structure"},[yt,c(" Ajouter une structure ")],8,gt)):h("",!0)],64)}const kt=k(pt,[["render",xt]]),Ct=Object.freeze(Object.defineProperty({__proto__:null,default:kt},Symbol.toStringTag,{value:"Module"})),Vt={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},Pt=["id"],Et={class:"modal-dialog"},Dt={class:"modal-content"},Tt={class:"modal-header"},St={class:"modal-title"},Mt=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Rt={class:"modal-body"},wt={class:"modal-footer"},$t=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1);function jt(n,s,t,_,l,r){return i(),a("div",{class:"modal fade",id:t.id,tabindex:"-1","aria-hidden":"true"},[e("div",Et,[e("div",Dt,[e("div",Tt,[e("h5",St,u(t.title),1),Mt]),e("div",Rt,[O(n.$slots,"body")]),e("div",wt,[O(n.$slots,"footer"),$t])])])],8,Pt)}const At=k(Vt,[["render",jt]]),Ut={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String}}};function It(n,s,t,_,l,r){return i(),a("i",{class:D(`fas fa-${t.name} text-${t.variant}`)},null,2)}const M=k(Ut,[["render",It]]);const Ht={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(n){this.validationText=this.calcValidation(n)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":'<span class="bg-info">'+Util.formattedHeures(this.mission.heures)+"</span> heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(n){return n===null?"A valider":n.id===null?"Autovalidée":"Validation du "+Util.dateToString(n.histoCreation)+" par "},saisie(n){modAjax(n.currentTarget,s=>{this.refresh()})},supprimer(n){popConfirm(n.currentTarget,s=>{this.$emit("supprimer",this.mission)})},valider(n){popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},devalider(n){popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},volumeHoraireSupprimer(n){n.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},volumeHoraireValider(n){n.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},volumeHoraireDevalider(n){n.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(n=>{this.$emit("refresh",n.data)})}}},P=n=>(q("data-v-1735108d"),n=n(),L(),n),qt=["id"],Lt={class:"card-header card-header-h3"},Ot={key:0},Ft={class:"float-end"},Bt={key:1},Nt={key:2},zt={class:"float-end"},Gt={class:"card-body"},Yt={class:"row"},Jt={class:"col-md-8"},Wt={class:"row"},Qt={class:"col-md-12"},Xt=P(()=>e("label",{class:"form-label"},"Composante en charge du suivi",-1)),Zt={class:"form-control"},Kt={class:"row"},es={class:"col-md-6"},ts=P(()=>e("label",{class:"form-label"},"Taux de rémunération",-1)),ss={class:"form-control"},rs={class:"col-md-6"},is=P(()=>e("label",{class:"form-label"},"Taux majoré (dimanches/jours fériés)",-1)),as={class:"form-control"},os={class:"col-md-7"},ls=P(()=>e("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),ds={class:"input-group mb-3"},us=["innerHTML"],cs=["data-bs-target"],hs={key:0,class:"col-md-5"},ms=P(()=>e("label",{class:"form-label"},"Heures de formation prévues",-1)),_s={class:"form-control"},fs={class:"row"},ps={class:"col-md-12"},vs=P(()=>e("label",{class:"form-label"},"Descriptif de la mission",-1)),bs={class:"form-control"},gs={key:0,class:"row"},ys={class:"col-md-12"},xs=P(()=>e("label",{class:"form-label"},"Etudiants suivis",-1)),ks={class:"form-control"},Cs=P(()=>e("div",{class:"row"},[e("div",{class:"col-md-12"}," ")],-1)),Vs={class:"row"},Ps={class:"col-md-12"},Es=["href"],Ds=["href"],Ts=["href"],Ss=["href"],Ms={class:"col-md-4"},Rs=P(()=>e("div",null,[e("label",{class:"form-label"},"Suivi")],-1)),ws={class:"table table-bordered table-condensed"},$s=P(()=>e("thead",null,[e("tr",null,[e("th",null,"Heures"),e("th",null,"Statut"),e("th",null,"Actions")])],-1)),js={style:{"text-align":"right"}},As=P(()=>e("br",null,null,-1)),Us={key:0},Is=["data-id"],Hs=["data-id"],qs=["data-id"];function Ls(n,s,t,_,l,r){const o=R,d=M,m=E("utilisateur"),y=E("u-heures"),x=At;return i(),a(p,null,[e("div",{id:t.mission.id,class:D([{"bg-success":t.mission.valide,"bg-default":!t.mission.valide},"card"])},[e("form",{onSubmit:s[4]||(s[4]=b((...v)=>n.submitForm&&n.submitForm(...v),["prevent"]))},[e("div",Lt,[t.mission.libelleMission?(i(),a("h5",Ot,[c(u(t.mission.libelleMission)+" ",1),e("span",Ft,[c("Du "),f(o,{value:t.mission.dateDebut},null,8,["value"]),c(" au "),f(o,{value:t.mission.dateFin},null,8,["value"])])])):h("",!0),t.mission.libelleMission?(i(),a("h6",Bt,u(t.mission.typeMission.libelle),1)):h("",!0),t.mission.libelleMission?h("",!0):(i(),a("h5",Nt,[c(u(t.mission.typeMission.libelle)+" ",1),e("span",zt,[c("Du "),f(o,{value:t.mission.dateDebut},null,8,["value"]),c(" au "),f(o,{value:t.mission.dateFin},null,8,["value"])])]))]),e("div",Gt,[e("div",Yt,[e("div",Jt,[e("div",Wt,[e("div",Qt,[Xt,e("div",Zt,u(t.mission.structure.libelle),1)])]),e("div",Kt,[e("div",es,[ts,e("div",ss,u(t.mission.tauxRemu?t.mission.tauxRemu.libelle:null),1)]),e("div",rs,[is,e("div",as,u(t.mission.tauxRemuMajore?t.mission.tauxRemuMajore.libelle:t.mission.tauxRemu?"Idem ("+t.mission.tauxRemu.libelle+")":null),1)]),e("div",os,[ls,e("div",ds,[e("div",{class:"form-control",innerHTML:r.heuresLib},null,8,us),e("button",{"data-bs-target":`#details-${t.mission.id}`,class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal"}," Détails ",8,cs)])]),t.mission.typeMission.besoinFormation?(i(),a("div",hs,[ms,e("div",_s,u(t.mission.heuresFormation),1)])):h("",!0)]),e("div",fs,[e("div",ps,[vs,e("div",bs,u(t.mission.description),1)])]),t.mission.typeMission.accompagnementEtudiants?(i(),a("div",gs,[e("div",ys,[xs,e("div",ks,[e("pre",null,u(t.mission.etudiantsSuivis),1)])])])):h("",!0),Cs,e("div",Vs,[e("div",Ps,[t.mission.canSaisie?(i(),a("a",{key:0,href:l.saisieUrl,class:"btn btn-primary",onClick:s[0]||(s[0]=b((...v)=>r.saisie&&r.saisie(...v),["prevent"]))},"Modifier",8,Es)):h("",!0),t.mission.canValider?(i(),a("a",{key:1,href:l.validerUrl,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider la mission ?","data-title":"Validation de la mission",onClick:s[1]||(s[1]=b((...v)=>r.valider&&r.valider(...v),["prevent"]))},"Valider",8,Ds)):h("",!0),t.mission.canDevalider?(i(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider la mission ?","data-title":"Dévalidation de la mission",onClick:s[2]||(s[2]=b((...v)=>r.devalider&&r.devalider(...v),["prevent"]))},"Dévalider",8,Ts)):h("",!0),t.mission.canSupprimer?(i(),a("a",{key:3,href:l.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer la mission ?","data-title":"Suppression de la mission",onClick:s[3]||(s[3]=b((...v)=>r.supprimer&&r.supprimer(...v),["prevent"]))},"Supprimer",8,Ss)):h("",!0)])])]),e("div",Ms,[Rs,e("div",null,[f(d,{name:"thumbs-up",variant:"success"}),c(" Créé le "),f(o,{value:t.mission.histoCreation},null,8,["value"]),c(" par "),f(m,{mail:t.mission.histoCreateur.email,nom:t.mission.histoCreateur.displayName},null,8,["mail","nom"])]),e("div",null,[f(d,{name:t.mission.valide?"thumbs-up":"thumbs-down",variant:t.mission.valide?"success":"info"},null,8,["name","variant"]),c(" "+u(l.validationText)+" ",1),t.mission.validation&&t.mission.validation.histoCreateur?(i(),C(m,{key:0,mail:t.mission.validation.histoCreateur.email,nom:t.mission.validation.histoCreateur.displayName},null,8,["mail","nom"])):h("",!0)]),e("div",null,[f(d,{name:t.mission.contrat?"thumbs-up":"thumbs-down",variant:t.mission.contrat?"success":"info"},null,8,["name","variant"]),c(" "+u(t.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),e("div",null,u(t.mission.heuresRealisees)+" heure"+u(t.mission.heuresRealisees<2?"":"s")+" réalisée"+u(t.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,qt),f(x,{id:`details-${t.mission.id}`,title:"Détail des heures prévisionnelles"},{body:F(()=>[e("table",ws,[$s,e("tbody",null,[(i(!0),a(p,null,g(t.mission.volumesHorairesPrevus,v=>(i(),a("tr",{key:v.id},[e("td",js,[f(y,{valeur:v.heures},null,8,["valeur"])]),e("td",null,[f(d,{name:"thumbs-up",variant:"success"}),c(" Saisi par "),f(m,{mail:v.histoCreateur.email,nom:v.histoCreateur.displayName},null,8,["mail","nom"]),c(" le "),f(o,{value:v.histoCreation},null,8,["value"]),As,f(d,{name:v.valide?"thumbs-up":"thumbs-down",variant:v.valide?"success":"info"},null,8,["name","variant"]),c(" "+u(v.validation&&v.validation.id==null?"Autovalidé":v.validation?"":"à valider")+" ",1),v.validation&&v.validation.histoCreateur?(i(),a("span",Us,[c(" Validé par "),f(m,{mail:v.validation.histoCreateur.email,nom:v.validation.histoCreateur.displayName},null,8,["mail","nom"]),c(" le "),f(o,{value:v.validation.histoCreation},null,8,["value"])])):h("",!0)]),e("td",null,[v.canValider?(i(),a("a",{key:0,"data-id":v.id,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?","data-title":"Validation du volume horaire",onClick:s[5]||(s[5]=b((...w)=>r.volumeHoraireValider&&r.volumeHoraireValider(...w),["prevent"]))},"Valider",8,Is)):h("",!0),v.canDevalider?(i(),a("a",{key:1,"data-id":v.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?","data-title":"Dévalidation du volume horaire",onClick:s[6]||(s[6]=b((...w)=>r.volumeHoraireDevalider&&r.volumeHoraireDevalider(...w),["prevent"]))},"Dévalider",8,Hs)):h("",!0),v.canSupprimer?(i(),a("a",{key:2,"data-id":v.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?","data-title":"Suppression du volume horaire",onClick:s[7]||(s[7]=b((...w)=>r.volumeHoraireSupprimer&&r.volumeHoraireSupprimer(...w),["prevent"]))},"Supprimer",8,qs)):h("",!0)])]))),128))])])]),footer:F(()=>[]),_:1},8,["id"])],64)}const N=k(Ht,[["render",Ls],["__scopeId","data-v-1735108d"]]),Os=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"})),Fs={components:{mission:N},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],isMounted:!1,ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,s=>{this.reload()})},supprimer(n){this.reload()},refresh(n){let s=Util.json.indexById(this.missions,n.id);this.missions[s]=n,this.refreshPlafonds()},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(n=>{this.missions=n.data,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?($(".plafonds").refresh(),$("#sidebar").refresh()):this.isMounted=!0}}},Bs=["href"];function Ns(n,s,t,_,l,r){const o=E("mission");return i(),a(p,null,[(i(!0),a(p,null,g(l.missions,d=>(i(),C(o,{onSupprimer:r.supprimer,onRefresh:r.refresh,key:d.id,mission:d},null,8,["onSupprimer","onRefresh","mission"]))),128)),t.canAddMission?(i(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:s[0]||(s[0]=b((...d)=>r.ajout&&r.ajout(...d),["prevent"]))},"Ajout d'une nouvelle mission",8,Bs)):h("",!0)],64)}const zs=k(Fs,[["render",Ns]]),Gs=Object.freeze(Object.defineProperty({__proto__:null,default:zs},Symbol.toStringTag,{value:"Module"})),Ys={name:"ListeCandidatures.vue",props:{intervenant:{required:!0},canValiderCandidature:{type:Boolean,required:!1}},data(){return{candidatures:[],urlListeOffre:unicaenVue.url("offre-emploi")}},mounted(){this.reload()},methods:{reload(){unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/get-candidatures",{intervenant:this.intervenant})).then(n=>{this.candidatures=n.data})},validerCandidature(n){modAjax(n.currentTarget,s=>{this.reload()})},refuserCandidature(n){popConfirm(n.target,s=>{this.reload()})},urlOffre(n){return unicaenVue.url("offre-emploi/detail/:offre",{offre:n.offre.id})},urlAccepterCandidature:function(n){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:n.id})},urlRefuserCandidature:function(n){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:n.id})}}},Js={class:"table table-bordered"},Ws=e("th",null,"Offre d'emploi",-1),Qs=e("th",null,"Composante",-1),Xs=e("th",null,"Etat",-1),Zs=e("th",null,"Date commission",-1),Ks={key:0},en={key:0},tn={key:0,colspan:"5",style:{"text-align":"center"}},sn={style:{"text-align":"center"}},nn=["href"],rn={style:{"text-align":"center"}},an={style:{"text-align":"center"}},on={key:0,class:"badge rounded-pill bg-success"},ln={key:1,class:"badge rounded-pill bg-danger"},dn={key:2,class:"badge rounded-pill bg-warning"},un={key:0,style:{"text-align":"center"}},cn=["href"],hn=e("i",{class:"fa-solid fa-check"},null,-1),mn=[hn],_n=["href"],fn=e("i",{class:"fa-sharp fa-solid fa-xmark"},null,-1),pn=[fn],vn=["href"];function bn(n,s,t,_,l,r){const o=R,d=M;return i(),a("div",null,[e("table",Js,[e("thead",null,[e("tr",null,[Ws,Qs,Xs,Zs,t.canValiderCandidature?(i(),a("th",Ks,"Action")):h("",!0)])]),e("tbody",null,[l.candidatures.length==0?(i(),a("tr",en,[t.canValiderCandidature?(i(),a("td",tn,"Aucune candidature")):h("",!0)])):h("",!0),(i(!0),a(p,null,g(l.candidatures,m=>(i(),a("tr",{key:m.id},[e("td",sn,[e("a",{href:r.urlOffre(m)},u(m.offre.titre),9,nn)]),e("td",rn,u(m.offre.structure.libelleCourt),1),e("td",an,[m.validation?(i(),a("span",on,"Acceptée par "+u(m.validation.histoCreateur.displayName),1)):h("",!0),!m.validation&&m.motif!==null?(i(),a("span",ln,u(m.motif),1)):h("",!0),!m.validation&&m.motif===null?(i(),a("span",dn,"En attente d'acceptation")):h("",!0)]),e("td",null,[m.dateCommission?(i(),C(o,{key:0,value:m.dateCommission},null,8,["value"])):h("",!0)]),this.canValiderCandidature?(i(),a("td",un,[m.validation?h("",!0):(i(),a("a",{key:0,href:r.urlAccepterCandidature(m),class:"btn btn-success","data-content":"Êtes vous sûr de vouloir accepter cette candidature ?","data-title":"Accepter la candidature",style:{color:"white"},title:"Accepter la candidature",onClick:s[0]||(s[0]=b((...y)=>r.validerCandidature&&r.validerCandidature(...y),["prevent"]))},mn,8,cn)),c("  "),e("a",{href:r.urlRefuserCandidature(m),class:"btn btn-danger","data-content":"Êtes vous sûr de vouloir refuser cette candidature ?","data-title":"Refuser la candidature",style:{color:"white"},title:"Refuser la candidature",onClick:s[1]||(s[1]=b((...y)=>r.refuserCandidature&&r.refuserCandidature(...y),["prevent"]))},pn,8,_n)])):h("",!0)]))),128))])]),e("a",{href:l.urlListeOffre,class:"btn btn-primary",title:"Voir les offres d'emploi"},[f(d,{name:"eye"}),c(" Voir toutes les offres d'emploi ")],8,vn),c("  ")])}const gn=k(Ys,[["render",bn]]),yn=Object.freeze(Object.defineProperty({__proto__:null,default:gn},Symbol.toStringTag,{value:"Module"})),xn={name:"OffreEmploi.vue",props:{offre:{required:!0},utilisateur:{required:!1},extended:{type:Boolean,required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},decretText:{type:String,required:!1}},data(){return{saisirUrl:unicaenVue.url("offre-emploi/saisir/:offre",{offre:this.offre.id}),supprimerUrl:unicaenVue.url("offre-emploi/supprimer/:offre",{offre:this.offre.id}),validerUrl:unicaenVue.url("offre-emploi/valider/:offre",{offre:this.offre.id}),devaliderUrl:unicaenVue.url("offre-emploi/devalider/:offre",{offre:this.offre.id}),consulterUrl:unicaenVue.url("offre-emploi/detail/:offre",{offre:this.offre.id}),offreEmploiUrl:unicaenVue.url("offre-emploi"),postulerUrl:unicaenVue.url("offre-emploi/postuler/:id",{id:this.offre.id}),decret:!1}},computed:{isCandidat:function(){return!1},shortDesc:function(){if(!this.offre.description)return"";let n=this.offre.description.substr(0,200);return this.offre.description.length>200&&(n+="..."),n},descriptionHtml:function(){return this.offre.description?this.offre.description.replace(/(?:\r\n|\r|\n)/g,"<br />"):""},connectionLink:function(){let n="auth/connexion?redirect="+window.location.href;return unicaenVue.url(n)}},mounted(){this.decretText||(this.decret=!0)},methods:{saisir(n){modAjax(n.target,s=>{this.refresh()})},urlVoir:function(n){return unicaenVue.url("intervenant/:code/voir",{code:"code:"+n.intervenant.code})},urlVoirCandidature:function(n){return unicaenVue.url("intervenant/:code/candidature",{code:"code:"+n.intervenant.code})},urlAccepterCandidature:function(n){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:n.id})},urlRefuserCandidature:function(n){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:n.id})},refresh(){unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.offre.id})).then(n=>{this.$emit("refresh",n.data)})},supprimer(n){popConfirm(n.target,s=>{this.$emit("supprimer",this.offre)})},postuler(n){popConfirm(n.target,s=>{this.$emit("postuler",this.offre)})},valider(n){popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},devalider(n){popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},validerCandidature(n){popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})},refuserCandidature(n){popConfirm(n.currentTarget,s=>{this.$emit("refresh",s.data)})}}},kn={key:0,class:"col"},Cn={class:"card h-100"},Vn={class:"card-header"},Pn={class:"badge rounded-pill bg-info"},En={key:0,class:"badge rounded-pill bg-success"},Dn={key:1,class:"badge rounded-pill bg-warning"},Tn={class:"card-body"},Sn={class:"bg-light",style:{padding:"5px"}},Mn=e("b",null,"Créée le : ",-1),Rn=e("br",null,null,-1),wn=e("b",null,"Période à pourvoir : ",-1),$n=e("br",null,null,-1),jn=e("b",null,"Demandée par la composante :",-1),An=e("br",null,null,-1),Un=e("b",null,"Type de mission :",-1),In={class:"card-footer"},Hn={class:"d-grid gap-2 d-md-flex justify-content-md-end"},qn=["href"],Ln={key:1},On={class:"page-header"},Fn={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},Bn=e("i",{class:"fa-solid fa-user"},null,-1),Nn={class:"ms-2"},zn=["href"],Gn={key:1,class:"alert alert-primary d-flex align-items-center",role:"alert"},Yn=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Jn=e("div",{class:"ms-2"}," Vous n'avez pas les droits pour postuler à cette offre, merci de contacter votre administration de rattachement. ",-1),Wn=[Yn,Jn],Qn={key:2,class:"alert alert-primary d-flex align-items-center",role:"alert"},Xn=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Zn=e("div",{class:"ms-2"}," Vous avez déjà postulé à cette offre. ",-1),Kn=[Xn,Zn],er={class:"bg-light",style:{padding:"10px"}},tr=e("b",null,"Créée le : ",-1),sr=e("br",null,null,-1),nr=e("b",null,"Période à pourvoir : ",-1),rr=e("br",null,null,-1),ir=e("b",null,"Date limite de candidature :",-1),ar=e("br",null,null,-1),or=e("b",null,"Demandé par la composante :",-1),lr=e("br",null,null,-1),dr=e("b",null,"Type de mission :",-1),ur=e("br",null,null,-1),cr=e("b",null,"Nombre d'heures pour la mission :",-1),hr=e("br",null,null,-1),mr=e("b",null,"Nombre de postes à pourvoir :",-1),_r=e("br",null,null,-1),fr=["innerHTML"],pr={key:3,class:"alert alert-info"},vr=["innerHTML"],br=e("br",null,null,-1),gr={key:4},yr=e("h5",null,[e("strong",null,"Liste des candidats :")],-1),xr={class:"table table-bordered"},kr=e("th",null,"Intervenant",-1),Cr=e("th",null,"Etat",-1),Vr={key:0},Pr={key:0},Er={key:0,colspan:"4",style:{"text-align":"center"}},Dr={key:1,colspan:"3",style:{"text-align":"center"}},Tr=["href"],Sr={key:0,class:"badge rounded-pill bg-success"},Mr={key:1,class:"badge rounded-pill bg-danger"},Rr={key:2,class:"badge rounded-pill bg-warning"},wr={key:0},$r=["href"],jr={class:"mt-5"},Ar=["href"],Ur=["href"],Ir=["href"],Hr=["href"],qr=["href"],Lr=["href"];function Or(n,s,t,_,l,r){const o=R,d=M;return i(),a(p,null,[this.extended?h("",!0):(i(),a("div",kn,[e("div",Cn,[e("div",Vn,[e("h4",null,u(t.offre.titre),1),e("span",Pn,u(t.offre.nombreHeures)+" heure(s)",1),c("   "),t.offre.validation?(i(),a("span",En,[c("Validée le "),f(o,{value:t.offre.validation.histoCreation},null,8,["value"]),c(" par "+u(t.offre.validation.histoCreateur.displayName),1)])):h("",!0),t.offre.validation?h("",!0):(i(),a("span",Dn," En attente de validation par la DRH")),c("  ")]),e("div",Tn,[e("p",Sn,[Mn,f(o,{value:t.offre.histoCreation},null,8,["value"]),c(" par "+u(t.offre.histoCreateur.displayName),1),Rn,wn,c("du "),f(o,{value:t.offre.dateDebut},null,8,["value"]),c(" au "),f(o,{value:t.offre.dateFin},null,8,["value"]),$n,jn,c(" "+u(t.offre.structure.libelleCourt)+" ",1),An,Un,c(" "+u(t.offre.typeMission.libelle),1)]),c(" "+u(r.shortDesc),1)]),e("div",In,[e("div",Hn,[e("a",{href:l.consulterUrl,class:"btn btn-primary",title:"Consulter "},[f(d,{name:"eye"}),c(" Voir ")],8,qn)])])])])),this.extended?(i(),a("div",Ln,[e("h1",On,u(t.offre.titre),1),this.utilisateur?h("",!0):(i(),a("div",Fn,[Bn,e("div",Nn,[c(" Vous devez "),e("a",{href:r.connectionLink,class:"text-decoration-underline alert-link"},"être identifé",8,zn),c(" pour pouvoir postuler. ")])])),!t.offre.canPostuler&&this.utilisateur?(i(),a("div",Gn,Wn)):h("",!0),r.isCandidat&&this.utilisateur?(i(),a("div",Qn,Kn)):h("",!0),e("p",er,[tr,f(o,{value:t.offre.histoCreation},null,8,["value"]),c(" par "+u(t.offre.histoCreateur.displayName),1),sr,nr,c("du "),f(o,{value:t.offre.dateDebut},null,8,["value"]),c(" au "),f(o,{value:t.offre.dateFin},null,8,["value"]),rr,ir,f(o,{value:t.offre.dateLimite},null,8,["value"]),ar,or,c(" "+u(t.offre.structure.libelleCourt)+" ",1),lr,dr,c(" "+u(t.offre.typeMission.libelle)+" ",1),ur,cr,c(" "+u(t.offre.nombreHeures)+" heure(s) ",1),hr,mr,c(" "+u(t.offre.nombrePostes)+" poste(s) ",1),_r]),e("p",{innerHTML:this.descriptionHtml},null,8,fr),this.decretText?(i(),a("p",pr,[S(e("input",{id:"decret","onUpdate:modelValue":s[0]||(s[0]=m=>l.decret=m),name:"decret",type:"checkbox"},null,512),[[j,l.decret]]),c("  "),e("span",{innerHTML:this.decretText},null,8,vr)])):h("",!0),br,this.canValiderCandidature?(i(),a("div",gr,[yr,e("table",xr,[e("thead",null,[e("tr",null,[kr,Cr,t.canValiderCandidature?(i(),a("th",Vr,"Action")):h("",!0)])]),e("tbody",null,[t.offre.candidatures.length==0?(i(),a("tr",Pr,[t.canValiderCandidature?(i(),a("td",Er,"Aucune candidature")):h("",!0),t.canValiderCandidature?h("",!0):(i(),a("td",Dr,"Aucune candidature"))])):h("",!0),(i(!0),a(p,null,g(t.offre.candidatures,m=>(i(),a("tr",null,[e("td",null,[e("a",{href:r.urlVoir(m)},u(m.intervenant.prenom+" "+m.intervenant.nomUsuel),9,Tr)]),e("td",null,[m.validation?(i(),a("span",Sr,[c("Acceptée le "),f(o,{value:m.validation.histoCreation},null,8,["value"]),c(" par "+u(m.validation.histoCreateur.displayName),1)])):h("",!0),!m.validation&&m.motif!==null?(i(),a("span",Mr,u(m.motif),1)):h("",!0),!m.validation&&m.motif===null?(i(),a("span",Rr,"En attente d'acceptation")):h("",!0)]),this.canValiderCandidature?(i(),a("td",wr,[e("a",{href:r.urlVoirCandidature(m),class:"btn btn-primary",title:"Consulter "},[f(d,{name:"eye"}),c(" Voir ")],8,$r)])):h("",!0)]))),256))])])])):h("",!0),e("div",jr,[e("a",{href:l.offreEmploiUrl,class:"btn btn-secondary"},"Retour aux offres",8,Ar),c("  "),this.canPostuler?(i(),a("a",{key:0,class:D([l.decret?"":"disabled","btn btn-primary"]),href:l.postulerUrl,"data-bs-original-title":"Vous devez être connecté pour postuler","data-bs-placement":"top","data-bs-toggle":"tooltip"},"Postuler",10,Ur)):h("",!0),c("  "),t.offre.canModifier?(i(),a("a",{key:1,href:l.saisirUrl,class:"btn btn-primary",title:"Modifier",onClick:s[1]||(s[1]=b((...m)=>r.saisir&&r.saisir(...m),["prevent"]))},[f(d,{name:"pen-to-square"}),c(" Modifier ")],8,Ir)):h("",!0),c("  "),t.offre.validation&&t.offre.canValider?(i(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger",title:"Devalider",onClick:s[2]||(s[2]=b((...m)=>r.devalider&&r.devalider(...m),["prevent"]))},[f(d,{name:"thumbs-down"}),c(" Devalider ")],8,Hr)):h("",!0),c("  "),!t.offre.validation&&t.offre.canValider?(i(),a("a",{key:3,href:l.validerUrl,class:"btn btn-success",title:"Valider",onClick:s[3]||(s[3]=b((...m)=>r.valider&&r.valider(...m),["prevent"]))},[f(d,{name:"thumbs-up"}),c(" Valider ")],8,qr)):h("",!0),c("  "),t.offre.canSupprimer?(i(),a("a",{key:4,href:l.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer l'offre ?","data-title":"Suppression de l'offre",title:"Supprimer",onClick:s[4]||(s[4]=b((...m)=>r.supprimer&&r.supprimer(...m),["prevent"]))},[f(d,{name:"trash"}),c(" Supprimer ")],8,Lr)):h("",!0)])])):h("",!0)],64)}const z=k(xn,[["render",Or]]),Fr=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"})),Br={components:{offreEmploi:z},props:{id:{type:Number,required:!1},utilisateur:{required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1}},data(){return{offres:[],ajoutUrl:unicaenVue.url("offre-emploi/saisir")}},mounted(){this.reload()},computed:{extended:function(){return!!this.id}},methods:{ajout(n){modAjax(n.target,s=>{this.reload()})},supprimer(){window.location.href=unicaenVue.url("offre-emploi")},refresh(n){let s=Util.json.indexById(this.offres,n.id);this.offres[s]=n},reload(){this.id?unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.id})).then(n=>{this.offres=[n.data]}):unicaenVue.axios.get(unicaenVue.url("offre-emploi/liste")).then(n=>{this.offres=n.data})}}},Nr={key:0,class:"row row-cols-1 row-cols-md-2 g-4 mb-3"},zr={key:1},Gr=["href"],Yr={key:2};function Jr(n,s,t,_,l,r){const o=E("offreEmploi");return i(),a(p,null,[r.extended?h("",!0):(i(),a("div",Nr,[(i(!0),a(p,null,g(l.offres,d=>(i(),C(o,{key:d.id,canModifier:this.canModifier,canSupprimer:this.canSupprimer,canValider:this.canValider,canVoirCandidature:this.canVoirCandidature,offre:d,decretText:d.decretText,onRefresh:r.refresh,onSupprimer:r.supprimer},null,8,["canModifier","canSupprimer","canValider","canVoirCandidature","offre","decretText","onRefresh","onSupprimer"]))),128))])),r.extended?h("",!0):(i(),a("div",zr,[this.canModifier?(i(),a("a",{key:0,href:l.ajoutUrl,class:"btn btn-primary",onClick:s[0]||(s[0]=b((...d)=>r.ajout&&r.ajout(...d),["prevent"]))},"Ajouter une nouvelle offre",8,Gr)):h("",!0)])),r.extended?(i(),a("div",Yr,[(i(!0),a(p,null,g(l.offres,d=>(i(),C(o,{key:d.id,canModifier:this.canModifier,canPostuler:this.canPostuler,canSupprimer:this.canSupprimer,canValider:this.canValider,canValiderCandidature:this.canValiderCandidature,canVoirCandidature:this.canVoirCandidature,decretText:d.decretText,extended:r.extended,offre:d,utilisateur:this.utilisateur,onRefresh:r.refresh,onSupprimer:r.supprimer},null,8,["canModifier","canPostuler","canSupprimer","canValider","canValiderCandidature","canVoirCandidature","decretText","extended","offre","utilisateur","onRefresh","onSupprimer"]))),128))])):h("",!0)],64)}const Wr=k(Br,[["render",Jr]]),Qr=Object.freeze(Object.defineProperty({__proto__:null,default:Wr},Symbol.toStringTag,{value:"Module"})),Xr={name:"Prime.vue",props:{prime:{required:!0},numero:{required:!1},intervenant:{required:!0},canGerer:{type:Boolean,required:!1}},data(){return{declarationUrl:unicaenVue.url("prime/:intervenant/declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerUrl:unicaenVue.url("prime/:intervenant/supprimer-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),validerUrl:unicaenVue.url("prime/:intervenant/valider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),devaliderUrl:unicaenVue.url("prime/:intervenant/devalider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),telechargerUrl:unicaenVue.url("prime/:intervenant/telecharger-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),refuserUrl:unicaenVue.url("prime/:intervenant/refuser-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),modifierPrimeUrl:unicaenVue.url("prime/:intervenant/saisie/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerPrimeUrl:unicaenVue.url("prime/:intervenant/supprimer-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id})}},computed:{},methods:{supprimer(n){popConfirm(n.target,s=>{this.$emit("reload")})},valider(n){popConfirm(n.target,s=>{this.$emit("reload")})},devalider(n){popConfirm(n.target,s=>{this.$emit("reload")})},refuser(){unicaenVue.axios.post(this.refuserUrl).then(n=>{this.$emit("reload")})},modifierPrime(n){modAjax(n.currentTarget,s=>{this.$emit("reload")})},supprimerPrime(n){popConfirm(n.target,s=>{this.$emit("reload")})}}},Zr={key:0},Kr=e("br",null,null,-1),ei=e("u",null,"Mission(s) concernée(s)",-1),ti={key:0},si=["action"],ni={class:"card-body"},ri={class:"row"},ii={key:0,class:"col-md-6"},ai={class:"card text-dark bg-light"},oi=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),li={class:"card-body"},di=e("p",{class:"card-text"},[c(" Pour "),e("b",null,"bénéficier de votre indemnité de fin de contrat"),c(", vous devez déposer une déclaration sur l'honneur ("),e("a",{href:""},"exemple"),c(") signée précisant que vous ne débutez pas d'autre contrat dans la fonction au publique à la suite de ces missions. ")],-1),ui=["disabled"],ci={class:"card-footer d-grid gap-2"},hi=["disabled"],mi={key:1,class:"col-md-6"},_i={class:"card text-dark bg-light"},fi=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),pi={class:"card-body"},vi=e("p",{class:"card-text"},"Vous pouvez télécharger votre déclaration sur l'honneur ci-dessous : ",-1),bi=["href"],gi={class:"card-footer",style:{"text-align":"right"}},yi=["href"],xi=["href"],ki=["href"],Ci={class:"col-md-6"},Vi={key:0},Pi=["checked","disabled"],Ei=e("b",null,"je déclare ne pas pouvoir bénéficier d'une indemnité",-1),Di=e("br",null,null,-1),Ti=e("br",null,null,-1),Si=e("div",null,[e("label",{class:"form-label"},"Suivi de la déclaration : ")],-1),Mi={key:0},Ri={key:1},wi={key:2},$i={key:3},ji={key:4},Ai={key:5},Ui={key:6},Ii={class:"row"},Hi={class:"col-md-12"},qi={class:"float-end"},Li=["href"],Oi=["href"];function Fi(n,s,t,_,l,r){const o=R,d=M;return i(),a("div",{class:D([{"bg-success":t.prime.validation,"bg-default":!t.prime.validation&&!t.prime.dateRefus,"bg-danger":t.prime.dateRefus},"card"])},[e("div",{class:D([{"text-white":t.prime.dateRefus},"card-header card-header-h3"])},[t.prime.id?(i(),a("h5",Zr,[c(" Indemnité de fin de contrat N°"+u(t.numero+1),1),Kr])):h("",!0),e("div",null,[ei,c(" : "),(i(!0),a(p,null,g(t.prime.missions,(m,y)=>(i(),a("span",null,[c(u(m.typeMission.libelle)+" (Pour "+u(m.structure.libelleCourt)+" du ",1),f(o,{value:m.dateDebut},null,8,["value"]),c(" au "),f(o,{value:m.dateFin},null,8,["value"]),c(") "),y!=t.prime.missions.length-1?(i(),a("span",ti,", ")):h("",!0)]))),256))])],2),e("form",{action:l.declarationUrl,enctype:"multipart/form-data",method:"post"},[e("div",ni,[e("div",ri,[t.prime.declaration?h("",!0):(i(),a("div",ii,[e("div",ai,[oi,e("div",li,[di,e("input",{ref:"file",disabled:!!t.prime.dateRefus,name:"files[]",type:"file"},null,8,ui)]),e("div",ci,[e("input",{disabled:!!t.prime.dateRefus,class:"btn btn-primary",type:"submit",value:"Envoyer"},null,8,hi)])])])),t.prime.declaration?(i(),a("div",mi,[e("div",_i,[fi,e("div",pi,[vi,e("a",{href:l.telechargerUrl},u(t.prime.declaration.nom),9,bi)]),e("div",gi,[t.prime.declaration&&!t.prime.validation&&!t.prime.dateRefus?(i(),a("a",{key:0,href:l.supprimerUrl,class:"btn btn-danger",title:"Supprimer",onClick:s[0]||(s[0]=b((...m)=>r.supprimer&&r.supprimer(...m),["prevent"]))}," Supprimer ",8,yi)):h("",!0),c("  "),t.prime.declaration&&!t.prime.validation&&this.canGerer&&!t.prime.dateRefus?(i(),a("a",{key:1,href:l.validerUrl,class:"btn btn-success",title:"Valider",onClick:s[1]||(s[1]=b((...m)=>r.valider&&r.valider(...m),["prevent"]))}," Valider ",8,xi)):h("",!0),c("  "),t.prime.declaration&&t.prime.validation&&this.canGerer&&!t.prime.dateRefus?(i(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger d-grid gap-2",title:"Dévalider",onClick:s[2]||(s[2]=b((...m)=>r.devalider&&r.devalider(...m),["prevent"]))}," Dévalider ",8,ki)):h("",!0),c("  ")])])])):h("",!0),e("div",Ci,[t.prime.validation?h("",!0):(i(),a("div",Vi,[e("input",{checked:t.prime.dateRefus,disabled:t.prime.validation,name:"prime",type:"checkbox",onChange:s[3]||(s[3]=(...m)=>r.refuser&&r.refuser(...m))},null,40,Pi),c("  Ou en cochant cette case, "),Ei,c(" de fin de contrat en raison du démarrage d'un nouveau contrat au sein de la fonction publique à la suite de ces missions. "),Di,Ti])),e("div",null,[Si,t.prime.dateRefus?(i(),a("div",Mi,[f(d,{name:"thumbs-down",variant:"danger"}),c(" Indemnité refusée le "),f(o,{value:t.prime.dateRefus},null,8,["value"])])):h("",!0),t.prime.declaration&&!t.prime.dateRefus?(i(),a("div",Ri,[f(d,{name:"thumbs-up",variant:"success"}),c(" Déclaration déposée le "),f(o,{value:t.prime.declaration.histoCreation},null,8,["value"]),c(" par "+u(t.prime.declaration.histoCreateur.displayName),1)])):h("",!0),!t.prime.declaration&&!t.prime.dateRefus?(i(),a("div",wi,[f(d,{name:"thumbs-down",variant:"info"}),c(" Aucune déclaration déposée ")])):h("",!0),t.prime.validation&&!t.prime.dateRefus?(i(),a("div",$i,[f(d,{name:"thumbs-up",variant:"success"}),c(" Déclaration validée le "),f(o,{value:t.prime.validation.histoCreation},null,8,["value"]),c(" par "+u(t.prime.validation.histoCreateur.displayName),1)])):h("",!0),!t.prime.validation&&!t.prime.dateRefus?(i(),a("div",ji,[f(d,{name:"thumbs-down",variant:"info"}),c(" Aucune déclaration validée ")])):h("",!0),t.prime.validation&&!t.prime.dateRefus?(i(),a("div",Ai,[f(d,{name:"euro-sign",variant:"success"}),c(" Intervenant éligible à une indemnité de fin de contrat ")])):h("",!0),t.prime.dateRefus?(i(),a("div",Ui,[f(d,{name:"euro-sign",variant:"info"}),c(" Intervenant non éligible à une indemnité de fin de contrat ")])):h("",!0)])])]),e("div",Ii,[e("div",Hi,[e("span",qi,[!t.prime.validation&&!t.prime.dateRefus&&this.canGerer?(i(),a("a",{key:0,href:l.modifierPrimeUrl,class:"btn btn-primary",onClick:s[4]||(s[4]=b((...m)=>r.modifierPrime&&r.modifierPrime(...m),["prevent"]))},"Modifier",8,Li)):h("",!0),c("   "),!t.prime.validation&&!t.prime.dateRefus&&this.canGerer?(i(),a("a",{key:1,href:l.supprimerPrimeUrl,class:"btn btn-danger",onClick:s[5]||(s[5]=b((...m)=>r.supprimerPrime&&r.supprimerPrime(...m),["prevent"]))},"Supprimer",8,Oi)):h("",!0)])])])])],8,si)],2)}const G=k(Xr,[["render",Fi]]),Bi=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"})),Ni={components:{prime:G},props:{intervenant:{type:Number,required:!0},numero:{type:Number,required:!1},missionsWithoutPrime:{type:Number,required:!1},canGerer:{type:Boolean,required:!1}},data(){return{load:!1,primes:[],ajoutUrl:unicaenVue.url("prime/:intervenant/saisie/",{intervenant:this.intervenant})}},mounted(){this.reload(),console.log(this.primes.length)},methods:{ajout(n){modAjax(n.currentTarget,s=>{this.reload()})},reload(){this.load=!1,this.primes=[],unicaenVue.axios.get(unicaenVue.url("prime/:intervenant/liste",{intervenant:this.intervenant})).then(n=>{this.primes=n.data,this.load=!0})}}},zi={key:0,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},Gi=e("br",null,null,-1),Yi=e("br",null,null,-1),Ji={key:1,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},Wi=e("br",null,null,-1),Qi=e("br",null,null,-1),Xi={key:2},Zi=["href"];function Ki(n,s,t,_,l,r){const o=E("prime");return i(),a(p,null,[(i(!0),a(p,null,g(l.primes,(d,m)=>(i(),C(o,{canGerer:t.canGerer,intervenant:this.intervenant,numero:m,prime:d,onReload:r.reload},null,8,["canGerer","intervenant","numero","prime","onReload"]))),256)),l.load?h("",!0):(i(),a("div",zi,[c(" Chargement en cours..."),Gi,Yi])),l.primes.length==0&&l.load?(i(),a("div",Ji,[c(" Aucune indemnité de fin de contrat actuellement..."),Wi,Qi])):h("",!0),this.missionsWithoutPrime>0&&this.canGerer?(i(),a("div",Xi,[e("a",{href:l.ajoutUrl,class:"btn btn-primary",onClick:s[0]||(s[0]=b((...d)=>r.ajout&&r.ajout(...d),["prevent"]))},"Créer une nouvelle indemnité",8,Zi)])):h("",!0)],64)}const ea=k(Ni,[["render",Ki]]),ta=Object.freeze(Object.defineProperty({__proto__:null,default:ea},Symbol.toStringTag,{value:"Module"}));const sa={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0},addDateDebut:{type:String,required:!1},addDateFin:{type:String,required:!1}},data(){const n=new Date(this.date);return{mois:n.getMonth()+1,annee:n.getFullYear()}},computed:{listeJours(){const n=new Date(this.date);n.setDate(1),n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1);let s=n.getDate();return Array.from({length:s},(t,_)=>_+1)}},watch:{date:function(n,s){const t=new Date(this.date);this.mois=t.getMonth()+1,this.annee=t.getFullYear()},mois:function(n,s){const t=new Date(this.date);t.setMonth(n-1),this.$emit("changeDate",t)},annee:function(n,s){const t=new Date(this.date);t.setFullYear(n),this.$emit("changeDate",t)}},methods:{nomJour(n){const s=new Date(this.date);return s.setDate(n),s.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let n=[];const s=new Date;for(let t=1;t<=12;t++){s.setMonth(t-1);let _=s.toLocaleString("fr-FR",{month:"long"});n.push({id:t,libelle:_})}return n},listeAnnees(){const s=new Date().getFullYear(),t=1;let _=[];for(let l=s-t;l<=s+t;l++)_.push(l);return _},canAdd(n){if(!this.canAddEvent)return!1;let s=this.addDateDebut;s===void 0?s=new Date("2000-01-01"):s==="now"?s=new Date:s=new Date(s);let t=this.addDateFin;t===void 0?t=new Date("2500-01-01"):t==="now"?t=new Date:t=new Date(t);let _=new Date(this.date);return _.setDate(n),s=this.isoDateOnly(s),t=this.isoDateOnly(t),_=this.isoDateOnly(_),!(_<s||_>t)},addEvent(n){const s=new Date(this.date);s.setDate(n.currentTarget.dataset.jour),this.$emit("addEvent",s,n)},prevMois(){const n=new Date(this.date);n.setMonth(n.getMonth()-1),this.$emit("changeDate",n)},nextMois(){const n=new Date(this.date);n.setMonth(n.getMonth()+1),this.$emit("changeDate",n)},eventsByJour(n){const s=new Date(this.date);let t={};for(let _ in this.events){let l=this.events[_];l.date.getFullYear()===s.getFullYear()&&l.date.getMonth()+1===s.getMonth()+1&&l.date.getDate()===n&&(t[_]=l)}return t},isoDateOnly(n){const s=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),_=String(n.getDate()).padStart(2,"0");return`${s}-${t}-${_}`}}},na={class:"calendar"},ra={class:"recherche"},ia={class:"recherche btn-group"},aa=["value"],oa=["value"],la={class:"table table-bordered table-hover table-sm"},da=["data-jour"],ua={class:"nom-jour"},ca={class:"numero-jour"},ha={class:"num-jour badge bg-secondary rounded-circle"},ma={key:0},_a=["data-jour"];function fa(n,s,t,_,l,r){const o=M;return i(),a("div",na,[e("div",ra,[e("div",ia,[e("button",{class:"btn btn-light",id:"prevMois",onClick:s[0]||(s[0]=(...d)=>r.prevMois&&r.prevMois(...d)),title:"Mois précédant"},[f(o,{name:"chevron-left"})]),S(e("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":s[1]||(s[1]=d=>l.mois=d)},[(i(!0),a(p,null,g(r.listeMois(),d=>(i(),a("option",{value:d.id},u(d.libelle),9,aa))),256))],512),[[U,l.mois]]),S(e("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":s[2]||(s[2]=d=>l.annee=d)},[(i(!0),a(p,null,g(r.listeAnnees(),d=>(i(),a("option",{value:d},u(d),9,oa))),256))],512),[[U,l.annee]]),e("button",{class:"btn btn-light",id:"nextMois",onClick:s[3]||(s[3]=(...d)=>r.nextMois&&r.nextMois(...d)),title:"Mois suivant"},[f(o,{name:"chevron-right"})])])]),e("table",la,[(i(!0),a(p,null,g(r.listeJours,d=>(i(),a("tr",{"data-jour":d},[e("th",ua,u(r.nomJour(d)),1),e("th",ca,[e("div",ha,u(d<10?"0"+d.toString():d),1)]),e("td",null,[(i(!0),a(p,null,g(r.eventsByJour(d),(m,y)=>(i(),a("div",{class:"event",style:Q("border-color:"+m.color+";background-color:"+m.bgcolor),key:y},[(i(),C(X(m.component),{event:m},null,8,["event"]))],4))),128)),r.canAdd(d)?(i(),a("div",ma,[e("button",{onClick:s[4]||(s[4]=(...m)=>r.addEvent&&r.addEvent(...m)),"data-jour":d,class:"btn btn-light btn-sm"},[f(o,{name:"plus"}),c(" Nouvel événement ")],8,_a)])):h("",!0)])],8,da))),256))])])}const pa=k(sa,[["render",fa],["__scopeId","data-v-51bbc42d"]]);const va={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(n){modAjax(n.currentTarget,s=>{this.suivi.refresh()})},supprimer(n){popConfirm(n.currentTarget,s=>{this.suivi.refresh()})},valider(n){unicaenVue.axios.get(this.validerUrl).then(s=>{this.suivi.refresh()})},devalider(n){popConfirm(n.currentTarget,s=>{this.suivi.refresh()})}}},ba={class:"event-content"},ga={class:"mission"},ya={key:0,class:"badge bg-success"},xa={class:"horaires"},ka={key:0,class:"badge bg-secondary"},Ca={key:0,class:"description"},Va={class:"event-actions"},Pa={class:"btn-group btn-group-sm"},Ea=["data-url"],Da=["data-url"],Ta=["data-url"],Sa=["data-url"];function Ma(n,s,t,_,l,r){const o=M;return i(),a(p,null,[e("div",ba,[e("p",ga,[c(u(t.event.mission.libelleCourt)+" ",1),t.event.valide?(i(),a("span",ya,"Validé")):h("",!0)]),e("p",xa,[c(" de "+u(r.heureDebut)+" à "+u(r.heureFin)+", soit "+u(r.heures)+" heure"+u(r.heures<2?"":"s")+" ",1),t.event.formation?(i(),a("span",ka,"En formation")):h("",!0)]),t.event.description?(i(),a("p",Ca,u(t.event.description),1)):h("",!0)]),e("div",Va,[e("div",Pa,[t.event.canEdit?(i(),a("button",{key:0,class:"btn btn-light",onClick:s[0]||(s[0]=(...d)=>r.modifier&&r.modifier(...d)),title:"Modifier le suivi","data-url":l.modifierUrl},[f(o,{name:"pen-to-square"})],8,Ea)):h("",!0),t.event.canValider?(i(),a("button",{key:1,class:"btn btn-light",onClick:s[1]||(s[1]=(...d)=>r.valider&&r.valider(...d)),title:"Valider le suivi","data-url":l.validerUrl},[f(o,{name:"check",class:"text-success"})],8,Da)):h("",!0),t.event.canDevalider?(i(),a("button",{key:2,class:"btn btn-light",onClick:s[2]||(s[2]=(...d)=>r.devalider&&r.devalider(...d)),title:"Dévalider le suivi","data-url":l.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[f(o,{name:"xmark",class:"text-danger"})],8,Ta)):h("",!0),t.event.canSupprimer?(i(),a("button",{key:3,class:"btn btn-light",onClick:s[3]||(s[3]=(...d)=>r.supprimer&&r.supprimer(...d)),title:"Supprimer le suivi","data-url":l.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[f(o,{name:"trash-can",class:"text-danger"})],8,Sa)):h("",!0)])])],64)}const Y=k(va,[["render",Ma],["__scopeId","data-v-17cb1f29"]]),Ra=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"})),wa={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,isMounted:!1,suivi:[]}},methods:{changeDate(n){this.date=n},ajouter(n,s){const t={intervenant:this.intervenant,date:n.toISOString().slice(0,10)};s.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",t),modAjax(s.currentTarget,_=>{this.refresh()})},refresh(){const n=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let s=0,t=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(_=>{let l=[];for(let r in _.data){let o=_.data[r];t[o.mission.id]===void 0&&(t[o.mission.id]=n[s],s++),o.valide&&(o.bgcolor="#d0eddb"),o.color=t[o.mission.id],o.component=Z(Y),o.date=new Date(o.date),o.intervenant=this.intervenant,l.push(o)}this.suivi=l,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?$(".plafonds").refresh():this.isMounted=!0}}};function $a(n,s,t,_,l,r){const o=pa;return i(),C(o,{date:l.date,onChangeDate:r.changeDate,onAddEvent:r.ajouter,"can-add-event":t.canAddMission,addDateFin:"now",events:l.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const ja=k(wa,[["render",$a]]),Aa=Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"}));function Ua(n){for(let s in n)for(let t in n[s])J(n[s][t],s)}function Ia(){let n=document.getElementById("unicaen-vue-toast-container");return n||(n=document.createElement("div"),n.id="unicaen-vue-toast-container",n.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(n)),n}function Ha(n){return n=qa(n),n=La(n),n}function qa(n){const s=document.createElement("div");s.innerHTML=n;const t=s.querySelector(".alert");return t?t.innerHTML:s.innerHTML}function La(n){const s=document.createElement("div");return s.innerHTML=n,s.querySelectorAll("i.fas").forEach(_=>_.style.display="none"),s.innerHTML}function J(n,s){const t={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},_={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"},l=document.createElement("button");l.classList.add("btn-close","btn-close-white","h5"),l.style.float="right",l.setAttribute("data-bs-dismiss","toast"),l.setAttribute("aria-label","Close");const r=document.createElement("i");r.classList.add("icon","fas",`fa-${_[s]}`),r.style.float="left",r.style.fontSize="26pt",r.style.paddingLeft=".4rem",r.style.marginTop=".4rem",r.style.paddingRight="1rem";const o=document.createElement("div");o.classList.add("toast-body"),o.innerHTML=Ha(n);const d=document.createElement("div");d.appendChild(l),d.appendChild(r),d.appendChild(o);const m=document.createElement("div");m.classList.add("toast","text-white",t[s]?t[s]:"bg-secondary"),m.setAttribute("role","alert"),m.setAttribute("aria-live","assertive"),m.setAttribute("aria-atomic","true"),s==="error"&&n.length>500&&m.setAttribute("style","width:700px"),m.appendChild(d),Ia().appendChild(m);const y={animation:!0,delay:s==="warning"?15e3:5e3,autohide:s!=="error"};new bootstrap.Toast(m,y).show()}const I={toast:J,toasts:Ua};let A={...K};A.interceptors.request.use(n=>{if(n.submitter){let s=n.msg?n.msg:"Action en cours";n.popover!=null&&n.popover.dispose(),n.popover=new bootstrap.Popover(n.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+s,html:!0,trigger:"focus"}),n.popover.show()}return n});A.interceptors.response.use(n=>{if(n.messages=n.data.messages,n.data=n.data.data,n.hasErrors=!!(n.messages&&n.messages.error&&n.messages.error.length>0),n.config.popover){var s=n.config.popover;let t="";for(ns in n.messages)for(mid in n.messages[ns])t+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+n.messages[ns][mid]+"</div>";t?(s._config.content=t,s.setContent(),setTimeout(()=>{s.dispose()},5e3)):s.dispose()}return n.messages&&I.toasts(n.messages),n},n=>{let s=n.response.data;n.response.status==403?s="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.":s=n.response.data,I.toast(s,"error")});A.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const Oa={uvAxios:A},H={axios:Oa.uvAxios,flashMessenger:I,url:(n,s,t)=>{let _=window.__unicaenVueBaseUrl;if(s)for(let r in s)n=n.replace(`:${r}`,s[r]);let l=t?H.encodeUrlQueryParam(t):null;return _+n+(l?`?${l}`:"")},encodeUrlQueryParam:(n,s)=>{var t=[];for(var _ in n)if(n.hasOwnProperty(_)){var l=n[_],r=s?s+"["+encodeURIComponent(_)+"]":encodeURIComponent(_);if(typeof l=="object"&&l!==null)t.push(H.encodeUrlQueryParam(l,r));else{var o=encodeURIComponent(l);t.push(r+"="+o)}}return t.join("&")}};window.unicaenVue=H;const Fa={name:"DemandeMiseEnPaiementLot.vue",props:{structures:{type:Array,required:!0},canMiseEnPaiement:{type:Boolean,required:!0}},data(){return{selectedStructure:null,urlRechercheDemandeMiseEnPaiement:unicaenVue.url("paiement/demande-mise-en-paiement-lot"),urlProcessDemandeMiseEnPaiement:unicaenVue.url("paiement/process-demande-mise-en-paiement-lot"),urlMiseEnPaiement:unicaenVue.url("paiement/etat-demande-paiement"),permanents:[],vacataires:[],etudiants:[],autres:[],intervenants:[],dotation:!1,liquidation:null,totalConsommationPaieEtat:0,totalConsommationRessourcePropre:0,totalConsommation:0,alertDotation:!1}},computed:{haveDotation(){return this.dotation?this.dotation.total>0:!1},alertPaieEtat(){return this.dotation.paieEtat<this.totalConsommationPaieEtat?"text-danger fw-bold":""},alertRessourcePropre(){return this.dotation.ressourcePropre<this.totalConsommationRessourcePropre?"text-danger fw-bold":""}},methods:{findDemandeMiseEnPaiement(n){this.totalConsommationRessourcePropre=0,this.totalConsommationPaieEtat=0,this.dotation=null,this.liquidation=null;let s=document.getElementById("formRechercheDemandeMiseEnPaiement"),t=new FormData(s),_=document.getElementById("btn-rdmep"),l=document.getElementById("btn-rdmep-inprogress");l.classList.remove("d-none"),_.classList.add("d-none"),_.disabled=!0,unicaenVue.axios.post(this.urlRechercheDemandeMiseEnPaiement,t,{}).then(r=>{this.dispatchDatas(r.data),_.disabled=!1,l.classList.add("d-none"),_.classList.remove("d-none"),document.querySelectorAll('input[type="checkbox"]').forEach(function(d,m){d.checked=!0}),unicaenVue.axios.get(unicaenVue.url("budget/get-budget-structure/:structure",{structure:this.selectedStructure})).then(d=>{let m=d.data;this.dotation=m.dotation,this.liquidation=m.liquidation,this.refreshTotalConsommation()})}).catch(r=>{console.error(r)})},processDemandeMiseEnPaiement(n){let s=document.getElementById("formProcessDemandeMiseEnPaiement"),t=new FormData(s);if(this.dotation.paieEtat>=this.totalConsommationPaieEtat&&this.dotation.ressourcePropre>=this.totalConsommationRessourcePropre||!this.haveDotation){let _=document.getElementById("btn-pdmep"),l=document.getElementById("btn-pdmep-inprogress");l.classList.remove("d-none"),_.classList.add("d-none"),_.disabled=!0,unicaenVue.axios.post(this.urlProcessDemandeMiseEnPaiement,t,{}).then(r=>{this.findDemandeMiseEnPaiement(),_.disabled=!1,l.classList.add("d-none"),_.classList.remove("d-none")}).catch(r=>{console.error("Error process dmep")})}},refreshTotalConsommation(){let n=0,s=0,t=0;n=parseFloat(this.liquidation.paieEtat),s=parseFloat(this.liquidation.ressourcePropre),t+=parseFloat(this.liquidation.ressourcePropre),t+=parseFloat(this.liquidation.paieEtat),document.querySelectorAll('input[type="checkbox"]').forEach(function(l,r){l.hasAttribute("data-paie-etat")&&l.checked&&(n+=parseFloat(l.getAttribute("data-paie-etat")),t+=parseFloat(l.getAttribute("data-paie-etat"))),l.hasAttribute("data-ressource-propre")&&l.checked&&(s+=parseFloat(l.getAttribute("data-ressource-propre")),t+=parseFloat(l.getAttribute("data-ressource-propre")))}),this.totalConsommationPaieEtat=n.toFixed(2),this.totalConsommationRessourcePropre=s.toFixed(2),this.totalConsommation=t.toFixed(2),this.alertDotation=(this.dotation.paieEtat<this.totalConsommationPaieEtat||this.dotation.ressourcePropre<this.totalConsommationRessourcePropre)&&this.dotation.total>0},totalPayable(n){let s=0;return n.forEach((t,_)=>{t.centreCout.code!=""&&(t.missionId!=""||t.serviceRefId!=""?t.domaineFonctionnel.code!=""&&(s+=t.heuresAPayer):s+=t.heuresAPayer)}),s.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalNonPayable(n){let s=0;return n.forEach((t,_)=>{(t.centreCout.code==""||(t.missionId!=""||t.serviceRefId!="")&&t.domaineFonctionnel.code=="")&&(s+=t.heuresAPayer)}),s.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePaieEtat(n){let s=0;return n.forEach((t,_)=>{t.centreCout.typeRessourceCode=="paie-etat"&&(s+=t.heuresAPayer)}),s.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePropre(n){let s=0;return n.forEach((t,_)=>{t.centreCout.typeRessourceCode=="ressources-propres"&&(s+=t.heuresAPayer)}),s.toLocaleString("fr-FR",{maximumFractionDigits:2})},dispatchDatas(n){this.vacataires=[],this.permanents=[],this.etudiants=[],this.autres=[],this.intervenants=[],console.log(n);for(const[s,t]of Object.entries(n))switch(t.datasIntervenant.typeIntervenant){case"Vacataire":this.vacataires.push(t),this.intervenants.push(t);break;case"Intervenant permanent":this.permanents.push(t),this.intervenants.push(t);break;case"Étudiant":this.etudiants.push(t),this.intervenants.push(t);break;default:this.autres.push(t),this.intervenants.push(t)}},toggleCheckbox(n){let s=Array.from(document.getElementsByClassName(n.target.className));n.target.checked?s.forEach(function(t,_){t.checked=!0}):s.forEach(function(t,_){t.checked=!1}),this.refreshTotalConsommation()},urlIntervenant(n){return unicaenVue.url("intervenant/code::intervenantCode/mise-en-paiement/demande",{intervenantCode:n.datasIntervenant.code})},formattedHETD(n){return Util.formattedHeures(n,!1)}}},Ba=e("h1",null,"Demande de mise en paiement par lots",-1),Na={class:"card text-dark bg-light"},za=e("div",{class:"card-header text-uppercase fw-bold"}," Recherchez des heures en attente de demande de mise en paiement : ",-1),Ga={class:"card-body"},Ya={id:"formRechercheDemandeMiseEnPaiement",action:"",method:"post"},Ja={class:"mb-3"},Wa=e("label",{class:"form-label",for:"modele"},"Choisissez une structure ",-1),Qa=["value"],Xa={class:"mb-3"},Za=e("button",{id:"btn-rdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),c("  Veuillez patienter... ")],-1),Ka=["disabled"],eo=e("div",{class:"alert alert-info",role:"alert"},[c(" Seules les HETD "),e("strong",null,"(hors référentiel)"),c(" avec des centres de coûts pré-paramètrés peuvent bénéficier d'une demande de mise en paiement automatisées. Pour les autres, il faudra passer sur chaque fiches intervenant pour faire les demandes en sélectionnant le centre de coût manuellement. ")],-1),to={key:0},so={key:0,class:"alert alert-danger",role:"alert"},no={class:"table table-bordered caption-top"},ro=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"fw-bold",scope:"col"},"Budget"),e("th",{class:"fw-bold",scope:"col"},"Paie etat"),e("th",{class:"fw-bold",scope:"col"},"Ressource propre"),e("th",{class:"fw-bold",scope:"col"},"Total")])],-1),io=e("td",null,"Dotation",-1),ao={class:"fw-bold"},oo=e("td",null,"Consommation",-1),lo={class:"fw-bold"},uo={id:"dmep",class:"accordion"},co={id:"formProcessDemandeMiseEnPaiement",action:"",method:"post"},ho={key:0,class:"accordion-item"},mo={id:"dmep-permanents-heading",class:"accordion-header"},_o={"aria-controls":"dmep-permanents-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-permanents-collapse","data-bs-toggle":"collapse",type:"button"},fo={id:"dmep-permanents-collapse","aria-labelledby":"dmep-permanents-heading",class:"accordion-collapse collapse show"},po={class:"accordion-body"},vo={class:"table"},bo={scope:"col"},go=e("th",{scope:"col"},"Intervenant",-1),yo=e("th",null,"HETD payables",-1),xo=e("th",null,"HETD non payables",-1),ko=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],Co=["href"],Vo=["title"],Po={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Eo={key:1,class:"accordion-item"},Do={id:"dmep-vacataires-heading",class:"accordion-header"},To={"aria-controls":"dmep-vacataires-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-vacataires-collapse","data-bs-toggle":"collapse",type:"button"},So={id:"dmep-vacataires-collapse","aria-labelledby":"dmep-vacataires-heading",class:"accordion-collapse collapse show"},Mo={class:"accordion-body"},Ro={class:"table"},wo=e("th",null,"Intervenant",-1),$o=e("th",null,"HETD payables",-1),jo=e("th",null,"HETD non payables",-1),Ao=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],Uo=["href"],Io=["title"],Ho={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},qo={key:2,class:"accordion-item"},Lo={id:"dmep-etudiants-heading",class:"accordion-header"},Oo={"aria-controls":"dmep-etudiants-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-etudiants-collapse","data-bs-toggle":"collapse",type:"button"},Fo={id:"dmep-etudiants-collapse","aria-labelledby":"dmep-etudiants-heading",class:"accordion-collapse collapse show"},Bo={class:"accordion-body"},No={class:"table"},zo=e("th",null,"Intervenant",-1),Go=e("th",null,"HETD payables",-1),Yo=e("th",null,"HETD non payables",-1),Jo=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],Wo=["href"],Qo=["title"],Xo={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Zo={key:3,class:"accordion-item"},Ko={id:"dmep-autres-heading",class:"accordion-header"},el={"aria-controls":"dmep-autres-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-autres-collapse","data-bs-toggle":"collapse",type:"button"},tl={id:"dmep-autres-collapse","aria-labelledby":"dmep-autres-heading",class:"accordion-collapse collapse show"},sl={class:"accordion-body"},nl={class:"table"},rl=e("th",null,"Intervenant",-1),il=e("th",null,"HETD payables",-1),al=e("th",null,"HETD non payables",-1),ol=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],ll=["href"],dl=["title"],ul={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},cl={key:4,class:"mt-3"},hl=e("button",{id:"btn-pdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),c("  Veuillez patienter... ")],-1),ml=["disabled"],_l=["href"];function fl(n,s,t,_,l,r){return i(),a(p,null,[Ba,e("div",Na,[za,e("div",Ga,[e("form",Ya,[e("div",Ja,[Wa,c("  "),S(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>l.selectedStructure=o),class:"form-select",name:"structure"},[(i(!0),a(p,null,g(t.structures,o=>(i(),a("option",{value:o.id},u(o.libelle),9,Qa))),256))],512),[[U,l.selectedStructure]])]),e("div",Xa,[Za,e("button",{id:"btn-rdmep",disabled:!l.selectedStructure,class:"btn btn-primary",type:"button",onClick:s[1]||(s[1]=(...o)=>r.findDemandeMiseEnPaiement&&r.findDemandeMiseEnPaiement(...o))}," Lancer la recherche ",8,Ka)])])])]),eo,r.haveDotation?(i(),a("div",to,[l.alertDotation?(i(),a("div",so," Attention vous dépassez vos dotations, vous ne pourrez pas lancer les demandes de mise en paiement par lot. Veuillez ajuster votre sélection d'intervenants pour faire les demandes de mise en paiement. ")):h("",!0),e("table",no,[ro,e("tbody",null,[e("tr",null,[io,e("td",null,u(r.formattedHETD(this.dotation.paieEtat))+" HETD",1),e("td",null,u(r.formattedHETD(this.dotation.ressourcePropre))+" HETD",1),e("td",ao,u(r.formattedHETD(this.dotation.total))+" HETD",1)]),e("tr",null,[oo,e("td",null,[e("span",{class:D(r.alertPaieEtat)},u(r.formattedHETD(this.totalConsommationPaieEtat))+" HETD",3)]),e("td",null,[e("span",{class:D(r.alertRessourcePropre)},u(r.formattedHETD(this.totalConsommationRessourcePropre))+" HETD",3)]),e("td",lo,u(r.formattedHETD(this.totalConsommation))+" HETD",1)])])])])):h("",!0),e("div",uo,[e("form",co,[this.permanents.length>0?(i(),a("div",ho,[e("h2",mo,[e("button",_o,u(this.permanents.length)+" Permanent(s) ",1)]),e("div",fo,[e("div",po,[e("table",vo,[e("thead",null,[e("tr",null,[e("th",bo,[e("input",{id:"allPermanents",checked:"checked",class:"checkbox-permanent",name:"allPermanents",type:"checkbox",onClick:s[2]||(s[2]=(...o)=>r.toggleCheckbox&&r.toggleCheckbox(...o))})]),go,yo,xo])]),e("tbody",null,[(i(!0),a(p,null,g(this.permanents,o=>(i(),a("tr",null,[e("td",null,[e("input",{id:"permanent-"+o.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(o.heures),"data-ressource-propre":r.totalRessourcePropre(o.heures),disabled:r.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:r.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-permanent",type:"checkbox",onChange:s[3]||(s[3]=d=>r.refreshTotalConsommation())},null,40,ko)]),e("td",null,[e("a",{href:r.urlIntervenant(o),target:"_blank"},u(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),9,Co)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+r.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},u(r.totalPayable(o.heures))+" h",9,Vo)]),e("td",null,[e("span",Po,u(r.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.vacataires.length>0?(i(),a("div",Eo,[e("h2",Do,[e("button",To,u(this.vacataires.length)+" Vacataire(s) ",1)]),e("div",So,[e("div",Mo,[e("table",Ro,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allVacataire",checked:"checked",class:"checkbox-vacataire",name:"allVacataire",type:"checkbox",onClick:s[4]||(s[4]=(...o)=>r.toggleCheckbox&&r.toggleCheckbox(...o))})]),wo,$o,jo])]),e("tbody",null,[(i(!0),a(p,null,g(this.vacataires,o=>(i(),a("tr",null,[e("td",null,[e("input",{id:"vacataire-"+o.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(o.heures),"data-ressource-propre":r.totalRessourcePropre(o.heures),disabled:r.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:r.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-vacataire",type:"checkbox",onChange:s[5]||(s[5]=d=>r.refreshTotalConsommation())},null,40,Ao)]),e("td",null,[e("a",{href:r.urlIntervenant(o),target:"_blank"},u(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),9,Uo)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+r.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},u(r.totalPayable(o.heures))+" h",9,Io)]),e("td",null,[e("span",Ho,u(r.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.etudiants.length>0?(i(),a("div",qo,[e("h2",Lo,[e("button",Oo,u(this.etudiants.length)+" Etudiant(s) ",1)]),e("div",Fo,[e("div",Bo,[e("table",No,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allEtudiants",checked:"checked",class:"checkbox-etudiant",name:"allEtudiants",type:"checkbox",onClick:s[6]||(s[6]=(...o)=>r.toggleCheckbox&&r.toggleCheckbox(...o))})]),zo,Go,Yo])]),e("tbody",null,[(i(!0),a(p,null,g(this.etudiants,o=>(i(),a("tr",null,[e("td",null,[e("input",{id:"etudiant-"+o.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(o.heures),"data-ressource-propre":r.totalRessourcePropre(o.heures),disabled:r.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:r.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-etudiant",type:"checkbox",onChange:s[7]||(s[7]=d=>r.refreshTotalConsommation())},null,40,Jo)]),e("td",null,[e("a",{href:r.urlIntervenant(o),target:"_blank"},u(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),9,Wo)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+r.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},u(r.totalPayable(o.heures))+" h",9,Qo)]),e("td",null,[e("span",Xo,u(r.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.autres.length>0?(i(),a("div",Zo,[e("h2",Ko,[e("button",el,u(this.autres.length)+" Autre(s) ",1)]),e("div",tl,[e("div",sl,[e("table",nl,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allAutres",checked:"checked",class:"checkbox-autre",name:"allAutres",type:"checkbox",onClick:s[8]||(s[8]=(...o)=>r.toggleCheckbox&&r.toggleCheckbox(...o))})]),rl,il,al])]),e("tbody",null,[(i(!0),a(p,null,g(this.etudiants,o=>(i(),a("tr",null,[e("td",null,[e("input",{id:"autre-"+o.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(o.heures),"data-ressource-propre":r.totalRessourcePropre(o.heures),disabled:r.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:r.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-autre",type:"checkbox",onChange:s[9]||(s[9]=d=>r.refreshTotalConsommation())},null,40,ol)]),e("td",null,[e("a",{href:r.urlIntervenant(o),target:"_blank"},u(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),9,ll)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+r.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},u(r.totalPayable(o.heures))+" h",9,dl)]),e("td",null,[e("span",ul,u(r.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.intervenants.length>0?(i(),a("div",cl,[hl,e("button",{id:"btn-pdmep",disabled:this.alertDotation,class:"btn btn-primary",type:"button",onClick:s[10]||(s[10]=(...o)=>r.processDemandeMiseEnPaiement&&r.processDemandeMiseEnPaiement(...o))}," Enregistrer les demandes de paiement ",8,ml),this.canMiseEnPaiement?(i(),a("a",{key:0,id:"btn-mep",href:this.urlMiseEnPaiement,class:"ms-2 btn btn-secondary"}," Aller au mise en paiement ",8,_l)):h("",!0)])):h("",!0)])])],64)}const pl=k(Fa,[["render",fl]]),vl=Object.freeze(Object.defineProperty({__proto__:null,default:pl},Symbol.toStringTag,{value:"Module"}));const bl={components:{},props:{parametres:{type:Array,required:!0},servicesAPayer:{type:Array,required:!0}}},V=n=>(q("data-v-d4a24889"),n=n(),L(),n),gl=V(()=>e("h2",null,"Paramètres généraux ou bien selon le statut",-1)),yl={class:"table table-bordered table-condensed table-extra-condensed"},xl=V(()=>e("tr",null,[e("th",null,"Paramètre général"),e("th",null,"Valeur")],-1)),kl=V(()=>e("h2",null,"Services à payer",-1)),Cl={class:"card"},Vl={class:"card-header"},Pl={class:"badge bg-primary"},El={class:"card-body"},Dl={class:"row lap"},Tl={class:"col-md-6"},Sl=V(()=>e("h6",null,"Heures à payer",-1)),Ml={class:"table table-bordered table-xs"},Rl={key:0,rowspan:"2"},wl={key:1,rowspan:"2"},$l=V(()=>e("th",{colspan:"2"},"Taux de rému.",-1)),jl=V(()=>e("th",{colspan:"3"},"Heures",-1)),Al=V(()=>e("tr",null,[e("th",null,"Nom"),e("th",null,"Valeur"),e("th",null,"Total"),e("th",null,"AA"),e("th",null,"AC")],-1)),Ul={key:0},Il=["title"],Hl={key:1},ql=["title"],Ll={class:"col-md-6"},Ol=V(()=>e("h6",null,[e("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),c(" correspondantes")],-1)),Fl={class:"table table-bordered table-xs"},Bl=V(()=>e("thead",null,[e("tr",null,[e("th",{rowspan:"2"},"Id"),e("th",{rowspan:"2"},"Centre de coûts"),e("th",{colspan:"2"},"Période"),e("th",{colspan:"3"},"Heures")]),e("tr",null,[e("th",null,"Mois"),e("th",null,"Date"),e("th",null,"Total"),e("th",null,"AA"),e("th",null,"AC")])],-1)),Nl=["title"],zl=["title"],Gl={key:0},Yl={class:"badge bg-info"},Jl={key:0,class:"row"},Wl=V(()=>e("div",{class:"col-md-6"},null,-1)),Ql={class:"col-md-6"},Xl=V(()=>e("h6",null,[e("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),c(" en trop")],-1)),Zl={class:"table table-bordered table-xs"},Kl=V(()=>e("thead",{class:"bg-danger"},[e("tr",null,[e("th",{rowspan:"2"},"Id"),e("th",{rowspan:"2"},"Centre de coûts"),e("th",{colspan:"2"},"Période"),e("th",{rowspan:"2"},"Heures")]),e("tr",null,[e("th",null,"Mois"),e("th",null,"Date")])],-1)),ed=["title"],td=["title"];function sd(n,s,t,_,l,r){return i(),a(p,null,[gl,e("table",yl,[xl,(i(!0),a(p,null,g(t.parametres,(o,d)=>(i(),a("tr",{key:d},[e("th",null,u(d),1),e("td",null,u(o),1)]))),128))]),kl,(i(!0),a(p,null,g(t.servicesAPayer,(o,d)=>(i(),a("div",{key:d},[e("div",Cl,[e("div",Vl,[e("span",Pl,u(o.type),1),c(" "+u(o.libelle),1)]),e("div",El,[e("ul",null,[(i(!0),a(p,null,g(o.parametres,(m,y)=>(i(),a("li",{key:y},u(y)+" : "+u(m),1))),128))]),(i(!0),a(p,null,g(o.laps,m=>(i(),a("div",Dl,[e("div",Tl,[Sl,e("table",Ml,[e("thead",null,[e("tr",null,[o.type!="Référentiel"?(i(),a("th",Rl,"Volume horaire")):(i(),a("th",wl,"Volumes horaires")),$l,jl]),Al]),e("tbody",null,[e("tr",null,[o.type!="Référentiel"?(i(),a("td",Ul,[e("abbr",{class:"badge bg-secondary",title:m.volumeHoraireHisto},u(m.volumeHoraireId),9,Il),c(" "+u(m.volumeHoraire),1)])):(i(),a("td",Hl,[(i(!0),a(p,null,g(m.volumeHoraireId,y=>(i(),a("div",null,[e("abbr",{class:"badge bg-secondary",title:y.HISTO},u(y.ID),9,ql),c(" "+u(y.HEURES)+"h ",1)]))),256))])),e("td",null,u(m.tauxRemu),1),e("td",null,u(m.tauxValeur)+"€",1),e("td",null,u(m.heures),1),e("td",null,u(m.heuresAA),1),e("td",null,u(m.heuresAC),1)])])])]),e("div",Ll,[Ol,e("table",Fl,[Bl,e("tbody",null,[(i(!0),a(p,null,g(m.misesEnPaiement,y=>(i(),a("tr",{key:y.id},[e("td",null,[e("abbr",{class:"badge bg-secondary",title:"Nombre d'heures total concernées : "+y.heuresTotal+`
Domaine fonctionnel : `+y.domaineFonctionnel+`
`+y.historique},u(y.id),9,Nl)]),e("td",null,[e("abbr",{title:y.centreCoutLibelle},u(y.centreCoutCode),9,zl)]),e("td",null,u(y.periodePaiement),1),e("td",null,u(y.date),1),e("td",null,u(y.heures),1),e("td",null,u(y.heuresAA),1),e("td",null,u(y.heuresAC),1)]))),128))])]),m.heuresRestantes!="0,00"?(i(),a("div",Gl,[e("span",Yl,u(m.heuresRestantes)+"h n'ont pas été demandées en paiement",1)])):h("",!0)])]))),256)),o.misesEnPaiement&&o.misesEnPaiement.length>0?(i(),a("div",Jl,[Wl,e("div",Ql,[Xl,e("table",Zl,[Kl,e("tbody",null,[(i(!0),a(p,null,g(o.misesEnPaiement,m=>(i(),a("tr",{key:m.id},[e("td",null,[e("abbr",{class:"badge bg-danger",title:"Domaine fonctionnel : "+m.domaineFonctionnel+`
`+m.historique},u(m.id),9,ed)]),e("td",null,[e("abbr",{title:m.centreCoutLibelle},u(m.centreCoutCode),9,td)]),e("td",null,u(m.periodePaiement),1),e("td",null,u(m.date),1),e("td",null,u(m.heures),1)]))),128))])])])])):h("",!0)])])]))),128))],64)}const nd=k(bl,[["render",sd],["__scopeId","data-v-d4a24889"]]),rd=Object.freeze(Object.defineProperty({__proto__:null,default:nd},Symbol.toStringTag,{value:"Module"})),id={props:{canImportPec:{type:Boolean,required:!1}},data(){return{selectedFile:null,importUrl:unicaenVue.url("paiement/import-numero-pec"),fileErrors:null,intervenantMissing:null,messageErrors:null,messageConfirm:null}},mounted(){},methods:{handleFileUpload(n){this.selectedFile=n.target.files[0],this.fileErrors=null,this.intervenantMissing=null,this.messageErrors=null,this.messageConfirm=null,document.getElementById("btn-import").disabled=!1},importFile(n){n.preventDefault(),this.messageErrors=null,this.messageConfirm=null;let s=document.getElementById("btn-import"),t=document.getElementById("btn-import-inprogress");t.classList.remove("d-none"),s.classList.add("d-none"),s.disabled=!0;let _=document.getElementById("formImport"),l=new FormData(_);unicaenVue.axios.post(this.importUrl,l,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{let o=r.data;this.fileErrors=o.file,this.intervenantMissing=o.intervenant,o.message.length!=0?this.messageErrors=o.message:this.messageConfirm="Importation des numéros de prise en charge réalisée avec succés !",s.disabled=!1,t.classList.add("d-none"),s.classList.remove("d-none")}).catch(r=>{console.error("Error uploading")})}}},ad={class:"card text-dark bg-light"},od=e("div",{class:"card-header text-uppercase fw-bold"}," Importation des numéros de prise en charge ",-1),ld={class:"card-body"},dd={key:0,class:"alert alert-danger",role:"alert"},ud={key:1,class:"alert alert-success",role:"alert"},cd={id:"formImport",action:"",enctype:"multipart/form-data",method:"post"},hd=e("p",{class:"fs-9 text"},[c(" Vous pouvez utiliser le modèle directement extrait de winpaie "),e("strong",null,"(format .xlsx ou .ods)"),c(" ou créer votre modèle générique de classeur "),e("strong",null,"(format .xlsx ou .ods)"),c(" incluant 3 colonnes : insee,numero pec, nom. ")],-1),md={class:"mb-3"},_d=e("label",{class:"form-label",for:"importFile"},"Choisissez le fichier à importer :",-1),fd=ee('<div class="mb-3"><label class="form-label" for="modele">Choisissez le modèle d&#39;import :</label>  <select id="modeleImport" class="form-select" name="modeleImport"><option value="winpaie">Winpaie</option><option value="generic">Generique (Modèle à 3 colonnes)</option></select></div>',1),pd={class:"mb-3"},vd=e("button",{id:"btn-import-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),c("  Veuillez patienter... ")],-1),bd={key:0,id:"fileErrors",class:"card text-dark bg-light"},gd=e("div",{class:"card-header text-uppercase fw-bold"}," Rapport de chargement du fichier ",-1),yd={class:"card-body"},xd={key:0},kd=e("p",null,"Listes des intervenants du fichier dont le numéro INSEE n'est pas valide : ",-1),Cd={key:1},Vd=e("p",null,"Listes des intervenants présents dans le fichier mais non trouvés dans OSE : ",-1);function Pd(n,s,t,_,l,r){return i(),a(p,null,[e("div",ad,[od,e("div",ld,[this.messageErrors?(i(),a("div",dd,u(this.messageErrors),1)):h("",!0),this.messageConfirm?(i(),a("div",ud,u(this.messageConfirm),1)):h("",!0),e("form",cd,[hd,e("div",md,[_d,c("  "),e("input",{class:"form-control",name:"importFile",type:"file",onChange:s[0]||(s[0]=(...o)=>r.handleFileUpload&&r.handleFileUpload(...o))},null,32)]),fd,e("div",pd,[vd,e("button",{id:"btn-import",class:"btn btn-primary",disabled:"",type:"button",onClick:s[1]||(s[1]=(...o)=>r.importFile&&r.importFile(...o))}," Importer les numéros de prise en charge ")])])])]),this.fileErrors||this.intervenantMissing?(i(),a("div",bd,[gd,e("div",yd,[this.fileErrors.length!=0?(i(),a("div",xd,[kd,e("ul",null,[(i(!0),a(p,null,g(this.fileErrors,o=>(i(),a("li",null,u(),1))),256))])])):h("",!0),this.intervenantMissing.length!=0?(i(),a("div",Cd,[Vd,e("ul",null,[(i(!0),a(p,null,g(this.intervenantMissing,o=>(i(),a("li",null,u(o),1))),256))])])):h("",!0)])])):h("",!0)],64)}const Ed=k(id,[["render",Pd]]),Dd=Object.freeze(Object.defineProperty({__proto__:null,default:Ed},Symbol.toStringTag,{value:"Module"})),Td={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(n){modAjax(n.target,s=>{this.$emit("refreshListe")})},ajoutValeur(n){modAjax(n.target,s=>{this.$emit("refreshListe")})},saisieValeur(n){n.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:n.currentTarget.dataset.id}),modAjax(n.currentTarget,s=>{this.$emit("refreshListe")})},refreshListe(n){this.$emit("refreshListe")},supprimer(n){popConfirm(n.target,s=>{this.$emit("refreshListe")})},supprimerValeur(n){n.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,s=>{this.$emit("refreshListe")})},refresh(n){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:n.id})).then(s=>{this.$emit("refresh",s.data)})}}},Sd={class:"card-header"},Md={style:{display:"inline"}},Rd={class:"float-end"},wd=["href"],$d=["href"],jd={class:"card-body"},Ad={key:0},Ud=e("br",null,null,-1),Id={class:""},Hd={class:"row align-items-start"},qd={class:"col-md-6"},Ld={class:"col"},Od=["data-id"],Fd=["data-id"],Bd=["href"],Nd={key:1,class:"row"},zd={class:"col-md-7"},Gd=e("br",null,null,-1),Yd={class:"row align-items-start"},Jd={class:"col-md-8"},Wd={class:"col-md-auto"},Qd=["data-id"],Xd=["data-id"],Zd=["href"],Kd={class:"col"},eu=e("br",null,null,-1),tu={key:0},su={key:0};function nu(n,s,t,_,l,r){const o=M,d=E("u-heures"),m=R,y=E("taux",!0);return i(),a(p,null,[e("div",{class:D(["card",{"ms-5":t.taux.tauxRemu}])},[e("div",Sd,[e("h3",Md,u(t.taux.libelle)+" ("+u(t.taux.code)+")",1),e("div",Rd,[t.taux.canEdit?(i(),a("a",{key:0,href:l.saisieUrl,class:"btn btn-primary",onClick:s[0]||(s[0]=b((...x)=>r.saisie&&r.saisie(...x),["prevent"]))},[f(o,{name:"pen-to-square"}),c(" Modifier")],8,wd)):h("",!0),c("   "),t.taux.canDelete?(i(),a("a",{key:1,href:l.supprimerUrl,class:"btn btn-danger",onClick:s[1]||(s[1]=b((...x)=>r.supprimer&&r.supprimer(...x),["prevent"]))},[f(o,{name:"trash-can"}),c(" Supprimer")],8,$d)):h("",!0)])]),e("div",jd,[t.taux.tauxRemu?h("",!0):(i(),a("div",Ad,[c(" Modification :"),Ud,e("ul",null,[(i(!0),a(p,null,g(t.taux.tauxRemuValeurs,x=>(i(),a("div",{key:x.id},[e("li",Id,[e("div",Hd,[e("div",qd,[f(d,{valeur:x.valeur},null,8,["valeur"]),c("€/h à partir du "),f(m,{value:x.dateEffet},null,8,["value"])]),e("div",Ld,[t.taux.canEdit?(i(),a("a",{key:0,class:"text-primary",onClick:s[2]||(s[2]=b((...v)=>r.saisieValeur&&r.saisieValeur(...v),["prevent"])),"data-id":x.id},[f(o,{name:"pen-to-square"})],8,Od)):h("",!0),c("   "),t.taux.canEdit?(i(),a("a",{key:1,class:"text-primary",onClick:s[3]||(s[3]=b((...v)=>r.supprimerValeur&&r.supprimerValeur(...v),["prevent"])),"data-id":x.id},[f(o,{name:"trash-can"})],8,Fd)):h("",!0)])])])]))),128))]),t.taux.canEdit?(i(),a("a",{key:0,href:l.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:s[4]||(s[4]=b((...x)=>r.ajoutValeur&&r.ajoutValeur(...x),["prevent"]))},[f(o,{name:"plus"}),c(" Ajouter une valeur ")],8,Bd)):h("",!0)])),t.taux.tauxRemu?(i(),a("div",Nd,[e("div",zd,[c(" Modification :"),Gd,e("ul",null,[(i(!0),a(p,null,g(t.taux.tauxRemuValeurs,x=>(i(),a("div",null,[e("li",null,[e("div",Yd,[e("div",Jd,[c(" Coéfficient de "),f(d,{valeur:x.valeur},null,8,["valeur"]),c(" à partir du "),f(m,{value:x.dateEffet},null,8,["value"])]),e("div",Wd,[t.taux.canEdit?(i(),a("a",{key:0,class:"text-primary",onClick:s[5]||(s[5]=b((...v)=>r.saisieValeur&&r.saisieValeur(...v),["prevent"])),"data-id":x.id},[f(o,{name:"pen-to-square"})],8,Qd)):h("",!0),c("   "),t.taux.canEdit?(i(),a("a",{key:1,class:"text-primary",onClick:s[6]||(s[6]=b((...v)=>r.supprimerValeur&&r.supprimerValeur(...v),["prevent"])),"data-id":x.id},[f(o,{name:"trash-can"})],8,Xd)):h("",!0)])])])]))),256))]),t.taux.canEdit?(i(),a("a",{key:0,href:l.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:s[7]||(s[7]=b((...x)=>r.ajoutValeur&&r.ajoutValeur(...x),["prevent"]))},[f(o,{name:"plus"})],8,Zd)):h("",!0)]),e("div",Kd,[c(" Valeurs calculées (indexées sur le taux "+u(t.taux.tauxRemu.libelle)+") : ",1),e("ul",null,[(i(!0),a(p,null,g(t.taux.tauxRemuValeursIndex,x=>(i(),a("div",null,[e("li",null,[f(d,{valeur:x.valeur},null,8,["valeur"]),c("€/h à partir du "),f(m,{value:x.date},null,8,["value"])])]))),256))]),eu])])):h("",!0)])],2),t.taux.tauxRemu?h("",!0):(i(),a("div",tu,[(i(!0),a(p,null,g(t.listeTaux,x=>(i(),a("div",{key:x},[x.tauxRemu&&x.tauxRemu.id===t.taux.id?(i(),a("div",su,[(i(),C(y,{onSupprimer:r.supprimer,onRefreshListe:r.refreshListe,key:t.taux.id,taux:x,listeTaux:t.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):h("",!0)]))),128))]))],64)}const W=k(Td,[["render",nu]]),ru=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"})),iu={components:{taux:W},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,s=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(n){let s=Util.json.indexById(this.listeTaux,n.id);this.listeTaux[s]=n},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(n=>{this.listeTaux=n.data})}}},au=["href"];function ou(n,s,t,_,l,r){const o=E("taux");return i(),a(p,null,[(i(!0),a(p,null,g(l.listeTaux,d=>(i(),a("div",null,[d.tauxRemu?h("",!0):(i(),C(o,{onSupprimer:r.supprimer,onRefreshListe:r.refreshListe,key:d.id,taux:d,listeTaux:l.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),t.canEditTaux?(i(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:s[0]||(s[0]=b((...d)=>r.ajout&&r.ajout(...d),["prevent"]))},"Ajout d'un nouveau taux",8,au)):h("",!0)],64)}const lu=k(iu,[["render",ou]]),du=Object.freeze(Object.defineProperty({__proto__:null,default:lu},Symbol.toStringTag,{value:"Module"})),uu={UHeures:"Application/UI/UHeures",Utilisateur:"Application/Utilisateur"};function cu(n,s){const t={};s===void 0&&(s={});for(const _ in n){let r=_.slice(2,-4).replace("/","");t[r]=n[_].default}for(const _ of document.getElementsByClassName("vue-app")){let l=te({template:_.innerHTML,components:t});if(s.beforeMount!==void 0&&s.beforeMount(l),s.autoloads!==void 0)for(const r in s.autoloads){let o=s.autoloads[r].replace("/","");l.component(r,t[o])}l.mount(_),s.afterMount!==void 0&&s.afterMount(l)}}const hu={init:cu},mu=Object.assign({"./Application/UI/UHeures.vue":ae,"./Application/Utilisateur.vue":ce,"./Intervenant/Recherche.vue":$e,"./Lieu/Structure.vue":ft,"./Lieu/StructuresAdmin.vue":Ct,"./Mission/Liste.vue":Gs,"./Mission/ListeCandidatures.vue":yn,"./Mission/ListeOffreEmploi.vue":Qr,"./Mission/ListePrime.vue":ta,"./Mission/Mission.vue":Os,"./Mission/OffreEmploi.vue":Fr,"./Mission/Prime.vue":Bi,"./Mission/Suivi.vue":Aa,"./Mission/SuiviEvent.vue":Ra,"./Paiement/DemandeMiseEnPaiementLot.vue":vl,"./Paiement/DetailsCalculs.vue":rd,"./Paiement/ImportNumeroPec.vue":Dd,"./Paiement/ListeTaux.vue":du,"./Paiement/Taux.vue":ru}),_u={autoloads:uu};hu.init(mu,_u);
