import{c as l,a as i,b as f,w as C,v as A,F as p,r as S,d as x,o,t as m,n as q,e as V,f as F,g as _,h as v,i as M,j as O,k as D,l as b,m as U,p as N,q as z,D as B,s as J,u as Y,x as X}from"./vendor-d4e44988.js";const y=(e,t)=>{const n=e.__vccOpts||e;for(const[c,r]of t)n[c]=r;return n},K={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0}},data(){const e=new Date(this.date);return{mois:e.getMonth()+1,annee:e.getFullYear()}},computed:{listeJours(){const e=new Date(this.date);e.setDate(1),e.setMonth(e.getMonth()+1),e.setDate(e.getDate()-1);let t=e.getDate();return Array.from({length:t},(n,c)=>c+1)}},watch:{date:function(e,t){const n=new Date(this.date);this.mois=n.getMonth()+1,this.annee=n.getFullYear()},mois:function(e,t){const n=new Date(this.date);n.setMonth(e-1),this.$emit("changeDate",n)},annee:function(e,t){const n=new Date(this.date);n.setFullYear(e),this.$emit("changeDate",n)}},methods:{nomJour(e){const t=new Date(this.date);return t.setDate(e),t.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let e=[];const t=new Date;for(let n=1;n<=12;n++){t.setMonth(n-1);let c=t.toLocaleString("fr-FR",{month:"long"});e.push({id:n,libelle:c})}return e},listeAnnees(){const t=new Date().getFullYear(),n=1;let c=[];for(let r=t-n;r<=t+n;r++)c.push(r);return c},addEvent(e){const t=new Date(this.date);t.setDate(e.currentTarget.dataset.jour),this.$emit("addEvent",t,e)},prevMois(){const e=new Date(this.date);e.setMonth(e.getMonth()-1),this.$emit("changeDate",e)},nextMois(){const e=new Date(this.date);e.setMonth(e.getMonth()+1),this.$emit("changeDate",e)},eventsByJour(e){const t=new Date(this.date);let n={};for(let c in this.events){let r=this.events[c];r.date.getFullYear()===t.getFullYear()&&r.date.getMonth()+1===t.getMonth()+1&&r.date.getDate()===e&&(n[c]=r)}return n}}},W={class:"calendar"},G={class:"recherche"},Q={class:"recherche btn-group"},Z=["value"],ee=["value"],te={class:"table table-bordered table-hover table-sm"},ie=["data-jour"],ne={class:"nom-jour"},se={class:"numero-jour"},re={class:"num-jour badge bg-secondary rounded-circle"},ae={key:0},oe=["data-jour"];function le(e,t,n,c,r,s){const u=x("u-icon");return o(),l("div",W,[i("div",G,[i("div",Q,[i("button",{class:"btn btn-light",id:"prevMois",onClick:t[0]||(t[0]=(...a)=>s.prevMois&&s.prevMois(...a)),title:"Mois précédant"},[f(u,{name:"chevron-left"})]),C(i("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":t[1]||(t[1]=a=>r.mois=a)},[(o(!0),l(p,null,S(s.listeMois(),a=>(o(),l("option",{value:a.id},m(a.libelle),9,Z))),256))],512),[[A,r.mois]]),C(i("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":t[2]||(t[2]=a=>r.annee=a)},[(o(!0),l(p,null,S(s.listeAnnees(),a=>(o(),l("option",{value:a},m(a),9,ee))),256))],512),[[A,r.annee]]),i("button",{class:"btn btn-light",id:"nextMois",onClick:t[3]||(t[3]=(...a)=>s.nextMois&&s.nextMois(...a)),title:"Mois suivant"},[f(u,{name:"chevron-right"})])])]),i("table",te,[(o(!0),l(p,null,S(s.listeJours,a=>(o(),l("tr",{"data-jour":a},[i("th",ne,m(s.nomJour(a)),1),i("th",se,[i("div",re,m(a<10?"0"+a.toString():a),1)]),i("td",null,[(o(!0),l(p,null,S(s.eventsByJour(a),(d,g)=>(o(),l("div",{class:"event",style:q("border-color:"+d.color+";background-color:"+d.bgcolor),key:g},[(o(),V(F(d.component),{event:d},null,8,["event"]))],4))),128)),n.canAddEvent?(o(),l("div",ae,[i("button",{onClick:t[4]||(t[4]=(...d)=>s.addEvent&&s.addEvent(...d)),"data-jour":a,class:"btn btn-light btn-sm"},[f(u,{name:"plus"}),_(" Nouvel événement ")],8,oe)])):v("",!0)])],8,ie))),256))])])}const ue=y(K,[["render",le],["__scopeId","data-v-5d5704ec"]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),ce={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(e){this.formatted=this.formatage(e)}},methods:{formatage(e){if(e===void 0)return;let t=new Date(e);const n=t.getFullYear(),c=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),s=t.getHours().toString().padStart(2,"0"),u=t.getMinutes().toString().padStart(2,"0"),a=t.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${r}/${c}/${n} à ${s}:${u}`;case"time":return`${s}:${u}:${a}`}return`${r}/${c}/${n}`}}};function me(e,t,n,c,r,s){return m(r.formatted)}const he=y(ce,[["render",me]]),_e=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"})),ve={name:"UIcon",props:{valeur:{required:!0,type:Float64Array}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},fe=["innerHTML"];function pe(e,t,n,c,r,s){return o(),l("span",{class:"heures",innerHTML:s.affichage},null,8,fe)}const be=y(ve,[["render",pe]]),ge=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"})),ye={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String}}};function xe(e,t,n,c,r,s){return o(),l("i",{class:M(`fas fa-${n.name} text-${n.variant}`)},null,2)}const R=y(ye,[["render",xe]]),Se=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"})),Te={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},Ve=["id"],ke={class:"modal-dialog"},Ce={class:"modal-content"},Ue={class:"modal-header"},Me={class:"modal-title"},je=i("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),De={class:"modal-body"},we={class:"modal-footer"},Ae=i("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1);function Oe(e,t,n,c,r,s){return o(),l("div",{class:"modal fade",id:n.id,tabindex:"-1","aria-hidden":"true"},[i("div",ke,[i("div",Ce,[i("div",Ue,[i("h5",Me,m(n.title),1),je]),i("div",De,[O(e.$slots,"body")]),i("div",we,[O(e.$slots,"footer"),Ae])])])],8,Ve)}const Re=y(Te,[["render",Oe]]),Le=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"})),Ie={name:"Utilisateur",props:{nom:String,mail:String}},Ee=["href"];function $e(e,t,n,c,r,s){return o(),l("a",{href:`mailto:${n.mail}`},m(n.nom),9,Ee)}const He=y(Ie,[["render",$e]]),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"})),qe={name:"MonTest",props:{monId:{required:!0,type:Number}},data(){return{contacts:[]}},mounted(){unicaenVue.axios.get(unicaenVue.url("mission/test-data/:monId",{monId:this.monId})).then(e=>{this.contacts=e.data})}},Fe=i("h2",null,"Contacts",-1),Ne={class:"table table-bordered"},ze=i("thead",null,[i("tr",null,[i("th",null,"Nom"),i("th",null,"Prénom")])],-1);function Be(e,t,n,c,r,s){return o(),l(p,null,[i("p",null,"Mon ID : "+m(n.monId),1),Fe,i("table",Ne,[ze,i("tbody",null,[(o(!0),l(p,null,S(r.contacts,u=>(o(),l("tr",null,[i("td",null,m(u.nom),1),i("td",null,m(u.prenom),1)]))),256))])])],64)}const Je=y(qe,[["render",Be]]),Ye=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"})),Xe={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(e){this.searchTerm=e.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(e){return"/intervenant/code:"+e+"/voir"},reload(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(e=>{let t=e.data,n=[];for(const c in t){if(t[c].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){n.push(t[c]);continue}if(t[c].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){n.push(t[c]);continue}if(t[c].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){n.push(t[c]);continue}}this.intervenants=n,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(e=>{console.log(e.message)})},800)}}},Ke=i("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1),We={class:"intervenant-recherche"},Ge={class:"critere"},Qe=i("br",null,null,-1),Ze=i("span",{class:"fw-bold"},"Types d'intervenant : ",-1),et=i("br",null,null,-1),tt={key:0,class:"table table-bordered table-hover"},it=i("thead",null,[i("tr",null,[i("th",{style:{width:"90px"}}),i("th",null,"Civilité"),i("th",null,"Nom"),i("th",null,"Prenom"),i("th",null,"Structure"),i("th",null,"Statut"),i("th",null,"Date de naissance"),i("th",null,"N° Personnel")])],-1),nt=["title"],st={style:{}},rt=["href"],at=i("i",{class:"fas fa-eye"},null,-1),ot={key:1,class:"table table-bordered table-hover"},lt=i("thead",null,[i("tr",null,[i("th",{style:{width:"90px"}}),i("th",null,"Civilité"),i("th",null,"Nom"),i("th",null,"Prenom"),i("th",null,"Structure"),i("th",null,"Statut"),i("th",null,"Date de naissance"),i("th",null,"N° Personnel")])],-1),ut=i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"},colspan:"8"},"Aucun intervenant trouvé")])],-1),dt=[lt,ut];function ct(e,t,n,c,r,s){const u=x("u-date");return o(),l(p,null,[Ke,i("div",We,[i("div",Ge,[i("div",null,[i("input",{id:"term",onKeyup:t[0]||(t[0]=(...a)=>s.rechercher&&s.rechercher(...a)),class:"form-control input",type:"text",placeholder:"votre recherche..."},null,32),Qe]),i("div",null,[Ze,C(i("input",{onChange:t[1]||(t[1]=a=>s.reload()),type:"checkbox",name:"type[]",value:"permanent",checked:"checked","onUpdate:modelValue":t[2]||(t[2]=a=>r.checkedTypes=a)},null,544),[[D,r.checkedTypes]]),_(" Permanent "),C(i("input",{onChange:t[3]||(t[3]=a=>s.reload()),type:"checkbox",name:"type[]",value:"vacataire",checked:"checked","onUpdate:modelValue":t[4]||(t[4]=a=>r.checkedTypes=a)},null,544),[[D,r.checkedTypes]]),_(" Vacataire "),C(i("input",{onChange:t[5]||(t[5]=a=>s.reload()),type:"checkbox",name:"type[]",value:"etudiant",checked:"checked","onUpdate:modelValue":t[6]||(t[6]=a=>r.checkedTypes=a)},null,544),[[D,r.checkedTypes]]),_(" Etudiant ")]),et])]),r.intervenants.length>0?(o(),l("table",tt,[it,i("tbody",null,[(o(!0),l(p,null,S(r.intervenants,(a,d)=>(o(),l("tr",{class:M({"bg-danger":a.destruction!==null}),title:a.destruction!==null?"Fiche historisé":""},[i("td",st,[i("a",{href:s.urlFiche(a.code)},[at,_(" Fiche")],8,rt)]),i("td",null,m(a.civilite),1),i("td",null,m(a.nom),1),i("td",null,m(a.prenom),1),i("td",null,m(a.structure),1),i("td",null,m(a.statut),1),i("td",null,[f(u,{value:a["date-naissance"]},null,8,["value"])]),i("td",null,m(a["numero-personnel"]),1)],10,nt))),256))])])):v("",!0),r.intervenants.length==0&&r.noResult==1?(o(),l("table",ot,dt)):v("",!0)],64)}const mt=y(Xe,[["render",ct]]),ht=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));const _t={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(e){this.validationText=this.calcValidation(e)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":Util.formattedHeures(this.mission.heures)+" heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(e){return e===null?"A valider":e.id===null?"Autovalidée":"Validation du "+e.histoCreation+" par "},saisie(e){modAjax(e.currentTarget,t=>{this.refresh()})},supprimer(e){popConfirm(e.currentTarget,t=>{this.$emit("supprimer",this.mission)})},valider(e){popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},devalider(e){popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireSupprimer(e){e.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireValider(e){e.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireDevalider(e){e.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(e=>{this.$emit("refresh",e.data)})}}},T=e=>(N("data-v-212ac409"),e=e(),z(),e),vt=["id"],ft={class:"card-header card-header-h3"},pt={class:"float-end"},bt={class:"card-body"},gt={class:"row"},yt={class:"col-md-8"},xt={class:"row"},St={class:"col-md-12"},Tt=T(()=>i("label",{class:"form-label"},"Composante en charge du suivi",-1)),Vt={class:"form-control"},kt={class:"row"},Ct={class:"col-md-5"},Ut=T(()=>i("label",{class:"form-label"},"Taux de rémunération",-1)),Mt={class:"form-control"},jt={class:"col-md-7"},Dt=T(()=>i("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),wt={class:"input-group mb-3"},At=["innerHTML"],Ot=["data-bs-target"],Rt={class:"row"},Lt={class:"col-md-12"},It=T(()=>i("label",{class:"form-label"},"Descriptif de la mission",-1)),Et={class:"form-control"},$t=T(()=>i("div",{class:"row"},[i("div",{class:"col-md-12"}," ")],-1)),Ht={class:"row"},Pt={class:"col-md-12"},qt=["href"],Ft=["href"],Nt=["href"],zt=["href"],Bt={class:"col-md-4"},Jt=T(()=>i("div",null,[i("label",{class:"form-label"},"Suivi")],-1)),Yt=T(()=>i("div",null," Aucune heure réalisée ",-1)),Xt={class:"table table-bordered table-condensed"},Kt=T(()=>i("thead",null,[i("tr",null,[i("th",null,"Heures"),i("th",null,"Statut"),i("th",null,"Actions")])],-1)),Wt={style:{"text-align":"right"}},Gt=T(()=>i("br",null,null,-1)),Qt={key:0},Zt=["data-id"],ei=["data-id"],ti=["data-id"];function ii(e,t,n,c,r,s){const u=x("u-date"),a=x("u-icon"),d=x("utilisateur"),g=x("u-heures"),P=x("u-modal");return o(),l(p,null,[i("div",{id:n.mission.id,class:M(["card",{"bg-success":n.mission.valide,"bg-default":!n.mission.valide}])},[i("form",{onSubmit:t[4]||(t[4]=b((...h)=>e.submitForm&&e.submitForm(...h),["prevent"]))},[i("div",ft,[i("h5",null,[_(m(n.mission.typeMission.libelle)+" ",1),i("span",pt,[_("Du "),f(u,{value:n.mission.dateDebut},null,8,["value"]),_(" au "),f(u,{value:n.mission.dateFin},null,8,["value"])])])]),i("div",bt,[i("div",gt,[i("div",yt,[i("div",xt,[i("div",St,[Tt,i("div",Vt,m(n.mission.structure.libelle),1)])]),i("div",kt,[i("div",Ct,[Ut,i("div",Mt,m(n.mission.tauxRemu.libelle),1)]),i("div",jt,[Dt,i("div",wt,[i("div",{class:"form-control",innerHTML:s.heuresLib},null,8,At),i("button",{class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal","data-bs-target":`#details-${n.mission.id}`}," Détails ",8,Ot)])])]),i("div",Rt,[i("div",Lt,[It,i("div",Et,m(n.mission.description),1)])]),$t,i("div",Ht,[i("div",Pt,[n.mission.canSaisie?(o(),l("a",{key:0,href:r.saisieUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...h)=>s.saisie&&s.saisie(...h),["prevent"]))},"Modifier",8,qt)):v("",!0),n.mission.canValider?(o(),l("a",{key:1,href:r.validerUrl,class:"btn btn-secondary","data-title":"Validation de la mission","data-content":"Êtes-vous sur de vouloir valider la mission ?",onClick:t[1]||(t[1]=b((...h)=>s.valider&&s.valider(...h),["prevent"]))},"Valider",8,Ft)):v("",!0),n.mission.canDevalider?(o(),l("a",{key:2,href:r.devaliderUrl,class:"btn btn-danger","data-title":"Dévalidation de la mission","data-content":"Êtes-vous sur de vouloir dévalider la mission ?",onClick:t[2]||(t[2]=b((...h)=>s.devalider&&s.devalider(...h),["prevent"]))},"Dévalider",8,Nt)):v("",!0),n.mission.canSupprimer?(o(),l("a",{key:3,href:r.supprimerUrl,class:"btn btn-danger","data-title":"Suppression de la mission","data-content":"Êtes-vous sur de vouloir supprimer la mission ?",onClick:t[3]||(t[3]=b((...h)=>s.supprimer&&s.supprimer(...h),["prevent"]))},"Supprimer",8,zt)):v("",!0)])])]),i("div",Bt,[Jt,i("div",null,[f(a,{name:"thumbs-up",variant:"success"}),_(" Créé le "),f(u,{value:"mission.histoCreation"}),_(" par "),f(d,{nom:n.mission.histoCreateur.displayName,mail:n.mission.histoCreateur.email},null,8,["nom","mail"])]),i("div",null,[f(a,{name:n.mission.valide?"thumbs-up":"thumbs-down",variant:n.mission.valide?"success":"info"},null,8,["name","variant"]),_(" "+m(r.validationText)+" ",1),n.mission.validation&&n.mission.validation.histoCreateur?(o(),V(d,{key:0,nom:n.mission.validation.histoCreateur.displayName,mail:n.mission.validation.histoCreateur.email},null,8,["nom","mail"])):v("",!0)]),i("div",null,[f(a,{name:n.mission.contrat?"thumbs-up":"thumbs-down",variant:n.mission.contrat?"success":"info"},null,8,["name","variant"]),_(" "+m(n.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),Yt])])])],32)],10,vt),f(P,{id:`details-${n.mission.id}`,title:"Détail des heures prévisionnelles"},{body:U(()=>[i("table",Xt,[Kt,i("tbody",null,[(o(!0),l(p,null,S(n.mission.volumesHoraires,h=>(o(),l("tr",{key:h.id},[i("td",Wt,[f(g,{valeur:h.heures},null,8,["valeur"])]),i("td",null,[f(a,{name:"thumbs-up",variant:"success"}),_(" Saisi par "),f(d,{nom:h.histoCreateur.displayName,mail:h.histoCreateur.email},null,8,["nom","mail"]),_(" le "+m(h.histoCreation)+" ",1),Gt,f(a,{name:h.valide?"thumbs-up":"thumbs-down",variant:h.valide?"success":"info"},null,8,["name","variant"]),_(" "+m(h.validation&&h.validation.id==null?"Autovalidé":h.validation?"":"à valider")+" ",1),h.validation&&h.validation.histoCreateur?(o(),l("span",Qt,[_(" Validé par "),f(d,{nom:h.validation.histoCreateur.displayName,mail:h.validation.histoCreateur.email},null,8,["nom","mail"]),_(" le "+m(h.validation.histoCreation),1)])):v("",!0)]),i("td",null,[h.canValider?(o(),l("a",{key:0,class:"btn btn-secondary","data-id":h.id,"data-title":"Validation du volume horaire","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?",onClick:t[5]||(t[5]=b((...k)=>s.volumeHoraireValider&&s.volumeHoraireValider(...k),["prevent"]))},"Valider",8,Zt)):v("",!0),h.canDevalider?(o(),l("a",{key:1,class:"btn btn-danger","data-id":h.id,"data-title":"Dévalidation du volume horaire","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?",onClick:t[6]||(t[6]=b((...k)=>s.volumeHoraireDevalider&&s.volumeHoraireDevalider(...k),["prevent"]))},"Dévalider",8,ei)):v("",!0),h.canSupprimer?(o(),l("a",{key:2,class:"btn btn-danger","data-id":h.id,"data-title":"Suppression du volume horaire","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?",onClick:t[7]||(t[7]=b((...k)=>s.volumeHoraireSupprimer&&s.volumeHoraireSupprimer(...k),["prevent"]))},"Supprimer",8,ti)):v("",!0)])]))),128))])])]),footer:U(()=>[]),_:1},8,["id"])],64)}const L=y(_t,[["render",ii],["__scopeId","data-v-212ac409"]]),ni=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"})),si={components:{mission:L},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(e){modAjax(e.currentTarget,t=>{this.reload()})},supprimer(e){this.reload()},refresh(e){console.log(e);let t=Util.json.indexById(this.missions,e.id);this.missions[t]=e},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(e=>{this.missions=e.data})}}},ri=["href"];function ai(e,t,n,c,r,s){const u=x("mission");return o(),l(p,null,[(o(!0),l(p,null,S(r.missions,a=>(o(),V(u,{onSupprimer:s.supprimer,onRefresh:s.refresh,key:a.id,mission:a},null,8,["onSupprimer","onRefresh","mission"]))),128)),n.canAddMission?(o(),l("a",{key:0,class:"btn btn-primary",href:r.ajoutUrl,onClick:t[0]||(t[0]=b((...a)=>s.ajout&&s.ajout(...a),["prevent"]))},"Ajout d'une nouvelle mission",8,ri)):v("",!0)],64)}const oi=y(si,[["render",ai]]),li=Object.freeze(Object.defineProperty({__proto__:null,default:oi},Symbol.toStringTag,{value:"Module"}));const ui={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(e){modAjax(e.currentTarget,t=>{this.suivi.refresh()})},supprimer(e){popConfirm(e.currentTarget,t=>{this.suivi.refresh()})},valider(e){unicaenVue.axios.get(this.validerUrl).then(t=>{this.suivi.refresh()})},devalider(e){popConfirm(e.currentTarget,t=>{this.suivi.refresh()})}}},di={class:"event-content"},ci={class:"mission"},mi={class:"horaires"},hi={key:0,class:"description"},_i={class:"event-actions"},vi={class:"btn-group btn-group-sm"},fi=["data-url"],pi=["data-url"],bi=["data-url"],gi=["data-url"];function yi(e,t,n,c,r,s){const u=B,a=x("u-icon");return o(),l(p,null,[i("div",di,[i("p",ci,m(n.event.mission.libelleCourt),1),i("p",mi,[_(" de "+m(s.heureDebut)+" à "+m(s.heureFin)+", soient "+m(s.heures)+" heures ",1),n.event.nocturne?(o(),V(u,{key:0},{default:U(()=>[_("Nocturne")]),_:1})):v("",!0),n.event.formation?(o(),V(u,{key:1},{default:U(()=>[_("En formation")]),_:1})):v("",!0)]),_(m(n.event.valide)+" ",1),n.event.description?(o(),l("p",hi,m(n.event.description),1)):v("",!0)]),i("div",_i,[i("div",vi,[i("button",{class:"btn btn-light",onClick:t[0]||(t[0]=(...d)=>s.modifier&&s.modifier(...d)),title:"Modifier le suivi","data-url":r.modifierUrl},[f(a,{name:"pen-to-square"})],8,fi),i("button",{class:"btn btn-light",onClick:t[1]||(t[1]=(...d)=>s.valider&&s.valider(...d)),title:"Valider le suivi","data-url":r.validerUrl},[f(a,{name:"check",class:"text-success"})],8,pi),i("button",{class:"btn btn-light",onClick:t[2]||(t[2]=(...d)=>s.devalider&&s.devalider(...d)),title:"Dévalider le suivi","data-url":r.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[f(a,{name:"xmark",class:"text-danger"})],8,bi),i("button",{class:"btn btn-light",onClick:t[3]||(t[3]=(...d)=>s.supprimer&&s.supprimer(...d)),title:"Supprimer le suivi","data-url":r.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[f(a,{name:"trash-can",class:"text-danger"})],8,gi)])])],64)}const I=y(ui,[["render",yi],["__scopeId","data-v-8793f2b3"]]),xi=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"})),Si={name:"Suivi",props:{intervenant:{type:Number,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,suivi:[]}},methods:{changeDate(e){this.date=e},ajouter(e,t){const n={intervenant:this.intervenant,date:e.toISOString().slice(0,10)};t.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",n),modAjax(t.currentTarget,c=>{this.refresh()})},refresh(){const e=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let t=0,n=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(c=>{let r=[];for(let s in c.data){let u=c.data[s];n[u.mission.id]===void 0&&(n[u.mission.id]=e[t],t++),u.valide&&(u.bgcolor="#d0eddb"),u.color=n[u.mission.id],u.component=J(I),u.date=new Date(u.date),u.intervenant=this.intervenant,r.push(u)}this.suivi=r})}}};function Ti(e,t,n,c,r,s){const u=x("u-calendar");return o(),V(u,{date:r.date,onChangeDate:s.changeDate,onAddEvent:s.ajouter,"can-add-event":!0,events:r.suivi},null,8,["date","onChangeDate","onAddEvent","events"])}const Vi=y(Si,[["render",Ti]]),ki=Object.freeze(Object.defineProperty({__proto__:null,default:Vi},Symbol.toStringTag,{value:"Module"})),Ci={name:"Taux",components:{UIcon:R},props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(e){modAjax(e.target,t=>{this.$emit("refreshListe")})},ajoutValeur(e){modAjax(e.target,t=>{this.$emit("refreshListe")})},saisieValeur(e){e.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:e.currentTarget.dataset.id}),modAjax(e.currentTarget,t=>{this.$emit("refreshListe")})},refreshListe(e){this.$emit("refreshListe")},supprimer(e){popConfirm(e.target,t=>{this.$emit("refreshListe")})},supprimerValeur(e){e.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refreshListe")})},refresh(e){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:e.id})).then(t=>{this.$emit("refresh",t.data)})}}},Ui={class:"card-header"},Mi={style:{display:"inline"}},ji={class:"float-end"},Di=["href"],wi=["href"],Ai={class:"card-body"},Oi={key:0},Ri=i("br",null,null,-1),Li={class:""},Ii={class:"row align-items-start"},Ei={class:"col-md-4"},$i={class:"col"},Hi=["data-id"],Pi=["data-id"],qi=["href"],Fi={key:1,class:"row"},Ni={class:"col-md-7"},zi=i("br",null,null,-1),Bi={class:"row align-items-start"},Ji={class:"col-md-8"},Yi={class:"col-md-auto"},Xi=["data-id"],Ki=["data-id"],Wi=["href"],Gi={class:"col"},Qi=i("br",null,null,-1),Zi={key:0},en={key:0};function tn(e,t,n,c,r,s){const u=x("u-icon"),a=x("taux",!0);return o(),l(p,null,[i("div",{class:M(["card",{"ms-5":n.taux.tauxRemu}])},[i("div",Ui,[i("h3",Mi,m(n.taux.libelle)+" ("+m(n.taux.code)+")",1),i("div",ji,[n.taux.canEdit?(o(),l("a",{key:0,href:r.saisieUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...d)=>s.saisie&&s.saisie(...d),["prevent"]))},[f(u,{name:"pen-to-square"}),_(" Modifier")],8,Di)):v("",!0),_("   "),n.taux.canDelete?(o(),l("a",{key:1,href:r.supprimerUrl,class:"btn btn-danger",onClick:t[1]||(t[1]=b((...d)=>s.supprimer&&s.supprimer(...d),["prevent"]))},[f(u,{name:"trash-can"}),_(" Supprimer")],8,wi)):v("",!0)])]),i("div",Ai,[n.taux.tauxRemu?v("",!0):(o(),l("div",Oi,[_(" Modification :"),Ri,i("ul",null,[(o(!0),l(p,null,S(n.taux.tauxRemuValeurs,d=>(o(),l("div",{key:d.id},[i("li",Li,[i("div",Ii,[i("div",Ei,m(d.valeur)+"€/h à partir du "+m(d.dateEffet),1),i("div",$i,[n.taux.canEdit?(o(),l("a",{key:0,class:"text-primary",onClick:t[2]||(t[2]=b((...g)=>s.saisieValeur&&s.saisieValeur(...g),["prevent"])),"data-id":d.id},[f(u,{name:"pen-to-square"})],8,Hi)):v("",!0),_("   "),n.taux.canEdit?(o(),l("a",{key:1,class:"text-primary",onClick:t[3]||(t[3]=b((...g)=>s.supprimerValeur&&s.supprimerValeur(...g),["prevent"])),"data-id":d.id},[f(u,{name:"trash-can"})],8,Pi)):v("",!0)])])])]))),128))]),n.taux.canEdit?(o(),l("a",{key:0,href:r.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:t[4]||(t[4]=b((...d)=>s.ajoutValeur&&s.ajoutValeur(...d),["prevent"]))},[f(u,{name:"plus"}),_(" Ajouter une valeur ")],8,qi)):v("",!0)])),n.taux.tauxRemu?(o(),l("div",Fi,[i("div",Ni,[_(" Modification :"),zi,i("ul",null,[(o(!0),l(p,null,S(n.taux.tauxRemuValeurs,d=>(o(),l("div",null,[i("li",null,[i("div",Bi,[i("div",Ji," Coéfficient de "+m(d.valeur)+" à partir du "+m(d.dateEffet),1),i("div",Yi,[n.taux.canEdit?(o(),l("a",{key:0,class:"text-primary",onClick:t[5]||(t[5]=b((...g)=>s.saisieValeur&&s.saisieValeur(...g),["prevent"])),"data-id":d.id},[f(u,{name:"pen-to-square"})],8,Xi)):v("",!0),_("   "),n.taux.canEdit?(o(),l("a",{key:1,class:"text-primary",onClick:t[6]||(t[6]=b((...g)=>s.supprimerValeur&&s.supprimerValeur(...g),["prevent"])),"data-id":d.id},[f(u,{name:"trash-can"})],8,Ki)):v("",!0)])])])]))),256))]),n.taux.canEdit?(o(),l("a",{key:0,href:r.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:t[7]||(t[7]=b((...d)=>s.ajoutValeur&&s.ajoutValeur(...d),["prevent"]))},[f(u,{name:"plus"})],8,Wi)):v("",!0)]),i("div",Gi,[_(" Valeurs calculées (indexées sur le taux "+m(n.taux.tauxRemu.libelle)+") : ",1),i("ul",null,[(o(!0),l(p,null,S(n.taux.tauxRemuValeursIndex,d=>(o(),l("div",null,[i("li",null,m(d.valeur)+"€/h à partir du "+m(d.date),1)]))),256))]),Qi])])):v("",!0)])],2),n.taux.tauxRemu?v("",!0):(o(),l("div",Zi,[(o(!0),l(p,null,S(n.listeTaux,d=>(o(),l("div",{key:d},[d.tauxRemu&&d.tauxRemu.id===n.taux.id?(o(),l("div",en,[(o(),V(a,{onSupprimer:s.supprimer,onRefreshListe:s.refreshListe,key:n.taux.id,taux:d,listeTaux:n.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):v("",!0)]))),128))]))],64)}const E=y(Ci,[["render",tn]]),nn=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),sn={components:{taux:E},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(e){modAjax(e.currentTarget,t=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(e){let t=Util.json.indexById(this.listeTaux,e.id);this.listeTaux[t]=e},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(e=>{this.listeTaux=e.data})}}},rn=["href"];function an(e,t,n,c,r,s){const u=x("taux");return o(),l(p,null,[(o(!0),l(p,null,S(r.listeTaux,a=>(o(),l("div",null,[a.tauxRemu?v("",!0):(o(),V(u,{onSupprimer:s.supprimer,onRefreshListe:s.refreshListe,key:a.id,taux:a,listeTaux:r.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),n.canEditTaux?(o(),l("a",{key:0,class:"btn btn-primary",href:r.ajoutUrl,onClick:t[0]||(t[0]=b((...a)=>s.ajout&&s.ajout(...a),["prevent"]))},"Ajout d'un nouveau taux",8,rn)):v("",!0)],64)}const on=y(sn,[["render",an]]),ln=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"})),un={UIcon:"Application/UI/UIcon",UHeures:"Application/UI/UHeures",UModal:"Application/UI/UModal",UDate:"Application/UI/UDate",UCalendar:"Application/UI/UCalendar",Utilisateur:"Application/Utilisateur"};function dn(e){for(let t in e)for(let n in e[t])H(e[t][n],t)}function H(e,t){const n={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},c={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"};let r=document.getElementById("unicaen-vue-toast-container");r||(r=document.createElement("div"),r.id="unicaen-vue-toast-container",r.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(r));const s=document.createElement("div");s.classList.add("toast","show","text-white",n[t]?n[t]:"bg-secondary"),s.setAttribute("role","alert"),s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true");const u=document.createElement("div");u.classList.add("d-flex");const a=document.createElement("button");a.type="button",a.classList.add("btn-close","btn-close-white","me-2","m-auto"),a.setAttribute("data-bs-dismiss","toast"),a.setAttribute("aria-label","Close");const d=document.createElement("span");d.classList.add("icon","fas","fa-"+c[t]),d.style="font-size: 25pt;margin-right:1rem;margin-bottom:.2rem";const g=document.createElement("div");g.classList.add("toast-body"),g.appendChild(d),g.innerHTML=g.innerHTML+e,s.appendChild(u),u.appendChild(g),u.appendChild(a),r.appendChild(s),t!=="error"&&setTimeout(()=>{s.classList.remove("show")},3e3)}const w={toast:H,toasts:dn},j={axios:Y,flashMessenger:w,url:(e,t,n)=>{let c=window.__unicaenVueBaseUrl;if(t)for(let s in t)e=e.replace(`:${s}`,t[s]);let r=n?new URLSearchParams(n).toString():null;return c+e+(r?`?${r}`:"")}};j.axios.interceptors.request.use(e=>{if(e.submitter){let t=e.msg?e.msg:"Action en cours";e.popover!=null&&e.popover.dispose(),e.popover=new bootstrap.Popover(e.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+t,html:!0,trigger:"focus"}),e.popover.show()}return e});j.axios.interceptors.response.use(e=>{if(e.messages=e.data.messages,e.data=e.data.data,e.hasErrors=!!(e.messages&&e.messages.error&&e.messages.error.length>0),e.config.popover){var t=e.config.popover;let n="";for(ns in e.messages)for(mid in e.messages[ns])n+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+e.messages[ns][mid]+"</div>";n?(t._config.content=n,t.setContent(),setTimeout(()=>{t.dispose()},3e3)):t.dispose()}return e.messages&&w.toasts(e.messages),e},e=>{var t=$("<div>").html(e.response.data);t.find("i.fas").hide(),w.toast(t.find(".alert").html(),"error")});j.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";window.unicaenVue=j;function cn(e,t){const n={};t===void 0&&(t={});for(const c in e){let s=c.slice(2,-4).replace("/","");n[s]=e[c].default}for(const c of document.getElementsByClassName("vue-app")){let r=X({template:c.innerHTML,components:n});if(t.beforeMount!==void 0&&t.beforeMount(r),t.autoloads!==void 0)for(const s in t.autoloads){let u=t.autoloads[s].replace("/","");r.component(s,n[u])}r.mount(c),t.afterMount!==void 0&&t.afterMount(r)}}const mn={init:cn},hn=Object.assign({"./Application/UI/UCalendar.vue":de,"./Application/UI/UDate.vue":_e,"./Application/UI/UHeures.vue":ge,"./Application/UI/UIcon.vue":Se,"./Application/UI/UModal.vue":Le,"./Application/Utilisateur.vue":Pe,"./Exemple/MonTest.vue":Ye,"./Intervenant/Recherche.vue":ht,"./Mission/Liste.vue":li,"./Mission/Mission.vue":ni,"./Mission/Suivi.vue":ki,"./Mission/SuiviEvent.vue":xi,"./Paiement/ListeTaux.vue":ln,"./Paiement/Taux.vue":nn}),_n={autoloads:un};mn.init(hn,_n);
