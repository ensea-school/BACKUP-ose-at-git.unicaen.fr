-- VUE globale
SELECT
  table_name, 
  source_code, 
  to_char( MIN(date_sync), 'dd/mm/YYYY' ) premiere_date, 
  to_char( MAX(date_sync), 'dd/mm/YYYY' ) derniere_date,
  count(*) occurences, 
  to_char(message) message
FROM
  sync_log
GROUP BY
  table_name,
  source_code,
  to_char(message)
ORDER BY
  derniere_date DESC
;



--SELECT *
DELETE 
FROM sync_log WHERE
  1=1
  --message like '%%'
  --message like '%cannot update ("OSE"."ETAPE"."TYPE_FORMATION_ID") to NULL%'
  --table_name = ''
;