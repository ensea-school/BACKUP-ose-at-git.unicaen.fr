import{c as l,o,t as m,a as _,w as M,F as p,b as i,r as V,d as f,e as C,v as D,f as y,g as h,n as j,h as A,i as b,j as k,p as F,k as z,l as L,m as I,q as N,s as B,u as J,x as Y}from"./vendor-5db8850c.js";const g=(e,t)=>{const s=e.__vccOpts||e;for(const[d,a]of t)s[d]=a;return s},X={props:{valeur:{required:!0,type:Float64Array}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},K=["innerHTML"];function W(e,t,s,d,a,n){return o(),l("span",{class:"heures",innerHTML:n.affichage},null,8,K)}const G=g(X,[["render",W]]),Q=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"})),Z={name:"Utilisateur",props:{nom:String,mail:String}},ee=["href"];function te(e,t,s,d,a,n){return o(),l("a",{href:`mailto:${s.mail}`},m(s.nom),9,ee)}const se=g(Z,[["render",te]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),ne={name:"MonTest"},ae=i("h2",null,"Contacts",-1);function re(e,t,s,d,a,n){const u=V("u-test-final"),r=V("zozo-mon-z");return o(),l(p,null,[ae,_(u,null,{default:M(()=>[f("Loupé coucou")]),_:1}),_(r,null,{default:M(()=>[f("Caramba encore raté")]),_:1})],64)}const oe=g(ne,[["render",re]]),le=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),ue={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(e){this.formatted=this.formatage(e)}},methods:{formatage(e){if(e===void 0)return;let t=new Date(e);const s=t.getFullYear(),d=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getDate().toString().padStart(2,"0"),n=t.getHours().toString().padStart(2,"0"),u=t.getMinutes().toString().padStart(2,"0"),r=t.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${a}/${d}/${s} à ${n}:${u}`;case"time":return`${n}:${u}:${r}`}return`${a}/${d}/${s}`}}};function de(e,t,s,d,a,n){return m(a.formatted)}const O=g(ue,[["render",de]]),ce={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(e){this.searchTerm=e.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(e){return"/intervenant/code:"+e+"/voir"},reload(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(e=>{let t=e.data,s=[];for(const d in t){if(t[d].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){s.push(t[d]);continue}if(t[d].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){s.push(t[d]);continue}if(t[d].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){s.push(t[d]);continue}}this.intervenants=s,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(e=>{console.log(e.message)})},800)}}},me=i("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1),he={class:"intervenant-recherche"},_e={class:"critere"},ve=i("br",null,null,-1),fe=i("span",{class:"fw-bold"},"Types d'intervenant : ",-1),pe=i("br",null,null,-1),be={key:0,class:"table table-bordered table-hover"},ge=i("thead",null,[i("tr",null,[i("th",{style:{width:"90px"}}),i("th",null,"Civilité"),i("th",null,"Nom"),i("th",null,"Prenom"),i("th",null,"Structure"),i("th",null,"Statut"),i("th",null,"Date de naissance"),i("th",null,"N° Personnel")])],-1),ye=["title"],xe={style:{}},Se=["href"],Ve=i("i",{class:"fas fa-eye"},null,-1),ke={key:1,class:"table table-bordered table-hover"},Te=i("thead",null,[i("tr",null,[i("th",{style:{width:"90px"}}),i("th",null,"Civilité"),i("th",null,"Nom"),i("th",null,"Prenom"),i("th",null,"Structure"),i("th",null,"Statut"),i("th",null,"Date de naissance"),i("th",null,"N° Personnel")])],-1),Ce=i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"},colspan:"8"},"Aucun intervenant trouvé")])],-1),Me=[Te,Ce];function je(e,t,s,d,a,n){const u=O;return o(),l(p,null,[me,i("div",he,[i("div",_e,[i("div",null,[i("input",{id:"term",onKeyup:t[0]||(t[0]=(...r)=>n.rechercher&&n.rechercher(...r)),class:"form-control input",type:"text",placeholder:"votre recherche..."},null,32),ve]),i("div",null,[fe,C(i("input",{onChange:t[1]||(t[1]=r=>n.reload()),type:"checkbox",name:"type[]",value:"permanent",checked:"checked","onUpdate:modelValue":t[2]||(t[2]=r=>a.checkedTypes=r)},null,544),[[D,a.checkedTypes]]),f(" Permanent "),C(i("input",{onChange:t[3]||(t[3]=r=>n.reload()),type:"checkbox",name:"type[]",value:"vacataire",checked:"checked","onUpdate:modelValue":t[4]||(t[4]=r=>a.checkedTypes=r)},null,544),[[D,a.checkedTypes]]),f(" Vacataire "),C(i("input",{onChange:t[5]||(t[5]=r=>n.reload()),type:"checkbox",name:"type[]",value:"etudiant",checked:"checked","onUpdate:modelValue":t[6]||(t[6]=r=>a.checkedTypes=r)},null,544),[[D,a.checkedTypes]]),f(" Etudiant ")]),pe])]),a.intervenants.length>0?(o(),l("table",be,[ge,i("tbody",null,[(o(!0),l(p,null,y(a.intervenants,(r,c)=>(o(),l("tr",{class:j({"bg-danger":r.destruction!==null}),title:r.destruction!==null?"Fiche historisé":""},[i("td",xe,[i("a",{href:n.urlFiche(r.code)},[Ve,f(" Fiche")],8,Se)]),i("td",null,m(r.civilite),1),i("td",null,m(r.nom),1),i("td",null,m(r.prenom),1),i("td",null,m(r.structure),1),i("td",null,m(r.statut),1),i("td",null,[_(u,{value:r["date-naissance"]},null,8,["value"])]),i("td",null,m(r["numero-personnel"]),1)],10,ye))),256))])])):h("",!0),a.intervenants.length==0&&a.noResult==1?(o(),l("table",ke,Me)):h("",!0)],64)}const we=g(ce,[["render",je]]),Ue=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"})),De={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},Re=["id"],Ae={class:"modal-dialog"},Le={class:"modal-content"},Oe={class:"modal-header"},Ee={class:"modal-title"},He=i("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),$e={class:"modal-body"},qe={class:"modal-footer"},Pe=i("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1);function Fe(e,t,s,d,a,n){return o(),l("div",{class:"modal fade",id:s.id,tabindex:"-1","aria-hidden":"true"},[i("div",Ae,[i("div",Le,[i("div",Oe,[i("h5",Ee,m(s.title),1),He]),i("div",$e,[A(e.$slots,"body")]),i("div",qe,[A(e.$slots,"footer"),Pe])])])],8,Re)}const ze=g(De,[["render",Fe]]),Ie={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String}}};function Ne(e,t,s,d,a,n){return o(),l("i",{class:j(`fas fa-${s.name} text-${s.variant}`)},null,2)}const w=g(Ie,[["render",Ne]]);const Be={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(e){this.validationText=this.calcValidation(e)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":Util.formattedHeures(this.mission.heures)+" heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(e){return e===null?"A valider":e.id===null?"Autovalidée":"Validation du "+Util.dateToString(e.histoCreation)+" par "},saisie(e){modAjax(e.currentTarget,t=>{this.refresh()})},supprimer(e){popConfirm(e.currentTarget,t=>{this.$emit("supprimer",this.mission)})},valider(e){popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},devalider(e){popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireSupprimer(e){e.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireValider(e){e.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireDevalider(e){e.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refresh",t.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(e=>{this.$emit("refresh",e.data)})}}},S=e=>(F("data-v-84350c49"),e=e(),z(),e),Je=["id"],Ye={class:"card-header card-header-h3"},Xe={class:"float-end"},Ke={class:"card-body"},We={class:"row"},Ge={class:"col-md-8"},Qe={class:"row"},Ze={class:"col-md-12"},et=S(()=>i("label",{class:"form-label"},"Composante en charge du suivi",-1)),tt={class:"form-control"},st={class:"row"},it={class:"col-md-5"},nt=S(()=>i("label",{class:"form-label"},"Taux de rémunération",-1)),at={class:"form-control"},rt={class:"col-md-7"},ot=S(()=>i("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),lt={class:"input-group mb-3"},ut=["innerHTML"],dt=["data-bs-target"],ct={class:"row"},mt={class:"col-md-12"},ht=S(()=>i("label",{class:"form-label"},"Descriptif de la mission",-1)),_t={class:"form-control"},vt=S(()=>i("div",{class:"row"},[i("div",{class:"col-md-12"}," ")],-1)),ft={class:"row"},pt={class:"col-md-12"},bt=["href"],gt=["href"],yt=["href"],xt=["href"],St={class:"col-md-4"},Vt=S(()=>i("div",null,[i("label",{class:"form-label"},"Suivi")],-1)),kt={class:"table table-bordered table-condensed"},Tt=S(()=>i("thead",null,[i("tr",null,[i("th",null,"Heures"),i("th",null,"Statut"),i("th",null,"Actions")])],-1)),Ct={style:{"text-align":"right"}},Mt=S(()=>i("br",null,null,-1)),jt={key:0},wt=["data-id"],Ut=["data-id"],Dt=["data-id"];function Rt(e,t,s,d,a,n){const u=O,r=w,c=V("utilisateur"),x=V("u-heures"),P=ze;return o(),l(p,null,[i("div",{id:s.mission.id,class:j(["card",{"bg-success":s.mission.valide,"bg-default":!s.mission.valide}])},[i("form",{onSubmit:t[4]||(t[4]=b((...v)=>e.submitForm&&e.submitForm(...v),["prevent"]))},[i("div",Ye,[i("h5",null,[f(m(s.mission.typeMission.libelle)+" ",1),i("span",Xe,[f("Du "),_(u,{value:s.mission.dateDebut},null,8,["value"]),f(" au "),_(u,{value:s.mission.dateFin},null,8,["value"])])])]),i("div",Ke,[i("div",We,[i("div",Ge,[i("div",Qe,[i("div",Ze,[et,i("div",tt,m(s.mission.structure.libelle),1)])]),i("div",st,[i("div",it,[nt,i("div",at,m(s.mission.tauxRemu.libelle),1)]),i("div",rt,[ot,i("div",lt,[i("div",{class:"form-control",innerHTML:n.heuresLib},null,8,ut),i("button",{class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal","data-bs-target":`#details-${s.mission.id}`}," Détails ",8,dt)])])]),i("div",ct,[i("div",mt,[ht,i("div",_t,m(s.mission.description),1)])]),vt,i("div",ft,[i("div",pt,[s.mission.canSaisie?(o(),l("a",{key:0,href:a.saisieUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...v)=>n.saisie&&n.saisie(...v),["prevent"]))},"Modifier",8,bt)):h("",!0),s.mission.canValider?(o(),l("a",{key:1,href:a.validerUrl,class:"btn btn-secondary","data-title":"Validation de la mission","data-content":"Êtes-vous sur de vouloir valider la mission ?",onClick:t[1]||(t[1]=b((...v)=>n.valider&&n.valider(...v),["prevent"]))},"Valider",8,gt)):h("",!0),s.mission.canDevalider?(o(),l("a",{key:2,href:a.devaliderUrl,class:"btn btn-danger","data-title":"Dévalidation de la mission","data-content":"Êtes-vous sur de vouloir dévalider la mission ?",onClick:t[2]||(t[2]=b((...v)=>n.devalider&&n.devalider(...v),["prevent"]))},"Dévalider",8,yt)):h("",!0),s.mission.canSupprimer?(o(),l("a",{key:3,href:a.supprimerUrl,class:"btn btn-danger","data-title":"Suppression de la mission","data-content":"Êtes-vous sur de vouloir supprimer la mission ?",onClick:t[3]||(t[3]=b((...v)=>n.supprimer&&n.supprimer(...v),["prevent"]))},"Supprimer",8,xt)):h("",!0)])])]),i("div",St,[Vt,i("div",null,[_(r,{name:"thumbs-up",variant:"success"}),f(" Créé le "),_(u,{value:s.mission.histoCreation},null,8,["value"]),f(" par "),_(c,{nom:s.mission.histoCreateur.displayName,mail:s.mission.histoCreateur.email},null,8,["nom","mail"])]),i("div",null,[_(r,{name:s.mission.valide?"thumbs-up":"thumbs-down",variant:s.mission.valide?"success":"info"},null,8,["name","variant"]),f(" "+m(a.validationText)+" ",1),s.mission.validation&&s.mission.validation.histoCreateur?(o(),k(c,{key:0,nom:s.mission.validation.histoCreateur.displayName,mail:s.mission.validation.histoCreateur.email},null,8,["nom","mail"])):h("",!0)]),i("div",null,[_(r,{name:s.mission.contrat?"thumbs-up":"thumbs-down",variant:s.mission.contrat?"success":"info"},null,8,["name","variant"]),f(" "+m(s.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),i("div",null,m(s.mission.heuresRealisees)+" heure"+m(s.mission.heuresRealisees<2?"":"s")+" réalisée"+m(s.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,Je),_(P,{id:`details-${s.mission.id}`,title:"Détail des heures prévisionnelles"},{body:M(()=>[i("table",kt,[Tt,i("tbody",null,[(o(!0),l(p,null,y(s.mission.volumesHorairesPrevus,v=>(o(),l("tr",{key:v.id},[i("td",Ct,[_(x,{valeur:v.heures},null,8,["valeur"])]),i("td",null,[_(r,{name:"thumbs-up",variant:"success"}),f(" Saisi par "),_(c,{nom:v.histoCreateur.displayName,mail:v.histoCreateur.email},null,8,["nom","mail"]),f(" le "),_(u,{value:v.histoCreation},null,8,["value"]),Mt,_(r,{name:v.valide?"thumbs-up":"thumbs-down",variant:v.valide?"success":"info"},null,8,["name","variant"]),f(" "+m(v.validation&&v.validation.id==null?"Autovalidé":v.validation?"":"à valider")+" ",1),v.validation&&v.validation.histoCreateur?(o(),l("span",jt,[f(" Validé par "),_(c,{nom:v.validation.histoCreateur.displayName,mail:v.validation.histoCreateur.email},null,8,["nom","mail"]),f(" le "),_(u,{value:v.validation.histoCreation},null,8,["value"])])):h("",!0)]),i("td",null,[v.canValider?(o(),l("a",{key:0,class:"btn btn-secondary","data-id":v.id,"data-title":"Validation du volume horaire","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?",onClick:t[5]||(t[5]=b((...T)=>n.volumeHoraireValider&&n.volumeHoraireValider(...T),["prevent"]))},"Valider",8,wt)):h("",!0),v.canDevalider?(o(),l("a",{key:1,class:"btn btn-danger","data-id":v.id,"data-title":"Dévalidation du volume horaire","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?",onClick:t[6]||(t[6]=b((...T)=>n.volumeHoraireDevalider&&n.volumeHoraireDevalider(...T),["prevent"]))},"Dévalider",8,Ut)):h("",!0),v.canSupprimer?(o(),l("a",{key:2,class:"btn btn-danger","data-id":v.id,"data-title":"Suppression du volume horaire","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?",onClick:t[7]||(t[7]=b((...T)=>n.volumeHoraireSupprimer&&n.volumeHoraireSupprimer(...T),["prevent"]))},"Supprimer",8,Dt)):h("",!0)])]))),128))])])]),footer:M(()=>[]),_:1},8,["id"])],64)}const E=g(Be,[["render",Rt],["__scopeId","data-v-84350c49"]]),At=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),Lt={components:{mission:E},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(e){modAjax(e.currentTarget,t=>{this.reload()})},supprimer(e){this.reload()},refresh(e){console.log(e);let t=Util.json.indexById(this.missions,e.id);this.missions[t]=e},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(e=>{this.missions=e.data})}}},Ot=["href"];function Et(e,t,s,d,a,n){const u=V("mission");return o(),l(p,null,[(o(!0),l(p,null,y(a.missions,r=>(o(),k(u,{onSupprimer:n.supprimer,onRefresh:n.refresh,key:r.id,mission:r},null,8,["onSupprimer","onRefresh","mission"]))),128)),s.canAddMission?(o(),l("a",{key:0,class:"btn btn-primary",href:a.ajoutUrl,onClick:t[0]||(t[0]=b((...r)=>n.ajout&&n.ajout(...r),["prevent"]))},"Ajout d'une nouvelle mission",8,Ot)):h("",!0)],64)}const Ht=g(Lt,[["render",Et]]),$t=Object.freeze(Object.defineProperty({__proto__:null,default:Ht},Symbol.toStringTag,{value:"Module"}));const qt={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0}},data(){const e=new Date(this.date);return{mois:e.getMonth()+1,annee:e.getFullYear()}},computed:{listeJours(){const e=new Date(this.date);e.setDate(1),e.setMonth(e.getMonth()+1),e.setDate(e.getDate()-1);let t=e.getDate();return Array.from({length:t},(s,d)=>d+1)}},watch:{date:function(e,t){const s=new Date(this.date);this.mois=s.getMonth()+1,this.annee=s.getFullYear()},mois:function(e,t){const s=new Date(this.date);s.setMonth(e-1),this.$emit("changeDate",s)},annee:function(e,t){const s=new Date(this.date);s.setFullYear(e),this.$emit("changeDate",s)}},methods:{nomJour(e){const t=new Date(this.date);return t.setDate(e),t.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let e=[];const t=new Date;for(let s=1;s<=12;s++){t.setMonth(s-1);let d=t.toLocaleString("fr-FR",{month:"long"});e.push({id:s,libelle:d})}return e},listeAnnees(){const t=new Date().getFullYear(),s=1;let d=[];for(let a=t-s;a<=t+s;a++)d.push(a);return d},addEvent(e){const t=new Date(this.date);t.setDate(e.currentTarget.dataset.jour),this.$emit("addEvent",t,e)},prevMois(){const e=new Date(this.date);e.setMonth(e.getMonth()-1),this.$emit("changeDate",e)},nextMois(){const e=new Date(this.date);e.setMonth(e.getMonth()+1),this.$emit("changeDate",e)},eventsByJour(e){const t=new Date(this.date);let s={};for(let d in this.events){let a=this.events[d];a.date.getFullYear()===t.getFullYear()&&a.date.getMonth()+1===t.getMonth()+1&&a.date.getDate()===e&&(s[d]=a)}return s}}},Pt={class:"calendar"},Ft={class:"recherche"},zt={class:"recherche btn-group"},It=["value"],Nt=["value"],Bt={class:"table table-bordered table-hover table-sm"},Jt=["data-jour"],Yt={class:"nom-jour"},Xt={class:"numero-jour"},Kt={class:"num-jour badge bg-secondary rounded-circle"},Wt={key:0},Gt=["data-jour"];function Qt(e,t,s,d,a,n){const u=w;return o(),l("div",Pt,[i("div",Ft,[i("div",zt,[i("button",{class:"btn btn-light",id:"prevMois",onClick:t[0]||(t[0]=(...r)=>n.prevMois&&n.prevMois(...r)),title:"Mois précédant"},[_(u,{name:"chevron-left"})]),C(i("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":t[1]||(t[1]=r=>a.mois=r)},[(o(!0),l(p,null,y(n.listeMois(),r=>(o(),l("option",{value:r.id},m(r.libelle),9,It))),256))],512),[[L,a.mois]]),C(i("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":t[2]||(t[2]=r=>a.annee=r)},[(o(!0),l(p,null,y(n.listeAnnees(),r=>(o(),l("option",{value:r},m(r),9,Nt))),256))],512),[[L,a.annee]]),i("button",{class:"btn btn-light",id:"nextMois",onClick:t[3]||(t[3]=(...r)=>n.nextMois&&n.nextMois(...r)),title:"Mois suivant"},[_(u,{name:"chevron-right"})])])]),i("table",Bt,[(o(!0),l(p,null,y(n.listeJours,r=>(o(),l("tr",{"data-jour":r},[i("th",Yt,m(n.nomJour(r)),1),i("th",Xt,[i("div",Kt,m(r<10?"0"+r.toString():r),1)]),i("td",null,[(o(!0),l(p,null,y(n.eventsByJour(r),(c,x)=>(o(),l("div",{class:"event",style:I("border-color:"+c.color+";background-color:"+c.bgcolor),key:x},[(o(),k(N(c.component),{event:c},null,8,["event"]))],4))),128)),s.canAddEvent?(o(),l("div",Wt,[i("button",{onClick:t[4]||(t[4]=(...c)=>n.addEvent&&n.addEvent(...c)),"data-jour":r,class:"btn btn-light btn-sm"},[_(u,{name:"plus"}),f(" Nouvel événement ")],8,Gt)])):h("",!0)])],8,Jt))),256))])])}const Zt=g(qt,[["render",Qt],["__scopeId","data-v-2f97b448"]]);const es={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(e){modAjax(e.currentTarget,t=>{this.suivi.refresh()})},supprimer(e){popConfirm(e.currentTarget,t=>{this.suivi.refresh()})},valider(e){unicaenVue.axios.get(this.validerUrl).then(t=>{this.suivi.refresh()})},devalider(e){popConfirm(e.currentTarget,t=>{this.suivi.refresh()})}}},ts={class:"event-content"},ss={class:"mission"},is={key:0,class:"badge bg-success"},as={class:"horaires"},rs={key:0,class:"badge bg-secondary"},os={key:1,class:"badge bg-secondary"},ls={key:0,class:"description"},us={class:"event-actions"},ds={class:"btn-group btn-group-sm"},cs=["data-url"],ms=["data-url"],hs=["data-url"],_s=["data-url"];function vs(e,t,s,d,a,n){const u=w;return o(),l(p,null,[i("div",ts,[i("p",ss,[f(m(s.event.mission.libelleCourt)+" ",1),s.event.valide?(o(),l("span",is,"Validé")):h("",!0)]),i("p",as,[f(" de "+m(n.heureDebut)+" à "+m(n.heureFin)+", soi"+m(n.heures<2?"":"en")+"t "+m(n.heures)+" heure"+m(n.heures<2?"":"s")+" ",1),s.event.nocturne?(o(),l("span",rs,"Nocturne")):h("",!0),s.event.formation?(o(),l("span",os,"En formation")):h("",!0)]),s.event.description?(o(),l("p",ls,m(s.event.description),1)):h("",!0)]),i("div",us,[i("div",ds,[s.event.canEdit?(o(),l("button",{key:0,class:"btn btn-light",onClick:t[0]||(t[0]=(...r)=>n.modifier&&n.modifier(...r)),title:"Modifier le suivi","data-url":a.modifierUrl},[_(u,{name:"pen-to-square"})],8,cs)):h("",!0),s.event.canValider?(o(),l("button",{key:1,class:"btn btn-light",onClick:t[1]||(t[1]=(...r)=>n.valider&&n.valider(...r)),title:"Valider le suivi","data-url":a.validerUrl},[_(u,{name:"check",class:"text-success"})],8,ms)):h("",!0),s.event.canDevalider?(o(),l("button",{key:2,class:"btn btn-light",onClick:t[2]||(t[2]=(...r)=>n.devalider&&n.devalider(...r)),title:"Dévalider le suivi","data-url":a.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[_(u,{name:"xmark",class:"text-danger"})],8,hs)):h("",!0),s.event.canSupprimer?(o(),l("button",{key:3,class:"btn btn-light",onClick:t[3]||(t[3]=(...r)=>n.supprimer&&n.supprimer(...r)),title:"Supprimer le suivi","data-url":a.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[_(u,{name:"trash-can",class:"text-danger"})],8,_s)):h("",!0)])])],64)}const H=g(es,[["render",vs],["__scopeId","data-v-7b625510"]]),fs=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"})),ps={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,suivi:[]}},methods:{changeDate(e){this.date=e},ajouter(e,t){const s={intervenant:this.intervenant,date:e.toISOString().slice(0,10)};t.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",s),modAjax(t.currentTarget,d=>{this.refresh()})},refresh(){const e=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let t=0,s=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(d=>{let a=[];for(let n in d.data){let u=d.data[n];s[u.mission.id]===void 0&&(s[u.mission.id]=e[t],t++),u.valide&&(u.bgcolor="#d0eddb"),u.color=s[u.mission.id],u.component=B(H),u.date=new Date(u.date),u.intervenant=this.intervenant,a.push(u)}this.suivi=a})}}};function bs(e,t,s,d,a,n){const u=Zt;return o(),k(u,{date:a.date,onChangeDate:n.changeDate,onAddEvent:n.ajouter,"can-add-event":s.canAddMission,events:a.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const gs=g(ps,[["render",bs]]),ys=Object.freeze(Object.defineProperty({__proto__:null,default:gs},Symbol.toStringTag,{value:"Module"})),xs={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(e){modAjax(e.target,t=>{this.$emit("refreshListe")})},ajoutValeur(e){modAjax(e.target,t=>{this.$emit("refreshListe")})},saisieValeur(e){e.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:e.currentTarget.dataset.id}),modAjax(e.currentTarget,t=>{this.$emit("refreshListe")})},refreshListe(e){this.$emit("refreshListe")},supprimer(e){popConfirm(e.target,t=>{this.$emit("refreshListe")})},supprimerValeur(e){e.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:e.currentTarget.dataset.id}),popConfirm(e.currentTarget,t=>{this.$emit("refreshListe")})},refresh(e){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:e.id})).then(t=>{this.$emit("refresh",t.data)})}}},Ss={class:"card-header"},Vs={style:{display:"inline"}},ks={class:"float-end"},Ts=["href"],Cs=["href"],Ms={class:"card-body"},js={key:0},ws=i("br",null,null,-1),Us={class:""},Ds={class:"row align-items-start"},Rs={class:"col-md-4"},As={class:"col"},Ls=["data-id"],Os=["data-id"],Es=["href"],Hs={key:1,class:"row"},$s={class:"col-md-7"},qs=i("br",null,null,-1),Ps={class:"row align-items-start"},Fs={class:"col-md-8"},zs={class:"col-md-auto"},Is=["data-id"],Ns=["data-id"],Bs=["href"],Js={class:"col"},Ys=i("br",null,null,-1),Xs={key:0},Ks={key:0};function Ws(e,t,s,d,a,n){const u=w,r=V("taux",!0);return o(),l(p,null,[i("div",{class:j(["card",{"ms-5":s.taux.tauxRemu}])},[i("div",Ss,[i("h3",Vs,m(s.taux.libelle)+" ("+m(s.taux.code)+")",1),i("div",ks,[s.taux.canEdit?(o(),l("a",{key:0,href:a.saisieUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...c)=>n.saisie&&n.saisie(...c),["prevent"]))},[_(u,{name:"pen-to-square"}),f(" Modifier")],8,Ts)):h("",!0),f("   "),s.taux.canDelete?(o(),l("a",{key:1,href:a.supprimerUrl,class:"btn btn-danger",onClick:t[1]||(t[1]=b((...c)=>n.supprimer&&n.supprimer(...c),["prevent"]))},[_(u,{name:"trash-can"}),f(" Supprimer")],8,Cs)):h("",!0)])]),i("div",Ms,[s.taux.tauxRemu?h("",!0):(o(),l("div",js,[f(" Modification :"),ws,i("ul",null,[(o(!0),l(p,null,y(s.taux.tauxRemuValeurs,c=>(o(),l("div",{key:c.id},[i("li",Us,[i("div",Ds,[i("div",Rs,m(c.valeur)+"€/h à partir du "+m(c.dateEffet),1),i("div",As,[s.taux.canEdit?(o(),l("a",{key:0,class:"text-primary",onClick:t[2]||(t[2]=b((...x)=>n.saisieValeur&&n.saisieValeur(...x),["prevent"])),"data-id":c.id},[_(u,{name:"pen-to-square"})],8,Ls)):h("",!0),f("   "),s.taux.canEdit?(o(),l("a",{key:1,class:"text-primary",onClick:t[3]||(t[3]=b((...x)=>n.supprimerValeur&&n.supprimerValeur(...x),["prevent"])),"data-id":c.id},[_(u,{name:"trash-can"})],8,Os)):h("",!0)])])])]))),128))]),s.taux.canEdit?(o(),l("a",{key:0,href:a.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:t[4]||(t[4]=b((...c)=>n.ajoutValeur&&n.ajoutValeur(...c),["prevent"]))},[_(u,{name:"plus"}),f(" Ajouter une valeur ")],8,Es)):h("",!0)])),s.taux.tauxRemu?(o(),l("div",Hs,[i("div",$s,[f(" Modification :"),qs,i("ul",null,[(o(!0),l(p,null,y(s.taux.tauxRemuValeurs,c=>(o(),l("div",null,[i("li",null,[i("div",Ps,[i("div",Fs," Coéfficient de "+m(c.valeur)+" à partir du "+m(c.dateEffet),1),i("div",zs,[s.taux.canEdit?(o(),l("a",{key:0,class:"text-primary",onClick:t[5]||(t[5]=b((...x)=>n.saisieValeur&&n.saisieValeur(...x),["prevent"])),"data-id":c.id},[_(u,{name:"pen-to-square"})],8,Is)):h("",!0),f("   "),s.taux.canEdit?(o(),l("a",{key:1,class:"text-primary",onClick:t[6]||(t[6]=b((...x)=>n.supprimerValeur&&n.supprimerValeur(...x),["prevent"])),"data-id":c.id},[_(u,{name:"trash-can"})],8,Ns)):h("",!0)])])])]))),256))]),s.taux.canEdit?(o(),l("a",{key:0,href:a.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:t[7]||(t[7]=b((...c)=>n.ajoutValeur&&n.ajoutValeur(...c),["prevent"]))},[_(u,{name:"plus"})],8,Bs)):h("",!0)]),i("div",Js,[f(" Valeurs calculées (indexées sur le taux "+m(s.taux.tauxRemu.libelle)+") : ",1),i("ul",null,[(o(!0),l(p,null,y(s.taux.tauxRemuValeursIndex,c=>(o(),l("div",null,[i("li",null,m(c.valeur)+"€/h à partir du "+m(c.date),1)]))),256))]),Ys])])):h("",!0)])],2),s.taux.tauxRemu?h("",!0):(o(),l("div",Xs,[(o(!0),l(p,null,y(s.listeTaux,c=>(o(),l("div",{key:c},[c.tauxRemu&&c.tauxRemu.id===s.taux.id?(o(),l("div",Ks,[(o(),k(r,{onSupprimer:n.supprimer,onRefreshListe:n.refreshListe,key:s.taux.id,taux:c,listeTaux:s.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):h("",!0)]))),128))]))],64)}const $=g(xs,[["render",Ws]]),Gs=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"})),Qs={components:{taux:$},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(e){modAjax(e.currentTarget,t=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(e){let t=Util.json.indexById(this.listeTaux,e.id);this.listeTaux[t]=e},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(e=>{this.listeTaux=e.data})}}},Zs=["href"];function ei(e,t,s,d,a,n){const u=V("taux");return o(),l(p,null,[(o(!0),l(p,null,y(a.listeTaux,r=>(o(),l("div",null,[r.tauxRemu?h("",!0):(o(),k(u,{onSupprimer:n.supprimer,onRefreshListe:n.refreshListe,key:r.id,taux:r,listeTaux:a.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),s.canEditTaux?(o(),l("a",{key:0,class:"btn btn-primary",href:a.ajoutUrl,onClick:t[0]||(t[0]=b((...r)=>n.ajout&&n.ajout(...r),["prevent"]))},"Ajout d'un nouveau taux",8,Zs)):h("",!0)],64)}const ti=g(Qs,[["render",ei]]),si=Object.freeze(Object.defineProperty({__proto__:null,default:ti},Symbol.toStringTag,{value:"Module"})),ii={UHeures:"Application/UI/UHeures",Utilisateur:"Application/Utilisateur"};function ni(e){for(let t in e)for(let s in e[t])q(e[t][s],t)}function q(e,t){const s={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},d={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"};let a=document.getElementById("unicaen-vue-toast-container");a||(a=document.createElement("div"),a.id="unicaen-vue-toast-container",a.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(a));const n=document.createElement("div");n.classList.add("toast","show","text-white",s[t]?s[t]:"bg-secondary"),n.setAttribute("role","alert"),n.setAttribute("aria-live","assertive"),n.setAttribute("aria-atomic","true"),t==="error"&&e.length>500&&n.setAttribute("style","width:700px");const u='<button class="btn-close btn-close-white h5" style="float:right" data-bs-dismiss="toast" aria-label="Close"></button><i class="icon fas fa-'+d[t]+'" style="float: left;font-size: 26pt;padding-left: .4rem;margin-top:.4rem;padding-right: 1rem;"></i><div class="toast-body">'+e+"  </div>";n.innerHTML=u,a.appendChild(n),t!=="error"&&setTimeout(()=>{n.classList.remove("show")},5e3)}const R={toast:q,toasts:ni},U={axios:J,flashMessenger:R,url:(e,t,s)=>{let d=window.__unicaenVueBaseUrl;if(t)for(let n in t)e=e.replace(`:${n}`,t[n]);let a=s?new URLSearchParams(s).toString():null;return d+e+(a?`?${a}`:"")}};U.axios.interceptors.request.use(e=>{if(e.submitter){let t=e.msg?e.msg:"Action en cours";e.popover!=null&&e.popover.dispose(),e.popover=new bootstrap.Popover(e.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+t,html:!0,trigger:"focus"}),e.popover.show()}return e});U.axios.interceptors.response.use(e=>{if(e.messages=e.data.messages,e.data=e.data.data,e.hasErrors=!!(e.messages&&e.messages.error&&e.messages.error.length>0),e.config.popover){var t=e.config.popover;let s="";for(ns in e.messages)for(mid in e.messages[ns])s+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+e.messages[ns][mid]+"</div>";s?(t._config.content=s,t.setContent(),setTimeout(()=>{t.dispose()},3e3)):t.dispose()}return e.messages&&R.toasts(e.messages),e},e=>{let t=e.response.data;if(e.response.status==403)t="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.";else if(e.response.status==500){const s=document.createElement("div");s.innerHTML=e.response.data,s.querySelectorAll("i.fas").forEach(a=>a.style.display="none"),t=s.querySelector(".alert").innerHTML,t===void 0&&(t=e.response.data)}else t=e.response.data;R.toast(t,"error")});U.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";window.unicaenVue=U;function ai(e,t){const s={};t===void 0&&(t={});for(const d in e){let n=d.slice(2,-4).replace("/","");s[n]=e[d].default}for(const d of document.getElementsByClassName("vue-app")){let a=Y({template:d.innerHTML,components:s});if(t.beforeMount!==void 0&&t.beforeMount(a),t.autoloads!==void 0)for(const n in t.autoloads){let u=t.autoloads[n].replace("/","");a.component(n,s[u])}a.mount(d),t.afterMount!==void 0&&t.afterMount(a)}}const ri={init:ai},oi=Object.assign({"./Application/UI/UHeures.vue":Q,"./Application/Utilisateur.vue":ie,"./Exemple/MonTest.vue":le,"./Intervenant/Recherche.vue":Ue,"./Mission/Liste.vue":$t,"./Mission/Mission.vue":At,"./Mission/Suivi.vue":ys,"./Mission/SuiviEvent.vue":fs,"./Paiement/ListeTaux.vue":si,"./Paiement/Taux.vue":Gs}),li={autoloads:ii};ri.init(oi,li);
