import{c as a,o as n,t as m,a as e,w as T,v as w,b as c,F as v,r as y,d as u,n as D,e as f,f as b,g as E,h as C,p as H,i as O,j as L,k as q,l as U,m as W,q as Q,s as X,u as Z,x as K,y as ee}from"./vendor-2e5f87a4.js";const x=(s,t)=>{const r=s.__vccOpts||s;for(const[h,l]of t)r[h]=l;return r},te={props:{valeur:{required:!0,type:Number}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},se=["innerHTML"];function re(s,t,r,h,l,i){return n(),a("span",{class:"heures",innerHTML:i.affichage},null,8,se)}const ie=x(te,[["render",re]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),ae={name:"Utilisateur",props:{nom:String,mail:String}},oe=["href"];function le(s,t,r,h,l,i){return n(),a("a",{href:`mailto:${r.mail}`},m(r.nom),9,oe)}const de=x(ae,[["render",le]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"})),ce={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(s){this.formatted=this.formatage(s)}},methods:{formatage(s){if(s===void 0)return;let t=new Date(s);const r=t.getFullYear(),h=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),i=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),d=t.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${l}/${h}/${r} à ${i}:${o}`;case"time":return`${i}:${o}:${d}`}return`${l}/${h}/${r}`}}};function me(s,t,r,h,l,i){return m(l.formatted)}const M=x(ce,[["render",me]]),he={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(s){this.searchTerm=s.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(s){return unicaenVue.url("intervenant/code:"+s+"/voir")},reload(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(s=>{let t=s.data,r=[];for(const h in t){if(t[h].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){r.push(t[h]);continue}if(t[h].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){r.push(t[h]);continue}if(t[h].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){r.push(t[h]);continue}}this.intervenants=r,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(s=>{console.log(s.message)})},800)}}},_e=e("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1),fe={class:"intervenant-recherche"},pe={class:"critere"},ve=e("br",null,null,-1),be=e("span",{class:"fw-bold"},"Types d'intervenant : ",-1),ge=e("br",null,null,-1),ye={key:0,class:"table table-bordered table-hover"},xe=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),ke=["title"],Ce={style:{}},Ve=["href"],Ee=e("i",{class:"fas fa-eye"},null,-1),De={key:1,class:"table table-bordered table-hover"},Pe=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),Te=e("tbody",null,[e("tr",null,[e("td",{colspan:"8",style:{"text-align":"center"}},"Aucun intervenant trouvé")])],-1),Se=[Pe,Te];function Me(s,t,r,h,l,i){const o=M;return n(),a(v,null,[_e,e("div",fe,[e("div",pe,[e("div",null,[e("input",{id:"term",autofocus:"",class:"form-control input",placeholder:"votre recherche...",type:"text",onKeyup:t[0]||(t[0]=(...d)=>i.rechercher&&i.rechercher(...d))},null,32),ve]),e("div",null,[be,T(e("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"permanent",onChange:t[2]||(t[2]=d=>i.reload())},null,544),[[w,l.checkedTypes]]),c(" Permanent "),T(e("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"vacataire",onChange:t[4]||(t[4]=d=>i.reload())},null,544),[[w,l.checkedTypes]]),c(" Vacataire "),T(e("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"etudiant",onChange:t[6]||(t[6]=d=>i.reload())},null,544),[[w,l.checkedTypes]]),c(" Etudiant ")]),ge])]),l.intervenants.length>0?(n(),a("table",ye,[xe,e("tbody",null,[(n(!0),a(v,null,y(l.intervenants,(d,_)=>(n(),a("tr",{class:D({"bg-danger":d.destruction!==null}),title:d.destruction!==null?"Fiche historisé":""},[e("td",Ce,[e("a",{href:i.urlFiche(d.code)},[Ee,c(" Fiche")],8,Ve)]),e("td",null,m(d.civilite),1),e("td",null,m(d.nom),1),e("td",null,m(d.prenom),1),e("td",null,m(d.structure),1),e("td",null,m(d.statut),1),e("td",null,[f(o,{value:d["date-naissance"]},null,8,["value"])]),e("td",null,m(d["numero-personnel"]),1)],10,ke))),256))])])):u("",!0),l.intervenants.length==0&&l.noResult==1?(n(),a("table",De,Se)):u("",!0)],64)}const Re=x(he,[["render",Me]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"}));const je={name:"Structure",props:{structure:{required:!0}},data(){return{saisieUrl:unicaenVue.url("structure/voir/:structure",{structure:this.structure.id})+"?tab=edition",deleteUrl:unicaenVue.url("structure/delete/:structure",{structure:this.structure.id}),liste:this.$parent.liste}},computed:{hasSousStructures:function(){return this.structure.structures.length>0}},methods:{saisie(s){modAjax(s.currentTarget,t=>{this.refresh()})},supprimer(s){popConfirm(s.currentTarget,t=>{this.refresh()})},refresh(){this.liste.reload()}}},P=s=>(H("data-v-a94dbf9e"),s=s(),O(),s),Ue={class:"accordion-item"},Ae={class:"accordion-header"},$e=["data-bs-target","aria-controls"],Ie=["href"],Le=P(()=>e("i",{class:"fas fa-pen-to-square"},null,-1)),qe=[Le],He=["href"],Oe=P(()=>e("i",{class:"fas fa-trash-can"},null,-1)),Fe=[Oe],Be=["id"],Ne={class:"accordion-body"},ze={class:"row"},Ge=P(()=>e("div",{class:"col-md-5"},[e("strong",null,"Code"),c(" : ")],-1)),Ye={class:"col-md-5"},Je={class:"row"},We=P(()=>e("div",{class:"col-md-5"},[e("strong",null,"Source"),c(" : ")],-1)),Qe={class:"col-md-5"},Xe={class:"row"},Ze=P(()=>e("div",{class:"col-md-5"},[e("strong",null,"Composante d'enseignement"),c(" : ")],-1)),Ke={class:"col-md-5"},et={key:0,class:"fas fa-check text-success"},tt={key:1,class:"fas fa-xmark text-danger"},st={class:"row"},rt=P(()=>e("div",{class:"col-md-5"},[e("strong",null,"Affichage de l'adresse sur le contrat de travail"),c(" : ")],-1)),it={class:"col-md-5"},nt={key:0,class:"fas fa-check text-success"},at={key:1,class:"fas fa-xmark text-danger"},ot={class:"row"},lt=P(()=>e("div",{class:"col-md-5"},[e("strong",null,"Adresse"),c(" : ")],-1)),dt={class:"col-md-5"},ut={key:0,class:"sous-structures"},ct=P(()=>e("h4",null,"Sous-structures",-1)),mt={class:"accordion"};function ht(s,t,r,h,l,i){const o=E("structure",!0);return n(),a("div",Ue,[e("h2",Ae,[e("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":`#str${r.structure.id}`,"aria-expanded":"true","aria-controls":r.structure.id},[r.structure.canEdit?(n(),a("a",{key:0,title:"Modifier la structure",href:l.saisieUrl,class:"btn btn-primary btn-sm",onClick:t[0]||(t[0]=b((...d)=>i.saisie&&i.saisie(...d),["prevent"]))},qe,8,Ie)):u("",!0),r.structure.canDelete?(n(),a("a",{key:1,title:"Supprimer la structure",href:l.deleteUrl,class:"btn btn-danger btn-sm","data-content":"Êtes-vous sûr de vouloir supprimer la structure ?","data-title":"Suppression de la structure",onClick:t[1]||(t[1]=b((...d)=>i.supprimer&&i.supprimer(...d),["prevent"]))},Fe,8,He)):u("",!0),c("   "+m(r.structure.libelleLong)+" ("+m(r.structure.libelleCourt)+") ",1)],8,$e)]),e("div",{id:`str${r.structure.id}`,class:"accordion-collapse collapse show"},[e("div",Ne,[e("div",ze,[Ge,e("div",Ye,m(r.structure.code),1)]),e("div",Je,[We,e("div",Qe,m(r.structure.source.libelle),1)]),e("div",Xe,[Ze,e("div",Ke,[r.structure.enseignement?(n(),a("i",et)):r.structure.enseignement?u("",!0):(n(),a("i",tt))])]),e("div",st,[rt,e("div",it,[r.structure.affAdresseContrat?(n(),a("i",nt)):r.structure.affAdresseContrat?u("",!0):(n(),a("i",at))])]),e("div",ot,[lt,e("div",dt,[e("pre",null,m(r.structure.adresse),1)])]),i.hasSousStructures?(n(),a("div",ut,[ct,e("div",mt,[(n(!0),a(v,null,y(r.structure.structures,d=>(n(),C(o,{onRefresh:i.refresh,key:d.id,structure:d},null,8,["onRefresh","structure"]))),128))])])):u("",!0)])],8,Be)])}const F=x(je,[["render",ht],["__scopeId","data-v-a94dbf9e"]]),_t=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"})),ft={components:{structure:F},props:{canAdd:{type:Boolean,required:!0}},data(){return{structures:[],ajoutUrl:unicaenVue.url("structure/saisie"),liste:this}},mounted(){this.reload()},methods:{ajout(s){modAjax(s.currentTarget,t=>{console.log("coucou"),this.reload()})},reload(){unicaenVue.axios.get(unicaenVue.url("structure/liste")).then(s=>{this.structures=s.data})}}},pt=e("h1",null,"Administration des structures",-1),vt={class:"accordion"},bt=["href"],gt=e("i",{class:"fas fa-pen-to-square"},null,-1);function yt(s,t,r,h,l,i){const o=E("structure");return n(),a(v,null,[pt,e("div",vt,[(n(!0),a(v,null,y(l.structures,d=>(n(),C(o,{key:d.id,structure:d},null,8,["structure"]))),128))]),r.canAdd?(n(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:t[0]||(t[0]=b((...d)=>i.ajout&&i.ajout(...d),["prevent"])),title:"Ajouter une structure"},[gt,c(" Ajouter une structure ")],8,bt)):u("",!0)],64)}const xt=x(ft,[["render",yt]]),kt=Object.freeze(Object.defineProperty({__proto__:null,default:xt},Symbol.toStringTag,{value:"Module"})),Ct={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},Vt=["id"],Et={class:"modal-dialog"},Dt={class:"modal-content"},Pt={class:"modal-header"},Tt={class:"modal-title"},St=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Mt={class:"modal-body"},Rt={class:"modal-footer"},wt=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1);function jt(s,t,r,h,l,i){return n(),a("div",{class:"modal fade",id:r.id,tabindex:"-1","aria-hidden":"true"},[e("div",Et,[e("div",Dt,[e("div",Pt,[e("h5",Tt,m(r.title),1),St]),e("div",Mt,[L(s.$slots,"body")]),e("div",Rt,[L(s.$slots,"footer"),wt])])])],8,Vt)}const Ut=x(Ct,[["render",jt]]),At={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String}}};function $t(s,t,r,h,l,i){return n(),a("i",{class:D(`fas fa-${r.name} text-${r.variant}`)},null,2)}const S=x(At,[["render",$t]]);const It={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(s){this.validationText=this.calcValidation(s)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":'<span class="bg-info">'+Util.formattedHeures(this.mission.heures)+"</span> heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(s){return s===null?"A valider":s.id===null?"Autovalidée":"Validation du "+Util.dateToString(s.histoCreation)+" par "},saisie(s){modAjax(s.currentTarget,t=>{this.refresh()})},supprimer(s){popConfirm(s.currentTarget,t=>{this.$emit("supprimer",this.mission)})},valider(s){popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},devalider(s){popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireSupprimer(s){s.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:s.currentTarget.dataset.id}),popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireValider(s){s.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:s.currentTarget.dataset.id}),popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},volumeHoraireDevalider(s){s.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:s.currentTarget.dataset.id}),popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(s=>{this.$emit("refresh",s.data)})}}},V=s=>(H("data-v-1735108d"),s=s(),O(),s),Lt=["id"],qt={class:"card-header card-header-h3"},Ht={key:0},Ot={class:"float-end"},Ft={key:1},Bt={key:2},Nt={class:"float-end"},zt={class:"card-body"},Gt={class:"row"},Yt={class:"col-md-8"},Jt={class:"row"},Wt={class:"col-md-12"},Qt=V(()=>e("label",{class:"form-label"},"Composante en charge du suivi",-1)),Xt={class:"form-control"},Zt={class:"row"},Kt={class:"col-md-6"},es=V(()=>e("label",{class:"form-label"},"Taux de rémunération",-1)),ts={class:"form-control"},ss={class:"col-md-6"},rs=V(()=>e("label",{class:"form-label"},"Taux majoré (dimanches/jours fériés)",-1)),is={class:"form-control"},as={class:"col-md-7"},os=V(()=>e("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),ls={class:"input-group mb-3"},ds=["innerHTML"],us=["data-bs-target"],cs={key:0,class:"col-md-5"},ms=V(()=>e("label",{class:"form-label"},"Heures de formation prévues",-1)),hs={class:"form-control"},_s={class:"row"},fs={class:"col-md-12"},ps=V(()=>e("label",{class:"form-label"},"Descriptif de la mission",-1)),vs={class:"form-control"},bs={key:0,class:"row"},gs={class:"col-md-12"},ys=V(()=>e("label",{class:"form-label"},"Etudiants suivis",-1)),xs={class:"form-control"},ks=V(()=>e("div",{class:"row"},[e("div",{class:"col-md-12"}," ")],-1)),Cs={class:"row"},Vs={class:"col-md-12"},Es=["href"],Ds=["href"],Ps=["href"],Ts=["href"],Ss={class:"col-md-4"},Ms=V(()=>e("div",null,[e("label",{class:"form-label"},"Suivi")],-1)),Rs={class:"table table-bordered table-condensed"},ws=V(()=>e("thead",null,[e("tr",null,[e("th",null,"Heures"),e("th",null,"Statut"),e("th",null,"Actions")])],-1)),js={style:{"text-align":"right"}},Us=V(()=>e("br",null,null,-1)),As={key:0},$s=["data-id"],Is=["data-id"],Ls=["data-id"];function qs(s,t,r,h,l,i){const o=M,d=S,_=E("utilisateur"),k=E("u-heures"),g=Ut;return n(),a(v,null,[e("div",{id:r.mission.id,class:D([{"bg-success":r.mission.valide,"bg-default":!r.mission.valide},"card"])},[e("form",{onSubmit:t[4]||(t[4]=b((...p)=>s.submitForm&&s.submitForm(...p),["prevent"]))},[e("div",qt,[r.mission.libelleMission?(n(),a("h5",Ht,[c(m(r.mission.libelleMission)+" ",1),e("span",Ot,[c("Du "),f(o,{value:r.mission.dateDebut},null,8,["value"]),c(" au "),f(o,{value:r.mission.dateFin},null,8,["value"])])])):u("",!0),r.mission.libelleMission?(n(),a("h6",Ft,m(r.mission.typeMission.libelle),1)):u("",!0),r.mission.libelleMission?u("",!0):(n(),a("h5",Bt,[c(m(r.mission.typeMission.libelle)+" ",1),e("span",Nt,[c("Du "),f(o,{value:r.mission.dateDebut},null,8,["value"]),c(" au "),f(o,{value:r.mission.dateFin},null,8,["value"])])]))]),e("div",zt,[e("div",Gt,[e("div",Yt,[e("div",Jt,[e("div",Wt,[Qt,e("div",Xt,m(r.mission.structure.libelle),1)])]),e("div",Zt,[e("div",Kt,[es,e("div",ts,m(r.mission.tauxRemu?r.mission.tauxRemu.libelle:null),1)]),e("div",ss,[rs,e("div",is,m(r.mission.tauxRemuMajore?r.mission.tauxRemuMajore.libelle:r.mission.tauxRemu?"Idem ("+r.mission.tauxRemu.libelle+")":null),1)]),e("div",as,[os,e("div",ls,[e("div",{class:"form-control",innerHTML:i.heuresLib},null,8,ds),e("button",{"data-bs-target":`#details-${r.mission.id}`,class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal"}," Détails ",8,us)])]),r.mission.typeMission.besoinFormation?(n(),a("div",cs,[ms,e("div",hs,m(r.mission.heuresFormation),1)])):u("",!0)]),e("div",_s,[e("div",fs,[ps,e("div",vs,m(r.mission.description),1)])]),r.mission.typeMission.accompagnementEtudiants?(n(),a("div",bs,[e("div",gs,[ys,e("div",xs,[e("pre",null,m(r.mission.etudiantsSuivis),1)])])])):u("",!0),ks,e("div",Cs,[e("div",Vs,[r.mission.canSaisie?(n(),a("a",{key:0,href:l.saisieUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...p)=>i.saisie&&i.saisie(...p),["prevent"]))},"Modifier",8,Es)):u("",!0),r.mission.canValider?(n(),a("a",{key:1,href:l.validerUrl,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider la mission ?","data-title":"Validation de la mission",onClick:t[1]||(t[1]=b((...p)=>i.valider&&i.valider(...p),["prevent"]))},"Valider",8,Ds)):u("",!0),r.mission.canDevalider?(n(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider la mission ?","data-title":"Dévalidation de la mission",onClick:t[2]||(t[2]=b((...p)=>i.devalider&&i.devalider(...p),["prevent"]))},"Dévalider",8,Ps)):u("",!0),r.mission.canSupprimer?(n(),a("a",{key:3,href:l.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer la mission ?","data-title":"Suppression de la mission",onClick:t[3]||(t[3]=b((...p)=>i.supprimer&&i.supprimer(...p),["prevent"]))},"Supprimer",8,Ts)):u("",!0)])])]),e("div",Ss,[Ms,e("div",null,[f(d,{name:"thumbs-up",variant:"success"}),c(" Créé le "),f(o,{value:r.mission.histoCreation},null,8,["value"]),c(" par "),f(_,{mail:r.mission.histoCreateur.email,nom:r.mission.histoCreateur.displayName},null,8,["mail","nom"])]),e("div",null,[f(d,{name:r.mission.valide?"thumbs-up":"thumbs-down",variant:r.mission.valide?"success":"info"},null,8,["name","variant"]),c(" "+m(l.validationText)+" ",1),r.mission.validation&&r.mission.validation.histoCreateur?(n(),C(_,{key:0,mail:r.mission.validation.histoCreateur.email,nom:r.mission.validation.histoCreateur.displayName},null,8,["mail","nom"])):u("",!0)]),e("div",null,[f(d,{name:r.mission.contrat?"thumbs-up":"thumbs-down",variant:r.mission.contrat?"success":"info"},null,8,["name","variant"]),c(" "+m(r.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),e("div",null,m(r.mission.heuresRealisees)+" heure"+m(r.mission.heuresRealisees<2?"":"s")+" réalisée"+m(r.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,Lt),f(g,{id:`details-${r.mission.id}`,title:"Détail des heures prévisionnelles"},{body:q(()=>[e("table",Rs,[ws,e("tbody",null,[(n(!0),a(v,null,y(r.mission.volumesHorairesPrevus,p=>(n(),a("tr",{key:p.id},[e("td",js,[f(k,{valeur:p.heures},null,8,["valeur"])]),e("td",null,[f(d,{name:"thumbs-up",variant:"success"}),c(" Saisi par "),f(_,{mail:p.histoCreateur.email,nom:p.histoCreateur.displayName},null,8,["mail","nom"]),c(" le "),f(o,{value:p.histoCreation},null,8,["value"]),Us,f(d,{name:p.valide?"thumbs-up":"thumbs-down",variant:p.valide?"success":"info"},null,8,["name","variant"]),c(" "+m(p.validation&&p.validation.id==null?"Autovalidé":p.validation?"":"à valider")+" ",1),p.validation&&p.validation.histoCreateur?(n(),a("span",As,[c(" Validé par "),f(_,{mail:p.validation.histoCreateur.email,nom:p.validation.histoCreateur.displayName},null,8,["mail","nom"]),c(" le "),f(o,{value:p.validation.histoCreation},null,8,["value"])])):u("",!0)]),e("td",null,[p.canValider?(n(),a("a",{key:0,"data-id":p.id,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?","data-title":"Validation du volume horaire",onClick:t[5]||(t[5]=b((...R)=>i.volumeHoraireValider&&i.volumeHoraireValider(...R),["prevent"]))},"Valider",8,$s)):u("",!0),p.canDevalider?(n(),a("a",{key:1,"data-id":p.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?","data-title":"Dévalidation du volume horaire",onClick:t[6]||(t[6]=b((...R)=>i.volumeHoraireDevalider&&i.volumeHoraireDevalider(...R),["prevent"]))},"Dévalider",8,Is)):u("",!0),p.canSupprimer?(n(),a("a",{key:2,"data-id":p.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?","data-title":"Suppression du volume horaire",onClick:t[7]||(t[7]=b((...R)=>i.volumeHoraireSupprimer&&i.volumeHoraireSupprimer(...R),["prevent"]))},"Supprimer",8,Ls)):u("",!0)])]))),128))])])]),footer:q(()=>[]),_:1},8,["id"])],64)}const B=x(It,[["render",qs],["__scopeId","data-v-1735108d"]]),Hs=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"})),Os={components:{mission:B},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],isMounted:!1,ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(s){modAjax(s.currentTarget,t=>{this.reload()})},supprimer(s){this.reload()},refresh(s){let t=Util.json.indexById(this.missions,s.id);this.missions[t]=s,this.refreshPlafonds()},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(s=>{this.missions=s.data,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?($(".plafonds").refresh(),$("#sidebar").refresh()):this.isMounted=!0}}},Fs=["href"];function Bs(s,t,r,h,l,i){const o=E("mission");return n(),a(v,null,[(n(!0),a(v,null,y(l.missions,d=>(n(),C(o,{onSupprimer:i.supprimer,onRefresh:i.refresh,key:d.id,mission:d},null,8,["onSupprimer","onRefresh","mission"]))),128)),r.canAddMission?(n(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:t[0]||(t[0]=b((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Ajout d'une nouvelle mission",8,Fs)):u("",!0)],64)}const Ns=x(Os,[["render",Bs]]),zs=Object.freeze(Object.defineProperty({__proto__:null,default:Ns},Symbol.toStringTag,{value:"Module"})),Gs={name:"ListeCandidatures.vue",props:{intervenant:{required:!0},canValiderCandidature:{type:Boolean,required:!1}},data(){return{candidatures:[],urlListeOffre:unicaenVue.url("offre-emploi")}},mounted(){this.reload()},methods:{reload(){unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/get-candidatures",{intervenant:this.intervenant})).then(s=>{this.candidatures=s.data})},validerCandidature(s){modAjax(s.currentTarget,t=>{this.reload()})},refuserCandidature(s){popConfirm(s.target,t=>{this.reload()})},urlOffre(s){return unicaenVue.url("offre-emploi/detail/:offre",{offre:s.offre.id})},urlAccepterCandidature:function(s){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:s.id})},urlRefuserCandidature:function(s){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:s.id})}}},Ys={class:"table table-bordered"},Js=e("th",null,"Offre d'emploi",-1),Ws=e("th",null,"Composante",-1),Qs=e("th",null,"Etat",-1),Xs=e("th",null,"Date commission",-1),Zs={key:0},Ks={key:0},er={key:0,colspan:"5",style:{"text-align":"center"}},tr={style:{"text-align":"center"}},sr=["href"],rr={style:{"text-align":"center"}},ir={style:{"text-align":"center"}},nr={key:0,class:"badge rounded-pill bg-success"},ar={key:1,class:"badge rounded-pill bg-danger"},or={key:2,class:"badge rounded-pill bg-warning"},lr={key:0,style:{"text-align":"center"}},dr=["href"],ur=e("i",{class:"fa-solid fa-check"},null,-1),cr=[ur],mr=["href"],hr=e("i",{class:"fa-sharp fa-solid fa-xmark"},null,-1),_r=[hr],fr=["href"];function pr(s,t,r,h,l,i){const o=M,d=S;return n(),a("div",null,[e("table",Ys,[e("thead",null,[e("tr",null,[Js,Ws,Qs,Xs,r.canValiderCandidature?(n(),a("th",Zs,"Action")):u("",!0)])]),e("tbody",null,[l.candidatures.length==0?(n(),a("tr",Ks,[r.canValiderCandidature?(n(),a("td",er,"Aucune candidature")):u("",!0)])):u("",!0),(n(!0),a(v,null,y(l.candidatures,_=>(n(),a("tr",{key:_.id},[e("td",tr,[e("a",{href:i.urlOffre(_)},m(_.offre.titre),9,sr)]),e("td",rr,m(_.offre.structure.libelleCourt),1),e("td",ir,[_.validation?(n(),a("span",nr,"Acceptée par "+m(_.validation.histoCreateur.displayName),1)):u("",!0),!_.validation&&_.motif!==null?(n(),a("span",ar,m(_.motif),1)):u("",!0),!_.validation&&_.motif===null?(n(),a("span",or,"En attente d'acceptation")):u("",!0)]),e("td",null,[_.dateCommission?(n(),C(o,{key:0,value:_.dateCommission},null,8,["value"])):u("",!0)]),this.canValiderCandidature?(n(),a("td",lr,[_.validation?u("",!0):(n(),a("a",{key:0,href:i.urlAccepterCandidature(_),class:"btn btn-success","data-content":"Êtes vous sûr de vouloir accepter cette candidature ?","data-title":"Accepter la candidature",style:{color:"white"},title:"Accepter la candidature",onClick:t[0]||(t[0]=b((...k)=>i.validerCandidature&&i.validerCandidature(...k),["prevent"]))},cr,8,dr)),c("  "),e("a",{href:i.urlRefuserCandidature(_),class:"btn btn-danger","data-content":"Êtes vous sûr de vouloir refuser cette candidature ?","data-title":"Refuser la candidature",style:{color:"white"},title:"Refuser la candidature",onClick:t[1]||(t[1]=b((...k)=>i.refuserCandidature&&i.refuserCandidature(...k),["prevent"]))},_r,8,mr)])):u("",!0)]))),128))])]),e("a",{href:l.urlListeOffre,class:"btn btn-primary",title:"Voir les offres d'emploi"},[f(d,{name:"eye"}),c(" Voir toutes les offres d'emploi ")],8,fr),c("  ")])}const vr=x(Gs,[["render",pr]]),br=Object.freeze(Object.defineProperty({__proto__:null,default:vr},Symbol.toStringTag,{value:"Module"})),gr={name:"OffreEmploi.vue",props:{offre:{required:!0},utilisateur:{required:!1},extended:{type:Boolean,required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},decretText:{type:String,required:!1}},data(){return{saisirUrl:unicaenVue.url("offre-emploi/saisir/:offre",{offre:this.offre.id}),supprimerUrl:unicaenVue.url("offre-emploi/supprimer/:offre",{offre:this.offre.id}),validerUrl:unicaenVue.url("offre-emploi/valider/:offre",{offre:this.offre.id}),devaliderUrl:unicaenVue.url("offre-emploi/devalider/:offre",{offre:this.offre.id}),consulterUrl:unicaenVue.url("offre-emploi/detail/:offre",{offre:this.offre.id}),offreEmploiUrl:unicaenVue.url("offre-emploi"),postulerUrl:unicaenVue.url("offre-emploi/postuler/:id",{id:this.offre.id}),decret:!1}},computed:{isCandidat:function(){return!1},shortDesc:function(){if(!this.offre.description)return"";let s=this.offre.description.substr(0,200);return this.offre.description.length>200&&(s+="..."),s},descriptionHtml:function(){return this.offre.description?this.offre.description.replace(/(?:\r\n|\r|\n)/g,"<br />"):""},connectionLink:function(){let s="auth/connexion?redirect="+window.location.href;return unicaenVue.url(s)}},mounted(){this.decretText||(this.decret=!0)},methods:{saisir(s){modAjax(s.target,t=>{this.refresh()})},urlVoir:function(s){return unicaenVue.url("intervenant/:code/voir",{code:"code:"+s.intervenant.code})},urlVoirCandidature:function(s){return unicaenVue.url("intervenant/:code/candidature",{code:"code:"+s.intervenant.code})},urlAccepterCandidature:function(s){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:s.id})},urlRefuserCandidature:function(s){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:s.id})},refresh(){unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.offre.id})).then(s=>{this.$emit("refresh",s.data)})},supprimer(s){popConfirm(s.target,t=>{this.$emit("supprimer",this.offre)})},postuler(s){popConfirm(s.target,t=>{this.$emit("postuler",this.offre)})},valider(s){popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},devalider(s){popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},validerCandidature(s){popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})},refuserCandidature(s){popConfirm(s.currentTarget,t=>{this.$emit("refresh",t.data)})}}},yr={key:0,class:"col"},xr={class:"card h-100"},kr={class:"card-header"},Cr={class:"badge rounded-pill bg-info"},Vr={key:0,class:"badge rounded-pill bg-success"},Er={key:1,class:"badge rounded-pill bg-warning"},Dr={class:"card-body"},Pr={class:"bg-light",style:{padding:"5px"}},Tr=e("b",null,"Créée le : ",-1),Sr=e("br",null,null,-1),Mr=e("b",null,"Période à pourvoir : ",-1),Rr=e("br",null,null,-1),wr=e("b",null,"Demandée par la composante :",-1),jr=e("br",null,null,-1),Ur=e("b",null,"Type de mission :",-1),Ar={class:"card-footer"},$r={class:"d-grid gap-2 d-md-flex justify-content-md-end"},Ir=["href"],Lr={key:1},qr={class:"page-header"},Hr={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},Or=e("i",{class:"fa-solid fa-user"},null,-1),Fr={class:"ms-2"},Br=["href"],Nr={key:1,class:"alert alert-primary d-flex align-items-center",role:"alert"},zr=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Gr=e("div",{class:"ms-2"}," Vous n'avez pas les droits pour postuler à cette offre, merci de contacter votre administration de rattachement. ",-1),Yr=[zr,Gr],Jr={key:2,class:"alert alert-primary d-flex align-items-center",role:"alert"},Wr=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Qr=e("div",{class:"ms-2"}," Vous avez déjà postulé à cette offre. ",-1),Xr=[Wr,Qr],Zr={class:"bg-light",style:{padding:"10px"}},Kr=e("b",null,"Créée le : ",-1),ei=e("br",null,null,-1),ti=e("b",null,"Période à pourvoir : ",-1),si=e("br",null,null,-1),ri=e("b",null,"Date limite de candidature :",-1),ii=e("br",null,null,-1),ni=e("b",null,"Demandé par la composante :",-1),ai=e("br",null,null,-1),oi=e("b",null,"Type de mission :",-1),li=e("br",null,null,-1),di=e("b",null,"Nombre d'heures pour la mission :",-1),ui=e("br",null,null,-1),ci=e("b",null,"Nombre de postes à pourvoir :",-1),mi=e("br",null,null,-1),hi={key:3,class:"alert alert-info"},_i=["innerHTML"],fi=e("br",null,null,-1),pi={key:4},vi=e("h5",null,[e("strong",null,"Liste des candidats :")],-1),bi={class:"table table-bordered"},gi=e("th",null,"Intervenant",-1),yi=e("th",null,"Etat",-1),xi={key:0},ki={key:0},Ci={key:0,colspan:"4",style:{"text-align":"center"}},Vi={key:1,colspan:"3",style:{"text-align":"center"}},Ei=["href"],Di={key:0,class:"badge rounded-pill bg-success"},Pi={key:1,class:"badge rounded-pill bg-danger"},Ti={key:2,class:"badge rounded-pill bg-warning"},Si={key:0},Mi=["href"],Ri={class:"mt-5"},wi=["href"],ji=["href"],Ui=["href"],Ai=["href"],$i=["href"],Ii=["href"];function Li(s,t,r,h,l,i){const o=M,d=S;return n(),a(v,null,[this.extended?u("",!0):(n(),a("div",yr,[e("div",xr,[e("div",kr,[e("h4",null,m(r.offre.titre),1),e("span",Cr,m(r.offre.nombreHeures)+" heure(s)",1),c("   "),r.offre.validation?(n(),a("span",Vr,[c("Validée le "),f(o,{value:r.offre.validation.histoCreation},null,8,["value"]),c(" par "+m(r.offre.validation.histoCreateur.displayName),1)])):u("",!0),r.offre.validation?u("",!0):(n(),a("span",Er," En attente de validation par la DRH")),c("  ")]),e("div",Dr,[e("p",Pr,[Tr,f(o,{value:r.offre.histoCreation},null,8,["value"]),c(" par "+m(r.offre.histoCreateur.displayName),1),Sr,Mr,c("du "),f(o,{value:r.offre.dateDebut},null,8,["value"]),c(" au "),f(o,{value:r.offre.dateFin},null,8,["value"]),Rr,wr,c(" "+m(r.offre.structure.libelleCourt)+" ",1),jr,Ur,c(" "+m(r.offre.typeMission.libelle),1)]),c(" "+m(i.shortDesc),1)]),e("div",Ar,[e("div",$r,[e("a",{href:l.consulterUrl,class:"btn btn-primary",title:"Consulter "},[f(d,{name:"eye"}),c(" Voir ")],8,Ir)])])])])),this.extended?(n(),a("div",Lr,[e("h1",qr,m(r.offre.titre),1),this.utilisateur?u("",!0):(n(),a("div",Hr,[Or,e("div",Fr,[c(" Vous devez "),e("a",{href:i.connectionLink,class:"text-decoration-underline alert-link"},"être identifé",8,Br),c(" pour pouvoir postuler. ")])])),!r.offre.canPostuler&&this.utilisateur?(n(),a("div",Nr,Yr)):u("",!0),i.isCandidat&&this.utilisateur?(n(),a("div",Jr,Xr)):u("",!0),e("p",Zr,[Kr,f(o,{value:r.offre.histoCreation},null,8,["value"]),c(" par "+m(r.offre.histoCreateur.displayName),1),ei,ti,c("du "),f(o,{value:r.offre.dateDebut},null,8,["value"]),c(" au "),f(o,{value:r.offre.dateFin},null,8,["value"]),si,ri,f(o,{value:r.offre.dateLimite},null,8,["value"]),ii,ni,c(" "+m(r.offre.structure.libelleCourt)+" ",1),ai,oi,c(" "+m(r.offre.typeMission.libelle)+" ",1),li,di,c(" "+m(r.offre.nombreHeures)+" heure(s) ",1),ui,ci,c(" "+m(r.offre.nombrePostes)+" poste(s) ",1),mi]),e("p",null,m(this.descriptionHtml),1),this.decretText?(n(),a("p",hi,[T(e("input",{id:"decret","onUpdate:modelValue":t[0]||(t[0]=_=>l.decret=_),name:"decret",type:"checkbox"},null,512),[[w,l.decret]]),c("  "),e("span",{innerHTML:this.decretText},null,8,_i)])):u("",!0),fi,this.canValiderCandidature?(n(),a("div",pi,[vi,e("table",bi,[e("thead",null,[e("tr",null,[gi,yi,r.canValiderCandidature?(n(),a("th",xi,"Action")):u("",!0)])]),e("tbody",null,[r.offre.candidatures.length==0?(n(),a("tr",ki,[r.canValiderCandidature?(n(),a("td",Ci,"Aucune candidature")):u("",!0),r.canValiderCandidature?u("",!0):(n(),a("td",Vi,"Aucune candidature"))])):u("",!0),(n(!0),a(v,null,y(r.offre.candidatures,_=>(n(),a("tr",null,[e("td",null,[e("a",{href:i.urlVoir(_)},m(_.intervenant.prenom+" "+_.intervenant.nomUsuel),9,Ei)]),e("td",null,[_.validation?(n(),a("span",Di,[c("Acceptée le "),f(o,{value:_.validation.histoCreation},null,8,["value"]),c(" par "+m(_.validation.histoCreateur.displayName),1)])):u("",!0),!_.validation&&_.motif!==null?(n(),a("span",Pi,m(_.motif),1)):u("",!0),!_.validation&&_.motif===null?(n(),a("span",Ti,"En attente d'acceptation")):u("",!0)]),this.canValiderCandidature?(n(),a("td",Si,[e("a",{href:i.urlVoirCandidature(_),class:"btn btn-primary",title:"Consulter "},[f(d,{name:"eye"}),c(" Voir ")],8,Mi)])):u("",!0)]))),256))])])])):u("",!0),e("div",Ri,[e("a",{href:l.offreEmploiUrl,class:"btn btn-secondary"},"Retour aux offres",8,wi),c("  "),this.canPostuler?(n(),a("a",{key:0,href:l.postulerUrl,class:D(["btn btn-primary",l.decret?"":"disabled"]),"data-bs-original-title":"Vous devez être connecté pour postuler","data-bs-placement":"top","data-bs-toggle":"tooltip"},"Postuler",10,ji)):u("",!0),c("  "),r.offre.canModifier?(n(),a("a",{key:1,href:l.saisirUrl,class:"btn btn-primary",title:"Modifier",onClick:t[1]||(t[1]=b((..._)=>i.saisir&&i.saisir(..._),["prevent"]))},[f(d,{name:"pen-to-square"}),c(" Modifier ")],8,Ui)):u("",!0),c("  "),r.offre.validation&&r.offre.canValider?(n(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger",title:"Devalider",onClick:t[2]||(t[2]=b((..._)=>i.devalider&&i.devalider(..._),["prevent"]))},[f(d,{name:"thumbs-down"}),c(" Devalider ")],8,Ai)):u("",!0),c("  "),!r.offre.validation&&r.offre.canValider?(n(),a("a",{key:3,href:l.validerUrl,class:"btn btn-success",title:"Valider",onClick:t[3]||(t[3]=b((..._)=>i.valider&&i.valider(..._),["prevent"]))},[f(d,{name:"thumbs-up"}),c(" Valider ")],8,$i)):u("",!0),c("  "),r.offre.canSupprimer?(n(),a("a",{key:4,href:l.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer l'offre ?","data-title":"Suppression de l'offre",title:"Supprimer",onClick:t[4]||(t[4]=b((..._)=>i.supprimer&&i.supprimer(..._),["prevent"]))},[f(d,{name:"trash"}),c(" Supprimer ")],8,Ii)):u("",!0)])])):u("",!0)],64)}const N=x(gr,[["render",Li]]),qi=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"})),Hi={components:{offreEmploi:N},props:{id:{type:Number,required:!1},utilisateur:{required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1}},data(){return{offres:[],ajoutUrl:unicaenVue.url("offre-emploi/saisir")}},mounted(){this.reload()},computed:{extended:function(){return!!this.id}},methods:{ajout(s){modAjax(s.target,t=>{this.reload()})},supprimer(){window.location.href=unicaenVue.url("offre-emploi")},refresh(s){let t=Util.json.indexById(this.offres,s.id);this.offres[t]=s},reload(){this.id?unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.id})).then(s=>{this.offres=[s.data]}):unicaenVue.axios.get(unicaenVue.url("offre-emploi/liste")).then(s=>{this.offres=s.data})}}},Oi={key:0,class:"row row-cols-1 row-cols-md-2 g-4 mb-3"},Fi={key:1},Bi=["href"],Ni={key:2};function zi(s,t,r,h,l,i){const o=E("offreEmploi");return n(),a(v,null,[i.extended?u("",!0):(n(),a("div",Oi,[(n(!0),a(v,null,y(l.offres,d=>(n(),C(o,{key:d.id,canModifier:this.canModifier,canSupprimer:this.canSupprimer,canValider:this.canValider,canVoirCandidature:this.canVoirCandidature,offre:d,decretText:d.decretText,onRefresh:i.refresh,onSupprimer:i.supprimer},null,8,["canModifier","canSupprimer","canValider","canVoirCandidature","offre","decretText","onRefresh","onSupprimer"]))),128))])),i.extended?u("",!0):(n(),a("div",Fi,[this.canModifier?(n(),a("a",{key:0,href:l.ajoutUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Ajouter une nouvelle offre",8,Bi)):u("",!0)])),i.extended?(n(),a("div",Ni,[(n(!0),a(v,null,y(l.offres,d=>(n(),C(o,{key:d.id,canModifier:this.canModifier,canPostuler:this.canPostuler,canSupprimer:this.canSupprimer,canValider:this.canValider,canValiderCandidature:this.canValiderCandidature,canVoirCandidature:this.canVoirCandidature,decretText:d.decretText,extended:i.extended,offre:d,utilisateur:this.utilisateur,onRefresh:i.refresh,onSupprimer:i.supprimer},null,8,["canModifier","canPostuler","canSupprimer","canValider","canValiderCandidature","canVoirCandidature","decretText","extended","offre","utilisateur","onRefresh","onSupprimer"]))),128))])):u("",!0)],64)}const Gi=x(Hi,[["render",zi]]),Yi=Object.freeze(Object.defineProperty({__proto__:null,default:Gi},Symbol.toStringTag,{value:"Module"})),Ji={name:"Prime.vue",props:{prime:{required:!0},numero:{required:!1},intervenant:{required:!0},canGerer:{type:Boolean,required:!1}},data(){return{declarationUrl:unicaenVue.url("prime/:intervenant/declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerUrl:unicaenVue.url("prime/:intervenant/supprimer-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),validerUrl:unicaenVue.url("prime/:intervenant/valider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),devaliderUrl:unicaenVue.url("prime/:intervenant/devalider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),telechargerUrl:unicaenVue.url("prime/:intervenant/telecharger-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),refuserUrl:unicaenVue.url("prime/:intervenant/refuser-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),modifierPrimeUrl:unicaenVue.url("prime/:intervenant/saisie/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerPrimeUrl:unicaenVue.url("prime/:intervenant/supprimer-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id})}},computed:{},methods:{supprimer(s){popConfirm(s.target,t=>{this.$emit("reload")})},valider(s){popConfirm(s.target,t=>{this.$emit("reload")})},devalider(s){popConfirm(s.target,t=>{this.$emit("reload")})},refuser(){unicaenVue.axios.post(this.refuserUrl).then(s=>{this.$emit("reload")})},modifierPrime(s){modAjax(s.currentTarget,t=>{this.$emit("reload")})},supprimerPrime(s){popConfirm(s.target,t=>{this.$emit("reload")})}}},Wi={key:0},Qi=e("br",null,null,-1),Xi=e("u",null,"Mission(s) concernée(s)",-1),Zi={key:0},Ki=["action"],en={class:"card-body"},tn={class:"row"},sn={key:0,class:"col-md-6"},rn={class:"card text-dark bg-light"},nn=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),an={class:"card-body"},on=e("p",{class:"card-text"},[c(" Pour "),e("b",null,"bénéficier de votre indemnité de fin de contrat"),c(", vous devez déposer une déclaration sur l'honneur ("),e("a",{href:""},"exemple"),c(") signée précisant que vous ne débutez pas d'autre contrat dans la fonction au publique à la suite de ces missions. ")],-1),ln=["disabled"],dn={class:"card-footer d-grid gap-2"},un=["disabled"],cn={key:1,class:"col-md-6"},mn={class:"card text-dark bg-light"},hn=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),_n={class:"card-body"},fn=e("p",{class:"card-text"},"Vous pouvez télécharger votre déclaration sur l'honneur ci-dessous : ",-1),pn=["href"],vn={class:"card-footer",style:{"text-align":"right"}},bn=["href"],gn=["href"],yn=["href"],xn={class:"col-md-6"},kn={key:0},Cn=["checked","disabled"],Vn=e("b",null,"je déclare ne pas pouvoir bénéficier d'une indemnité",-1),En=e("br",null,null,-1),Dn=e("br",null,null,-1),Pn=e("div",null,[e("label",{class:"form-label"},"Suivi de la déclaration : ")],-1),Tn={key:0},Sn={key:1},Mn={key:2},Rn={key:3},wn={key:4},jn={key:5},Un={key:6},An={class:"row"},$n={class:"col-md-12"},In={class:"float-end"},Ln=["href"],qn=["href"];function Hn(s,t,r,h,l,i){const o=M,d=S;return n(),a("div",{class:D([{"bg-success":r.prime.validation,"bg-default":!r.prime.validation&&!r.prime.dateRefus,"bg-danger":r.prime.dateRefus},"card"])},[e("div",{class:D([{"text-white":r.prime.dateRefus},"card-header card-header-h3"])},[r.prime.id?(n(),a("h5",Wi,[c(" Indemnité de fin de contrat N°"+m(r.numero+1),1),Qi])):u("",!0),e("div",null,[Xi,c(" : "),(n(!0),a(v,null,y(r.prime.missions,(_,k)=>(n(),a("span",null,[c(m(_.typeMission.libelle)+" (Pour "+m(_.structure.libelleCourt)+" du ",1),f(o,{value:_.dateDebut},null,8,["value"]),c(" au "),f(o,{value:_.dateFin},null,8,["value"]),c(") "),k!=r.prime.missions.length-1?(n(),a("span",Zi,", ")):u("",!0)]))),256))])],2),e("form",{action:l.declarationUrl,enctype:"multipart/form-data",method:"post"},[e("div",en,[e("div",tn,[r.prime.declaration?u("",!0):(n(),a("div",sn,[e("div",rn,[nn,e("div",an,[on,e("input",{ref:"file",disabled:!!r.prime.dateRefus,name:"files[]",type:"file"},null,8,ln)]),e("div",dn,[e("input",{disabled:!!r.prime.dateRefus,class:"btn btn-primary",type:"submit",value:"Envoyer"},null,8,un)])])])),r.prime.declaration?(n(),a("div",cn,[e("div",mn,[hn,e("div",_n,[fn,e("a",{href:l.telechargerUrl},m(r.prime.declaration.nom),9,pn)]),e("div",vn,[r.prime.declaration&&!r.prime.validation&&!r.prime.dateRefus?(n(),a("a",{key:0,href:l.supprimerUrl,class:"btn btn-danger",title:"Supprimer",onClick:t[0]||(t[0]=b((..._)=>i.supprimer&&i.supprimer(..._),["prevent"]))}," Supprimer ",8,bn)):u("",!0),c("  "),r.prime.declaration&&!r.prime.validation&&this.canGerer&&!r.prime.dateRefus?(n(),a("a",{key:1,href:l.validerUrl,class:"btn btn-success",title:"Valider",onClick:t[1]||(t[1]=b((..._)=>i.valider&&i.valider(..._),["prevent"]))}," Valider ",8,gn)):u("",!0),c("  "),r.prime.declaration&&r.prime.validation&&this.canGerer&&!r.prime.dateRefus?(n(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger d-grid gap-2",title:"Dévalider",onClick:t[2]||(t[2]=b((..._)=>i.devalider&&i.devalider(..._),["prevent"]))}," Dévalider ",8,yn)):u("",!0),c("  ")])])])):u("",!0),e("div",xn,[r.prime.validation?u("",!0):(n(),a("div",kn,[e("input",{checked:r.prime.dateRefus,disabled:r.prime.validation,name:"prime",type:"checkbox",onChange:t[3]||(t[3]=(..._)=>i.refuser&&i.refuser(..._))},null,40,Cn),c("  Ou en cochant cette case, "),Vn,c(" de fin de contrat en raison du démarrage d'un nouveau contrat au sein de la fonction publique à la suite de ces missions. "),En,Dn])),e("div",null,[Pn,r.prime.dateRefus?(n(),a("div",Tn,[f(d,{name:"thumbs-down",variant:"danger"}),c(" Indemnité refusée le "),f(o,{value:r.prime.dateRefus},null,8,["value"])])):u("",!0),r.prime.declaration&&!r.prime.dateRefus?(n(),a("div",Sn,[f(d,{name:"thumbs-up",variant:"success"}),c(" Déclaration déposée le "),f(o,{value:r.prime.declaration.histoCreation},null,8,["value"]),c(" par "+m(r.prime.declaration.histoCreateur.displayName),1)])):u("",!0),!r.prime.declaration&&!r.prime.dateRefus?(n(),a("div",Mn,[f(d,{name:"thumbs-down",variant:"info"}),c(" Aucune déclaration déposée ")])):u("",!0),r.prime.validation&&!r.prime.dateRefus?(n(),a("div",Rn,[f(d,{name:"thumbs-up",variant:"success"}),c(" Déclaration validée le "),f(o,{value:r.prime.validation.histoCreation},null,8,["value"]),c(" par "+m(r.prime.validation.histoCreateur.displayName),1)])):u("",!0),!r.prime.validation&&!r.prime.dateRefus?(n(),a("div",wn,[f(d,{name:"thumbs-down",variant:"info"}),c(" Aucune déclaration validée ")])):u("",!0),r.prime.validation&&!r.prime.dateRefus?(n(),a("div",jn,[f(d,{name:"euro-sign",variant:"success"}),c(" Intervenant éligible à une indemnité de fin de contrat ")])):u("",!0),r.prime.dateRefus?(n(),a("div",Un,[f(d,{name:"euro-sign",variant:"info"}),c(" Intervenant non éligible à une indemnité de fin de contrat ")])):u("",!0)])])]),e("div",An,[e("div",$n,[e("span",In,[!r.prime.validation&&!r.prime.dateRefus&&this.canGerer?(n(),a("a",{key:0,href:l.modifierPrimeUrl,class:"btn btn-primary",onClick:t[4]||(t[4]=b((..._)=>i.modifierPrime&&i.modifierPrime(..._),["prevent"]))},"Modifier",8,Ln)):u("",!0),c("   "),!r.prime.validation&&!r.prime.dateRefus&&this.canGerer?(n(),a("a",{key:1,href:l.supprimerPrimeUrl,class:"btn btn-danger",onClick:t[5]||(t[5]=b((..._)=>i.supprimerPrime&&i.supprimerPrime(..._),["prevent"]))},"Supprimer",8,qn)):u("",!0)])])])])],8,Ki)],2)}const z=x(Ji,[["render",Hn]]),On=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"})),Fn={components:{prime:z},props:{intervenant:{type:Number,required:!0},numero:{type:Number,required:!1},missionsWithoutPrime:{type:Number,required:!1},canGerer:{type:Boolean,required:!1}},data(){return{load:!1,primes:[],ajoutUrl:unicaenVue.url("prime/:intervenant/saisie/",{intervenant:this.intervenant})}},mounted(){this.reload(),console.log(this.primes.length)},methods:{ajout(s){modAjax(s.currentTarget,t=>{this.reload()})},reload(){this.load=!1,this.primes=[],unicaenVue.axios.get(unicaenVue.url("prime/:intervenant/liste",{intervenant:this.intervenant})).then(s=>{this.primes=s.data,this.load=!0})}}},Bn={key:0,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},Nn=e("br",null,null,-1),zn=e("br",null,null,-1),Gn={key:1,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},Yn=e("br",null,null,-1),Jn=e("br",null,null,-1),Wn={key:2},Qn=["href"];function Xn(s,t,r,h,l,i){const o=E("prime");return n(),a(v,null,[(n(!0),a(v,null,y(l.primes,(d,_)=>(n(),C(o,{canGerer:r.canGerer,intervenant:this.intervenant,numero:_,prime:d,onReload:i.reload},null,8,["canGerer","intervenant","numero","prime","onReload"]))),256)),l.load?u("",!0):(n(),a("div",Bn,[c(" Chargement en cours..."),Nn,zn])),l.primes.length==0&&l.load?(n(),a("div",Gn,[c(" Aucune indemnité de fin de contrat actuellement..."),Yn,Jn])):u("",!0),this.missionsWithoutPrime>0&&this.canGerer?(n(),a("div",Wn,[e("a",{href:l.ajoutUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Créer une nouvelle indemnité",8,Qn)])):u("",!0)],64)}const Zn=x(Fn,[["render",Xn]]),Kn=Object.freeze(Object.defineProperty({__proto__:null,default:Zn},Symbol.toStringTag,{value:"Module"}));const ea={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0},addDateDebut:{type:String,required:!1},addDateFin:{type:String,required:!1}},data(){const s=new Date(this.date);return{mois:s.getMonth()+1,annee:s.getFullYear()}},computed:{listeJours(){const s=new Date(this.date);s.setDate(1),s.setMonth(s.getMonth()+1),s.setDate(s.getDate()-1);let t=s.getDate();return Array.from({length:t},(r,h)=>h+1)}},watch:{date:function(s,t){const r=new Date(this.date);this.mois=r.getMonth()+1,this.annee=r.getFullYear()},mois:function(s,t){const r=new Date(this.date);r.setMonth(s-1),this.$emit("changeDate",r)},annee:function(s,t){const r=new Date(this.date);r.setFullYear(s),this.$emit("changeDate",r)}},methods:{nomJour(s){const t=new Date(this.date);return t.setDate(s),t.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let s=[];const t=new Date;for(let r=1;r<=12;r++){t.setMonth(r-1);let h=t.toLocaleString("fr-FR",{month:"long"});s.push({id:r,libelle:h})}return s},listeAnnees(){const t=new Date().getFullYear(),r=1;let h=[];for(let l=t-r;l<=t+r;l++)h.push(l);return h},canAdd(s){if(!this.canAddEvent)return!1;let t=this.addDateDebut;t===void 0?t=new Date("2000-01-01"):t==="now"?t=new Date:t=new Date(t);let r=this.addDateFin;r===void 0?r=new Date("2500-01-01"):r==="now"?r=new Date:r=new Date(r);let h=new Date(this.date);return h.setDate(s),t=this.isoDateOnly(t),r=this.isoDateOnly(r),h=this.isoDateOnly(h),!(h<t||h>r)},addEvent(s){const t=new Date(this.date);t.setDate(s.currentTarget.dataset.jour),this.$emit("addEvent",t,s)},prevMois(){const s=new Date(this.date);s.setMonth(s.getMonth()-1),this.$emit("changeDate",s)},nextMois(){const s=new Date(this.date);s.setMonth(s.getMonth()+1),this.$emit("changeDate",s)},eventsByJour(s){const t=new Date(this.date);let r={};for(let h in this.events){let l=this.events[h];l.date.getFullYear()===t.getFullYear()&&l.date.getMonth()+1===t.getMonth()+1&&l.date.getDate()===s&&(r[h]=l)}return r},isoDateOnly(s){const t=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),h=String(s.getDate()).padStart(2,"0");return`${t}-${r}-${h}`}}},ta={class:"calendar"},sa={class:"recherche"},ra={class:"recherche btn-group"},ia=["value"],na=["value"],aa={class:"table table-bordered table-hover table-sm"},oa=["data-jour"],la={class:"nom-jour"},da={class:"numero-jour"},ua={class:"num-jour badge bg-secondary rounded-circle"},ca={key:0},ma=["data-jour"];function ha(s,t,r,h,l,i){const o=S;return n(),a("div",ta,[e("div",sa,[e("div",ra,[e("button",{class:"btn btn-light",id:"prevMois",onClick:t[0]||(t[0]=(...d)=>i.prevMois&&i.prevMois(...d)),title:"Mois précédant"},[f(o,{name:"chevron-left"})]),T(e("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":t[1]||(t[1]=d=>l.mois=d)},[(n(!0),a(v,null,y(i.listeMois(),d=>(n(),a("option",{value:d.id},m(d.libelle),9,ia))),256))],512),[[U,l.mois]]),T(e("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":t[2]||(t[2]=d=>l.annee=d)},[(n(!0),a(v,null,y(i.listeAnnees(),d=>(n(),a("option",{value:d},m(d),9,na))),256))],512),[[U,l.annee]]),e("button",{class:"btn btn-light",id:"nextMois",onClick:t[3]||(t[3]=(...d)=>i.nextMois&&i.nextMois(...d)),title:"Mois suivant"},[f(o,{name:"chevron-right"})])])]),e("table",aa,[(n(!0),a(v,null,y(i.listeJours,d=>(n(),a("tr",{"data-jour":d},[e("th",la,m(i.nomJour(d)),1),e("th",da,[e("div",ua,m(d<10?"0"+d.toString():d),1)]),e("td",null,[(n(!0),a(v,null,y(i.eventsByJour(d),(_,k)=>(n(),a("div",{class:"event",style:W("border-color:"+_.color+";background-color:"+_.bgcolor),key:k},[(n(),C(Q(_.component),{event:_},null,8,["event"]))],4))),128)),i.canAdd(d)?(n(),a("div",ca,[e("button",{onClick:t[4]||(t[4]=(..._)=>i.addEvent&&i.addEvent(..._)),"data-jour":d,class:"btn btn-light btn-sm"},[f(o,{name:"plus"}),c(" Nouvel événement ")],8,ma)])):u("",!0)])],8,oa))),256))])])}const _a=x(ea,[["render",ha],["__scopeId","data-v-51bbc42d"]]);const fa={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(s){modAjax(s.currentTarget,t=>{this.suivi.refresh()})},supprimer(s){popConfirm(s.currentTarget,t=>{this.suivi.refresh()})},valider(s){unicaenVue.axios.get(this.validerUrl).then(t=>{this.suivi.refresh()})},devalider(s){popConfirm(s.currentTarget,t=>{this.suivi.refresh()})}}},pa={class:"event-content"},va={class:"mission"},ba={key:0,class:"badge bg-success"},ga={class:"horaires"},ya={key:0,class:"badge bg-secondary"},xa={key:0,class:"description"},ka={class:"event-actions"},Ca={class:"btn-group btn-group-sm"},Va=["data-url"],Ea=["data-url"],Da=["data-url"],Pa=["data-url"];function Ta(s,t,r,h,l,i){const o=S;return n(),a(v,null,[e("div",pa,[e("p",va,[c(m(r.event.mission.libelleCourt)+" ",1),r.event.valide?(n(),a("span",ba,"Validé")):u("",!0)]),e("p",ga,[c(" de "+m(i.heureDebut)+" à "+m(i.heureFin)+", soit "+m(i.heures)+" heure"+m(i.heures<2?"":"s")+" ",1),r.event.formation?(n(),a("span",ya,"En formation")):u("",!0)]),r.event.description?(n(),a("p",xa,m(r.event.description),1)):u("",!0)]),e("div",ka,[e("div",Ca,[r.event.canEdit?(n(),a("button",{key:0,class:"btn btn-light",onClick:t[0]||(t[0]=(...d)=>i.modifier&&i.modifier(...d)),title:"Modifier le suivi","data-url":l.modifierUrl},[f(o,{name:"pen-to-square"})],8,Va)):u("",!0),r.event.canValider?(n(),a("button",{key:1,class:"btn btn-light",onClick:t[1]||(t[1]=(...d)=>i.valider&&i.valider(...d)),title:"Valider le suivi","data-url":l.validerUrl},[f(o,{name:"check",class:"text-success"})],8,Ea)):u("",!0),r.event.canDevalider?(n(),a("button",{key:2,class:"btn btn-light",onClick:t[2]||(t[2]=(...d)=>i.devalider&&i.devalider(...d)),title:"Dévalider le suivi","data-url":l.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[f(o,{name:"xmark",class:"text-danger"})],8,Da)):u("",!0),r.event.canSupprimer?(n(),a("button",{key:3,class:"btn btn-light",onClick:t[3]||(t[3]=(...d)=>i.supprimer&&i.supprimer(...d)),title:"Supprimer le suivi","data-url":l.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[f(o,{name:"trash-can",class:"text-danger"})],8,Pa)):u("",!0)])])],64)}const G=x(fa,[["render",Ta],["__scopeId","data-v-17cb1f29"]]),Sa=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"})),Ma={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,isMounted:!1,suivi:[]}},methods:{changeDate(s){this.date=s},ajouter(s,t){const r={intervenant:this.intervenant,date:s.toISOString().slice(0,10)};t.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",r),modAjax(t.currentTarget,h=>{this.refresh()})},refresh(){const s=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let t=0,r=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(h=>{let l=[];for(let i in h.data){let o=h.data[i];r[o.mission.id]===void 0&&(r[o.mission.id]=s[t],t++),o.valide&&(o.bgcolor="#d0eddb"),o.color=r[o.mission.id],o.component=X(G),o.date=new Date(o.date),o.intervenant=this.intervenant,l.push(o)}this.suivi=l,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?$(".plafonds").refresh():this.isMounted=!0}}};function Ra(s,t,r,h,l,i){const o=_a;return n(),C(o,{date:l.date,onChangeDate:i.changeDate,onAddEvent:i.ajouter,"can-add-event":r.canAddMission,addDateFin:"now",events:l.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const wa=x(Ma,[["render",Ra]]),ja=Object.freeze(Object.defineProperty({__proto__:null,default:wa},Symbol.toStringTag,{value:"Module"}));function Ua(s){for(let t in s)for(let r in s[t])Y(s[t][r],t)}function Aa(){let s=document.getElementById("unicaen-vue-toast-container");return s||(s=document.createElement("div"),s.id="unicaen-vue-toast-container",s.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(s)),s}function $a(s){return s=Ia(s),s=La(s),s}function Ia(s){const t=document.createElement("div");t.innerHTML=s;const r=t.querySelector(".alert");return r?r.innerHTML:t.innerHTML}function La(s){const t=document.createElement("div");return t.innerHTML=s,t.querySelectorAll("i.fas").forEach(h=>h.style.display="none"),t.innerHTML}function Y(s,t){const r={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},h={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"},l=document.createElement("button");l.classList.add("btn-close","btn-close-white","h5"),l.style.float="right",l.setAttribute("data-bs-dismiss","toast"),l.setAttribute("aria-label","Close");const i=document.createElement("i");i.classList.add("icon","fas",`fa-${h[t]}`),i.style.float="left",i.style.fontSize="26pt",i.style.paddingLeft=".4rem",i.style.marginTop=".4rem",i.style.paddingRight="1rem";const o=document.createElement("div");o.classList.add("toast-body"),o.innerHTML=$a(s);const d=document.createElement("div");d.appendChild(l),d.appendChild(i),d.appendChild(o);const _=document.createElement("div");_.classList.add("toast","text-white",r[t]?r[t]:"bg-secondary"),_.setAttribute("role","alert"),_.setAttribute("aria-live","assertive"),_.setAttribute("aria-atomic","true"),t==="error"&&s.length>500&&_.setAttribute("style","width:700px"),_.appendChild(d),Aa().appendChild(_);const k={animation:!0,delay:t==="warning"?15e3:5e3,autohide:t!=="error"};new bootstrap.Toast(_,k).show()}const A={toast:Y,toasts:Ua};let j={...Z};j.interceptors.request.use(s=>{if(s.submitter){let t=s.msg?s.msg:"Action en cours";s.popover!=null&&s.popover.dispose(),s.popover=new bootstrap.Popover(s.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+t,html:!0,trigger:"focus"}),s.popover.show()}return s});j.interceptors.response.use(s=>{if(s.messages=s.data.messages,s.data=s.data.data,s.hasErrors=!!(s.messages&&s.messages.error&&s.messages.error.length>0),s.config.popover){var t=s.config.popover;let r="";for(ns in s.messages)for(mid in s.messages[ns])r+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+s.messages[ns][mid]+"</div>";r?(t._config.content=r,t.setContent(),setTimeout(()=>{t.dispose()},5e3)):t.dispose()}return s.messages&&A.toasts(s.messages),s},s=>{let t=s.response.data;s.response.status==403?t="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.":t=s.response.data,A.toast(t,"error")});j.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const qa={uvAxios:j},I={axios:qa.uvAxios,flashMessenger:A,url:(s,t,r)=>{let h=window.__unicaenVueBaseUrl;if(t)for(let i in t)s=s.replace(`:${i}`,t[i]);let l=r?I.encodeUrlQueryParam(r):null;return h+s+(l?`?${l}`:"")},encodeUrlQueryParam:(s,t)=>{var r=[];for(var h in s)if(s.hasOwnProperty(h)){var l=s[h],i=t?t+"["+encodeURIComponent(h)+"]":encodeURIComponent(h);if(typeof l=="object"&&l!==null)r.push(I.encodeUrlQueryParam(l,i));else{var o=encodeURIComponent(l);r.push(i+"="+o)}}return r.join("&")}};window.unicaenVue=I;const Ha={name:"DemandeMiseEnPaiementLot.vue",props:{structures:{required:!0}},data(){return{selectedStructure:null,urlRechercheDemandeMiseEnPaiement:unicaenVue.url("paiement/demande-mise-en-paiement-lot"),urlProcessDemandeMiseEnPaiement:unicaenVue.url("paiement/process-demande-mise-en-paiement-lot"),permanents:[],vacataires:[],etudiants:[],autres:[],intervenants:[],dotation:null,liquidation:null,totalConsommationPaieEtat:0,totalConsommationRessourcePropre:0,totalConsommation:0,alertDotation:!1}},computed:{haveDotation(){return this.dotation?this.dotation.total>0:!1},alertPaieEtat(){return this.dotation.paieEtat<this.totalConsommationPaieEtat?"text-danger fw-bold":""},alertRessourcePropre(){return this.dotation.ressourcePropre<this.totalConsommationRessourcePropre?"text-danger fw-bold":""}},methods:{findDemandeMiseEnPaiement(s){this.totalConsommationRessourcePropre=0,this.totalConsommationPaieEtat=0,this.dotation=null,this.liquidation=null;let t=document.getElementById("formRechercheDemandeMiseEnPaiement"),r=new FormData(t),h=document.getElementById("btn-rdmep"),l=document.getElementById("btn-rdmep-inprogress");l.classList.remove("d-none"),h.classList.add("d-none"),h.disabled=!0,unicaenVue.axios.post(this.urlRechercheDemandeMiseEnPaiement,r,{}).then(i=>{this.dispatchDatas(i.data),h.disabled=!1,l.classList.add("d-none"),h.classList.remove("d-none"),document.querySelectorAll('input[type="checkbox"]').forEach(function(d,_){d.checked=!0}),unicaenVue.axios.get(unicaenVue.url("budget/get-budget-structure/:structure",{structure:this.selectedStructure})).then(d=>{let _=d.data;this.dotation=_.dotation,this.liquidation=_.liquidation,this.refreshTotalConsommation()})}).catch(i=>{console.error(i)})},processDemandeMiseEnPaiement(s){let t=document.getElementById("formProcessDemandeMiseEnPaiement"),r=new FormData(t);if(this.dotation.paieEtat>=this.totalConsommationPaieEtat&&this.dotation.ressourcePropre>this.totalConsommationRessourcePropre||!this.haveDotation){let h=document.getElementById("btn-pdmep"),l=document.getElementById("btn-pdmep-inprogress");l.classList.remove("d-none"),h.classList.add("d-none"),h.disabled=!0,unicaenVue.axios.post(this.urlProcessDemandeMiseEnPaiement,r,{}).then(i=>{this.findDemandeMiseEnPaiement(),h.disabled=!1,l.classList.add("d-none"),h.classList.remove("d-none")}).catch(i=>{console.error("Error process dmep")})}},refreshTotalConsommation(){let s=0,t=0,r=0;s=parseFloat(this.liquidation.paieEtat),t=parseFloat(this.liquidation.ressourcePropre),r+=parseFloat(this.liquidation.ressourcePropre),r+=parseFloat(this.liquidation.paieEtat),document.querySelectorAll('input[type="checkbox"]').forEach(function(l,i){l.hasAttribute("data-paie-etat")&&l.checked&&(s+=parseFloat(l.getAttribute("data-paie-etat")),r+=parseFloat(l.getAttribute("data-paie-etat"))),l.hasAttribute("data-ressource-propre")&&l.checked&&(t+=parseFloat(l.getAttribute("data-ressource-propre")),r+=parseFloat(l.getAttribute("data-ressource-propre")))}),this.totalConsommationPaieEtat=s.toFixed(2),this.totalConsommationRessourcePropre=t.toFixed(2),this.totalConsommation=r.toFixed(2),this.alertDotation=(this.dotation.paieEtat<this.totalConsommationPaieEtat||this.dotation.ressourcePropre<this.totalConsommationRessourcePropre)&&this.dotation.total>0},totalPayable(s){let t=0;return s.forEach((r,h)=>{r.centreCout.code!=""&&(t+=r.heuresAPayer)}),t.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalNonPayable(s){let t=0;return s.forEach((r,h)=>{r.centreCout.code==""&&(t+=r.heuresAPayer)}),t.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePaieEtat(s){let t=0;return s.forEach((r,h)=>{r.centreCout.typeRessourceCode=="paie-etat"&&(t+=r.heuresAPayer)}),t.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePropre(s){let t=0;return s.forEach((r,h)=>{r.centreCout.typeRessourceCode=="ressources-propres"&&(t+=r.heuresAPayer)}),t.toLocaleString("fr-FR",{maximumFractionDigits:2})},dispatchDatas(s){this.vacataires=[],this.permanents=[],this.etudiants=[],this.autres=[],this.intervenants=[],s.forEach((t,r)=>{switch(t.datasIntervenant.typeIntervenant){case"Vacataire":this.vacataires.push(t),this.intervenants.push(t);break;case"Intervenant permanent":this.permanents.push(t),this.intervenants.push(t);break;case"Étudiant":this.etudiants.push(t),this.intervenants.push(t);break;default:this.autres.push(t),this.intervenants.push(t)}})},toggleCheckbox(s){let t=Array.from(document.getElementsByClassName(s.target.className));s.target.checked?t.forEach(function(r,h){r.checked=!0}):t.forEach(function(r,h){r.checked=!1}),this.refreshTotalConsommation()},urlIntervenant(s){return unicaenVue.url("intervenant/code::intervenantCode/mise-en-paiement/demande",{intervenantCode:s.datasIntervenant.code})},formattedHETD(s){return Util.formattedHeures(s,!1)}}},Oa=e("h1",null,"Demande de mise en paiement par lots",-1),Fa={class:"card text-dark bg-light"},Ba=e("div",{class:"card-header text-uppercase fw-bold"}," Recherchez des heures en attente de demande de mise en paiement : ",-1),Na={class:"card-body"},za={id:"formRechercheDemandeMiseEnPaiement",action:"",method:"post"},Ga={class:"mb-3"},Ya=e("label",{class:"form-label",for:"modele"},"Choisissez une structure ",-1),Ja=["value"],Wa={class:"mb-3"},Qa=e("button",{id:"btn-rdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),c("  Veuillez patienter... ")],-1),Xa=["disabled"],Za=e("div",{class:"alert alert-info",role:"alert"}," Seules les HETD avec des centres de coûts pré-paramètrés peuvent bénéficier d'une demande de mise en paiement automatisées. Pour les autres, il faudra passer sur chaque fiches intervenant pour faire les demandes en sélectionnant le centre de coût manuellement. ",-1),Ka={key:0},eo={key:0,class:"alert alert-danger",role:"alert"},to={class:"table table-bordered caption-top"},so=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"fw-bold",scope:"col"},"Budget"),e("th",{class:"fw-bold",scope:"col"},"Paie etat"),e("th",{class:"fw-bold",scope:"col"},"Ressource propre"),e("th",{class:"fw-bold",scope:"col"},"Total")])],-1),ro=e("td",null,"Dotation",-1),io={class:"fw-bold"},no=e("td",null,"Consommation",-1),ao={class:"fw-bold"},oo={id:"dmep",class:"accordion"},lo={id:"formProcessDemandeMiseEnPaiement",action:"",method:"post"},uo={key:0,class:"accordion-item"},co={id:"dmep-permanents-heading",class:"accordion-header"},mo={"aria-controls":"dmep-permanents-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-permanents-collapse","data-bs-toggle":"collapse",type:"button"},ho={id:"dmep-permanents-collapse","aria-labelledby":"dmep-permanents-heading",class:"accordion-collapse collapse show"},_o={class:"accordion-body"},fo={class:"table"},po={scope:"col"},vo=e("th",{scope:"col"},"Intervenant",-1),bo=e("th",{scope:"col"},"HETD avec centre coût",-1),go=e("th",{scope:"col"},"HETD sans centre coût",-1),yo=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],xo=["title"],ko={key:1,class:"accordion-item"},Co={id:"dmep-vacataires-heading",class:"accordion-header"},Vo={"aria-controls":"dmep-vacataires-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-vacataires-collapse","data-bs-toggle":"collapse",type:"button"},Eo={id:"dmep-vacataires-collapse","aria-labelledby":"dmep-vacataires-heading",class:"accordion-collapse collapse show"},Do={class:"accordion-body"},Po={class:"table"},To=e("th",null,"Intervenant",-1),So=e("th",null,"HETD avec centre coût",-1),Mo=e("th",null,"HETD sans centre coût",-1),Ro=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],wo=["href"],jo=["title"],Uo={key:2,class:"accordion-item"},Ao={id:"dmep-etudiants-heading",class:"accordion-header"},$o={"aria-controls":"dmep-etudiants-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-etudiants-collapse","data-bs-toggle":"collapse",type:"button"},Io={id:"dmep-etudiants-collapse","aria-labelledby":"dmep-etudiants-heading",class:"accordion-collapse collapse show"},Lo={class:"accordion-body"},qo={class:"table"},Ho=e("th",null,"Intervenant",-1),Oo=e("th",null,"HETD avec centre coût",-1),Fo=e("th",null,"HETD sans centre coût",-1),Bo=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],No=["title"],zo={key:3,class:"accordion-item"},Go={id:"dmep-autres-heading",class:"accordion-header"},Yo={"aria-controls":"dmep-autres-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-autres-collapse","data-bs-toggle":"collapse",type:"button"},Jo={id:"dmep-autres-collapse","aria-labelledby":"dmep-autres-heading",class:"accordion-collapse collapse show"},Wo={class:"accordion-body"},Qo={class:"table"},Xo=e("th",null,"Intervenant",-1),Zo=e("th",null,"HETD avec centre coût",-1),Ko=e("th",null,"HETD sans centre coût",-1),el=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],tl=["title"],sl={key:4,class:"mt-3"},rl=e("button",{id:"btn-pdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),c("  Veuillez patienter... ")],-1),il=["disabled"];function nl(s,t,r,h,l,i){return n(),a(v,null,[Oa,e("div",Fa,[Ba,e("div",Na,[e("form",za,[e("div",Ga,[Ya,c("  "),T(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.selectedStructure=o),class:"form-select",name:"structure"},[(n(!0),a(v,null,y(r.structures,o=>(n(),a("option",{value:o.id},m(o.libelle),9,Ja))),256))],512),[[U,l.selectedStructure]])]),e("div",Wa,[Qa,e("button",{id:"btn-rdmep",disabled:!l.selectedStructure,class:"btn btn-primary",type:"button",onClick:t[1]||(t[1]=(...o)=>i.findDemandeMiseEnPaiement&&i.findDemandeMiseEnPaiement(...o))}," Lancer la recherche ",8,Xa)])])])]),Za,i.haveDotation?(n(),a("div",Ka,[l.alertDotation?(n(),a("div",eo," Attention vous dépassez vos dotations, vous ne pourrez pas enclencher les demandes de mise en paiement par lot. Veuillez ajuster votre sélection d'intervenants pour faire les demandes de mise en paiement. ")):u("",!0),e("table",to,[so,e("tbody",null,[e("tr",null,[ro,e("td",null,m(i.formattedHETD(this.dotation.paieEtat))+" HETD",1),e("td",null,m(i.formattedHETD(this.dotation.ressourcePropre))+" HETD",1),e("td",io,m(i.formattedHETD(this.dotation.total))+" HETD",1)]),e("tr",null,[no,e("td",null,[e("span",{class:D(i.alertPaieEtat)},m(i.formattedHETD(this.totalConsommationPaieEtat))+" HETD",3)]),e("td",null,[e("span",{class:D(i.alertRessourcePropre)},m(i.formattedHETD(this.totalConsommationRessourcePropre))+" HETD",3)]),e("td",ao,m(i.formattedHETD(this.totalConsommation))+" HETD",1)])])])])):u("",!0),e("div",oo,[e("form",lo,[this.permanents.length>0?(n(),a("div",uo,[e("h2",co,[e("button",mo,m(this.permanents.length)+" Permanent(s) ",1)]),e("div",ho,[e("div",_o,[e("table",fo,[e("thead",null,[e("tr",null,[e("th",po,[e("input",{id:"allPermanents",checked:"checked",class:"checkbox-permanent",name:"allPermanents",type:"checkbox",onClick:t[2]||(t[2]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),vo,bo,go])]),e("tbody",null,[(n(!0),a(v,null,y(this.permanents,o=>(n(),a("tr",null,[e("td",null,[e("input",{id:"permanent-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-permanent",type:"checkbox",onChange:t[3]||(t[3]=d=>i.refreshTotalConsommation())},null,40,yo)]),e("td",null,m(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),1),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre"},m(i.totalPayable(o.heures))+" h",9,xo)]),e("td",null,m(i.totalNonPayable(o.heures))+" h",1)]))),256))])])])])])):u("",!0),this.vacataires.length>0?(n(),a("div",ko,[e("h2",Co,[e("button",Vo,m(this.vacataires.length)+" Vacataire(s) ",1)]),e("div",Eo,[e("div",Do,[e("table",Po,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allVacataire",checked:"checked",class:"checkbox-vacataire",name:"allVacataire",type:"checkbox",onClick:t[4]||(t[4]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),To,So,Mo])]),e("tbody",null,[(n(!0),a(v,null,y(this.vacataires,o=>(n(),a("tr",null,[e("td",null,[e("input",{id:"vacataire-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-vacataire",type:"checkbox",onChange:t[5]||(t[5]=d=>i.refreshTotalConsommation())},null,40,Ro)]),e("td",null,[e("a",{href:i.urlIntervenant(o),target:"_blank"},m(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),9,wo)]),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre"},m(i.totalPayable(o.heures))+" h",9,jo)]),e("td",null,m(i.totalNonPayable(o.heures))+" h",1)]))),256))])])])])])):u("",!0),this.etudiants.length>0?(n(),a("div",Uo,[e("h2",Ao,[e("button",$o,m(this.etudiants.length)+" Etudiant(s) ",1)]),e("div",Io,[e("div",Lo,[e("table",qo,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allEtudiants",checked:"checked",class:"checkbox-etudiant",name:"allEtudiants",type:"checkbox",onClick:t[6]||(t[6]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),Ho,Oo,Fo])]),e("tbody",null,[(n(!0),a(v,null,y(this.etudiants,o=>(n(),a("tr",null,[e("td",null,[e("input",{id:"etudiant-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-etudiant",type:"checkbox",onChange:t[7]||(t[7]=d=>i.refreshTotalConsommation())},null,40,Bo)]),e("td",null,m(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),1),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre"},m(i.totalPayable(o.heures))+" h",9,No)]),e("td",null,m(i.totalNonPayable(o.heures))+" h",1)]))),256))])])])])])):u("",!0),this.autres.length>0?(n(),a("div",zo,[e("h2",Go,[e("button",Yo,m(this.autres.length)+" Autre(s) ",1)]),e("div",Jo,[e("div",Wo,[e("table",Qo,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allAutres",checked:"checked",class:"checkbox-autre",name:"allAutres",type:"checkbox",onClick:t[8]||(t[8]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),Xo,Zo,Ko])]),e("tbody",null,[(n(!0),a(v,null,y(this.etudiants,o=>(n(),a("tr",null,[e("td",null,[e("input",{id:"autre-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-autre",type:"checkbox",onChange:t[9]||(t[9]=d=>i.refreshTotalConsommation())},null,40,el)]),e("td",null,m(o.datasIntervenant.prenom+" "+o.datasIntervenant.nom_usuel),1),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre"},m(i.totalPayable(o.heures))+" h",9,tl)]),e("td",null,m(i.totalNonPayable(o.heures))+" h",1)]))),256))])])])])])):u("",!0),this.intervenants.length>0?(n(),a("div",sl,[rl,e("button",{id:"btn-pdmep",disabled:this.alertDotation,class:"btn btn-primary",type:"button",onClick:t[10]||(t[10]=(...o)=>i.processDemandeMiseEnPaiement&&i.processDemandeMiseEnPaiement(...o))}," Enregistrer les demandes de paiement ",8,il)])):u("",!0)])])],64)}const al=x(Ha,[["render",nl]]),ol=Object.freeze(Object.defineProperty({__proto__:null,default:al},Symbol.toStringTag,{value:"Module"})),ll={props:{canImportPec:{type:Boolean,required:!1}},data(){return{selectedFile:null,importUrl:unicaenVue.url("paiement/import-numero-pec"),fileErrors:null,intervenantMissing:null,messageErrors:null,messageConfirm:null}},mounted(){},methods:{handleFileUpload(s){this.selectedFile=s.target.files[0],this.fileErrors=null,this.intervenantMissing=null,this.messageErrors=null,this.messageConfirm=null,document.getElementById("btn-import").disabled=!1},importFile(s){s.preventDefault(),this.messageErrors=null,this.messageConfirm=null;let t=document.getElementById("btn-import"),r=document.getElementById("btn-import-inprogress");r.classList.remove("d-none"),t.classList.add("d-none"),t.disabled=!0;let h=document.getElementById("formImport"),l=new FormData(h);unicaenVue.axios.post(this.importUrl,l,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{let o=i.data;this.fileErrors=o.file,this.intervenantMissing=o.intervenant,o.message.length!=0?this.messageErrors=o.message:this.messageConfirm="Importation des numéros de prise en charge réalisée avec succés !",t.disabled=!1,r.classList.add("d-none"),t.classList.remove("d-none")}).catch(i=>{console.error("Error uploading")})}}},dl={class:"card text-dark bg-light"},ul=e("div",{class:"card-header text-uppercase fw-bold"}," Importation des numéros de prise en charge ",-1),cl={class:"card-body"},ml={key:0,class:"alert alert-danger",role:"alert"},hl={key:1,class:"alert alert-success",role:"alert"},_l={id:"formImport",action:"",enctype:"multipart/form-data",method:"post"},fl=e("p",{class:"fs-9 text"},[c(" Vous pouvez utiliser le modèle directement extrait de winpaie ou télécharger le modèle d'import générique en "),e("a",{href:"/modeles/import-numero-pec.xlsx"},"cliquant ici.")],-1),pl={class:"mb-3"},vl=e("label",{class:"form-label",for:"importFile"},"Choisissez le fichier à importer :",-1),bl=K('<div class="mb-3"><label class="form-label" for="modele">Choisissez le modèle d&#39;import :</label>  <select id="modeleImport" class="form-select" name="modeleImport"><option value="winpaie">Winpaie</option><option value="generic">Generique (Modèle à 3 colonnes)</option></select></div>',1),gl={class:"mb-3"},yl=e("button",{id:"btn-import-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),c("  Veuillez patienter... ")],-1),xl={key:0,id:"fileErrors",class:"card text-dark bg-light"},kl=e("div",{class:"card-header text-uppercase fw-bold"}," Rapport de chargement du fichier ",-1),Cl={class:"card-body"},Vl={key:0},El=e("p",null,"Listes des intervenants du fichier dont le numéro INSEE n'est pas valide : ",-1),Dl={key:1},Pl=e("p",null,"Listes des intervenants présents dans le fichier mais non trouvés dans OSE : ",-1);function Tl(s,t,r,h,l,i){return n(),a(v,null,[e("div",dl,[ul,e("div",cl,[this.messageErrors?(n(),a("div",ml,m(this.messageErrors),1)):u("",!0),this.messageConfirm?(n(),a("div",hl,m(this.messageConfirm),1)):u("",!0),e("form",_l,[fl,e("div",pl,[vl,c("  "),e("input",{class:"form-control",name:"importFile",type:"file",onChange:t[0]||(t[0]=(...o)=>i.handleFileUpload&&i.handleFileUpload(...o))},null,32)]),bl,e("div",gl,[yl,e("button",{id:"btn-import",class:"btn btn-primary",disabled:"",type:"button",onClick:t[1]||(t[1]=(...o)=>i.importFile&&i.importFile(...o))}," Importer les numéros de prise en charge ")])])])]),this.fileErrors||this.intervenantMissing?(n(),a("div",xl,[kl,e("div",Cl,[this.fileErrors.length!=0?(n(),a("div",Vl,[El,e("ul",null,[(n(!0),a(v,null,y(this.fileErrors,o=>(n(),a("li",null,m(),1))),256))])])):u("",!0),this.intervenantMissing.length!=0?(n(),a("div",Dl,[Pl,e("ul",null,[(n(!0),a(v,null,y(this.intervenantMissing,o=>(n(),a("li",null,m(o),1))),256))])])):u("",!0)])])):u("",!0)],64)}const Sl=x(ll,[["render",Tl]]),Ml=Object.freeze(Object.defineProperty({__proto__:null,default:Sl},Symbol.toStringTag,{value:"Module"})),Rl={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(s){modAjax(s.target,t=>{this.$emit("refreshListe")})},ajoutValeur(s){modAjax(s.target,t=>{this.$emit("refreshListe")})},saisieValeur(s){s.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:s.currentTarget.dataset.id}),modAjax(s.currentTarget,t=>{this.$emit("refreshListe")})},refreshListe(s){this.$emit("refreshListe")},supprimer(s){popConfirm(s.target,t=>{this.$emit("refreshListe")})},supprimerValeur(s){s.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:s.currentTarget.dataset.id}),popConfirm(s.currentTarget,t=>{this.$emit("refreshListe")})},refresh(s){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:s.id})).then(t=>{this.$emit("refresh",t.data)})}}},wl={class:"card-header"},jl={style:{display:"inline"}},Ul={class:"float-end"},Al=["href"],$l=["href"],Il={class:"card-body"},Ll={key:0},ql=e("br",null,null,-1),Hl={class:""},Ol={class:"row align-items-start"},Fl={class:"col-md-6"},Bl={class:"col"},Nl=["data-id"],zl=["data-id"],Gl=["href"],Yl={key:1,class:"row"},Jl={class:"col-md-7"},Wl=e("br",null,null,-1),Ql={class:"row align-items-start"},Xl={class:"col-md-8"},Zl={class:"col-md-auto"},Kl=["data-id"],ed=["data-id"],td=["href"],sd={class:"col"},rd=e("br",null,null,-1),id={key:0},nd={key:0};function ad(s,t,r,h,l,i){const o=S,d=E("u-heures"),_=M,k=E("taux",!0);return n(),a(v,null,[e("div",{class:D(["card",{"ms-5":r.taux.tauxRemu}])},[e("div",wl,[e("h3",jl,m(r.taux.libelle)+" ("+m(r.taux.code)+")",1),e("div",Ul,[r.taux.canEdit?(n(),a("a",{key:0,href:l.saisieUrl,class:"btn btn-primary",onClick:t[0]||(t[0]=b((...g)=>i.saisie&&i.saisie(...g),["prevent"]))},[f(o,{name:"pen-to-square"}),c(" Modifier")],8,Al)):u("",!0),c("   "),r.taux.canDelete?(n(),a("a",{key:1,href:l.supprimerUrl,class:"btn btn-danger",onClick:t[1]||(t[1]=b((...g)=>i.supprimer&&i.supprimer(...g),["prevent"]))},[f(o,{name:"trash-can"}),c(" Supprimer")],8,$l)):u("",!0)])]),e("div",Il,[r.taux.tauxRemu?u("",!0):(n(),a("div",Ll,[c(" Modification :"),ql,e("ul",null,[(n(!0),a(v,null,y(r.taux.tauxRemuValeurs,g=>(n(),a("div",{key:g.id},[e("li",Hl,[e("div",Ol,[e("div",Fl,[f(d,{valeur:g.valeur},null,8,["valeur"]),c("€/h à partir du "),f(_,{value:g.dateEffet},null,8,["value"])]),e("div",Bl,[r.taux.canEdit?(n(),a("a",{key:0,class:"text-primary",onClick:t[2]||(t[2]=b((...p)=>i.saisieValeur&&i.saisieValeur(...p),["prevent"])),"data-id":g.id},[f(o,{name:"pen-to-square"})],8,Nl)):u("",!0),c("   "),r.taux.canEdit?(n(),a("a",{key:1,class:"text-primary",onClick:t[3]||(t[3]=b((...p)=>i.supprimerValeur&&i.supprimerValeur(...p),["prevent"])),"data-id":g.id},[f(o,{name:"trash-can"})],8,zl)):u("",!0)])])])]))),128))]),r.taux.canEdit?(n(),a("a",{key:0,href:l.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:t[4]||(t[4]=b((...g)=>i.ajoutValeur&&i.ajoutValeur(...g),["prevent"]))},[f(o,{name:"plus"}),c(" Ajouter une valeur ")],8,Gl)):u("",!0)])),r.taux.tauxRemu?(n(),a("div",Yl,[e("div",Jl,[c(" Modification :"),Wl,e("ul",null,[(n(!0),a(v,null,y(r.taux.tauxRemuValeurs,g=>(n(),a("div",null,[e("li",null,[e("div",Ql,[e("div",Xl,[c(" Coéfficient de "),f(d,{valeur:g.valeur},null,8,["valeur"]),c(" à partir du "),f(_,{value:g.dateEffet},null,8,["value"])]),e("div",Zl,[r.taux.canEdit?(n(),a("a",{key:0,class:"text-primary",onClick:t[5]||(t[5]=b((...p)=>i.saisieValeur&&i.saisieValeur(...p),["prevent"])),"data-id":g.id},[f(o,{name:"pen-to-square"})],8,Kl)):u("",!0),c("   "),r.taux.canEdit?(n(),a("a",{key:1,class:"text-primary",onClick:t[6]||(t[6]=b((...p)=>i.supprimerValeur&&i.supprimerValeur(...p),["prevent"])),"data-id":g.id},[f(o,{name:"trash-can"})],8,ed)):u("",!0)])])])]))),256))]),r.taux.canEdit?(n(),a("a",{key:0,href:l.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:t[7]||(t[7]=b((...g)=>i.ajoutValeur&&i.ajoutValeur(...g),["prevent"]))},[f(o,{name:"plus"})],8,td)):u("",!0)]),e("div",sd,[c(" Valeurs calculées (indexées sur le taux "+m(r.taux.tauxRemu.libelle)+") : ",1),e("ul",null,[(n(!0),a(v,null,y(r.taux.tauxRemuValeursIndex,g=>(n(),a("div",null,[e("li",null,[f(d,{valeur:g.valeur},null,8,["valeur"]),c("€/h à partir du "),f(_,{value:g.date},null,8,["value"])])]))),256))]),rd])])):u("",!0)])],2),r.taux.tauxRemu?u("",!0):(n(),a("div",id,[(n(!0),a(v,null,y(r.listeTaux,g=>(n(),a("div",{key:g},[g.tauxRemu&&g.tauxRemu.id===r.taux.id?(n(),a("div",nd,[(n(),C(k,{onSupprimer:i.supprimer,onRefreshListe:i.refreshListe,key:r.taux.id,taux:g,listeTaux:r.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):u("",!0)]))),128))]))],64)}const J=x(Rl,[["render",ad]]),od=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"})),ld={components:{taux:J},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(s){modAjax(s.currentTarget,t=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(s){let t=Util.json.indexById(this.listeTaux,s.id);this.listeTaux[t]=s},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(s=>{this.listeTaux=s.data})}}},dd=["href"];function ud(s,t,r,h,l,i){const o=E("taux");return n(),a(v,null,[(n(!0),a(v,null,y(l.listeTaux,d=>(n(),a("div",null,[d.tauxRemu?u("",!0):(n(),C(o,{onSupprimer:i.supprimer,onRefreshListe:i.refreshListe,key:d.id,taux:d,listeTaux:l.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),r.canEditTaux?(n(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:t[0]||(t[0]=b((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Ajout d'un nouveau taux",8,dd)):u("",!0)],64)}const cd=x(ld,[["render",ud]]),md=Object.freeze(Object.defineProperty({__proto__:null,default:cd},Symbol.toStringTag,{value:"Module"})),hd={UHeures:"Application/UI/UHeures",Utilisateur:"Application/Utilisateur"};function _d(s,t){const r={};t===void 0&&(t={});for(const h in s){let i=h.slice(2,-4).replace("/","");r[i]=s[h].default}for(const h of document.getElementsByClassName("vue-app")){let l=ee({template:h.innerHTML,components:r});if(t.beforeMount!==void 0&&t.beforeMount(l),t.autoloads!==void 0)for(const i in t.autoloads){let o=t.autoloads[i].replace("/","");l.component(i,r[o])}l.mount(h),t.afterMount!==void 0&&t.afterMount(l)}}const fd={init:_d},pd=Object.assign({"./Application/UI/UHeures.vue":ne,"./Application/Utilisateur.vue":ue,"./Intervenant/Recherche.vue":we,"./Lieu/Structure.vue":_t,"./Lieu/StructuresAdmin.vue":kt,"./Mission/Liste.vue":zs,"./Mission/ListeCandidatures.vue":br,"./Mission/ListeOffreEmploi.vue":Yi,"./Mission/ListePrime.vue":Kn,"./Mission/Mission.vue":Hs,"./Mission/OffreEmploi.vue":qi,"./Mission/Prime.vue":On,"./Mission/Suivi.vue":ja,"./Mission/SuiviEvent.vue":Sa,"./Paiement/DemandeMiseEnPaiementLot.vue":ol,"./Paiement/ImportNumeroPec.vue":Ml,"./Paiement/ListeTaux.vue":md,"./Paiement/Taux.vue":od}),vd={autoloads:hd};fd.init(pd,vd);
