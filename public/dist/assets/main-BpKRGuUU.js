import{c as o,a as t,n as A,t as d,b,d as h,e as f,w as M,F as g,B as ce,o as l,r as x,f as _,v as he,g as R,h as E,_ as z,M as pe,i as N,j as J,k as Y,l as fe,m as P,p as B,q as U,s as Q,u as D,x as y,y as L,z as W,A as be,C as ve,D as _e,E as ge,G as ye}from"./vendor-Rl39KpUh.js";const k=(n,e)=>{const r=n.__vccOpts||n;for(const[p,i]of e)r[p]=i;return r},xe={name:"Connexion",props:{data:Object},data(){return{identity:"",currentRoleId:null,selectedStructures:{}}},mounted(){this.currentRoleId=this.data.roleId;for(let n in this.data.roles)this.selectedStructures[n]=-1;this.selectedStructures[this.currentRoleId]=this.data.structureId??-1},methods:{userProfileChange(n){let e=this.selectedStructures[n];e==-1&&(e=null),n!=this.currentRoleId&&(this.currentRoleId=n),document.body.classList.add("wait-cursor"),unicaenVue.axios.post(this.selectionProfilUrl,{role:n,structure:e}).then(r=>{window.location.href=unicaenVue.url("")})}},computed:{roleIcon(){return this.data.usurpationEnCours?"fa fa-theater-masks":"fa fa-user"},roleContent(){return"coucou!!!"},connexionUrl(){return this.data.connecte?unicaenVue.url("auth/deconnexion"):unicaenVue.url("auth/connexion")},connexionTitle(){return this.data.connecte?"Supprime les informations de connexion":"Affiche le formulaire d'authentification"},connexionContent(){return this.data.connecte?"Déconnexion":"Connexion"},startUsurpationUrl(){return unicaenVue.url("utilisateur/usurper-identite")},stopUsurpationUrl(){return unicaenVue.url("utilisateur/stopper-usurpation")},selectionProfilUrl(){return unicaenVue.url("utilisateur/selectionner-profil")}}},Ce={key:0,class:"navbar-link",id:"user-current-info",href:"#"},Ve={id:"user-status"},Se={id:"user-status-name"},ke={key:1},Pe=["href","title"],Ae={method:"POST",class:"user-profile-select-form"},De=["value","onClick"],Te=["onUpdate:modelValue","onChange"],Me=["value"],Ue={key:0},Ee=["action"],Fe={class:"mb-2"},Re={class:"mb-2"},we=["disabled"],Ie={key:1};function He(n,e,r,p,i,s){const u=z,c=ce;return l(),o(g,null,[r.data.connecte?(l(),o("a",Ce,[t("span",Ve,[t("span",{class:A(s.roleIcon)},null,2),e[2]||(e[2]=t("span",{class:"caret"}," ",-1)),t("span",Se,[t("strong",null,d(r.data.utilisateurNom),1),b(", "+d(r.data.roleNom),1)])])])):h("",!0),r.data.connecte?(l(),o("span",ke,"|")):h("",!0),t("a",{class:"navbar-link user-connection",href:s.connexionUrl,title:s.connexionUrl},d(s.connexionContent),9,Pe),f(c,{click:!0,"close-on-hide":!0,delay:{show:0,hide:0},target:"user-current-info"},{title:M(()=>e[3]||(e[3]=[b("Utilisateur connecté à l'application")])),default:M(()=>[e[8]||(e[8]=t("div",null,[t("strong",null,"Profil utilisateur :")],-1)),t("div",null,[t("form",Ae,[(l(!0),o(g,null,x(r.data.roles,(m,a)=>(l(),o("div",{key:a,class:"radio"},[t("label",null,[_(t("input",{type:"radio",name:"role",class:"user-profile-select-input",title:"Cliquez pour changer de profil courant",value:a,onClick:C=>s.userProfileChange(a),"onUpdate:modelValue":e[0]||(e[0]=C=>i.currentRoleId=C)},null,8,De),[[he,i.currentRoleId]]),b(d(m.libelle),1)]),e[5]||(e[5]=b("  ")),r.data.roles[a].peutChangerStructure?_((l(),o("select",{key:0,class:"user-profile-select-input-structure","onUpdate:modelValue":C=>i.selectedStructures[a]=C,onChange:C=>s.userProfileChange(a),title:"Cliquez pour sélectionner la structure associée au profil Administrateur"},[e[4]||(e[4]=t("option",{value:"-1"},"- toutes structures -",-1)),(l(!0),o(g,null,x(r.data.structures,(C,v)=>(l(),o("option",{key:v,value:v},d(C),9,Me))),128))],40,Te)),[[R,i.selectedStructures[a]]]):h("",!0)]))),128))])]),r.data.usurpationEnabled&&!r.data.usurpationEnCours?(l(),o("div",Ue,[t("form",{action:s.startUsurpationUrl},[e[6]||(e[6]=t("div",null,[t("strong",null,"Usurpation d'identité :")],-1)),t("div",Fe,[_(t("input",{type:"text",name:"identity","onUpdate:modelValue":e[1]||(e[1]=m=>i.identity=m),class:"user-usurpation-input form-control",placeholder:"Identifiant utilisateur",value:""},null,512),[[E,i.identity]])]),t("div",Re,[t("input",{type:"submit",name:"submit",disabled:!i.identity,class:"user-usurpation-submit btn btn-danger form-control",value:"Usurper"},null,8,we)])],8,Ee)])):h("",!0),r.data.usurpationEnabled&&r.data.usurpationEnCours?(l(),o("div",Ie,[f(u,{variant:"danger",href:s.stopUsurpationUrl},{default:M(()=>e[7]||(e[7]=[b("Stopper l'usurpation")])),_:1},8,["href"])])):h("",!0)]),_:1})],64)}const Le=k(xe,[["render",He],["__scopeId","data-v-cbfe77c3"]]),je=Object.freeze(Object.defineProperty({__proto__:null,default:Le},Symbol.toStringTag,{value:"Module"})),Ne={data(){return{modal:null,resolveFn:null,message:"",title:"Confirmation"}},mounted(){this.modal=new pe(this.$refs.modalEl,{backdrop:"static",keyboard:!0}),this.$refs.modalEl.addEventListener("hidden.bs.modal",()=>{this.resolveFn&&(this.resolveFn(!1),this.resolveFn=null)})},methods:{open(n,e="Confirmation"){return this.message=n,this.title=e,this.modal.show(),new Promise(r=>{this.resolveFn=r})},confirmAction(){this.resolveFn&&this.resolveFn(!0),this.resolveFn=null,this.modal.hide()}}},Oe={class:"modal fade",tabindex:"-1",ref:"modalEl","aria-hidden":"true"},qe={class:"modal-dialog modal-dialog-centered"},ze={class:"modal-content"},Be={class:"modal-header"},$e={class:"modal-title"},Ge={class:"modal-body"},Je={class:"modal-footer"};function Ye(n,e,r,p,i,s){return l(),o("div",Oe,[t("div",qe,[t("div",ze,[t("div",Be,[t("h5",$e,d(i.title),1),e[1]||(e[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),t("div",Ge,d(i.message),1),t("div",Je,[e[2]||(e[2]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Annuler",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...u)=>s.confirmAction&&s.confirmAction(...u))},"Confirmer")])])])],512)}const Qe=k(Ne,[["render",Ye]]),We=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"})),Xe={props:{valeur:{required:!0,type:Number}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},Ke=["innerHTML"];function Ze(n,e,r,p,i,s){return l(),o("span",{class:"heures",innerHTML:s.affichage},null,8,Ke)}const et=k(Xe,[["render",Ze]]),tt=Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"})),nt={name:"UInputFloat",props:{modelValue:{},isPourc:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},class:{type:String,required:!1,default:""},fraction:{type:Boolean,required:!1,default:!1},maximumDigits:{required:!1,default:8}},data(){return{fractions:{.333333:"1/3",.166667:"1/6",.142857:"1/7",.111111:"1/9",.666667:"2/3",.285714:"2/7",.222222:"2/9",.428571:"3/7",1.333333:"4/3",.571429:"4/7",.444444:"4/9",1.666667:"5/3",.833333:"5/6",.714286:"5/7",.555556:"5/9",.857143:"6/7",2.333333:"7/3",1.166667:"7/6",.777778:"7/9",2.666667:"8/3",1.142857:"8/7",.888889:"8/9",1.285714:"9/7"},inError:!1}},emits:["update:modelValue"],computed:{value:{get(){let n=this.modelValue;return this.isPourc&&(n*=100),this.floatToString(n)},set(n){const e=/^-?\d*\.?\d+$/;if(this.inError=n!==void 0&&n!==""&&!e.test(n.replace("/","").replace(",","").replace(".","")),!this.inError){let r=this.stringToFloat(n);this.isPourc&&(r/=100),(r===void 0||!isNaN(r)&&isFinite(r))&&this.$emit("update:modelValue",r)}}},cclass(){let n=this.class;return this.inError&&(n+=" is-invalid"),n}},methods:{floatToString(n){if(n==null)return;const e=Math.round(n*1e6)/1e6;if(this.fraction&&this.fractions[e]!==void 0)return this.fractions[e];var r="fr",p={minimumFractionDigits:0,maximumFractionDigits:this.maximumDigits,useGrouping:!1},i=new Intl.NumberFormat(r,p);return i.format(n)},stringToFloat(n){if(!(n===null||n===""||n===void 0))return n.indexOf("/")!==-1?(n=n.split("/"),n=Util.stringToFloat(n[0])/Util.stringToFloat(n[1])):n=parseFloat(n.replace(",",".")),n}},mounted(){}},rt=["disabled"];function st(n,e,r,p,i,s){return _((l(),o("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>s.value=u),disabled:r.disabled,ref:"inputFloat",class:A(s.cclass)},null,10,rt)),[[E,s.value]])}const it=k(nt,[["render",st],["__scopeId","data-v-29c90e6d"]]),lt=Object.freeze(Object.defineProperty({__proto__:null,default:it},Symbol.toStringTag,{value:"Module"})),ot={name:"Utilisateur",props:{nom:String,mail:String}},at=["href"];function ut(n,e,r,p,i,s){return l(),o("a",{href:`mailto:${r.mail}`},d(r.nom),9,at)}const dt=k(ot,[["render",ut]]),mt=Object.freeze(Object.defineProperty({__proto__:null,default:dt},Symbol.toStringTag,{value:"Module"})),ct={name:"UTableAjax",emits:["update:modelValue"],props:{modelValue:{required:!0},id:{required:!1,type:String},size:{required:!1,default:10},count:{required:!1},search:{required:!1},dataUrl:{required:!0,type:String}},data(){return{page:1,pageSizes:[10,25,50,100,"Tous"],defaultSize:10,dSize:this.size,dCount:this.count,dSearch:this.search,searchTimer:null,columns:{},loading:!1,orderCol:void 0,orderDir:"asc"}},computed:{cSize(){return isNaN(this.dSize)?9999999999999:this.dSize},storageIdentifier(){return"UTableAjax-"+this.id+"-"+window.location.href},elStart(){return isNaN(this.dSize)?1:(this.page-1)*this.dSize+1},elEnd(){return isNaN(this.dCount)?(this.page-1)*this.dSize+this.dSize:isNaN(this.dSize)?this.dCount:Math.min(this.dCount,(this.page-1)*this.dSize+this.dSize)}},watch:{dSize(n){localStorage.setItem(this.storageIdentifier,n),this.getData()},dSearch(n){const e=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.page>1?this.page=1:e.getData()},500)},page(n){this.getData()}},methods:{getData(){unicaenVue.axios.post(this.dataUrl,{page:this.page,size:this.dSize,elStart:this.elStart,elEnd:this.elEnd,search:this.dSearch,orderCol:this.orderCol,orderDir:this.orderDir}).then(n=>{let e=n.data;this.dCount=e.count,this.$emit("update:modelValue",e.data)})},orderBy(n){const e=this.columns[n];for(let p in this.columns)p!=n&&(this.columns[p].classList.contains("sorting_asc")&&this.columns[p].classList.remove("sorting_asc"),this.columns[p].classList.contains("sorting_desc")&&this.columns[p].classList.remove("sorting_desc"),console.log(p));let r="asc";e.classList.contains("sorting_asc")?(r="desc",e.classList.remove("sorting_asc"),e.classList.add("sorting_desc")):(e.classList.contains("sorting_desc")&&e.classList.remove("sorting_desc"),e.classList.add("sorting_asc")),this.orderCol=n,this.orderDir=r,this.getData()}},mounted(){this.dSize=parseInt(localStorage.getItem(this.storageIdentifier))||this.defaultSize,this.page=1,this.dSize=this.size,this.dCount=this.count;const n=this.$refs.tableRef,e=this;n&&n.querySelectorAll("th[column]").forEach(p=>{Array.from(p.attributes).forEach(i=>{i.name=="column"&&(this.columns[i.value]=p,p.dataset.column=i.value,p.onclick=function(){e.orderBy(this.dataset.column)},p.removeAttribute(i.name),p.classList.add("sorting"))})}),this.getData()}},ht={class:"dt-bootstrap5"},pt=["value"],ft={class:"float-end"},bt={class:"table table-bordered dataTable mb-2",ref:"tableRef"},vt={class:"dataTables_paginate paging_simple_numbers"};function _t(n,e,r,p,i,s){const u=J,c=Y,m=fe;return l(),o("div",ht,[f(c,null,{default:M(()=>[f(u,null,{default:M(()=>[e[3]||(e[3]=b(" Afficher ")),t("label",null,[_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>i.dSize=a),class:"form-select form-select-sm"},[(l(!0),o(g,null,x(i.pageSizes,a=>(l(),o("option",{key:a,value:a},d(a),9,pt))),128))],512),[[R,i.dSize]])]),e[4]||(e[4]=b(" éléments "))]),_:1}),f(u,null,{default:M(()=>[t("div",ft,[e[5]||(e[5]=b(" Rechercher : ")),t("label",null,[_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>i.dSearch=a),class:"form-control form-inline form-control-sm"},null,512),[[E,i.dSearch]])])])]),_:1})]),_:1}),t("table",bt,[N(n.$slots,"default")],512),f(c,null,{default:M(()=>[f(u,null,{default:M(()=>[b("Affichage de l'élément "+d(s.elStart)+" à "+d(s.elEnd)+" sur "+d(i.dCount)+" éléments",1)]),_:1}),f(u,null,{default:M(()=>[t("div",vt,[f(m,{align:"end",page:i.page,modelValue:i.page,"onUpdate:modelValue":e[2]||(e[2]=a=>i.page=a),"total-rows":i.dCount,"per-page":s.cSize,"last-number":"true",firstNumber:"true","prev-text":"Précédent","next-text":"Suivant"},null,8,["page","modelValue","total-rows","per-page"])])]),_:1})]),_:1})])}const G=k(ct,[["render",_t]]),gt={name:"listeEmployeur",data(){return{dataUrl:unicaenVue.url("employeur/get-data"),dataNewEmployeur:unicaenVue.url("employeur/saisie"),lines:[]}},methods:{saisie(n){modAjax(n.currentTarget,e=>{this.$refs.employeurs.getData()})},editUrl(n){return unicaenVue.url("employeur/saisie/:id",{id:n})}}},yt={key:0},xt=["href"],Ct={key:1},Vt=["href"];function St(n,e,r,p,i,s){const u=G;return l(),o(g,null,[e[5]||(e[5]=t("h1",{class:"page-header"},"Gestion des employeurs",-1)),f(u,{ref:"employeurs",modelValue:i.lines,"onUpdate:modelValue":e[1]||(e[1]=c=>i.lines=c),"data-url":this.dataUrl},{default:M(()=>[e[3]||(e[3]=t("thead",null,[t("tr",null,[t("th",{column:"ID"},"Id"),t("th",{column:"RAISON_SOCIALE"},"Raison sociale"),t("th",{column:"NOM_COMMERCIAL"},"Nom commercial"),t("th",null,"Siren"),t("th",null," ")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(i.lines,(c,m)=>(l(),o("tr",{key:m},[t("td",null,d(c.ID),1),t("td",null,d(c.RAISON_SOCIALE),1),t("td",null,d(c.NOM_COMMERCIAL),1),t("td",null,d(c.SIREN),1),c.IMPORTABLE==0?(l(),o("td",yt,[c.IMPORTABLE==0?(l(),o("a",{key:0,href:s.editUrl(c.ID),onClick:e[0]||(e[0]=P((...a)=>s.saisie&&s.saisie(...a),["prevent"]))},"Modifier",8,xt)):h("",!0)])):h("",!0),c.IMPORTABLE==1?(l(),o("td",Ct," NON MODIFIABLE ")):h("",!0)]))),128))])]),_:1},8,["modelValue","data-url"]),t("a",{class:"btn btn-primary",onClick:e[2]||(e[2]=P((...c)=>s.saisie&&s.saisie(...c),["prevent"])),href:this.dataNewEmployeur,title:"Ajouter un employeur"},e[4]||(e[4]=[t("i",{class:"fas fa-plus"},null,-1),b(" Ajout d'un employeur")]),8,Vt)],64)}const kt=k(gt,[["render",St]]),Pt=Object.freeze(Object.defineProperty({__proto__:null,default:kt},Symbol.toStringTag,{value:"Module"})),At={name:"Details",components:{},props:{formule:{type:Object},phpClass:{type:String}},methods:{indexUrl(){return unicaenVue.url("formule/administration")}}},Dt=["innerHTML"],Tt={class:"mb-2"},Mt=["href"];function Ut(n,e,r,p,i,s){return l(),o(g,null,[t("h1",null,"Code source de "+d(r.formule.code),1),t("div",{innerHTML:r.phpClass,class:"code"},null,8,Dt),t("div",Tt,[t("a",{class:"btn btn-secondary",href:this.indexUrl()},e[0]||(e[0]=[t("i",{class:"fas fa-rotate-left"},null,-1),b(" Retour à l'administration des formules")]),8,Mt)])],64)}const Et=k(At,[["render",Ut]]),Ft=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Rt={name:"Formulator",components:{},props:{phpClass:{type:String},error:{type:String}},methods:{indexUrl(){return unicaenVue.url("formule/administration")}}},wt={class:"mb-2"},It=["href"],Ht={key:0},Lt={class:"alert alert-danger"},jt={key:1},Nt={key:2},Ot=["innerHTML"];function qt(n,e,r,p,i,s){return l(),o(g,null,[e[3]||(e[3]=t("h1",null,"Formulator",-1)),t("div",wt,[t("a",{class:"btn btn-secondary",href:this.indexUrl()},e[0]||(e[0]=[t("i",{class:"fas fa-rotate-left"},null,-1),b(" Retour à l'administration des formules")]),8,It)]),r.error?(l(),o("div",Ht,[t("div",Lt,d(r.error),1)])):(l(),o("div",jt,e[1]||(e[1]=[t("div",{class:"alert alert-success"},"Formule bien intégrée",-1)]))),r.phpClass?(l(),o("div",Nt,[e[2]||(e[2]=t("h3",null,"Code généré :",-1)),t("div",{innerHTML:r.phpClass},null,8,Ot)])):h("",!0),b(" "+d(r.error),1)],64)}const zt=k(Rt,[["render",qt]]),Bt=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"})),$t={name:"Index",components:{},props:{formules:{required:!0,type:Array},canEdit:{required:!0,type:Boolean}},methods:{telechargementUrl(n){return unicaenVue.url("formule/administration/telecharger-tableur/"+n)},televersementUrl(){return unicaenVue.url("formule/administration/televerser-tableur")},detailsUrl(n){return unicaenVue.url("formule/administration/details/"+n)}}},Gt={class:"table table-bordered table-hover table-sort"},Jt=["title"],Yt={key:0,class:"cartridge"},Qt={key:1,class:"cartridge"},Wt={key:2,class:"cartridge"},Xt={key:3,class:"cartridge"},Kt={key:4,class:"cartridge"},Zt={key:5,class:"cartridge"},en={key:6,class:"cartridge"},tn={key:7,class:"cartridge"},nn={key:8,class:"cartridge"},rn={key:9,class:"cartridge"},sn={key:0},ln={key:1},on=["href"],an=["href"],un={key:0,class:"card bg-warning"},dn={class:"card-body"},mn=["action"];function cn(n,e,r,p,i,s){return l(),o(g,null,[e[28]||(e[28]=t("h1",null,"Formules de calcul",-1)),t("table",Gt,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",null,"Libellé"),t("th",null,"Paramètres"),t("th",null,"Règle de délégation"),t("th",null,"Ressources")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(r.formules,u=>(l(),o("tr",{key:n.id,class:A({desactivee:!u.active}),title:u.active?"":"Cette formule est désactivée"},[t("td",null,[b(d(u.libelle),1),e[0]||(e[0]=t("br",null,null,-1)),t("i",null,d(u.code),1)]),t("td",null,[u.iParam1Libelle?(l(),o("div",Yt,[e[1]||(e[1]=t("span",null,"intervenant",-1)),e[2]||(e[2]=t("span",null,"param1",-1)),b(" "+d(u.iParam1Libelle),1)])):h("",!0),u.iParam2Libelle?(l(),o("div",Qt,[e[3]||(e[3]=t("span",null,"intervenant",-1)),e[4]||(e[4]=t("span",null,"param2",-1)),b(" "+d(u.iParam2Libelle),1)])):h("",!0),u.iParam3Libelle?(l(),o("div",Wt,[e[5]||(e[5]=t("span",null,"intervenant",-1)),e[6]||(e[6]=t("span",null,"param3",-1)),b(" "+d(u.iParam3Libelle),1)])):h("",!0),u.iParam4Libelle?(l(),o("div",Xt,[e[7]||(e[7]=t("span",null,"intervenant",-1)),e[8]||(e[8]=t("span",null,"param4",-1)),b(" "+d(u.iParam4Libelle),1)])):h("",!0),u.iParam5Libelle?(l(),o("div",Kt,[e[9]||(e[9]=t("span",null,"intervenant",-1)),e[10]||(e[10]=t("span",null,"param5",-1)),b(" "+d(u.iParam5Libelle),1)])):h("",!0),u.vhParam1Libelle?(l(),o("div",Zt,[e[11]||(e[11]=t("span",null,"volume horaire",-1)),e[12]||(e[12]=t("span",null,"param1",-1)),b(" "+d(u.vhParam1Libelle),1)])):h("",!0),u.vhParam2Libelle?(l(),o("div",en,[e[13]||(e[13]=t("span",null,"volume horaire",-1)),e[14]||(e[14]=t("span",null,"param2",-1)),b(" "+d(u.vhParam2Libelle),1)])):h("",!0),u.vhParam3Libelle?(l(),o("div",tn,[e[15]||(e[15]=t("span",null,"volume horaire",-1)),e[16]||(e[16]=t("span",null,"param3",-1)),b(" "+d(u.vhParam3Libelle),1)])):h("",!0),u.vhParam4Libelle?(l(),o("div",nn,[e[17]||(e[17]=t("span",null,"volume horaire",-1)),e[18]||(e[18]=t("span",null,"param4",-1)),b(" "+d(u.vhParam4Libelle),1)])):h("",!0),u.vhParam5Libelle?(l(),o("div",rn,[e[19]||(e[19]=t("span",null,"volume horaire",-1)),e[20]||(e[20]=t("span",null,"param5",-1)),b(" "+d(u.vhParam5Libelle),1)])):h("",!0)]),u.delegationAnnee?(l(),o("td",sn,[b("Avant "+d(u.delegationAnnee)+"/"+d(u.delegationAnnee+1)+", utilise ",1),t("i",null,d(u.delegationFormule),1)])):(l(),o("td",ln)),t("td",null,[t("a",{href:this.telechargementUrl(u.id)},e[21]||(e[21]=[t("i",{class:"fas fa-table-cells"},null,-1),b(" tableur")]),8,on),e[23]||(e[23]=t("br",null,null,-1)),this.canEdit?(l(),o("a",{key:0,href:this.detailsUrl(u.id)},e[22]||(e[22]=[t("i",{class:"fas fa-table-cells"},null,-1),b(" code PHP")]),8,an)):h("",!0)])],10,Jt))),128))])]),e[29]||(e[29]=t("br",null,null,-1)),this.canEdit?(l(),o("div",un,[e[27]||(e[27]=t("div",{class:"card-header"},[t("h3",null,"Création/Modification d'une formule à partir d'un tableur")],-1)),t("div",dn,[e[26]||(e[26]=t("div",{class:"alert alert-warning"},[t("span",{class:"icon iconly icon-attention"}),t("strong",null,"Attention :"),b(" cette opération peut avoir un impact déterminant sur le calcul de vos heures complémentaires et par extension sur tous vos paiements. En outre, le fichier doit être bâti selon un modèle bien précis. Vous êtes invités à ne téléverser que des tableurs préparés ou validés par l'équipe OSE. ")],-1)),t("form",{method:"post",enctype:"multipart/form-data",action:this.televersementUrl()},e[25]||(e[25]=[B('<div class="form-group mb-3" data-v-ba77464f><label for="formule-name" data-v-ba77464f>Feuille de calcul (format Excel ou Calc)</label><input class="form-control" id="formule-fichier" type="file" name="fichier" data-v-ba77464f></div><div class="form-group" data-v-ba77464f><button type="submit" class="btn btn-primary" data-v-ba77464f>Ajout/Modification à partir d&#39;un tableur</button></div>',2)]),8,mn)])])):h("",!0)],64)}const hn=k($t,[["render",cn],["__scopeId","data-v-ba77464f"]]),pn=Object.freeze(Object.defineProperty({__proto__:null,default:hn},Symbol.toStringTag,{value:"Module"})),fn={name:"DetailsServiceEnseignement",components:{},props:{enseignement:{type:Object}},computed:{tauxFi(){return Util.floatToString(this.enseignement.tauxFi*100)+"% FI"},tauxFa(){return Util.floatToString(this.enseignement.tauxFa*100)+"% FA"},tauxFc(){return Util.floatToString(this.enseignement.tauxFc*100)+"% FC"}}},bn={key:0},vn={key:1},_n={key:0,class:"cartridge"},gn={class:"code"},yn={class:"code"},xn={key:1,class:"cartridge gray"},Cn={key:0};function Vn(n,e,r,p,i,s){const u=Q;return l(),o(g,null,[t("h6",null,[e[0]||(e[0]=b(" Enseignement ")),r.enseignement.elementPedagogique?h("",!0):(l(),o("span",bn," extérieur")),r.enseignement.elementPedagogique?(l(),o("span",vn,[f(u,null,{default:M(()=>[b(d(r.enseignement.structure.libelle),1)]),_:1}),r.enseignement.tauxFi>0?(l(),U(u,{key:0,variant:"light"},{default:M(()=>[b(d(s.tauxFi),1)]),_:1})):h("",!0),r.enseignement.tauxFa>0?(l(),U(u,{key:1,variant:"light"},{default:M(()=>[b(d(s.tauxFa),1)]),_:1})):h("",!0),r.enseignement.tauxFc>0?(l(),U(u,{key:2,variant:"light"},{default:M(()=>[b(d(s.tauxFc),1)]),_:1})):h("",!0)])):h("",!0)]),r.enseignement.elementPedagogique?(l(),o("div",_n,[t("span",null,[t("span",gn,d(r.enseignement.etape.code),1),b(" "+d(r.enseignement.etape.libelle),1)]),t("span",null,[t("span",yn,d(r.enseignement.elementPedagogique.code),1),b(" "+d(r.enseignement.elementPedagogique.libelle),1)])])):(l(),o("div",xn,[t("span",null,d(r.enseignement.etablissement.libelle),1),r.enseignement.description?(l(),o("span",Cn,d(r.enseignement.description),1)):h("",!0)]))],64)}const X=k(fn,[["render",Vn],["__scopeId","data-v-f6c21cf6"]]),Sn=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),kn={name:"DetailsServiceEnseignement",components:{},props:{referentiel:{type:Object}}},Pn={class:"cartridge"},An={key:0};function Dn(n,e,r,p,i,s){const u=Q;return l(),o(g,null,[t("h6",null,[e[0]||(e[0]=b(" Référentiel ")),f(u,null,{default:M(()=>[b(d(r.referentiel.structure.libelle),1)]),_:1})]),t("div",Pn,[t("span",null,d(r.referentiel.fonction.libelle),1),r.referentiel.description?(l(),o("span",An,d(r.referentiel.description),1)):h("",!0)])],64)}const K=k(kn,[["render",Dn]]),Tn=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),Mn={name:"DetailsVolumeHoraireEnseignement",components:{},props:{vh:{type:Object},visibilite:{type:Object}},methods:{histoTooltip(){return"Créé le "+Util.dateToString(this.vh.histo.creation)+" par "+this.vh.histo.createur.libelle+`
Modifié le `+Util.dateToString(this.vh.histo.modification)+" par "+this.vh.histo.modificateur.libelle+`
`},typeInterventionTooltip(){return"Taux en service : "+Util.floatToString(this.vh.tauxServiceDu)+`
Taux en HC : `+Util.floatToString(this.vh.tauxServiceCompl)+`
`},motifNonPaiement(){return this.vh.motifNonPaiement?this.vh.motifNonPaiement.libelle:this.vh.nonPayable?"Non payable":""},floatToString(n){return Util.floatToString(n)}}},Un={style:{"text-align":"center"}},En=["title"],Fn={key:0},Rn={key:1},wn={style:{"text-align":"center"}},In={key:2},Hn=["title"],Ln={key:3},jn={key:0,class:"fa fa-check text-success"},Nn={key:1,class:"fa fa-xmark text-danger"},On={key:4},qn={key:5};function zn(n,e,r,p,i,s){const u=D("u-heures");return l(),o(g,null,[t("td",Un,[t("abbr",{title:s.histoTooltip()},e[0]||(e[0]=[t("i",{class:"fa-regular fa-user"},null,-1)]),8,En)]),r.visibilite.horaires?(l(),o("td",Fn,d(r.vh.horaireDebut),1)):h("",!0),r.visibilite.horaires?(l(),o("td",Rn,d(r.vh.horaireFin),1)):h("",!0),t("td",wn,d(r.vh.periode.libelle),1),(l(!0),o(g,null,x(r.vh.params,(c,m)=>(l(),o("td",{key:m},d(c),1))),128)),r.visibilite.motifsNonPaiement?(l(),o("td",In,d(s.motifNonPaiement()),1)):h("",!0),t("td",null,[t("abbr",{title:s.typeInterventionTooltip()},d(r.vh.typeIntervention.code),9,Hn)]),r.visibilite.servicesStatutaire?(l(),o("td",Ln,[r.vh.serviceStatutaire?(l(),o("i",jn)):(l(),o("i",Nn))])):h("",!0),r.visibilite.majorations?(l(),o("td",On,d(s.floatToString(r.vh.ponderationServiceDu)),1)):h("",!0),r.visibilite.majorations?(l(),o("td",qn,d(s.floatToString(r.vh.ponderationServiceCompl)),1)):h("",!0),t("td",null,[f(u,{valeur:r.vh.heures},null,8,["valeur"])]),e[1]||(e[1]=t("td",null," ",-1))],64)}const Z=k(Mn,[["render",zn]]),Bn=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),$n={name:"DetailsVolumeHoraireReferentiel",components:{},props:{vhr:{type:Object},visibilite:{type:Object}},methods:{histoTooltip(){return"Créé le "+Util.dateToString(this.vhr.histo.creation)+" par "+this.vhr.histo.createur.libelle+`
Modifié le `+Util.dateToString(this.vhr.histo.modification)+" par "+this.vhr.histo.modificateur.libelle+`
`},motifNonPaiement(){return this.vhr.motifNonPaiement?this.vhr.motifNonPaiement.libelle:this.vhr.nonPayable?"Non payable":""},floatToString(n){return Util.floatToString(n)}}},Gn={style:{"text-align":"center"}},Jn=["title"],Yn={key:0},Qn={key:1},Wn={key:2},Xn={key:3},Kn={key:0,class:"fa fa-check text-success"},Zn={key:1,class:"fa fa-xmark text-danger"},er={key:4},tr={key:5};function nr(n,e,r,p,i,s){const u=D("u-heures");return l(),o(g,null,[t("td",Gn,[t("abbr",{title:s.histoTooltip()},e[0]||(e[0]=[t("i",{class:"fa-regular fa-user"},null,-1)]),8,Jn)]),r.visibilite.horaires?(l(),o("td",Yn)):h("",!0),r.visibilite.horaires?(l(),o("td",Qn)):h("",!0),e[1]||(e[1]=t("td",null,null,-1)),(l(!0),o(g,null,x(r.vhr.params,(c,m)=>(l(),o("td",{key:m},d(c),1))),128)),r.visibilite.motifsNonPaiement?(l(),o("td",Wn,d(s.motifNonPaiement()),1)):h("",!0),e[2]||(e[2]=t("td",null,"Référentiel",-1)),r.visibilite.servicesStatutaire?(l(),o("td",Xn,[n.vh.serviceStatutaire?(l(),o("i",Kn)):(l(),o("i",Zn))])):h("",!0),r.visibilite.majorations?(l(),o("td",er,d(s.floatToString(r.vhr.ponderationServiceDu)),1)):h("",!0),r.visibilite.majorations?(l(),o("td",tr,d(s.floatToString(r.vhr.ponderationServiceCompl)),1)):h("",!0),t("td",null,[f(u,{valeur:r.vhr.heures},null,8,["valeur"])]),e[3]||(e[3]=t("td",null," ",-1))],64)}const ee=k($n,[["render",nr]]),rr=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"})),sr={name:"DetailsHetd",components:{},props:{type:{type:String},hetd:{type:Object}},computed:{arrondiClass(){switch(this.hetd.arrondi){case-1:return"arrondi-defaut";case 1:return"arrondi-exces"}return this.hetd.original!=this.hetd.valeur?"arrondi":""},legende(){let n="";return this.hetd.arrondi==1?n="L'arrondisseur de règle de calcul a procédé à un arrondi à l'excès":this.hetd.arrondi==-1&&(n="L'arrondisseur de règle de calcul a procédé à un arrondi par troncature"),this.hetd.original!=this.hetd.valeur&&(n!=""&&(n+=`
`),n+="Valeur originale : "+Util.floatToString(this.hetd.original,15)),n}}},ir=["title"];function lr(n,e,r,p,i,s){const u=D("u-heures");return l(),o("td",{class:A(s.arrondiClass),title:s.legende},[f(u,{valeur:r.hetd.valeur},null,8,["valeur"])],10,ir)}const te=k(sr,[["render",lr],["__scopeId","data-v-717df7b7"]]),or=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"})),ar={name:"DetailsHetds",components:{DetailsHetd:te},props:{hetds:{type:Object}}};function ur(n,e,r,p,i,s){const u=D("details-hetd");return l(!0),o(g,null,x(r.hetds,(c,m)=>(l(),U(u,{key:m,type:m,hetd:c},null,8,["type","hetd"]))),128)}const ne=k(ar,[["render",ur]]),dr=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"})),mr={name:"Details",components:{DetailsVolumeHoraireReferentiel:ee,DetailsVolumeHoraireEnseignement:Z,DetailsServiceEnseignement:X,DetailsServiceReferentiel:K,DetailsHetds:ne},props:{intervenant:{type:Number},typesVolumesHoraires:{type:Object},canReporter:{type:Boolean}},data(){return{data:{},typeVolumeHoraire:null,etatVolumeHoraire:null}},mounted(){if(this.countChoix()==1){for(let n in this.typesVolumesHoraires){this.typeVolumeHoraire=n;for(let e in this.typesVolumesHoraires[n].etats)this.etatVolumeHoraire=e}this.load(this.typeVolumeHoraire,this.etatVolumeHoraire)}},methods:{load(n,e){this.typeVolumeHoraire=n,this.etatVolumeHoraire=e;const r={intervenant:this.intervenant,typeVolumeHoraire:this.typeVolumeHoraire,etatVolumeHoraire:this.etatVolumeHoraire};IntraNavigator.loadBegin(),unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/formule/details-data/:typeVolumeHoraire/:etatVolumeHoraire",r)).then(p=>{this.data=p.data,IntraNavigator.loadEnd()})},reportUrl(){const n={intervenant:this.intervenant,typeVolumeHoraire:this.data.intervenant.typeVolumeHoraireId,etatVolumeHoraire:this.data.intervenant.etatVolumeHoraireId};return unicaenVue.url("formule-test/creer-from-reel/:intervenant/:typeVolumeHoraire/:etatVolumeHoraire",n)},totalColSpan(){let n=4;return this.data.visibilite.horaires&&(n+=2),this.data.visibilite.motifsNonPaiement&&(n+=1),this.data.visibilite.servicesStatutaire&&(n+=1),this.data.visibilite.majorations&&(n+=2),n},countChoix(){let n=0;for(let e in this.typesVolumesHoraires)for(let r in this.typesVolumesHoraires[e].etats)n++;return n}},computed:{listeTypes(){let n={};for(let e in this.typesVolumesHoraires)n[e]=this.typesVolumesHoraires[e].libelle;return n},listeEtats(){let n={};for(let r in this.typesVolumesHoraires)for(let p in this.typesVolumesHoraires[r].etats)n[p]=this.typesVolumesHoraires[r].etats[p];return Object.keys(n).sort((r,p)=>r-p).reduce((r,p)=>(r[p]=n[p],r),{})}}},cr={key:0},hr={key:1},pr={class:"d-flex justify-content-center align-items-center"},fr={class:"table table-borderless table-xs"},br={key:0},vr=["onClick"],_r={key:0,class:"alert alert-info"},gr={key:2},yr={key:3},xr={key:0},Cr={class:"table table-bordered"},Vr={key:0},Sr={key:1},kr={key:0},Pr={key:1},Ar={key:2},Dr={key:0},Tr={key:1},Mr={key:1,class:"alert alert-info"},Ur={key:2,class:"alert alert-info"},Er={class:"table table-bordered table-xs table-details"},Fr={class:"service",colspan:"999"},Rr={class:"details"},wr={key:0,colspan:"2"},Ir={key:1,rowspan:"2"},Hr={key:2,rowspan:"2"},Lr={key:3,colspan:"2"},jr=["rowspan","colspan"],Nr={class:"details"},Or={key:0},qr={key:1},zr={key:2},Br={key:3},$r=["colspan"],Gr=["colspan"],Jr=["href"];function Yr(n,e,r,p,i,s){const u=D("u-heures"),c=D("details-service-enseignement"),m=D("details-service-referentiel"),a=D("details-volume-horaire-enseignement"),C=D("details-volume-horaire-referentiel"),v=D("details-hetds");return l(),o(g,null,[s.countChoix()==0?(l(),o("div",cr,e[0]||(e[0]=[t("div",{class:"alert alert-info"},"Aucun service saisi",-1)]))):h("",!0),s.countChoix()>1?(l(),o("div",hr,[t("div",pr,[t("div",null,[t("table",fr,[(l(!0),o(g,null,x(s.listeTypes,(V,S)=>(l(),o("tr",{key:S},[(l(!0),o(g,null,x(s.listeEtats,(F,T)=>(l(),o("td",{key:T},[r.typesVolumesHoraires[S].etats[T]?(l(),o("div",br,[t("a",{class:A({"btn btn-outline-secondary btn-choixtevh":!0,active:!(S==i.typeVolumeHoraire&&T==i.etatVolumeHoraire)}),onClick:w=>s.load(S,T)},d(V)+" "+d(F),11,vr)])):h("",!0)]))),128))]))),128))])])]),i.typeVolumeHoraire?h("",!0):(l(),o("div",_r,"Veuillez cliquer sur un des boutons ci-dessus pour afficher de détail de calcul des HETD "))])):(l(),o("div",gr,[t("h2",null,d(s.listeTypes[i.typeVolumeHoraire])+" "+d(s.listeEtats[i.etatVolumeHoraire]),1)])),Object.keys(this.data).length>0?(l(),o("div",yr,[i.data.typesHetd.length==0?(l(),o("div",xr,e[1]||(e[1]=[t("div",{class:"alert alert-warning"},"Aucune heure HETD n'a été calculée",-1)]))):h("",!0),e[18]||(e[18]=t("h2",null,"Paramètres intervenant",-1)),t("table",Cr,[t("tbody",null,[t("tr",null,[e[3]||(e[3]=t("th",null,"Structure",-1)),i.data.intervenant.structure?(l(),o("td",Vr,d(i.data.intervenant.structure.libelle),1)):(l(),o("td",Sr,e[2]||(e[2]=[t("span",{class:"text-secondary"},"Aucune structure d'affectation",-1)])))]),i.data.intervenant.heuresServiceStatutaire>0&&i.data.intervenant.heuresServiceStatutaire!=i.data.intervenant.serviceDu?(l(),o("tr",kr,[e[4]||(e[4]=t("th",null,"Heures de service statutaire",-1)),t("td",null,[f(u,{valeur:i.data.intervenant.heuresServiceStatutaire},null,8,["valeur"])])])):h("",!0),i.data.intervenant.heuresServiceModifie>0?(l(),o("tr",Pr,[e[5]||(e[5]=t("th",null,"Heures de service modifié",-1)),t("td",null,[f(u,{valeur:i.data.intervenant.heuresServiceModifie},null,8,["valeur"])])])):h("",!0),i.data.intervenant.serviceDu>0?(l(),o("tr",Ar,[e[6]||(e[6]=t("th",null,"Heures de service dû",-1)),t("td",null,[f(u,{valeur:i.data.intervenant.serviceDu},null,8,["valeur"])])])):h("",!0),t("tr",null,[e[7]||(e[7]=t("th",null,"Dépassement de service dû sans HC",-1)),i.data.intervenant.depassementServiceDuSansHC?(l(),o("td",Dr,"Oui")):(l(),o("td",Tr,"Non"))]),(l(!0),o(g,null,x(i.data.iParams,(V,S)=>(l(),o("tr",{key:S},[t("th",null,d(V)+" "+d(S),1),t("td",null,d(i.data.intervenant.params[S]),1)]))),128))])]),e[19]||(e[19]=t("h2",null,[b("Données utilisées pour le calcul des "),t("abbr",{title:"Heures équivalent TD"},"HETD")],-1)),i.data.intervenant.arrondisseur==0?(l(),o("div",Mr,"L'arrondisseur de calcul HETD est désactivé ")):h("",!0),i.data.intervenant.arrondisseur==1?(l(),o("div",Ur,`L'arrondisseur de calcul HETD est ici activé en mode "minimal" : les opérations d'arrondissage ne se font ici qu'au niveau des volumes horaires et ne prennent pas en compte la totalisation des heures au niveau de la fiche de l'intervenant. `)):h("",!0),t("table",Er,[e[17]||(e[17]=t("thead",null,null,-1)),t("tbody",null,[(l(!0),o(g,null,x(i.data.services,(V,S)=>(l(),o(g,{key:S},[t("tr",null,[t("th",Fr,[V.type=="enseignement"?(l(),U(c,{key:0,enseignement:V},null,8,["enseignement"])):(l(),U(m,{key:1,referentiel:V},null,8,["referentiel"]))])]),t("tr",Rr,[e[9]||(e[9]=t("th",{rowspan:"2"}," ",-1)),i.data.visibilite.horaires?(l(),o("th",wr,"Horaire")):h("",!0),e[10]||(e[10]=t("th",{rowspan:"2"},"Période",-1)),(l(!0),o(g,null,x(i.data.vhParams,(F,T)=>(l(),o("th",{rowspan:"2",key:T},d(F),1))),128)),i.data.visibilite.motifsNonPaiement?(l(),o("th",Ir,"Motif non paiement")):h("",!0),e[11]||(e[11]=t("th",{rowspan:"2"},"Type d'intervention",-1)),i.data.visibilite.servicesStatutaire?(l(),o("th",Hr,e[8]||(e[8]=[t("abbr",{title:"Détermine si les heures peuvent être comptées dans le service statutaire de l'intervenant ou non"},"Peut dans serv.",-1)]))):h("",!0),i.data.visibilite.majorations?(l(),o("th",Lr,"Majoration")):h("",!0),e[12]||(e[12]=t("th",{rowspan:"2"},"Heures",-1)),e[13]||(e[13]=t("th",{rowspan:"2"}," ",-1)),(l(!0),o(g,null,x(i.data.typesHetd,(F,T)=>(l(),o("th",{key:T,rowspan:F.length==0?2:1,colspan:Math.max(F.length,1)},d(T),9,jr))),128))]),t("tr",Nr,[i.data.visibilite.horaires?(l(),o("th",Or,"Début")):h("",!0),i.data.visibilite.horaires?(l(),o("th",qr,"Fin")):h("",!0),i.data.visibilite.majorations?(l(),o("th",zr,"Service")):h("",!0),i.data.visibilite.majorations?(l(),o("th",Br,"Compl.")):h("",!0),(l(!0),o(g,null,x(i.data.typesHetd,F=>(l(),o(g,{key:F},[(l(!0),o(g,null,x(F,(T,w)=>(l(),o("th",{key:w},d(T),1))),128))],64))),128))]),(l(!0),o(g,null,x(V.volumesHoraires,(F,T)=>(l(),o("tr",{key:T},[V.type=="enseignement"?(l(),U(a,{key:0,vh:F,visibilite:i.data.visibilite},null,8,["vh","visibilite"])):(l(),U(C,{key:1,vhr:F,visibilite:i.data.visibilite},null,8,["vhr","visibilite"])),f(v,{hetds:F.hetd},null,8,["hetds"])]))),128)),t("tr",null,[t("th",{class:"total",colspan:s.totalColSpan()},"Total",8,$r),e[14]||(e[14]=t("th",null," ",-1)),f(v,{hetds:V.hetd},null,8,["hetds"])])],64))),128)),e[16]||(e[16]=t("tr",null,[t("th",{class:"service",colspan:"999"}," ")],-1)),t("tr",null,[t("th",{class:"total",colspan:s.totalColSpan()},"Total intervenant",8,Gr),e[15]||(e[15]=t("th",null," ",-1)),f(v,{hetds:i.data.intervenant.hetd},null,8,["hetds"])])])]),r.canReporter?(l(),o("a",{key:3,href:s.reportUrl(),class:"btn btn-secondary"},"Reporter les données de cet intervenant dans l'interface de tests de formule",8,Jr)):h("",!0)])):h("",!0)],64)}const Qr=k(mr,[["render",Yr],["__scopeId","data-v-07a28351"]]),Wr=Object.freeze(Object.defineProperty({__proto__:null,default:Qr},Symbol.toStringTag,{value:"Module"})),Xr={data(){return{dataUrl:unicaenVue.url("formule-test/data"),lines:[]}},methods:{addUrl(){return unicaenVue.url("formule-test/saisir")},editUrl(n){return unicaenVue.url("formule-test/saisir/:id",{id:n})},deleteUrl(n){return unicaenVue.url("formule-test/supprimer/:id",{id:n})},importUrl(){return unicaenVue.url("formule-test/import")},supprimerTest(n){return popConfirm(n.currentTarget,e=>{this.$refs.testsFormules.getData()}),!1}}},Kr={style:{width:"1%","white-space":"nowrap"}},Zr=["href"],es=["href"],ts={class:"card bg-warning"},rs={class:"card-body"},ss=["action"];function is(n,e,r,p,i,s){const u=G,c=z;return l(),o(g,null,[e[9]||(e[9]=t("h1",{class:"page-header"},"Page de tests de formule de calcul des HETD",-1)),f(u,{"data-url":this.dataUrl,modelValue:i.lines,"onUpdate:modelValue":e[1]||(e[1]=m=>i.lines=m),ref:"testsFormules"},{default:M(()=>[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",{column:"ID"},"Id"),t("th",{column:"LIBELLE"},"Libellé"),t("th",{column:"FORMULE"},"Formule"),t("th",{column:"ANNEE"},"Année"),t("th",null," ")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(i.lines,(m,a)=>(l(),o("tr",{key:a},[t("td",null,d(m.ID),1),t("td",null,d(m.LIBELLE),1),t("td",null,d(m.FORMULE),1),t("td",null,d(m.ANNEE),1),t("td",Kr,[t("a",{href:s.editUrl(m.ID),title:"Modification du test de formule"},e[2]||(e[2]=[t("i",{class:"fas fa-pencil"},null,-1)]),8,Zr),e[4]||(e[4]=b("   ")),t("a",{href:s.deleteUrl(m.ID),title:"Suppression du test de formule","data-content":"Êtes-vous sur de vouloir supprimer ce test ?","data-title":"Suppression du test de formule",onClick:e[0]||(e[0]=P((...C)=>s.supprimerTest&&s.supprimerTest(...C),["prevent"]))},e[3]||(e[3]=[t("i",{class:"fas fa-trash-can"},null,-1)]),8,es)])]))),128))])]),_:1},8,["data-url","modelValue"]),f(c,{variant:"primary",href:s.addUrl()},{default:M(()=>e[6]||(e[6]=[b("Ajout d'un nouveau test")])),_:1},8,["href"]),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=t("br",null,null,-1)),t("div",ts,[e[8]||(e[8]=t("div",{class:"card-header"},[t("h3",null,"Import d'un nouveau test à partir d'un tableur")],-1)),t("div",rs,[t("form",{method:"post",enctype:"multipart/form-data",action:this.importUrl()},e[7]||(e[7]=[B('<div class="form-group mb-3"><label for="formule-name">Feuille de calcul (format Excel ou Calc)</label><input class="form-control" id="formule-fichier" type="file" name="fichier"></div><div class="form-group"><button type="submit" class="btn btn-primary">Import d&#39;un test à partir d&#39;un tableur</button></div>',2)]),8,ss)])])],64)}const ls=k(Xr,[["render",is]]),os=Object.freeze(Object.defineProperty({__proto__:null,default:ls},Symbol.toStringTag,{value:"Module"})),as={props:{id:{type:Number},formules:{type:Object},annees:{type:Object},typesIntervenants:{type:Object},typesVolumesHoraires:{type:Object},etatsVolumesHoraires:{type:Object},defaultFormule:{type:Number}},data(){return{indexUrl:unicaenVue.url("formule-test"),dataUrl:unicaenVue.url("formule-test/data"),tauxAutre1Visibility:!0,tauxAutre2Visibility:!1,tauxAutre3Visibility:!1,tauxAutre4Visibility:!1,tauxAutre5Visibility:!1,resMode:"hetd",debug:{},intervenant:{formule:void 0,tauxCmServiceDu:1.5,tauxCmServiceCompl:1.5,tauxTpServiceDu:1,tauxTpServiceCompl:.6666666666667},volumesHoraires:[],formule:{iParam1Libelle:void 0,iParam2Libelle:void 0,iParam3Libelle:void 0,iParam4Libelle:void 0,iParam5Libelle:void 0,vhParam1Libelle:void 0,vhParam2Libelle:void 0,vhParam3Libelle:void 0,vhParam4Libelle:void 0,vhParam5Libelle:void 0},structures:{},typesIntervention:["CM","TD","TP",void 0,void 0,void 0,void 0,void 0,"Référentiel"]}},watch:{"intervenant.tauxAutre1Code"(n){this.tauxAutre2Visibility=n||this.intervenant.tauxAutre1Code||this.intervenant.tauxAutre2ServiceDu||this.intervenant.tauxAutre2ServiceCompl,this.typesIntervention[3]=n},"intervenant.tauxAutre2Code"(n){this.tauxAutre3Visibility=n||this.intervenant.tauxAutre2Code||this.intervenant.tauxAutre3ServiceDu||this.intervenant.tauxAutre3ServiceCompl,this.typesIntervention[4]=n},"intervenant.tauxAutre3Code"(n){this.tauxAutre4Visibility=n||this.intervenant.tauxAutre3Code||this.intervenant.tauxAutre4ServiceDu||this.intervenant.tauxAutre4ServiceCompl,this.typesIntervention[5]=n},"intervenant.tauxAutre4Code"(n){this.tauxAutre5Visibility=n||this.intervenant.tauxAutre4Code||this.intervenant.tauxAutre5ServiceDu||this.intervenant.tauxAutre5ServiceCompl,this.typesIntervention[6]=n},"intervenant.tauxAutre5Code"(n){this.typesIntervention[7]=n},"intervenant.formule"(n){n&&(this.formule=this.formules[n])}},computed:{filteredTypesIntervention(){let n=Object.values(this.typesIntervention).filter(e=>e);return n.unshift(""),n},vhParamCount(){let n=0;for(let e=1;e<6;e++)this.formule["vhParam"+e+"Libelle"]&&n++;return n}},methods:{charger(){unicaenVue.axios.get(unicaenVue.url("formule-test/saisir-data/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0})).then(n=>{this.intervenant=this.dropTauxNonUtilises(n.data.intervenant),this.volumesHoraires=n.data.volumesHoraires,this.debug={},this.addVolumeHoraire(),this.updateStructures()})},enregistrer(){unicaenVue.axios.post(unicaenVue.url("formule-test/enregistrer/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0}),{intervenant:this.intervenant,volumesHoraires:this.volumesHoraires}).then(n=>{this.intervenant=this.dropTauxNonUtilises(n.data.intervenant),this.volumesHoraires=n.data.volumesHoraires,n.data.debug?this.debug=n.data.debug:this.debug={},this.addVolumeHoraire(),this.updateStructures()})},calculer(){unicaenVue.axios.post(unicaenVue.url("formule-test/enregistrer/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0}),{intervenant:this.intervenant,volumesHoraires:this.volumesHoraires,simpleCalcul:!0}).then(n=>{this.intervenant=this.dropTauxNonUtilises(n.data.intervenant),this.volumesHoraires=n.data.volumesHoraires,n.data.debug?this.debug=n.data.debug:this.debug={},this.addVolumeHoraire(),this.updateStructures()})},exporter:function(){const n={intervenant:this.intervenant,volumesHoraires:this.volumesHoraires},e=this.intervenant.libelle;var r=document.createElement("a"),p=new Blob([JSON.stringify(n)],{type:"text/json"});r.href=window.URL.createObjectURL(p),r.download="Test de formule "+e+".json",r.click()},exporterCsv:function(){let n=`Structure;Heures non payables;Compte dans le service statutaire;Type d’intervention;Taux FI;Taux FA;Taux FC;Modulation service dû;Modulation service compl.;Param 1;Param 2;Param 3;Param 4;Param 5;Heures;Service FI;Service FA;Service FC;Service Référentiel;HC FI;HC FA;HC FC;HC Référentiel;Primes;Non payable FI;Non payable FA;Non payable FC;Non payable Référentiel
`;for(const i in this.volumesHoraires){const s=this.volumesHoraires[i];n+=(s.structureCode?s.structureCode:"")+";"+(s.nonPayable?"Oui":"Non")+";"+(s.serviceStatutaire?"Oui":"Non")+";"+(s.referentiel?"Référentiel":s.typeInterventionCode?s.typeInterventionCode:"")+";"+(s.tauxFi?s.tauxFi.toLocaleString("fr-FR"):"")+";"+(s.tauxFa?s.tauxFa.toLocaleString("fr-FR"):"")+";"+(s.tauxFc?s.tauxFc.toLocaleString("fr-FR"):"")+";"+(s.ponderationServiceDu?s.ponderationServiceDu.toLocaleString("fr-FR"):"")+";"+(s.ponderationServiceCompl?s.ponderationServiceCompl.toLocaleString("fr-FR"):"")+";"+(s.param1?s.param1:"")+";"+(s.param2?s.param2:"")+";"+(s.param3?s.param3:"")+";"+(s.param4?s.param4:"")+";"+(s.param5?s.param5:"")+";"+(s.heures?s.heures.toLocaleString("fr-FR"):"")+";"+(s.heuresServiceFi?s.heuresServiceFi.toLocaleString("fr-FR"):"")+";"+(s.heuresServiceFa?s.heuresServiceFa.toLocaleString("fr-FR"):"")+";"+(s.heuresServiceFc?s.heuresServiceFc.toLocaleString("fr-FR"):"")+";"+(s.heuresServiceReferentiel?s.heuresServiceReferentiel.toLocaleString("fr-FR"):"")+";"+(s.heuresComplFi?s.heuresComplFi.toLocaleString("fr-FR"):"")+";"+(s.heuresComplFa?s.heuresComplFa.toLocaleString("fr-FR"):"")+";"+(s.heuresComplFc?s.heuresComplFc.toLocaleString("fr-FR"):"")+";"+(s.heuresComplReferentiel?s.heuresComplReferentiel.toLocaleString("fr-FR"):"")+";"+(s.heuresPrimes?s.heuresPrimes.toLocaleString("fr-FR"):"")+";"+(s.heuresNonPayableFi?s.heuresNonPayableFi.toLocaleString("fr-FR"):"")+";"+(s.heuresNonPayableFa?s.heuresNonPayableFa.toLocaleString("fr-FR"):"")+";"+(s.heuresNonPayableFc?s.heuresNonPayableFc.toLocaleString("fr-FR"):"")+";"+(s.heuresNonPayableReferentiel?s.heuresNonPayableReferentiel.toLocaleString("fr-FR"):"")+`;
`}const e=this.intervenant.libelle;var r=document.createElement("a"),p=new Blob([n],{type:"text/csv"});r.href=window.URL.createObjectURL(p),r.download="Test de formule "+e+".csv",r.click()},importer:function(n){const e=n.target.files[0];if(!e.type.match("application/json")){console.error("Le fichier n'est pas de type JSON.");return}const r=new FileReader;r.onload=p=>{try{const i=JSON.parse(p.target.result);this.intervenant=i.intervenant,this.volumesHoraires=i.volumesHoraires,this.updateStructures()}catch(i){console.error("Erreur lors de l'analyse du contenu JSON :",i)}},r.readAsText(e)},dropTauxNonUtilises(n){return n.tauxAutre1Code||(n.tauxAutre1ServiceDu=void 0,n.tauxAutre1ServiceCompl=void 0),n.tauxAutre2Code||(n.tauxAutre2ServiceDu=void 0,n.tauxAutre2ServiceCompl=void 0),n.tauxAutre3Code||(n.tauxAutre3ServiceDu=void 0,n.tauxAutre3ServiceCompl=void 0),n.tauxAutre4Code||(n.tauxAutre4ServiceDu=void 0,n.tauxAutre4ServiceCompl=void 0),n.tauxAutre5Code||(n.tauxAutre5ServiceDu=void 0,n.tauxAutre5ServiceCompl=void 0),n},updateStructures(){let n={"":""};this.intervenant.structureCode&&(n[this.intervenant.structureCode]=this.intervenant.structureCode);for(let e in this.volumesHoraires){const r=this.volumesHoraires[e].structureCode;r&&(n[r]=r)}n.__UNIV__="Université (établissement)",n.__EXTERIEUR__="Extérieur (autre établissement)",n.__new_structure__="- Ajout d'une nouvelle structure -",this.structures=n},selectStructure(n){if(n.target.value=="__new_structure__"&&this.addStructure(n.target),n.target.dataset.variable!="intervenant"){const e=parseInt(n.target.dataset.variable);e==this.lastVolumeHoraireIndex()&&this.volumesHoraires[e].structureCode&&this.addVolumeHoraire()}},majTauxFi(n){const e=n.target.dataset.variable;this.volumesHoraires[e].tauxFi=1-this.volumesHoraires[e].tauxFa-this.volumesHoraires[e].tauxFc},lastVolumeHoraireIndex(){return this.volumesHoraires.length==0?-1:parseInt(Object.keys(this.volumesHoraires).pop())},addVolumeHoraire(){this.volumesHoraires.push({structureCode:null,typeInterventionCode:null,tauxFi:1,tauxFa:0,tauxFc:0,ponderationServiceDu:1,ponderationServiceCompl:1,serviceStatutaire:!0,heures:null})},addStructure(n){const e=prompt("Ajout d'une nouvelle structure");this.structures[e]=e,setTimeout(()=>{const r=n.dataset.variable;r=="intervenant"?this.intervenant.structureCode=e:this.volumesHoraires[r].structureCode=e},200)}},mounted(){this.charger()}},us={class:"row"},ds={class:"col-md-6"},ms={class:"table table-xs table-bordered fti"},cs={class:"saisie"},hs={class:"saisie"},ps=["value"],fs={class:"saisie"},bs=["value"],vs={class:"saisie"},_s=["value"],gs={class:"saisie"},ys=["value"],xs={class:"saisie"},Cs=["value"],Vs={class:"saisie"},Ss=["value"],ks={class:"saisie"},Ps={class:"saisie"},As={class:"saisie"},Ds={class:"i-param i-param-1"},Ts={class:"i-param"},Ms={class:"saisie"},Us={class:"i-param i-param-2"},Es={class:"i-param"},Fs={class:"saisie"},Rs={class:"i-param i-param-3"},ws={class:"i-param"},Is={class:"saisie"},Hs={class:"i-param i-param-4"},Ls={class:"i-param"},js={class:"saisie"},Ns={class:"i-param i-param-5"},Os={class:"i-param"},qs={class:"saisie"},zs={class:"actions"},Bs={class:"row mb-4"},$s={class:"col-md-6"},Gs={class:"col-md-6"},Js={class:"row mb-4"},Ys={class:"col-md-6"},Qs={class:"col-md-6"},Ws={for:"importbtn"},Xs={class:"row"},Ks={class:"col-md-6"},Zs={class:"col-md-5"},ei={class:"types-interventions"},ti={class:"table table-bordered table-xs"},ni={style:{width:"10%"}},ri={style:{width:"10%"}},si={style:{width:"10%"}},ii={style:{width:"10%"}},li={style:{width:"10%"}},oi={class:"saisie"},ai={class:"saisie"},ui={class:"saisie"},di={class:"saisie"},mi={class:"saisie"},ci={class:"saisie"},hi={class:"saisie"},pi={class:"saisie"},fi={class:"saisie"},bi={class:"saisie"},vi={class:"saisie"},_i={class:"saisie"},gi={class:"saisie"},yi={class:"saisie"},xi={class:"table table-xs table-bordered resultats"},Ci={class:"table table-bordered table-xs table-hover fvh"},Vi=["colspan"],Si={colspan:"13"},ki=["colspan"],Pi={colspan:"4"},Ai={colspan:"4"},Di={rowspan:"2"},Ti={colspan:"4"},Mi={colspan:"4"},Ui={colspan:"4"},Ei={rowspan:"2"},Fi={colspan:"4"},Ri={rowspan:"2"},wi=["onUpdate:modelValue","data-variable"],Ii=["value"],Hi=["onUpdate:modelValue"],Li=["onUpdate:modelValue"],ji=["onUpdate:modelValue"],Ni=["value"],Oi=["onUpdate:modelValue"],qi=["onUpdate:modelValue"],zi=["onUpdate:modelValue"],Bi=["onUpdate:modelValue"],$i=["onUpdate:modelValue"],Gi={class:"debug-td"},Ji={key:0},Yi={class:"debug-cell"},Qi={class:"debug-val"},Wi={key:0},Xi={class:"debug-cell"},Ki={class:"debug-val"},Zi=["href"];function el(n,e,r,p,i,s){const u=D("u-input-float"),c=z,m=D("u-heures");return l(),o(g,null,[e[114]||(e[114]=t("h1",{class:"page-header"},"Modification d'un test de formule",-1)),t("div",us,[t("div",ds,[e[54]||(e[54]=t("h2",null,"Intervenant",-1)),t("table",ms,[t("tr",null,[e[40]||(e[40]=t("th",null,"Libellé",-1)),t("td",cs,[_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>i.intervenant.libelle=a),class:"dinput"},null,512),[[E,i.intervenant.libelle]])])]),t("tr",null,[e[41]||(e[41]=t("th",null,"Formule",-1)),t("td",hs,[_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>i.intervenant.formule=a),class:"dinput"},[(l(!0),o(g,null,x(r.formules,a=>(l(),o("option",{value:a.id},d(a.libelle),9,ps))),256))],512),[[R,i.intervenant.formule]])])]),t("tr",null,[e[42]||(e[42]=t("th",null,"Année",-1)),t("td",fs,[_(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>i.intervenant.annee=a),class:"dinput"},[(l(!0),o(g,null,x(r.annees,a=>(l(),o("option",{value:a.id},d(a.libelle),9,bs))),256))],512),[[R,i.intervenant.annee]])])]),t("tr",null,[e[43]||(e[43]=t("th",null,"Type",-1)),t("td",vs,[_(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>i.intervenant.typeIntervenant=a),class:"dinput"},[(l(!0),o(g,null,x(r.typesIntervenants,a=>(l(),o("option",{value:a.id},d(a.libelle),9,_s))),256))],512),[[R,i.intervenant.typeIntervenant]])])]),t("tr",null,[e[44]||(e[44]=t("th",null,"Structure",-1)),t("td",gs,[_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>i.intervenant.structureCode=a),"data-variable":"intervenant",class:"dinput",onChange:e[5]||(e[5]=(...a)=>s.selectStructure&&s.selectStructure(...a))},[(l(!0),o(g,null,x(i.structures,(a,C)=>(l(),o("option",{value:C,key:C},d(a),9,ys))),128))],544),[[R,i.intervenant.structureCode]])])]),t("tr",null,[e[45]||(e[45]=t("th",null,"Type de volume horaire",-1)),t("td",xs,[_(t("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>i.intervenant.typeVolumeHoraire=a),class:"dinput"},[(l(!0),o(g,null,x(r.typesVolumesHoraires,a=>(l(),o("option",{value:a.id},d(a.libelle),9,Cs))),256))],512),[[R,i.intervenant.typeVolumeHoraire]])])]),t("tr",null,[e[46]||(e[46]=t("th",null,"État de volume horaire",-1)),t("td",Vs,[_(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>i.intervenant.etatVolumeHoraire=a),class:"dinput"},[(l(!0),o(g,null,x(r.etatsVolumesHoraires,a=>(l(),o("option",{value:a.id},d(a.libelle),9,Ss))),256))],512),[[R,i.intervenant.etatVolumeHoraire]])])]),t("tr",null,[e[47]||(e[47]=t("th",null,"Heures de service statutaire",-1)),t("td",ks,[f(u,{modelValue:i.intervenant.heuresServiceStatutaire,"onUpdate:modelValue":e[8]||(e[8]=a=>i.intervenant.heuresServiceStatutaire=a),class:"dinput"},null,8,["modelValue"])])]),t("tr",null,[e[48]||(e[48]=t("th",null,"Heures de service modifié",-1)),t("td",Ps,[f(u,{modelValue:i.intervenant.heuresServiceModifie,"onUpdate:modelValue":e[9]||(e[9]=a=>i.intervenant.heuresServiceModifie=a),class:"dinput"},null,8,["modelValue"])])]),t("tr",null,[e[50]||(e[50]=t("th",null,"Dépassement de service dû sans HC",-1)),t("td",As,[_(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>i.intervenant.depassementServiceDuSansHC=a),class:"dinput"},e[49]||(e[49]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)]),512),[[R,i.intervenant.depassementServiceDuSansHC]])])]),_(t("tr",Ds,[t("th",Ts,d(i.formule.iParam1Libelle),1),t("td",Ms,[_(t("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>i.intervenant.param1=a),class:"dinput"},null,512),[[E,i.intervenant.param1]])])],512),[[y,i.formule.iParam1Libelle]]),_(t("tr",Us,[t("th",Es,d(i.formule.iParam2Libelle),1),t("td",Fs,[_(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>i.intervenant.param2=a),class:"dinput"},null,512),[[E,i.intervenant.param2]])])],512),[[y,i.formule.iParam2Libelle]]),_(t("tr",Rs,[t("th",ws,d(i.formule.iParam3Libelle),1),t("td",Is,[_(t("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>i.intervenant.param3=a),class:"dinput"},null,512),[[E,i.intervenant.param3]])])],512),[[y,i.formule.iParam3Libelle]]),_(t("tr",Hs,[t("th",Ls,d(i.formule.iParam4Libelle),1),t("td",js,[_(t("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>i.intervenant.param4=a),class:"dinput"},null,512),[[E,i.intervenant.param4]])])],512),[[y,i.formule.iParam4Libelle]]),_(t("tr",Ns,[t("th",Os,d(i.formule.iParam5Libelle),1),t("td",qs,[_(t("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>i.intervenant.param5=a),class:"dinput"},null,512),[[E,i.intervenant.param5]])])],512),[[y,i.formule.iParam5Libelle]])]),t("div",zs,[t("div",Bs,[t("div",$s,[f(c,{variant:"primary",onClick:s.enregistrer},{default:M(()=>e[51]||(e[51]=[b("Enregistrer les données")])),_:1},8,["onClick"])]),t("div",Gs,[f(c,{variant:"secondary",onClick:s.calculer},{default:M(()=>e[52]||(e[52]=[b("Calculer les HETD")])),_:1},8,["onClick"])])]),t("div",Js,[t("div",Ys,[t("button",{class:"exporter btn btn-secondary",onClick:e[16]||(e[16]=(...a)=>s.exporter&&s.exporter(...a))},"Télécharger les données")]),t("div",Qs,[t("label",Ws,[e[53]||(e[53]=t("span",{class:"btn btn-secondary"},"Téléverser un jeu de données",-1)),t("input",{type:"file",id:"importbtn",class:"importer",onChange:e[17]||(e[17]=(...a)=>s.importer&&s.importer(...a))},null,32)])])]),t("div",Xs,[t("div",Ks,[t("button",{class:"exporter btn btn-secondary",onClick:e[18]||(e[18]=(...a)=>s.exporterCsv&&s.exporterCsv(...a))},"Télécharger les données en CSV ")])])])]),t("div",Zs,[e[84]||(e[84]=t("h2",null,"Types d'intervention (HETD)",-1)),t("div",ei,[t("table",ti,[e[63]||(e[63]=t("tr",null,[t("th"),t("th",{colspan:"3"},"Standards"),t("th",{colspan:"5"},"Personnalisés")],-1)),t("tr",null,[e[55]||(e[55]=t("th",{style:{width:"20%"}},null,-1)),e[56]||(e[56]=t("th",{style:{width:"5%"}},"CM",-1)),e[57]||(e[57]=t("th",{style:{width:"5%"}},"TD",-1)),e[58]||(e[58]=t("th",{style:{width:"5%"}},"TP",-1)),_(t("th",ni,[_(t("input",{"onUpdate:modelValue":e[19]||(e[19]=a=>i.intervenant.tauxAutre1Code=a),class:"dinput"},null,512),[[E,i.intervenant.tauxAutre1Code]])],512),[[y,i.tauxAutre1Visibility]]),_(t("th",ri,[_(t("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>i.intervenant.tauxAutre2Code=a),class:"dinput"},null,512),[[E,i.intervenant.tauxAutre2Code]])],512),[[y,i.tauxAutre2Visibility]]),_(t("th",si,[_(t("input",{"onUpdate:modelValue":e[21]||(e[21]=a=>i.intervenant.tauxAutre3Code=a),class:"dinput"},null,512),[[E,i.intervenant.tauxAutre3Code]])],512),[[y,i.tauxAutre3Visibility]]),_(t("th",ii,[_(t("input",{"onUpdate:modelValue":e[22]||(e[22]=a=>i.intervenant.tauxAutre4Code=a),class:"dinput"},null,512),[[E,i.intervenant.tauxAutre4Code]])],512),[[y,i.tauxAutre4Visibility]]),_(t("th",li,[_(t("input",{"onUpdate:modelValue":e[23]||(e[23]=a=>i.intervenant.tauxAutre5Code=a),class:"dinput"},null,512),[[E,i.intervenant.tauxAutre5Code]])],512),[[y,i.tauxAutre5Visibility]])]),t("tr",null,[e[59]||(e[59]=t("th",null,"En service",-1)),t("td",oi,[f(u,{modelValue:i.intervenant.tauxCmServiceDu,"onUpdate:modelValue":e[24]||(e[24]=a=>i.intervenant.tauxCmServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])]),e[60]||(e[60]=t("td",null,"1",-1)),t("td",ai,[f(u,{modelValue:i.intervenant.tauxTpServiceDu,"onUpdate:modelValue":e[25]||(e[25]=a=>i.intervenant.tauxTpServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])]),_(t("td",ui,[f(u,{modelValue:i.intervenant.tauxAutre1ServiceDu,"onUpdate:modelValue":e[26]||(e[26]=a=>i.intervenant.tauxAutre1ServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre1Visibility]]),_(t("td",di,[f(u,{modelValue:i.intervenant.tauxAutre2ServiceDu,"onUpdate:modelValue":e[27]||(e[27]=a=>i.intervenant.tauxAutre2ServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre2Visibility]]),_(t("td",mi,[f(u,{modelValue:i.intervenant.tauxAutre3ServiceDu,"onUpdate:modelValue":e[28]||(e[28]=a=>i.intervenant.tauxAutre3ServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre3Visibility]]),_(t("td",ci,[f(u,{modelValue:i.intervenant.tauxAutre4ServiceDu,"onUpdate:modelValue":e[29]||(e[29]=a=>i.intervenant.tauxAutre4ServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre4Visibility]]),_(t("td",hi,[f(u,{modelValue:i.intervenant.tauxAutre5ServiceDu,"onUpdate:modelValue":e[30]||(e[30]=a=>i.intervenant.tauxAutre5ServiceDu=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre5Visibility]])]),t("tr",null,[e[61]||(e[61]=t("th",null,"Au-delà du service",-1)),t("td",pi,[f(u,{modelValue:i.intervenant.tauxCmServiceCompl,"onUpdate:modelValue":e[31]||(e[31]=a=>i.intervenant.tauxCmServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])]),e[62]||(e[62]=t("td",null,"1",-1)),t("td",fi,[f(u,{modelValue:i.intervenant.tauxTpServiceCompl,"onUpdate:modelValue":e[32]||(e[32]=a=>i.intervenant.tauxTpServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])]),_(t("td",bi,[f(u,{modelValue:i.intervenant.tauxAutre1ServiceCompl,"onUpdate:modelValue":e[33]||(e[33]=a=>i.intervenant.tauxAutre1ServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre1Visibility]]),_(t("td",vi,[f(u,{modelValue:i.intervenant.tauxAutre2ServiceCompl,"onUpdate:modelValue":e[34]||(e[34]=a=>i.intervenant.tauxAutre2ServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre2Visibility]]),_(t("td",_i,[f(u,{modelValue:i.intervenant.tauxAutre3ServiceCompl,"onUpdate:modelValue":e[35]||(e[35]=a=>i.intervenant.tauxAutre3ServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre3Visibility]]),_(t("td",gi,[f(u,{modelValue:i.intervenant.tauxAutre4ServiceCompl,"onUpdate:modelValue":e[36]||(e[36]=a=>i.intervenant.tauxAutre4ServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre4Visibility]]),_(t("td",yi,[f(u,{modelValue:i.intervenant.tauxAutre5ServiceCompl,"onUpdate:modelValue":e[37]||(e[37]=a=>i.intervenant.tauxAutre5ServiceCompl=a),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,i.tauxAutre5Visibility]])])])]),e[85]||(e[85]=t("h2",null,"Résultat",-1)),t("table",xi,[t("tr",null,[e[64]||(e[64]=t("th",{colspan:"2"},"Service dû",-1)),t("td",null,[f(m,{valeur:i.intervenant.serviceDu??NaN},null,8,["valeur"])])]),t("tr",null,[e[65]||(e[65]=t("th",{rowspan:"4"},"Service",-1)),e[66]||(e[66]=t("th",null,"FI",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresServiceFi??NaN},null,8,["valeur"])])]),t("tr",null,[e[67]||(e[67]=t("th",null,"FA",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresServiceFa??NaN},null,8,["valeur"])])]),t("tr",null,[e[68]||(e[68]=t("th",null,"FC",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresServiceFc??NaN},null,8,["valeur"])])]),t("tr",null,[e[69]||(e[69]=t("th",null,"Référentiel",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresServiceReferentiel??NaN},null,8,["valeur"])])]),t("tr",null,[e[70]||(e[70]=t("th",{colspan:"2"},"Total service dû assuré",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresService??NaN},null,8,["valeur"])])]),t("tr",null,[e[71]||(e[71]=t("th",{rowspan:"4"},"Heures compl.",-1)),e[72]||(e[72]=t("th",null,"FI",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresComplFi??NaN},null,8,["valeur"])])]),t("tr",null,[e[73]||(e[73]=t("th",null,"FA",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresComplFa??NaN},null,8,["valeur"])])]),t("tr",null,[e[74]||(e[74]=t("th",null,"FC",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresComplFc??NaN},null,8,["valeur"])])]),t("tr",null,[e[75]||(e[75]=t("th",null,"Référentiel",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresComplReferentiel??NaN},null,8,["valeur"])])]),t("tr",null,[e[76]||(e[76]=t("th",{colspan:"2"},"Total heures compl. à payer",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresCompl??NaN},null,8,["valeur"])])]),t("tr",null,[e[77]||(e[77]=t("th",{colspan:"2"},"Primes",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresPrimes??NaN},null,8,["valeur"])])]),t("tr",null,[e[78]||(e[78]=t("th",{rowspan:"4"},"Heures non payables",-1)),e[79]||(e[79]=t("th",null,"FI",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresNonPayableFi??NaN},null,8,["valeur"])])]),t("tr",null,[e[80]||(e[80]=t("th",null,"FA",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresNonPayableFa??NaN},null,8,["valeur"])])]),t("tr",null,[e[81]||(e[81]=t("th",null,"FC",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresNonPayableFc??NaN},null,8,["valeur"])])]),t("tr",null,[e[82]||(e[82]=t("th",null,"Référentiel",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresNonPayableReferentiel??NaN},null,8,["valeur"])])]),t("tr",null,[e[83]||(e[83]=t("th",{colspan:"2"},"Total heures non payables",-1)),t("td",null,[f(m,{valeur:i.intervenant.heuresNonPayable??NaN},null,8,["valeur"])])])])]),e[113]||(e[113]=t("h2",null,"Heures effectuées (A saisir de manière chronologique)",-1)),t("table",Ci,[t("thead",null,[t("tr",null,[e[87]||(e[87]=t("th",{rowspan:"3"},null,-1)),t("th",{colspan:10+s.vhParamCount,class:"vh-donnees"},"Données",8,Vi),e[88]||(e[88]=t("th",{rowspan:"3",class:"spacer"}," ",-1)),t("th",Si,[_(t("select",{"onUpdate:modelValue":e[38]||(e[38]=a=>i.resMode=a),class:"form-select res-mode"},e[86]||(e[86]=[t("option",{value:"attendu"},"Résultats attendus (en HETD)",-1),t("option",{value:"hetd",selected:"selected"},"Résultats calculés (en HETD)",-1),t("option",{value:"debug"},"Informations de débogage",-1)]),512),[[R,i.resMode]])])]),t("tr",null,[e[89]||(e[89]=t("th",{rowspan:"2",style:{"min-width":"10em"}},"Structure",-1)),e[90]||(e[90]=t("th",{rowspan:"2"},"Non payable",-1)),e[91]||(e[91]=t("th",{rowspan:"2"},"Compte dans le service statutaire",-1)),e[92]||(e[92]=t("th",{rowspan:"2",style:{"min-width":"5em"}},"Type d'intervention",-1)),e[93]||(e[93]=t("th",{colspan:"3"},"Répartition",-1)),e[94]||(e[94]=t("th",{colspan:"2"},"Modulation",-1)),_(t("th",{colspan:s.vhParamCount},"Paramètres",8,ki),[[y,s.vhParamCount>0]]),e[95]||(e[95]=t("th",{rowspan:"2"},"Heures",-1)),_(t("th",Pi,"Service",512),[[y,i.resMode=="attendu"]]),_(t("th",Ai,"Heures compl.",512),[[y,i.resMode=="attendu"]]),_(t("th",Di,"Primes",512),[[y,i.resMode=="attendu"]]),_(t("th",Ti,"Heures non payables",512),[[y,i.resMode=="attendu"]]),_(t("th",Mi,"Service",512),[[y,i.resMode=="hetd"]]),_(t("th",Ui,"Heures compl.",512),[[y,i.resMode=="hetd"]]),_(t("th",Ei,"Primes",512),[[y,i.resMode=="hetd"]]),_(t("th",Fi,"Heures non payables",512),[[y,i.resMode=="hetd"]]),_(t("th",Ri,"Informations de débogage",512),[[y,i.resMode=="debug"]])]),t("tr",null,[e[96]||(e[96]=t("th",null,"Fi",-1)),e[97]||(e[97]=t("th",null,"Fa",-1)),e[98]||(e[98]=t("th",null,"Fc",-1)),e[99]||(e[99]=t("th",null,"Service dû",-1)),e[100]||(e[100]=t("th",null,"Service compl.",-1)),(l(),o(g,null,x([1,2,3,4,5],a=>_(t("th",{key:a},d(i.formule["vhParam"+a+"Libelle"]),1),[[y,i.formule["vhParam"+a+"Libelle"]]])),64)),_(t("th",null,"Fi",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fa",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fc",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Référentiel",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fi",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fa",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fc",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Référentiel",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fi",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fa",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fc",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Référentiel",512),[[y,i.resMode=="attendu"]]),_(t("th",null,"Fi",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fa",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fc",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Référentiel",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fi",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fa",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fc",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Référentiel",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fi",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fa",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Fc",512),[[y,i.resMode=="hetd"]]),_(t("th",null,"Référentiel",512),[[y,i.resMode=="hetd"]])])]),t("tbody",null,[(l(!0),o(g,null,x(i.volumesHoraires,(a,C)=>(l(),o("tr",{key:C},[t("th",null,d(C+1),1),t("td",null,[_(t("select",{"onUpdate:modelValue":v=>a.structureCode=v,"data-variable":C,class:"dinput",onChange:e[39]||(e[39]=(...v)=>s.selectStructure&&s.selectStructure(...v))},[(l(!0),o(g,null,x(i.structures,(v,V)=>(l(),o("option",{value:V,key:V},d(v),9,Ii))),128))],40,wi),[[R,a.structureCode]])]),t("td",null,[_(t("select",{"onUpdate:modelValue":v=>a.nonPayable=v,class:"dinput"},e[101]||(e[101]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)]),8,Hi),[[R,a.nonPayable],[y,a.structureCode]])]),t("td",null,[_(t("select",{"onUpdate:modelValue":v=>a.serviceStatutaire=v,class:"dinput"},e[102]||(e[102]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)]),8,Li),[[R,a.serviceStatutaire],[y,a.structureCode]])]),t("td",null,[_(t("select",{"onUpdate:modelValue":v=>a.typeInterventionCode=v,class:"dinput"},[(l(!0),o(g,null,x(s.filteredTypesIntervention,v=>(l(),o("option",{value:v,key:v},d(v),9,Ni))),128))],8,ji),[[R,a.typeInterventionCode],[y,a.structureCode]])]),t("td",null,[_(t("div",null,[f(u,{modelValue:a.tauxFi,"onUpdate:modelValue":v=>a.tauxFi=v,"is-pourc":"",class:"doutput",readonly:"",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),e[103]||(e[103]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(a.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[f(u,{modelValue:a.tauxFa,"onUpdate:modelValue":v=>a.tauxFa=v,"is-pourc":"",class:"dinput","data-variable":C,onChange:s.majTauxFi,onClick:s.majTauxFi,style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue","data-variable","onChange","onClick"]),e[104]||(e[104]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(a.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[f(u,{modelValue:a.tauxFc,"onUpdate:modelValue":v=>a.tauxFc=v,"is-pourc":"",class:"dinput","data-variable":C,onChange:s.majTauxFi,onClick:s.majTauxFi,style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue","data-variable","onChange","onClick"]),e[105]||(e[105]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(a.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[f(u,{modelValue:a.ponderationServiceDu,"onUpdate:modelValue":v=>a.ponderationServiceDu=v,"is-pourc":"",class:"dinput",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),e[106]||(e[106]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(a.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[f(u,{modelValue:a.ponderationServiceCompl,"onUpdate:modelValue":v=>a.ponderationServiceCompl=v,"is-pourc":"",class:"dinput",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),e[107]||(e[107]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(a.typeInterventionCode)]])]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":v=>a.param1=v,class:"dinput"},null,8,Oi),[[E,a.param1],[y,a.structureCode]])],512),[[y,i.formule.vhParam1Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":v=>a.param2=v,class:"dinput"},null,8,qi),[[E,a.param2],[y,a.structureCode]])],512),[[y,i.formule.vhParam2Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":v=>a.param3=v,class:"dinput"},null,8,zi),[[E,a.param3],[y,a.structureCode]])],512),[[y,i.formule.vhParam3Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":v=>a.param4=v,class:"dinput"},null,8,Bi),[[E,a.param4],[y,a.structureCode]])],512),[[y,i.formule.vhParam4Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":v=>a.param5=v,class:"dinput"},null,8,$i),[[E,a.param5],[y,a.structureCode]])],512),[[y,i.formule.vhParam5Libelle]]),t("td",null,[_(f(u,{modelValue:a.heures,"onUpdate:modelValue":v=>a.heures=v,class:"dinput",onChange:s.calculer},null,8,["modelValue","onUpdate:modelValue","onChange"]),[[y,!["",null].includes(a.typeInterventionCode)]])]),e[109]||(e[109]=t("td",{class:"spacer"},null,-1)),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesServiceFi,"onUpdate:modelValue":v=>a.heuresAttenduesServiceFi=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesServiceFa,"onUpdate:modelValue":v=>a.heuresAttenduesServiceFa=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesServiceFc,"onUpdate:modelValue":v=>a.heuresAttenduesServiceFc=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesServiceReferentiel,"onUpdate:modelValue":v=>a.heuresAttenduesServiceReferentiel=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesComplFi,"onUpdate:modelValue":v=>a.heuresAttenduesComplFi=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesComplFa,"onUpdate:modelValue":v=>a.heuresAttenduesComplFa=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesComplFc,"onUpdate:modelValue":v=>a.heuresAttenduesComplFc=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesComplReferentiel,"onUpdate:modelValue":v=>a.heuresAttenduesComplReferentiel=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesPrimes,"onUpdate:modelValue":v=>a.heuresAttenduesPrimes=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesNonPayableFi,"onUpdate:modelValue":v=>a.heuresAttenduesNonPayableFi=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesNonPayableFa,"onUpdate:modelValue":v=>a.heuresAttenduesNonPayableFa=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesNonPayableFc,"onUpdate:modelValue":v=>a.heuresAttenduesNonPayableFc=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresAttenduesNonPayableReferentiel,"onUpdate:modelValue":v=>a.heuresAttenduesNonPayableReferentiel=v,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,i.resMode=="attendu"]]),_(t("td",null,[f(u,{modelValue:a.heuresServiceFi,"onUpdate:modelValue":v=>a.heuresServiceFi=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesServiceFi!=null&&Math.round(a.heuresAttenduesServiceFi*100)!=Math.round(a.heuresServiceFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresServiceFa,"onUpdate:modelValue":v=>a.heuresServiceFa=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesServiceFa!=null&&Math.round(a.heuresAttenduesServiceFa*100)!=Math.round(a.heuresServiceFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresServiceFc,"onUpdate:modelValue":v=>a.heuresServiceFc=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesServiceFc!=null&&Math.round(a.heuresAttenduesServiceFc*100)!=Math.round(a.heuresServiceFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresServiceReferentiel,"onUpdate:modelValue":v=>a.heuresServiceReferentiel=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesServiceReferentiel!=null&&Math.round(a.heuresAttenduesServiceReferentiel*100)!=Math.round(a.heuresServiceReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresComplFi,"onUpdate:modelValue":v=>a.heuresComplFi=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesComplFi!=null&&Math.round(a.heuresAttenduesComplFi*100)!=Math.round(a.heuresComplFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresComplFa,"onUpdate:modelValue":v=>a.heuresComplFa=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesComplFa!=null&&Math.round(a.heuresAttenduesComplFa*100)!=Math.round(a.heuresComplFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresComplFc,"onUpdate:modelValue":v=>a.heuresComplFc=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesComplFc!=null&&Math.round(a.heuresAttenduesComplFc*100)!=Math.round(a.heuresComplFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresComplReferentiel,"onUpdate:modelValue":v=>a.heuresComplReferentiel=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesComplReferentiel!=null&&Math.round(a.heuresAttenduesComplReferentiel*100)!=Math.round(a.heuresComplReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresPrimes,"onUpdate:modelValue":v=>a.heuresPrimes=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesPrimes!=null&&Math.round(a.heuresAttenduesPrimes*100)!=Math.round(a.heuresPrimes*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresNonPayableFi,"onUpdate:modelValue":v=>a.heuresNonPayableFi=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesNonPayableFi!=null&&Math.round(a.heuresAttenduesNonPayableFi*100)!=Math.round(a.heuresNonPayableFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresNonPayableFa,"onUpdate:modelValue":v=>a.heuresNonPayableFa=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesNonPayableFa!=null&&Math.round(a.heuresAttenduesNonPayableFa*100)!=Math.round(a.heuresNonPayableFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresNonPayableFc,"onUpdate:modelValue":v=>a.heuresNonPayableFc=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesNonPayableFc!=null&&Math.round(a.heuresAttenduesNonPayableFc*100)!=Math.round(a.heuresNonPayableFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",null,[f(u,{modelValue:a.heuresNonPayableReferentiel,"onUpdate:modelValue":v=>a.heuresNonPayableReferentiel=v,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":a.heuresAttenduesNonPayableReferentiel!=null&&Math.round(a.heuresAttenduesNonPayableReferentiel*100)!=Math.round(a.heuresNonPayableReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,i.resMode=="hetd"]]),_(t("td",Gi,[i.debug.vh&&i.debug.vh[C]?(l(),o("div",Ji,[(l(!0),o(g,null,x(i.debug.vh[C],(v,V)=>(l(),o("span",Yi,[b(d(V)+" ",1),t("span",Qi,d(Math.round(v*100)/100),1)]))),256)),e[108]||(e[108]=b("  "))])):h("",!0)],512),[[y,i.resMode=="debug"]])]))),128))])]),i.resMode=="debug"&&i.debug.global?(l(),o("div",Wi,[e[110]||(e[110]=t("h4",null,"Débogage : calculs globaux",-1)),(l(!0),o(g,null,x(i.debug.global,(a,C)=>(l(),o("span",Xi,[b(d(C)+" ",1),t("span",Ki,d(Math.round(a*100)/100),1)]))),256)),e[111]||(e[111]=b("  "))])):h("",!0),t("div",null,[t("a",{class:"btn btn-secondary",href:i.indexUrl},e[112]||(e[112]=[t("i",{class:"fas fa-rotate-left","aria-hidden":"true"},null,-1),b(" Retour à la liste des formules")]),8,Zi)])])],64)}const tl=k(as,[["render",el],["__scopeId","data-v-bd222fc1"]]),nl=Object.freeze(Object.defineProperty({__proto__:null,default:tl},Symbol.toStringTag,{value:"Module"})),rl={name:"TotauxHetd",props:{intervenant:{type:Number},typeVolumeHoraire:{type:Number}},data(){return{data:{types:[]},serviceLigne:""}},mounted(){this.load(),window.addEventListener("Formule/TotauxHetd.refresh",n=>{this.load()})},methods:{load(){unicaenVue.axios.get(unicaenVue.url("intervenant/formule-totaux-hetd/:intervenant/:typeVolumeHoraire",{intervenant:this.intervenant,typeVolumeHoraire:this.typeVolumeHoraire})).then(n=>{this.data=n.data.data,this.data.serviceStatutaire>0&&(this.data.serviceDu!=this.data.serviceStatutaire?this.serviceLigne="* "+this.data.serviceDu+"h de service dû en tenant compte des modifications de service":this.serviceLigne="* "+this.data.serviceStatutaire+"h de service statutaire")})},tradType(n){switch(n){case"fi":return"FI";case"fa":return"FA";case"fc":return"FC";case"enseignement":return"Enseignement";case"referentiel":return"Référentiel";case"total":return"Total";default:return n}},tradCategorie(n){switch(n){case"service":return"Service*";case"compl":return"Heures complémentaires";case"payable":return"Heures";case"non-payable":return"Non payable";case"primes":return"Primes";case"total":return"Total";default:return n}}}},sl={class:"table table-bordered"},il=["colspan"];function ll(n,e,r,p,i,s){const u=D("u-heures"),c=J,m=Y;return l(),o(g,null,[i.data.types.length>0?(l(),U(m,{key:0},{default:M(()=>[f(c,{cols:"6"},{default:M(()=>[e[1]||(e[1]=t("h2",null,"Totaux en heures équivalent TD",-1)),t("table",sl,[t("tr",null,[e[0]||(e[0]=t("th",null," ",-1)),(l(!0),o(g,null,x(i.data.types,a=>(l(),o("th",{key:a},d(s.tradType(a)),1))),128))]),(l(!0),o(g,null,x(i.data.heures,(a,C)=>(l(),o("tr",{key:C},[t("th",null,d(s.tradCategorie(C)),1),C!=="primes"?(l(!0),o(g,{key:0},x(a,(v,V)=>(l(),o("td",{class:"nombre",key:V},[f(u,{valeur:v},null,8,["valeur"])]))),128)):(l(),o("td",{key:1,class:"nombre",colspan:a.length},[f(u,{valeur:i.data.heures.primes.total},null,8,["valeur"])],8,il))]))),128))]),b(" "+d(i.serviceLigne),1)]),_:1})]),_:1})):h("",!0),e[2]||(e[2]=t("br",null,null,-1))],64)}const ol=k(rl,[["render",ll],["__scopeId","data-v-f852d328"]]),al=Object.freeze(Object.defineProperty({__proto__:null,default:ol},Symbol.toStringTag,{value:"Module"})),ul={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(n){this.formatted=this.formatage(n)}},methods:{formatage(n){if(n===void 0)return;let e=new Date(n);const r=e.getFullYear(),p=(e.getMonth()+1).toString().padStart(2,"0"),i=e.getDate().toString().padStart(2,"0"),s=e.getHours().toString().padStart(2,"0"),u=e.getMinutes().toString().padStart(2,"0"),c=e.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${i}/${p}/${r} à ${s}:${u}`;case"time":return`${s}:${u}:${c}`}return`${i}/${p}/${r}`}}};function dl(n,e,r,p,i,s){return d(i.formatted)}const H=k(ul,[["render",dl]]),ml={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(n){this.searchTerm=n.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(n){return unicaenVue.url("intervenant/code:"+n+"/voir")},reload(){var n=document.getElementById("term");n.focus(),this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(e=>{let r=e.data,p=[];for(const i in r){if(r[i].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){p.push(r[i]);continue}if(r[i].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){p.push(r[i]);continue}if(r[i].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){p.push(r[i]);continue}}this.intervenants=p,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(e=>{console.log(e.message)})},800)}}},cl={class:"intervenant-recherche"},hl={class:"critere"},pl={key:0,class:"table table-bordered table-hover"},fl=["title"],bl={style:{}},vl=["href"],_l={key:1,class:"table table-bordered table-hover"};function gl(n,e,r,p,i,s){const u=H;return l(),o(g,null,[e[16]||(e[16]=t("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1)),t("div",cl,[t("div",hl,[t("div",null,[t("input",{id:"term",autofocus:"",class:"form-control input",placeholder:"votre recherche...",type:"text",onKeyup:e[0]||(e[0]=(...c)=>s.rechercher&&s.rechercher(...c))},null,32),e[7]||(e[7]=t("br",null,null,-1))]),t("div",null,[e[8]||(e[8]=t("span",{class:"fw-bold"},"Types d'intervenant : ",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=c=>i.checkedTypes=c),checked:"checked",name:"type[]",type:"checkbox",value:"permanent",onChange:e[2]||(e[2]=c=>s.reload())},null,544),[[L,i.checkedTypes]]),e[9]||(e[9]=b(" Permanent ")),_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=c=>i.checkedTypes=c),checked:"checked",name:"type[]",type:"checkbox",value:"vacataire",onChange:e[4]||(e[4]=c=>s.reload())},null,544),[[L,i.checkedTypes]]),e[10]||(e[10]=b(" Vacataire ")),_(t("input",{"onUpdate:modelValue":e[5]||(e[5]=c=>i.checkedTypes=c),checked:"checked",name:"type[]",type:"checkbox",value:"etudiant",onChange:e[6]||(e[6]=c=>s.reload())},null,544),[[L,i.checkedTypes]]),e[11]||(e[11]=b(" Etudiant "))]),e[12]||(e[12]=t("br",null,null,-1))])]),i.intervenants.length>0?(l(),o("table",pl,[e[14]||(e[14]=t("thead",null,[t("tr",null,[t("th",{style:{width:"90px"}}),t("th",null,"Civilité"),t("th",null,"Nom"),t("th",null,"Prenom"),t("th",null,"Structure"),t("th",null,"Statut"),t("th",null,"Date de naissance"),t("th",null,"N° Personnel")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(i.intervenants,(c,m)=>(l(),o("tr",{class:A({"bg-danger":c.destruction!==null}),title:c.destruction!==null?"Fiche historisé":""},[t("td",bl,[t("a",{href:s.urlFiche(c.code)},e[13]||(e[13]=[t("i",{class:"fas fa-eye"},null,-1),b(" Fiche")]),8,vl)]),t("td",null,d(c.civilite),1),t("td",null,d(c.nom),1),t("td",null,d(c.prenom),1),t("td",null,d(c.structure),1),t("td",null,d(c.statut),1),t("td",null,[f(u,{value:c["date-naissance"]},null,8,["value"])]),t("td",null,d(c["numero-personnel"]),1)],10,fl))),256))])])):h("",!0),i.intervenants.length==0&&i.noResult==1?(l(),o("table",_l,e[15]||(e[15]=[t("thead",null,[t("tr",null,[t("th",{style:{width:"90px"}}),t("th",null,"Civilité"),t("th",null,"Nom"),t("th",null,"Prenom"),t("th",null,"Structure"),t("th",null,"Statut"),t("th",null,"Date de naissance"),t("th",null,"N° Personnel")])],-1),t("tbody",null,[t("tr",null,[t("td",{colspan:"8",style:{"text-align":"center"}},"Aucun intervenant trouvé")])],-1)]))):h("",!0)],64)}const yl=k(ml,[["render",gl]]),xl=Object.freeze(Object.defineProperty({__proto__:null,default:yl},Symbol.toStringTag,{value:"Module"})),Cl={name:"Structure",props:{structure:{required:!0}},data(){return{saisieUrl:unicaenVue.url("structure/voir/:structure",{structure:this.structure.id})+"?tab=edition",deleteUrl:unicaenVue.url("structure/delete/:structure",{structure:this.structure.id}),liste:this.$parent.liste}},computed:{hasSousStructures:function(){return Object.keys(this.structure.structures).length>0}},methods:{saisie(n){modAjax(n.currentTarget,e=>{this.refresh()})},supprimer(n){popConfirm(n.currentTarget,e=>{this.refresh()})},refresh(){this.liste.reload()}}},Vl={class:"accordion-item"},Sl={class:"accordion-header"},kl=["aria-controls","data-bs-target"],Pl=["href"],Al=["href"],Dl=["id"],Tl={class:"accordion-body"},Ml={class:"row"},Ul={class:"col-md-5"},El={class:"row"},Fl={class:"col-md-5"},Rl={class:"row"},wl={class:"col-md-5"},Il={key:0,class:"fas fa-check text-success"},Hl={key:1,class:"fas fa-xmark text-danger"},Ll={class:"row"},jl={class:"col-md-5"},Nl={key:0,class:"fas fa-check text-success"},Ol={key:1,class:"fas fa-xmark text-danger"},ql={class:"row"},zl={class:"col-md-5"},Bl={key:0,class:"sous-structures"},$l={class:"accordion"};function Gl(n,e,r,p,i,s){const u=D("structure",!0);return l(),o("div",Vl,[t("h2",Sl,[t("button",{"aria-controls":r.structure.id,"data-bs-target":`#str${r.structure.id}`,"aria-expanded":"true",class:"accordion-button","data-bs-toggle":"collapse",type:"button"},[r.structure.canEdit?(l(),o("a",{key:0,href:i.saisieUrl,class:"btn btn-primary btn-sm",title:"Modifier la structure",onClick:e[0]||(e[0]=P((...c)=>s.saisie&&s.saisie(...c),["prevent"]))},e[2]||(e[2]=[t("i",{class:"fas fa-pen-to-square"},null,-1)]),8,Pl)):h("",!0),r.structure.canDelete?(l(),o("a",{key:1,href:i.deleteUrl,class:"btn btn-danger btn-sm","data-content":"Êtes-vous sûr de vouloir supprimer la structure ?","data-title":"Suppression de la structure",title:"Supprimer la structure",onClick:e[1]||(e[1]=P((...c)=>s.supprimer&&s.supprimer(...c),["prevent"]))},e[3]||(e[3]=[t("i",{class:"fas fa-trash-can"},null,-1)]),8,Al)):h("",!0),b("   "+d(r.structure.libelleLong)+" ("+d(r.structure.libelleCourt)+") ",1)],8,kl)]),t("div",{id:`str${r.structure.id}`,class:"accordion-collapse collapse show"},[t("div",Tl,[t("div",Ml,[e[4]||(e[4]=t("div",{class:"col-md-5"},[t("strong",null,"Code"),b(" :")],-1)),t("div",Ul,d(r.structure.code),1)]),t("div",El,[e[5]||(e[5]=t("div",{class:"col-md-5"},[t("strong",null,"Source"),b(" :")],-1)),t("div",Fl,d(r.structure.source.libelle),1)]),t("div",Rl,[e[6]||(e[6]=t("div",{class:"col-md-5"},[t("strong",null,"Composante d'enseignement"),b(" :")],-1)),t("div",wl,[r.structure.enseignement?(l(),o("i",Il)):r.structure.enseignement?h("",!0):(l(),o("i",Hl))])]),t("div",Ll,[e[7]||(e[7]=t("div",{class:"col-md-5"},[t("strong",null,"Affichage de l'adresse sur le contrat de travail"),b(" :")],-1)),t("div",jl,[r.structure.affAdresseContrat?(l(),o("i",Nl)):r.structure.affAdresseContrat?h("",!0):(l(),o("i",Ol))])]),t("div",ql,[e[8]||(e[8]=t("div",{class:"col-md-5"},[t("strong",null,"Adresse"),b(" :")],-1)),t("div",zl,[t("pre",null,d(r.structure.adresse),1)])]),s.hasSousStructures?(l(),o("div",Bl,[e[9]||(e[9]=t("h4",null,"Sous-structures",-1)),t("div",$l,[(l(!0),o(g,null,x(r.structure.structures,c=>(l(),U(u,{key:c.id,structure:c,onRefresh:s.refresh},null,8,["structure","onRefresh"]))),128))])])):h("",!0)])],8,Dl)])}const re=k(Cl,[["render",Gl],["__scopeId","data-v-046af32d"]]),Jl=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"})),Yl={components:{structure:re},props:{canAdd:{type:Boolean,required:!0}},data(){return{structures:[],ajoutUrl:unicaenVue.url("structure/saisie"),liste:this}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},reload(){unicaenVue.axios.get(unicaenVue.url("structure/liste")).then(n=>{this.structures=n.data})}}},Ql={class:"accordion no-intranavigation"},Wl=["href"];function Xl(n,e,r,p,i,s){const u=D("structure");return l(),o(g,null,[e[2]||(e[2]=t("h1",null,"Administration des structures",-1)),t("div",Ql,[(l(!0),o(g,null,x(i.structures,c=>(l(),U(u,{key:c.id,structure:c},null,8,["structure"]))),128))]),r.canAdd?(l(),o("a",{key:0,class:"btn btn-primary no-intranavigation",href:i.ajoutUrl,onClick:e[0]||(e[0]=P((...c)=>s.ajout&&s.ajout(...c),["prevent"])),title:"Ajouter une structure"},e[1]||(e[1]=[t("i",{class:"fas fa-pen-to-square"},null,-1),b(" Ajouter une structure ")]),8,Wl)):h("",!0)],64)}const Kl=k(Yl,[["render",Xl]]),Zl=Object.freeze(Object.defineProperty({__proto__:null,default:Kl},Symbol.toStringTag,{value:"Module"})),eo={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},to=["id"],no={class:"modal-dialog"},ro={class:"modal-content"},so={class:"modal-header"},io={class:"modal-title"},lo={class:"modal-body"},oo={class:"modal-footer"};function ao(n,e,r,p,i,s){return l(),o("div",{class:"modal fade",id:r.id,tabindex:"-1","aria-hidden":"true"},[t("div",no,[t("div",ro,[t("div",so,[t("h5",io,d(r.title),1),e[0]||(e[0]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",lo,[N(n.$slots,"body")]),t("div",oo,[N(n.$slots,"footer"),e[1]||(e[1]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1))])])])],8,to)}const uo=k(eo,[["render",ao]]),mo={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String},rotate:{required:!1,type:String},id:{required:!1,type:String}}},co=["id"];function ho(n,e,r,p,i,s){return l(),o("i",{class:A(`fas fa-${r.name} text-${r.variant} fa-rotate-${r.rotate}`),id:`${r.id}`},null,10,co)}const I=k(mo,[["render",ho]]),po={name:"Mission",props:{mission:{required:!0}},data(){return{boxOne:"",boxTwo:"",validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(n){this.validationText=this.calcValidation(n)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":'<span class="bg-info">'+Util.formattedHeures(this.mission.heures)+"</span> heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(n){return n===null?"A valider":n.id===null?"Autovalidée":"Validation du "+Util.dateToString(n.histoCreation)+" par "},saisie(n){modAjax(n.currentTarget,e=>{this.refresh()})},async supprimer(n){const e=n.currentTarget.href,r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content,i=await this.$refs.confirmDialog.open(p,r);if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(i){const s=await unicaenVue.axios.get(e);s&&s.data&&this.$emit("supprimer",this.mission)}},async valider(n){const e=n.currentTarget.href,r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content;if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(await this.$refs.confirmDialog.open(p,r)){const s=await unicaenVue.axios.get(e);s&&s.data&&this.$emit("refresh",s.data)}},async devalider(n){const e=n.currentTarget.href,r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content;if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(await this.$refs.confirmDialog.open(p,r)){const s=await unicaenVue.axios.get(e);s&&s.data&&this.$emit("refresh",s.data)}},async volumeHoraireSupprimer(n){const e=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content;if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(await this.$refs.confirmDialog.open(p,r)){const s=await unicaenVue.axios.get(e);s&&s.data&&this.$emit("refresh",s.data)}},async volumeHoraireValider(n){const e=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content;if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(await this.$refs.confirmDialog.open(p,r)){const s=await unicaenVue.axios.get(e);s&&s.data&&this.$emit("refresh",s.data)}},async volumeHoraireDevalider(n){const e=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content;if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(await this.$refs.confirmDialog.open(p,r)){const s=await unicaenVue.axios.get(e);s&&s.data&&this.$emit("refresh",s.data)}},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(n=>{this.$emit("refresh",n.data)})}}},fo=["id"],bo={class:"card-header card-header-h3"},vo={key:0},_o={class:"float-end"},go={key:1},yo={key:2},xo={class:"float-end"},Co={class:"card-body"},Vo={class:"row"},So={class:"col-md-8"},ko={class:"row"},Po={class:"col-md-12"},Ao={class:"form-control"},Do={class:"row"},To={class:"col-md-6"},Mo={class:"form-control"},Uo={class:"col-md-6"},Eo={class:"form-control"},Fo={class:"col-md-7"},Ro={class:"input-group mb-3"},wo=["innerHTML"],Io=["data-bs-target"],Ho={key:0,class:"col-md-5"},Lo={class:"form-control"},jo={class:"row"},No={class:"col-md-12"},Oo={class:"form-control"},qo={key:0,class:"row"},zo={class:"col-md-12"},Bo={class:"form-control"},$o={class:"row"},Go={class:"col-md-12"},Jo=["href"],Yo=["href"],Qo=["href"],Wo=["href"],Xo={class:"col-md-4"},Ko={class:"table table-bordered table-condensed"},Zo={style:{"text-align":"right"}},ea={key:0},ta=["data-id"],na=["data-id"],ra=["data-id"];function sa(n,e,r,p,i,s){const u=H,c=I,m=D("utilisateur"),a=D("u-heures"),C=uo,v=D("u-confirm-dialog");return l(),o(g,null,[t("div",{id:r.mission.id,class:A([{"bg-success":r.mission.valide,"bg-default":!r.mission.valide},"card"])},[t("form",{onSubmit:e[4]||(e[4]=P((...V)=>n.submitForm&&n.submitForm(...V),["prevent"]))},[t("div",bo,[r.mission.libelleMission?(l(),o("h5",vo,[b(d(r.mission.libelleMission)+" ",1),t("span",_o,[e[8]||(e[8]=b("Du ")),f(u,{value:r.mission.dateDebut},null,8,["value"]),e[9]||(e[9]=b(" au ")),f(u,{value:r.mission.dateFin},null,8,["value"])])])):h("",!0),r.mission.libelleMission?(l(),o("h6",go,d(r.mission.typeMission.libelle),1)):h("",!0),r.mission.libelleMission?h("",!0):(l(),o("h5",yo,[b(d(r.mission.typeMission.libelle)+" ",1),t("span",xo,[e[10]||(e[10]=b("Du ")),f(u,{value:r.mission.dateDebut},null,8,["value"]),e[11]||(e[11]=b(" au ")),f(u,{value:r.mission.dateFin},null,8,["value"])])]))]),t("div",Co,[t("div",Vo,[t("div",So,[t("div",ko,[t("div",Po,[e[12]||(e[12]=t("label",{class:"form-label"},"Composante en charge du suivi",-1)),t("div",Ao,d(r.mission.structure.libelle),1)])]),t("div",Do,[t("div",To,[e[13]||(e[13]=t("label",{class:"form-label"},"Taux de rémunération",-1)),t("div",Mo,d(r.mission.tauxRemu?r.mission.tauxRemu.libelle:null),1)]),t("div",Uo,[e[14]||(e[14]=t("label",{class:"form-label"},"Taux majoré (dimanches/jours fériés)",-1)),t("div",Eo,d(r.mission.tauxRemuMajore?r.mission.tauxRemuMajore.libelle:r.mission.tauxRemu?"Idem ("+r.mission.tauxRemu.libelle+")":null),1)]),t("div",Fo,[e[15]||(e[15]=t("label",{class:"form-label"},"Nombre d'heures effectives prévisionnelles",-1)),t("div",Ro,[t("div",{class:"form-control",innerHTML:s.heuresLib},null,8,wo),t("button",{"data-bs-target":`#details-${r.mission.id}`,class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal"}," Détails ",8,Io)])]),r.mission.typeMission.besoinFormation?(l(),o("div",Ho,[e[16]||(e[16]=t("label",{class:"form-label"},"Heures de formation prévues",-1)),t("div",Lo,d(r.mission.heuresFormation),1)])):h("",!0)]),t("div",jo,[t("div",No,[e[17]||(e[17]=t("label",{class:"form-label"},"Descriptif de la mission",-1)),t("div",Oo,d(r.mission.description),1)])]),r.mission.typeMission.accompagnementEtudiants?(l(),o("div",qo,[t("div",zo,[e[18]||(e[18]=t("label",{class:"form-label"},"Etudiants suivis",-1)),t("div",Bo,[t("pre",null,d(r.mission.etudiantsSuivis),1)])])])):h("",!0),e[19]||(e[19]=t("div",{class:"row"},[t("div",{class:"col-md-12"}," ")],-1)),t("div",$o,[t("div",Go,[r.mission.canSaisie?(l(),o("a",{key:0,href:i.saisieUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=P((...V)=>s.saisie&&s.saisie(...V),["prevent"]))},"Modifier",8,Jo)):h("",!0),r.mission.canValider?(l(),o("a",{key:1,href:i.validerUrl,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider la mission ?","data-title":"Validation de la mission",onClick:e[1]||(e[1]=P((...V)=>s.valider&&s.valider(...V),["prevent"]))},"Valider",8,Yo)):h("",!0),r.mission.canDevalider?(l(),o("a",{key:2,href:i.devaliderUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider la mission ?","data-title":"Dévalidation de la mission",onClick:e[2]||(e[2]=P((...V)=>s.devalider&&s.devalider(...V),["prevent"]))},"Dévalider",8,Qo)):h("",!0),r.mission.canSupprimer?(l(),o("a",{key:3,href:i.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer la mission ?","data-title":"Suppression de la mission",onClick:e[3]||(e[3]=P((...V)=>s.supprimer&&s.supprimer(...V),["prevent"]))},"Supprimer",8,Wo)):h("",!0)])])]),t("div",Xo,[e[22]||(e[22]=t("div",null,[t("label",{class:"form-label"},"Suivi")],-1)),t("div",null,[f(c,{name:"thumbs-up",variant:"success"}),e[20]||(e[20]=b(" Créé le ")),f(u,{value:r.mission.histoCreation},null,8,["value"]),e[21]||(e[21]=b(" par ")),f(m,{mail:r.mission.histoCreateur.email,nom:r.mission.histoCreateur.displayName},null,8,["mail","nom"])]),t("div",null,[f(c,{name:r.mission.valide?"thumbs-up":"thumbs-down",variant:r.mission.valide?"success":"info"},null,8,["name","variant"]),b(" "+d(i.validationText)+" ",1),r.mission.validation&&r.mission.validation.histoCreateur?(l(),U(m,{key:0,mail:r.mission.validation.histoCreateur.email,nom:r.mission.validation.histoCreateur.displayName},null,8,["mail","nom"])):h("",!0)]),t("div",null,[f(c,{name:r.mission.contrat?"thumbs-up":"thumbs-down",variant:r.mission.contrat?"success":"info"},null,8,["name","variant"]),b(" "+d(r.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),t("div",null,d(r.mission.heuresRealisees)+" heure"+d(r.mission.heuresRealisees<2?"":"s")+" réalisée"+d(r.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,fo),f(C,{id:`details-${r.mission.id}`,title:"Détail des heures prévisionnelles"},{body:M(()=>[t("table",Ko,[e[28]||(e[28]=t("thead",null,[t("tr",null,[t("th",null,"Heures"),t("th",null,"Statut"),t("th",null,"Actions")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(r.mission.volumesHorairesPrevus,V=>(l(),o("tr",{key:V.id},[t("td",Zo,[f(a,{valeur:V.heures},null,8,["valeur"])]),t("td",null,[f(c,{name:"thumbs-up",variant:"success"}),e[25]||(e[25]=b(" Saisi par ")),f(m,{mail:V.histoCreateur.email,nom:V.histoCreateur.displayName},null,8,["mail","nom"]),e[26]||(e[26]=b(" le ")),f(u,{value:V.histoCreation},null,8,["value"]),e[27]||(e[27]=t("br",null,null,-1)),f(c,{name:V.valide?"thumbs-up":"thumbs-down",variant:V.valide?"success":"info"},null,8,["name","variant"]),b(" "+d(V.validation&&V.validation.id==null?"Autovalidé":V.validation?"":"à valider")+" ",1),V.validation&&V.validation.histoCreateur?(l(),o("span",ea,[e[23]||(e[23]=b(" Validé par ")),f(m,{mail:V.validation.histoCreateur.email,nom:V.validation.histoCreateur.displayName},null,8,["mail","nom"]),e[24]||(e[24]=b(" le ")),f(u,{value:V.validation.histoCreation},null,8,["value"])])):h("",!0)]),t("td",null,[V.canValider?(l(),o("a",{key:0,"data-id":V.id,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?","data-title":"Validation du volume horaire",onClick:e[5]||(e[5]=P((...S)=>s.volumeHoraireValider&&s.volumeHoraireValider(...S),["prevent"]))},"Valider",8,ta)):h("",!0),V.canDevalider?(l(),o("a",{key:1,"data-id":V.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?","data-title":"Dévalidation du volume horaire",onClick:e[6]||(e[6]=P((...S)=>s.volumeHoraireDevalider&&s.volumeHoraireDevalider(...S),["prevent"]))},"Dévalider",8,na)):h("",!0),V.canSupprimer?(l(),o("a",{key:2,"data-id":V.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?","data-title":"Suppression du volume horaire",onClick:e[7]||(e[7]=P((...S)=>s.volumeHoraireSupprimer&&s.volumeHoraireSupprimer(...S),["prevent"]))},"Supprimer",8,ra)):h("",!0)])]))),128))])])]),footer:M(()=>e[29]||(e[29]=[])),_:1},8,["id"]),f(v,{ref:"confirmDialog"},null,512)],64)}const se=k(po,[["render",sa],["__scopeId","data-v-62a72466"]]),ia=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),la={components:{mission:se},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],isMounted:!1,ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},supprimer(n){this.reload()},refresh(n){let e=Util.json.indexById(this.missions,n.id);this.missions[e]=n,this.refreshPlafonds()},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(n=>{this.missions=n.data,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?($(".plafonds").refresh(),$("#sidebar").refresh()):this.isMounted=!0}}},oa=["href"];function aa(n,e,r,p,i,s){const u=D("mission");return l(),o(g,null,[(l(!0),o(g,null,x(i.missions,c=>(l(),U(u,{onSupprimer:s.supprimer,onRefresh:s.refresh,key:c.id,mission:c},null,8,["onSupprimer","onRefresh","mission"]))),128)),r.canAddMission?(l(),o("a",{key:0,class:"btn btn-primary",href:i.ajoutUrl,onClick:e[0]||(e[0]=P((...c)=>s.ajout&&s.ajout(...c),["prevent"]))},"Ajout d'une nouvelle mission",8,oa)):h("",!0)],64)}const ua=k(la,[["render",aa]]),da=Object.freeze(Object.defineProperty({__proto__:null,default:ua},Symbol.toStringTag,{value:"Module"})),ma={name:"ListeCandidatures.vue",props:{intervenant:{required:!0},renseignerDonneesPersonnelles:{type:Boolean,required:!1}},data(){return{candidatures:[],urlListeOffre:unicaenVue.url("offre-emploi")}},mounted(){this.reload()},computed:{urlDonneesPersonnelles:function(){return unicaenVue.url("intervenant/:intervenant/dossier",{intervenant:this.intervenant})}},methods:{reload(){unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/get-candidatures",{intervenant:this.intervenant})).then(n=>{this.candidatures=n.data})},validerCandidature(n){modAjax(n.currentTarget,e=>{this.reload()})},refuserCandidature(n){popConfirm(n.currentTarget,e=>{this.reload()})},urlOffre(n){return unicaenVue.url("offre-emploi/detail/:offre",{offre:n.offre.id})},urlAccepterCandidature:function(n){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:n.id})},urlRefuserCandidature:function(n){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:n.id})}}},ca={key:0,class:"alert alert-primary",role:"alert"},ha=["href"],pa={class:"table table-bordered"},fa={key:0},ba={style:{"text-align":"center"}},va=["href"],_a={style:{"text-align":"center"}},ga={style:{"text-align":"center"}},ya={key:0,class:"badge rounded-pill bg-success"},xa={key:1,class:"badge rounded-pill bg-danger"},Ca={key:2,class:"badge rounded-pill bg-warning"},Va={style:{"text-align":"center"}},Sa=["href"],ka=["href"],Pa=["href"];function Aa(n,e,r,p,i,s){const u=H,c=I;return l(),o("div",null,[this.renseignerDonneesPersonnelles?(l(),o("div",ca,[e[2]||(e[2]=b(" Afin que vos candidatures soient étudiées, veuillez compléter ")),t("a",{href:this.urlDonneesPersonnelles},"vos données personnelles",8,ha),e[3]||(e[3]=b(" et fournir les pièces justificatives qui vous seront demandées. "))])):h("",!0),t("table",pa,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",null,"Offre d'emploi"),t("th",null,"Composante"),t("th",null,"Etat"),t("th",null,"Date commission"),t("th",null,"Action")])],-1)),t("tbody",null,[i.candidatures.length==0?(l(),o("tr",fa,e[4]||(e[4]=[t("td",{colspan:"5",style:{"text-align":"center"}},"Aucune candidature",-1)]))):h("",!0),(l(!0),o(g,null,x(i.candidatures,m=>(l(),o("tr",{key:m.id},[t("td",ba,[t("a",{href:s.urlOffre(m)},d(m.offre.titre),9,va)]),t("td",_a,d(m.offre.structure.libelleCourt),1),t("td",ga,[m.validation?(l(),o("span",ya,"Acceptée par "+d(m.validation.histoCreateur.displayName),1)):h("",!0),!m.validation&&m.motif!==null?(l(),o("span",xa,d(m.motif),1)):h("",!0),!m.validation&&m.motif===null?(l(),o("span",Ca,"En attente d'acceptation")):h("",!0)]),t("td",null,[m.dateCommission?(l(),U(u,{key:0,value:m.dateCommission},null,8,["value"])):h("",!0)]),t("td",Va,[!m.validation&&m.canValider?(l(),o("a",{key:0,href:s.urlAccepterCandidature(m),class:"btn btn-success","data-content":"Êtes vous sûr de vouloir accepter cette candidature ?","data-title":"Accepter la candidature",style:{color:"white"},title:"Accepter la candidature",onClick:e[0]||(e[0]=P((...a)=>s.validerCandidature&&s.validerCandidature(...a),["prevent"]))},e[5]||(e[5]=[t("i",{class:"fa-solid fa-check"},null,-1)]),8,Sa)):h("",!0),e[7]||(e[7]=b("  ")),!m.motif&&m.canRefuser?(l(),o("a",{key:1,href:s.urlRefuserCandidature(m),class:"btn btn-danger","data-content":"Êtes vous sûr de vouloir refuser cette candidature ?","data-title":"Refuser la candidature",style:{color:"white"},title:"Refuser la candidature",onClick:e[1]||(e[1]=P((...a)=>s.refuserCandidature&&s.refuserCandidature(...a),["prevent"]))},e[6]||(e[6]=[t("i",{class:"fa-sharp fa-solid fa-xmark"},null,-1)]),8,ka)):h("",!0)])]))),128))])]),t("a",{href:i.urlListeOffre,class:"btn btn-primary",title:"Voir les offres d'emploi"},[f(c,{name:"eye"}),e[9]||(e[9]=b(" Voir toutes les offres d'emploi "))],8,Pa),e[10]||(e[10]=b("  "))])}const Da=k(ma,[["render",Aa]]),Ta=Object.freeze(Object.defineProperty({__proto__:null,default:Da},Symbol.toStringTag,{value:"Module"})),Ma={name:"OffreEmploi.vue",props:{offre:{required:!0},utilisateur:{required:!1},extended:{type:Boolean,required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},decretText:{type:String,required:!1}},data(){return{saisirUrl:unicaenVue.url("offre-emploi/saisir/:offre",{offre:this.offre.id}),supprimerUrl:unicaenVue.url("offre-emploi/supprimer/:offre",{offre:this.offre.id}),validerUrl:unicaenVue.url("offre-emploi/valider/:offre",{offre:this.offre.id}),devaliderUrl:unicaenVue.url("offre-emploi/devalider/:offre",{offre:this.offre.id}),consulterUrl:unicaenVue.url("offre-emploi/detail/:offre",{offre:this.offre.id}),offreEmploiUrl:unicaenVue.url("offre-emploi"),postulerUrl:unicaenVue.url("offre-emploi/postuler/:id",{id:this.offre.id}),decret:!1}},computed:{isCandidat:function(){return!1},shortDesc:function(){if(!this.offre.description)return"";let n=this.offre.description.substr(0,200);return this.offre.description.length>200&&(n+="..."),n},descriptionHtml:function(){return this.offre.description?this.offre.description.replace(/(?:\r\n|\r|\n)/g,"<br />"):""},connectionLink:function(){let n="auth/connexion?redirect="+window.location.href;return unicaenVue.url(n)}},mounted(){this.decretText||(this.decret=!0)},methods:{saisir(n){modAjax(n.target,e=>{this.refresh()})},urlVoir:function(n){return unicaenVue.url("intervenant/:code/voir",{code:"code:"+n.intervenant.code})},urlVoirCandidature:function(n){return unicaenVue.url("intervenant/:code/candidature",{code:"code:"+n.intervenant.code})},urlAccepterCandidature:function(n){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:n.id})},urlRefuserCandidature:function(n){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:n.id})},refresh(){unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.offre.id})).then(n=>{this.$emit("refresh",n.data)})},supprimer(n){popConfirm(n.currentTarget,e=>{this.$emit("supprimer",this.offre)})},postuler(n){popConfirm(n.currentTarget,e=>{this.$emit("postuler",this.offre)})},valider(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},devalider(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},validerCandidature(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},refuserCandidature(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})}}},Ua={key:0,class:"col"},Ea={class:"card h-100"},Fa={class:"card-header"},Ra={class:"badge rounded-pill bg-info"},wa={key:0,class:"badge rounded-pill bg-success"},Ia={key:1,class:"badge rounded-pill bg-warning"},Ha={class:"card-body"},La={class:"bg-light",style:{padding:"5px"}},ja={class:"card-footer"},Na={class:"d-grid gap-2 d-md-flex justify-content-md-end"},Oa=["href"],qa={key:1},za={class:"page-header"},Ba={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},$a={class:"ms-2"},Ga=["href"],Ja={key:1,class:"alert alert-primary d-flex align-items-center",role:"alert"},Ya={key:2,class:"alert alert-primary d-flex align-items-center",role:"alert"},Qa={class:"bg-light",style:{padding:"10px"}},Wa=["innerHTML"],Xa={key:3,class:"alert alert-info"},Ka=["innerHTML"],Za={key:4},eu={class:"table table-bordered"},tu={key:0},nu={key:0},ru={key:0,colspan:"4",style:{"text-align":"center"}},su={key:1,colspan:"3",style:{"text-align":"center"}},iu=["href"],lu={key:0,class:"badge rounded-pill bg-success"},ou={key:1,class:"badge rounded-pill bg-danger"},au={key:2,class:"badge rounded-pill bg-warning"},uu={key:0},du=["href"],mu={class:"mt-5"},cu=["href"],hu=["href"],pu=["href"],fu=["href"],bu=["href"],vu=["href"];function _u(n,e,r,p,i,s){const u=H,c=I;return l(),o(g,null,[this.extended?h("",!0):(l(),o("div",Ua,[t("div",Ea,[t("div",Fa,[t("h4",null,d(r.offre.titre),1),t("span",Ra,d(r.offre.nombreHeures)+" heure(s)",1),e[6]||(e[6]=b("   ")),r.offre.validation?(l(),o("span",wa,[e[5]||(e[5]=b("Validée le ")),f(u,{value:r.offre.validation.histoCreation},null,8,["value"]),b(" par "+d(r.offre.validation.histoCreateur.displayName),1)])):h("",!0),r.offre.validation?h("",!0):(l(),o("span",Ia," En attente de validation par la DRH")),e[7]||(e[7]=b("  "))]),t("div",Ha,[t("p",La,[e[8]||(e[8]=t("b",null,"Créée le : ",-1)),f(u,{value:r.offre.histoCreation},null,8,["value"]),b(" par "+d(r.offre.histoCreateur.displayName),1),e[9]||(e[9]=t("br",null,null,-1)),e[10]||(e[10]=t("b",null,"Période à pourvoir : ",-1)),e[11]||(e[11]=b("du ")),f(u,{value:r.offre.dateDebut},null,8,["value"]),e[12]||(e[12]=b(" au ")),f(u,{value:r.offre.dateFin},null,8,["value"]),e[13]||(e[13]=t("br",null,null,-1)),e[14]||(e[14]=t("b",null,"Demandée par la composante :",-1)),b(" "+d(r.offre.structure.libelleCourt)+" ",1),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=t("b",null,"Type de mission :",-1)),b(" "+d(r.offre.typeMission.libelle),1)]),b(" "+d(s.shortDesc),1)]),t("div",ja,[t("div",Na,[t("a",{href:i.consulterUrl,class:"btn btn-primary",title:"Consulter "},[f(c,{name:"eye"}),e[17]||(e[17]=b(" Voir "))],8,Oa)])])])])),this.extended?(l(),o("div",qa,[t("h1",za,d(r.offre.titre),1),this.utilisateur?h("",!0):(l(),o("div",Ba,[e[20]||(e[20]=t("i",{class:"fa-solid fa-user"},null,-1)),t("div",$a,[e[18]||(e[18]=b(" Vous devez ")),t("a",{href:s.connectionLink,class:"text-decoration-underline alert-link"},"être identifé",8,Ga),e[19]||(e[19]=b(" pour pouvoir postuler. "))])])),!r.offre.canPostuler&&this.utilisateur?(l(),o("div",Ja,e[21]||(e[21]=[t("i",{class:"fa-solid fa-circle-xmark"},null,-1),t("div",{class:"ms-2"}," Vous n'avez pas les droits pour postuler à cette offre, merci de contacter votre administration de rattachement. ",-1)]))):h("",!0),s.isCandidat&&this.utilisateur?(l(),o("div",Ya,e[22]||(e[22]=[t("i",{class:"fa-solid fa-circle-xmark"},null,-1),t("div",{class:"ms-2"}," Vous avez déjà postulé à cette offre. ",-1)]))):h("",!0),t("p",Qa,[e[23]||(e[23]=t("b",null,"Créée le : ",-1)),f(u,{value:r.offre.histoCreation},null,8,["value"]),b(" par "+d(r.offre.histoCreateur.displayName),1),e[24]||(e[24]=t("br",null,null,-1)),e[25]||(e[25]=t("b",null,"Période à pourvoir : ",-1)),e[26]||(e[26]=b("du ")),f(u,{value:r.offre.dateDebut},null,8,["value"]),e[27]||(e[27]=b(" au ")),f(u,{value:r.offre.dateFin},null,8,["value"]),e[28]||(e[28]=t("br",null,null,-1)),e[29]||(e[29]=t("b",null,"Date limite de candidature :",-1)),f(u,{value:r.offre.dateLimite},null,8,["value"]),e[30]||(e[30]=t("br",null,null,-1)),e[31]||(e[31]=t("b",null,"Demandé par la composante :",-1)),b(" "+d(r.offre.structure.libelleCourt)+" ",1),e[32]||(e[32]=t("br",null,null,-1)),e[33]||(e[33]=t("b",null,"Type de mission :",-1)),b(" "+d(r.offre.typeMission.libelle)+" ",1),e[34]||(e[34]=t("br",null,null,-1)),e[35]||(e[35]=t("b",null,"Nombre d'heures pour la mission :",-1)),b(" "+d(r.offre.nombreHeures)+" heure(s) ",1),e[36]||(e[36]=t("br",null,null,-1)),e[37]||(e[37]=t("b",null,"Nombre de postes à pourvoir :",-1)),b(" "+d(r.offre.nombrePostes)+" poste(s) ",1),e[38]||(e[38]=t("br",null,null,-1))]),t("p",{innerHTML:this.descriptionHtml},null,8,Wa),this.decretText?(l(),o("p",Xa,[_(t("input",{id:"decret","onUpdate:modelValue":e[0]||(e[0]=m=>i.decret=m),name:"decret",type:"checkbox"},null,512),[[L,i.decret]]),e[39]||(e[39]=b("  ")),t("span",{innerHTML:this.decretText},null,8,Ka)])):h("",!0),e[54]||(e[54]=t("br",null,null,-1)),this.canVoirCandidature?(l(),o("div",Za,[e[44]||(e[44]=t("h5",null,[t("strong",null,"Liste des candidats :")],-1)),t("table",eu,[t("thead",null,[t("tr",null,[e[40]||(e[40]=t("th",null,"Intervenant",-1)),e[41]||(e[41]=t("th",null,"Etat",-1)),r.canValiderCandidature?(l(),o("th",tu,"Action")):h("",!0)])]),t("tbody",null,[r.offre.candidatures.length==0?(l(),o("tr",nu,[r.canValiderCandidature?(l(),o("td",ru,"Aucune candidature")):h("",!0),r.canValiderCandidature?h("",!0):(l(),o("td",su,"Aucune candidature"))])):h("",!0),(l(!0),o(g,null,x(r.offre.candidatures,m=>(l(),o("tr",null,[t("td",null,[t("a",{href:s.urlVoir(m)},d(m.intervenant.prenom+" "+m.intervenant.nomUsuel),9,iu)]),t("td",null,[m.validation?(l(),o("span",lu,[e[42]||(e[42]=b("Acceptée le ")),f(u,{value:m.validation.histoCreation},null,8,["value"]),b(" par "+d(m.validation.histoCreateur.displayName),1)])):h("",!0),!m.validation&&m.motif!==null?(l(),o("span",ou,d(m.motif),1)):h("",!0),!m.validation&&m.motif===null?(l(),o("span",au,"En attente d'acceptation")):h("",!0)]),this.canValiderCandidature?(l(),o("td",uu,[t("a",{href:s.urlVoirCandidature(m),class:"btn btn-primary",title:"Consulter "},[f(c,{name:"eye"}),e[43]||(e[43]=b(" Voir "))],8,du)])):h("",!0)]))),256))])])])):h("",!0),t("div",mu,[t("a",{href:i.offreEmploiUrl,class:"btn btn-secondary"},"Retour aux offres",8,cu),e[49]||(e[49]=b("  ")),this.canPostuler?(l(),o("a",{key:0,class:A([i.decret?"":"disabled","btn btn-primary"]),href:i.postulerUrl,"data-bs-original-title":"Vous devez être connecté pour postuler","data-bs-placement":"top","data-bs-toggle":"tooltip"},"Postuler",10,hu)):h("",!0),e[50]||(e[50]=b("  ")),r.offre.canModifier?(l(),o("a",{key:1,href:i.saisirUrl,class:"btn btn-primary",title:"Modifier",onClick:e[1]||(e[1]=P((...m)=>s.saisir&&s.saisir(...m),["prevent"]))},[f(c,{name:"pen-to-square"}),e[45]||(e[45]=b(" Modifier "))],8,pu)):h("",!0),e[51]||(e[51]=b("  ")),r.offre.validation&&r.offre.canValider?(l(),o("a",{key:2,href:i.devaliderUrl,class:"btn btn-danger",title:"Devalider",onClick:e[2]||(e[2]=P((...m)=>s.devalider&&s.devalider(...m),["prevent"]))},[f(c,{name:"thumbs-down"}),e[46]||(e[46]=b(" Devalider "))],8,fu)):h("",!0),e[52]||(e[52]=b("  ")),!r.offre.validation&&r.offre.canValider?(l(),o("a",{key:3,href:i.validerUrl,class:"btn btn-success",title:"Valider",onClick:e[3]||(e[3]=P((...m)=>s.valider&&s.valider(...m),["prevent"]))},[f(c,{name:"thumbs-up"}),e[47]||(e[47]=b(" Valider "))],8,bu)):h("",!0),e[53]||(e[53]=b("  ")),r.offre.canSupprimer?(l(),o("a",{key:4,href:i.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer l'offre ?","data-title":"Suppression de l'offre",title:"Supprimer",onClick:e[4]||(e[4]=P((...m)=>s.supprimer&&s.supprimer(...m),["prevent"]))},[f(c,{name:"trash"}),e[48]||(e[48]=b(" Supprimer "))],8,vu)):h("",!0)])])):h("",!0)],64)}const ie=k(Ma,[["render",_u]]),gu=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),yu={components:{offreEmploi:ie},props:{id:{type:Number,required:!1},utilisateur:{required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1}},data(){return{offres:[],ajoutUrl:unicaenVue.url("offre-emploi/saisir")}},mounted(){this.reload()},computed:{extended:function(){return!!this.id}},methods:{ajout(n){modAjax(n.target,e=>{this.reload()})},supprimer(){window.location.href=unicaenVue.url("offre-emploi")},refresh(n){let e=Util.json.indexById(this.offres,n.id);this.offres[e]=n},reload(){this.id?unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.id})).then(n=>{this.offres=[n.data]}):unicaenVue.axios.get(unicaenVue.url("offre-emploi/liste")).then(n=>{this.offres=n.data})}}},xu={key:0,class:"row row-cols-1 row-cols-md-2 g-4 mb-3"},Cu={key:1},Vu=["href"],Su={key:2};function ku(n,e,r,p,i,s){const u=D("offreEmploi");return l(),o(g,null,[s.extended?h("",!0):(l(),o("div",xu,[(l(!0),o(g,null,x(i.offres,c=>(l(),U(u,{key:c.id,canModifier:this.canModifier,canSupprimer:this.canSupprimer,canValider:this.canValider,canVoirCandidature:this.canVoirCandidature,offre:c,decretText:c.decretText,onRefresh:s.refresh,onSupprimer:s.supprimer},null,8,["canModifier","canSupprimer","canValider","canVoirCandidature","offre","decretText","onRefresh","onSupprimer"]))),128))])),s.extended?h("",!0):(l(),o("div",Cu,[this.canModifier?(l(),o("a",{key:0,href:i.ajoutUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=P((...c)=>s.ajout&&s.ajout(...c),["prevent"]))},"Ajouter une nouvelle offre",8,Vu)):h("",!0)])),s.extended?(l(),o("div",Su,[(l(!0),o(g,null,x(i.offres,c=>(l(),U(u,{key:c.id,canModifier:this.canModifier,canPostuler:this.canPostuler,canSupprimer:this.canSupprimer,canValider:this.canValider,canValiderCandidature:this.canValiderCandidature,canVoirCandidature:this.canVoirCandidature,decretText:c.decretText,extended:s.extended,offre:c,utilisateur:this.utilisateur,onRefresh:s.refresh,onSupprimer:s.supprimer},null,8,["canModifier","canPostuler","canSupprimer","canValider","canValiderCandidature","canVoirCandidature","decretText","extended","offre","utilisateur","onRefresh","onSupprimer"]))),128))])):h("",!0)],64)}const Pu=k(yu,[["render",ku]]),Au=Object.freeze(Object.defineProperty({__proto__:null,default:Pu},Symbol.toStringTag,{value:"Module"})),Du={name:"Prime.vue",props:{prime:{required:!0},numero:{required:!1},intervenant:{required:!0},canGerer:{type:Boolean,required:!1}},data(){return{declarationUrl:unicaenVue.url("prime/:intervenant/declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerUrl:unicaenVue.url("prime/:intervenant/supprimer-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),validerUrl:unicaenVue.url("prime/:intervenant/valider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),devaliderUrl:unicaenVue.url("prime/:intervenant/devalider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),telechargerUrl:unicaenVue.url("prime/:intervenant/telecharger-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),refuserUrl:unicaenVue.url("prime/:intervenant/refuser-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),modifierPrimeUrl:unicaenVue.url("prime/:intervenant/saisie/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerPrimeUrl:unicaenVue.url("prime/:intervenant/supprimer-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id})}},computed:{},methods:{supprimer(n){popConfirm(n.currentTarget,e=>{this.$emit("reload")})},valider(n){popConfirm(n.currentTarget,e=>{this.$emit("reload")})},devalider(n){popConfirm(n.currentTarget,e=>{this.$emit("reload")})},refuser(){unicaenVue.axios.post(this.refuserUrl).then(n=>{this.$emit("reload")})},modifierPrime(n){modAjax(n.currentTarget,e=>{this.$emit("reload")})},supprimerPrime(n){popConfirm(n.currentTarget,e=>{this.$emit("reload")})}}},Tu={key:0},Mu={key:0},Uu=["action"],Eu={class:"card-body"},Fu={class:"row"},Ru={key:0,class:"col-md-6"},wu={class:"card text-dark bg-light"},Iu={class:"card-body"},Hu=["disabled"],Lu={class:"card-footer d-grid gap-2"},ju=["disabled"],Nu={key:1,class:"col-md-6"},Ou={class:"card text-dark bg-light"},qu={class:"card-body"},zu=["href"],Bu={class:"card-footer",style:{"text-align":"right"}},$u=["href"],Gu=["href"],Ju=["href"],Yu={class:"col-md-6"},Qu={key:0},Wu=["checked","disabled"],Xu={key:0},Ku={key:1},Zu={key:2},ed={key:3},td={key:4},nd={key:5},rd={key:6},sd={class:"row"},id={class:"col-md-12"},ld={class:"float-end"},od=["href"],ad=["href"];function ud(n,e,r,p,i,s){const u=H,c=I;return l(),o("div",{class:A([{"bg-success":r.prime.validation,"bg-default":!r.prime.validation&&!r.prime.dateRefus,"bg-danger":r.prime.dateRefus},"card"])},[t("div",{class:A([{"text-white":r.prime.dateRefus},"card-header card-header-h3"])},[r.prime.id?(l(),o("h5",Tu,[b(" Indemnité de fin de contrat N°"+d(r.numero+1),1),e[6]||(e[6]=t("br",null,null,-1))])):h("",!0),t("div",null,[e[9]||(e[9]=t("u",null,"Mission(s) concernée(s)",-1)),e[10]||(e[10]=b(" : ")),(l(!0),o(g,null,x(r.prime.missions,(m,a)=>(l(),o("span",null,[b(d(m.typeMission.libelle)+" (Pour "+d(m.structure.libelleCourt)+" du ",1),f(u,{value:m.dateDebut},null,8,["value"]),e[7]||(e[7]=b(" au ")),f(u,{value:m.dateFin},null,8,["value"]),e[8]||(e[8]=b(") ")),a!=r.prime.missions.length-1?(l(),o("span",Mu,", ")):h("",!0)]))),256))])],2),t("form",{action:i.declarationUrl,enctype:"multipart/form-data",method:"post"},[t("div",Eu,[t("div",Fu,[r.prime.declaration?h("",!0):(l(),o("div",Ru,[t("div",wu,[e[12]||(e[12]=t("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1)),t("div",Iu,[e[11]||(e[11]=t("p",{class:"card-text"},[b(" Pour "),t("b",null,"bénéficier de votre indemnité de fin de contrat"),b(", vous devez déposer une déclaration sur l'honneur ("),t("a",{href:""},"exemple"),b(") signée précisant que vous ne débutez pas d'autre contrat dans la fonction au publique à la suite de ces missions. ")],-1)),t("input",{ref:"file",disabled:!!r.prime.dateRefus,name:"files[]",type:"file"},null,8,Hu)]),t("div",Lu,[t("input",{disabled:!!r.prime.dateRefus,class:"btn btn-primary",type:"submit",value:"Envoyer"},null,8,ju)])])])),r.prime.declaration?(l(),o("div",Nu,[t("div",Ou,[e[17]||(e[17]=t("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1)),t("div",qu,[e[13]||(e[13]=t("p",{class:"card-text"},"Vous pouvez télécharger votre déclaration sur l'honneur ci-dessous : ",-1)),t("a",{href:i.telechargerUrl},d(r.prime.declaration.nom),9,zu)]),t("div",Bu,[r.prime.declaration&&!r.prime.validation&&!r.prime.dateRefus?(l(),o("a",{key:0,href:i.supprimerUrl,class:"btn btn-danger",title:"Supprimer",onClick:e[0]||(e[0]=P((...m)=>s.supprimer&&s.supprimer(...m),["prevent"]))}," Supprimer ",8,$u)):h("",!0),e[14]||(e[14]=b("  ")),r.prime.declaration&&!r.prime.validation&&this.canGerer&&!r.prime.dateRefus?(l(),o("a",{key:1,href:i.validerUrl,class:"btn btn-success",title:"Valider",onClick:e[1]||(e[1]=P((...m)=>s.valider&&s.valider(...m),["prevent"]))}," Valider ",8,Gu)):h("",!0),e[15]||(e[15]=b("  ")),r.prime.declaration&&r.prime.validation&&this.canGerer&&!r.prime.dateRefus?(l(),o("a",{key:2,href:i.devaliderUrl,class:"btn btn-danger d-grid gap-2",title:"Dévalider",onClick:e[2]||(e[2]=P((...m)=>s.devalider&&s.devalider(...m),["prevent"]))}," Dévalider ",8,Ju)):h("",!0),e[16]||(e[16]=b("  "))])])])):h("",!0),t("div",Yu,[r.prime.validation?h("",!0):(l(),o("div",Qu,[t("input",{checked:r.prime.dateRefus,disabled:r.prime.validation,name:"prime",type:"checkbox",onChange:e[3]||(e[3]=(...m)=>s.refuser&&s.refuser(...m))},null,40,Wu),e[18]||(e[18]=b("  Ou en cochant cette case, ")),e[19]||(e[19]=t("b",null,"je déclare ne pas pouvoir bénéficier d'une indemnité",-1)),e[20]||(e[20]=b(" de fin de contrat en raison du démarrage d'un nouveau contrat au sein de la fonction publique à la suite de ces missions. ")),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=t("br",null,null,-1))])),t("div",null,[e[30]||(e[30]=t("div",null,[t("label",{class:"form-label"},"Suivi de la déclaration : ")],-1)),r.prime.dateRefus?(l(),o("div",Xu,[f(c,{name:"thumbs-down",variant:"danger"}),e[23]||(e[23]=b(" Indemnité refusée le ")),f(u,{value:r.prime.dateRefus},null,8,["value"])])):h("",!0),r.prime.declaration&&!r.prime.dateRefus?(l(),o("div",Ku,[f(c,{name:"thumbs-up",variant:"success"}),e[24]||(e[24]=b(" Déclaration déposée le ")),f(u,{value:r.prime.declaration.histoCreation},null,8,["value"]),b(" par "+d(r.prime.declaration.histoCreateur.displayName),1)])):h("",!0),!r.prime.declaration&&!r.prime.dateRefus?(l(),o("div",Zu,[f(c,{name:"thumbs-down",variant:"info"}),e[25]||(e[25]=b(" Aucune déclaration déposée "))])):h("",!0),r.prime.validation&&!r.prime.dateRefus?(l(),o("div",ed,[f(c,{name:"thumbs-up",variant:"success"}),e[26]||(e[26]=b(" Déclaration validée le ")),f(u,{value:r.prime.validation.histoCreation},null,8,["value"]),b(" par "+d(r.prime.validation.histoCreateur.displayName),1)])):h("",!0),!r.prime.validation&&!r.prime.dateRefus?(l(),o("div",td,[f(c,{name:"thumbs-down",variant:"info"}),e[27]||(e[27]=b(" Aucune déclaration validée "))])):h("",!0),r.prime.validation&&!r.prime.dateRefus?(l(),o("div",nd,[f(c,{name:"euro-sign",variant:"success"}),e[28]||(e[28]=b(" Intervenant éligible à une indemnité de fin de contrat "))])):h("",!0),r.prime.dateRefus?(l(),o("div",rd,[f(c,{name:"euro-sign",variant:"info"}),e[29]||(e[29]=b(" Intervenant non éligible à une indemnité de fin de contrat "))])):h("",!0)])])]),t("div",sd,[t("div",id,[t("span",ld,[!r.prime.validation&&!r.prime.dateRefus&&this.canGerer?(l(),o("a",{key:0,href:i.modifierPrimeUrl,class:"btn btn-primary",onClick:e[4]||(e[4]=P((...m)=>s.modifierPrime&&s.modifierPrime(...m),["prevent"]))},"Modifier",8,od)):h("",!0),e[31]||(e[31]=b("   ")),!r.prime.validation&&!r.prime.dateRefus&&this.canGerer?(l(),o("a",{key:1,href:i.supprimerPrimeUrl,class:"btn btn-danger",onClick:e[5]||(e[5]=P((...m)=>s.supprimerPrime&&s.supprimerPrime(...m),["prevent"]))},"Supprimer",8,ad)):h("",!0)])])])])],8,Uu)],2)}const le=k(Du,[["render",ud]]),dd=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"})),md={components:{prime:le},props:{intervenant:{type:Number,required:!0},numero:{type:Number,required:!1},missionsWithoutPrime:{type:Number,required:!1},canGerer:{type:Boolean,required:!1}},data(){return{load:!1,primes:[],ajoutUrl:unicaenVue.url("prime/:intervenant/saisie/",{intervenant:this.intervenant})}},mounted(){this.reload(),console.log(this.primes.length)},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},reload(){this.load=!1,this.primes=[],unicaenVue.axios.get(unicaenVue.url("prime/:intervenant/liste",{intervenant:this.intervenant})).then(n=>{this.primes=n.data,this.load=!0})}}},cd={key:0,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},hd={key:1,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},pd={key:2},fd=["href"];function bd(n,e,r,p,i,s){const u=D("prime");return l(),o(g,null,[(l(!0),o(g,null,x(i.primes,(c,m)=>(l(),U(u,{canGerer:r.canGerer,intervenant:this.intervenant,numero:m,prime:c,onReload:s.reload},null,8,["canGerer","intervenant","numero","prime","onReload"]))),256)),i.load?h("",!0):(l(),o("div",cd,e[1]||(e[1]=[b(" Chargement en cours..."),t("br",null,null,-1),t("br",null,null,-1)]))),i.primes.length==0&&i.load?(l(),o("div",hd,e[2]||(e[2]=[b(" Aucune indemnité de fin de contrat actuellement..."),t("br",null,null,-1),t("br",null,null,-1)]))):h("",!0),this.missionsWithoutPrime>0&&this.canGerer?(l(),o("div",pd,[t("a",{href:i.ajoutUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=P((...c)=>s.ajout&&s.ajout(...c),["prevent"]))},"Créer une nouvelle indemnité",8,fd)])):h("",!0)],64)}const vd=k(md,[["render",bd]]),_d=Object.freeze(Object.defineProperty({__proto__:null,default:vd},Symbol.toStringTag,{value:"Module"})),gd={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0},addDateDebut:{type:String,required:!1},addDateFin:{type:String,required:!1}},data(){const n=new Date(this.date);return{mois:n.getMonth()+1,annee:n.getFullYear()}},computed:{listeJours(){const n=new Date(this.date);n.setDate(1),n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1);let e=n.getDate();return Array.from({length:e},(r,p)=>p+1)}},watch:{date:function(n,e){const r=new Date(this.date);this.mois=r.getMonth()+1,this.annee=r.getFullYear()},mois:function(n,e){const r=new Date(this.date);r.setMonth(n-1),this.$emit("changeDate",r)},annee:function(n,e){const r=new Date(this.date);r.setFullYear(n),this.$emit("changeDate",r)}},methods:{nomJour(n){const e=new Date(this.date);return e.setDate(n),e.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let n=[];const e=new Date(2e3,0,1);for(let r=1;r<=12;r++){e.setMonth(r-1);let p=e.toLocaleString("fr-FR",{month:"long"});n.push({id:r,libelle:p})}return n},listeAnnees(){const e=new Date().getFullYear(),r=1;let p=[];for(let i=e-r;i<=e+r;i++)p.push(i);return p},canAdd(n){if(!this.canAddEvent)return!1;let e=this.addDateDebut;e===void 0?e=new Date("2000-01-01"):e==="now"?e=new Date:e=new Date(e);let r=this.addDateFin;r===void 0?r=new Date("2500-01-01"):r==="now"?r=new Date:r=new Date(r);let p=new Date(this.date);return p.setDate(n),e=this.isoDateOnly(e),r=this.isoDateOnly(r),p=this.isoDateOnly(p),!(p<e||p>r)},addEvent(n){const e=new Date(this.date);e.setDate(n.currentTarget.dataset.jour),this.$emit("addEvent",e,n)},prevMois(){const n=new Date(this.date);n.setMonth(n.getMonth()-1),this.$emit("changeDate",n)},nextMois(){const n=new Date(this.date);n.setMonth(n.getMonth()+1),this.$emit("changeDate",n)},eventsByJour(n){const e=new Date(this.date);let r={};for(let p in this.events){let i=this.events[p];i.date.getFullYear()===e.getFullYear()&&i.date.getMonth()+1===e.getMonth()+1&&i.date.getDate()===n&&(r[p]=i)}return r},isoDateOnly(n){const e=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),p=String(n.getDate()).padStart(2,"0");return`${e}-${r}-${p}`}}},yd={class:"calendar"},xd={class:"recherche"},Cd={class:"recherche btn-group"},Vd=["value"],Sd=["value"],kd={class:"table table-bordered table-hover table-sm"},Pd=["data-jour"],Ad={class:"nom-jour"},Dd={class:"numero-jour"},Td={class:"num-jour badge bg-secondary rounded-circle"},Md={key:0},Ud=["data-jour"];function Ed(n,e,r,p,i,s){const u=I;return l(),o("div",yd,[t("div",xd,[t("div",Cd,[t("button",{class:"btn btn-light",id:"prevMois",onClick:e[0]||(e[0]=(...c)=>s.prevMois&&s.prevMois(...c)),title:"Mois précédant"},[f(u,{name:"chevron-left"})]),_(t("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":e[1]||(e[1]=c=>i.mois=c)},[(l(!0),o(g,null,x(s.listeMois(),c=>(l(),o("option",{value:c.id},d(c.libelle),9,Vd))),256))],512),[[R,i.mois]]),_(t("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":e[2]||(e[2]=c=>i.annee=c)},[(l(!0),o(g,null,x(s.listeAnnees(),c=>(l(),o("option",{value:c},d(c),9,Sd))),256))],512),[[R,i.annee]]),t("button",{class:"btn btn-light",id:"nextMois",onClick:e[3]||(e[3]=(...c)=>s.nextMois&&s.nextMois(...c)),title:"Mois suivant"},[f(u,{name:"chevron-right"})])])]),t("table",kd,[(l(!0),o(g,null,x(s.listeJours,c=>(l(),o("tr",{"data-jour":c},[t("th",Ad,d(s.nomJour(c)),1),t("th",Dd,[t("div",Td,d(c<10?"0"+c.toString():c),1)]),t("td",null,[(l(!0),o(g,null,x(s.eventsByJour(c),(m,a)=>(l(),o("div",{class:"event",style:W("border-color:"+m.color+";background-color:"+m.bgcolor),key:a},[(l(),U(be(m.component),{event:m},null,8,["event"]))],4))),128)),s.canAdd(c)?(l(),o("div",Md,[t("button",{onClick:e[4]||(e[4]=(...m)=>s.addEvent&&s.addEvent(...m)),"data-jour":c,class:"btn btn-light btn-sm"},[f(u,{name:"plus"}),e[5]||(e[5]=b(" Nouvel événement "))],8,Ud)])):h("",!0)])],8,Pd))),256))])])}const Fd=k(gd,[["render",Ed],["__scopeId","data-v-b803dde7"]]),Rd={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(n){modAjax(n.currentTarget,e=>{this.suivi.refresh()})},async supprimer(n){const e=n.currentTarget.dataset.url,r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content,i=await this.$refs.confirmDialog.open(p,r);if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(i){const s=await unicaenVue.axios.get(e);s&&s.data&&this.suivi.refresh()}},valider(n){unicaenVue.axios.get(this.validerUrl).then(e=>{this.suivi.refresh()})},async devalider(n){const e=n.currentTarget.dataset.url,r=n.currentTarget.dataset.title,p=n.currentTarget.dataset.content,i=await this.$refs.confirmDialog.open(p,r);if(!e){console.error("Aucune URL trouvée sur le bouton !");return}if(i){const s=await unicaenVue.axios.get(e);s&&s.data&&this.suivi.refresh()}}}},wd={class:"event-content"},Id={class:"mission"},Hd={key:0,class:"badge bg-success"},Ld={class:"horaires"},jd={key:0,class:"badge bg-secondary"},Nd={key:0,class:"description"},Od={class:"event-actions"},qd={class:"btn-group btn-group-sm"},zd=["data-url"],Bd=["data-url"],$d=["data-url"],Gd=["data-url"];function Jd(n,e,r,p,i,s){const u=I,c=D("u-confirm-dialog");return l(),o(g,null,[t("div",wd,[t("p",Id,[b(d(r.event.mission.libelleMission||r.event.mission.libelleCourt)+" ",1),r.event.valide?(l(),o("span",Hd,"Validé")):h("",!0)]),t("p",Ld,[b(" de "+d(s.heureDebut)+" à "+d(s.heureFin)+", soit "+d(s.heures)+" heure"+d(s.heures<2?"":"s")+" ",1),r.event.formation?(l(),o("span",jd,"En formation")):h("",!0)]),r.event.description?(l(),o("p",Nd,d(r.event.description),1)):h("",!0)]),t("div",Od,[t("div",qd,[r.event.canEdit?(l(),o("button",{key:0,class:"btn btn-light",onClick:e[0]||(e[0]=(...m)=>s.modifier&&s.modifier(...m)),"data-title":"Modifier le suivi",title:"Modifier le suivi","data-url":i.modifierUrl},[f(u,{name:"pen-to-square"})],8,zd)):h("",!0),r.event.canValider?(l(),o("button",{key:1,class:"btn btn-light",onClick:e[1]||(e[1]=(...m)=>s.valider&&s.valider(...m)),"data-title":"Valider le suivi",title:"Valider le suivi","data-url":i.validerUrl},[f(u,{name:"check",class:"text-success"})],8,Bd)):h("",!0),r.event.canDevalider?(l(),o("button",{key:2,class:"btn btn-light",onClick:e[2]||(e[2]=(...m)=>s.devalider&&s.devalider(...m)),"data-title":"Dévalider le suivi",title:"Dévalider le suivi","data-url":i.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[f(u,{name:"xmark",class:"text-danger"})],8,$d)):h("",!0),r.event.canSupprimer?(l(),o("button",{key:3,class:"btn btn-light",onClick:e[3]||(e[3]=(...m)=>s.supprimer&&s.supprimer(...m)),"data-title":"Supprimer le suivi",title:"Supprimer le suivi","data-url":i.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[f(u,{name:"trash-can",class:"text-danger"})],8,Gd)):h("",!0)])]),f(c,{ref:"confirmDialog"},null,512)],64)}const oe=k(Rd,[["render",Jd],["__scopeId","data-v-e8d5184e"]]),Yd=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),Qd={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,isMounted:!1,suivi:[]}},methods:{changeDate(n){this.date=n},ajouter(n,e){const r={intervenant:this.intervenant,date:n.toISOString().slice(0,10)};e.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",r),modAjax(e.currentTarget,p=>{this.refresh()})},refresh(){const n=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let e=0,r=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(p=>{let i=[];for(let s in p.data){let u=p.data[s];r[u.mission.id]===void 0&&(r[u.mission.id]=n[e],e++),u.valide&&(u.bgcolor="#d0eddb"),u.color=r[u.mission.id],u.component=ve(oe),u.date=new Date(u.date),u.intervenant=this.intervenant,i.push(u)}this.suivi=i,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?$(".plafonds").refresh():this.isMounted=!0}}};function Wd(n,e,r,p,i,s){const u=Fd;return l(),U(u,{date:i.date,onChangeDate:s.changeDate,onAddEvent:s.ajouter,"can-add-event":r.canAddMission,addDateFin:"now",events:i.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const Xd=k(Qd,[["render",Wd]]),Kd=Object.freeze(Object.defineProperty({__proto__:null,default:Xd},Symbol.toStringTag,{value:"Module"})),Zd={name:"DemandeMiseEnPaiementStructure",props:{datas:{required:!0},intervenant:{required:!0}},computed:{datasBudget(){let n={};return Object.entries(this.datas.budget.dotation).forEach(([e,r])=>{e!="total"&&(n[e]={},n[e].libelle=r.libelle,n[e].dotation=r.heures,n[e].consommation=1001)}),Object.entries(this.datas.budget.consommation).forEach(([e,r])=>{e!="total"&&e in n&&(n[e].consommation=r.heures)}),n}},methods:{heuresStatutToString(n){if(n.heuresAPayer==n.heuresPayees&&n.heuresAPayer>0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-success">Paiement effectué</span>';if(n.heuresAPayer==n.heuresDemandees)return'<span style="font-size:12px;line-height:20px;" class="badge bg-secondary text-dark">Paiement demandé</span>';if(n.heuresDemandees==0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-light text-dark">A payer</span>';if(Number(n.heuresPayees)>Number(n.heuresAPayer)){let e=n.heuresPayees-n.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement effectué - '+parseFloat(e.toFixed(2))+" hetd(s) payées en trop. </span>"}if(Number(n.heuresDemandees)>Number(n.heuresAPayer)){let e=n.heuresDemandees-n.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement demandé - '+parseFloat(e.toFixed(2))+" hetd(s) demandées en trop. </span></span>"}return"indetermine"},supprimerDemandeMiseEnPaiement(n){this.btnState("remove-"+n,"disabled"),unicaenVue.axios.get(unicaenVue.url("paiement/:intervenant/supprimer-demande/:dmep",{intervenant:this.intervenant,dmep:n})).then(e=>{this.$emit("refresh")}).catch(e=>{this.$emit("refresh")})},disabledPaiement(n){return n.missionId!=""||n.formuleResServiceRefId!=""?!(n.centreCoutId&&n.domaineFonctionnel):!1},enabledPaiement(n,e){if(e=="mission"){let r=document.getElementById("add-"+n),p=document.getElementById("centreCout-"+n).value,i=document.getElementById("domaineFonctionnel-"+n).value;p!=""&&i!=""?r.disabled=!1:r.disabled=!0}},ajouterDemandeMiseEnPaiement(n){this.btnState("add-"+n,"disabled");let e={animation:!0,delay:15e3,autohide:!0},r=document.getElementById("heures-"+n),p=document.getElementById("centreCout-"+n),i=document.getElementById("domaineFonctionnel-"+n),s=Number(r.value),u=Number(r.getAttribute("max")),c=i?i.value:"",m=r.hasAttribute("data-type-heures-id")?r.getAttribute("data-type-heures-id"):"",a=r.hasAttribute("data-service-id")?r.getAttribute("data-service-id"):"",C=r.hasAttribute("data-service-referentiel-id")?r.getAttribute("data-service-referentiel-id"):"",v=r.hasAttribute("data-mission-id")?r.getAttribute("data-mission-id"):"",V=p.value;if(V=="")return unicaenVue.flashMessenger.toast("Vous devez sélectionner un centre de coût pour demander la mise en paiement de ces heures","error",e),this.$emit("refresh-btn-state"),!1;if(s>0&&s>u)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible, vous demandez "+s+" hetd(s) alors que vous pouvez demander maximum "+u+" hetd(s)","error",e),this.$emit("refresh-btn-state"),!1;var S=[];let F={heures:s,centreCoutId:V,typeHeuresId:m,serviceId:a,serviceReferentielId:C,domaineFonctionnelId:c,missionId:v,structureId:this.datas.id};S.push(F),unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),S).then(T=>{this.$emit("refresh")}).catch(T=>{this.$emit("refresh"),console.error(T)})},demanderToutesLesHeuresEnPaiement(n,e){this.btnState("add-all-"+n,"disabled");let r=[],i=document.getElementById("demande-mise-en-paiement-"+n).getElementsByTagName("tr");for(var s=0;s<i.length;s++)if(i[s].getElementsByTagName("input").length>0&&i[s].classList.contains("detailHeure")){let u=i[s].getElementsByTagName("input")[0],c=i[s].getElementsByTagName("select")[0],m=i[s].getElementsByTagName("select")[1],a=Number(u.value),C=Number(u.getAttribute("max"));if(a<=0||a>C)console.warn("Le nombre d'heures demandées en paiement n'est pas situé entre le max et min possible.");else{let v=c.value,V=u.hasAttribute("data-type-heures-id")?u.getAttribute("data-type-heures-id"):"",S=u.hasAttribute("data-mission-id")?u.getAttribute("data-mission-id"):"",F=u.hasAttribute("data-service-id")?u.getAttribute("data-service-id"):"",T=u.hasAttribute("data-service-referentiel-id")?u.getAttribute("data-service-referentiel-id"):"",w=m?m.value:"",me={heures:a,centreCoutId:v,typeHeuresId:V,serviceId:F,serviceReferentielId:T,domaineFonctionnelId:w,missionId:S,structureId:this.datas.id};r.push(me)}}unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),r).then(u=>{this.$emit("refresh")}).catch(u=>{this.$emit("refresh")})},filtrerCentresCouts(n,e){let r=[];for(var p in n){let i=p,s=[];n[p].forEach(function(u,c){u[e]==1&&s.push(u)}),s.length!=0&&r.push({group:i,child:s})}return r},notValueCentreCoutValue(n,e){return this.filtrerCentresCouts(n,e).length!=0?"Choisir un centre de coûts":"Aucun centre de coûts disponible: demande de paiement impossible"},totalHeure(n){let e=0;for(var r in n)e+=Number(n[r].heuresAPayer);return parseFloat(e.toFixed(2))},shorten(n,e=20){if(n===null)return n;if(n.length>e){var r='<span title="'+n+'"';return r+='data-bs-placement="top" data-bs-toggle="tooltip">',r+=n.substring(0,e)+"...",r+="</span>",r}else return n},substr(n,e=20){if(n===null)return n;if(n.length>e){var r=n.substring(0,e)+"...";return r}else return n},btnState(n,e){let r=document.getElementById(n);return r?(e=="enabled"&&(r.disabled=!1,r.querySelector("#waiting").style.display="none",r.querySelector("#action").style.display="inline-block"),e=="disabled"&&(r.disabled=!0,r.querySelector("#waiting").style.display="inline-block",r.querySelector("#action").style.display="none"),!0):!1},formatDate(n,e){return Util.dateToString(n)},pourcentageBudget(n){return Math.round(n.consommation/n.dotation*100)},bgBudget(n){return Math.round(n.consommation/n.dotation*100)>100?"bg-danger":"bg-success"}}},em=["id"],tm=["id"],nm=["aria-controls","data-bs-target"],rm=["id","aria-labelledby"],sm={class:"accordion-body"},im={key:0},lm={class:"container"},om={class:"table table-bordered caption-top",style:{"table-layout":"fixed",width:"100%"}},am={class:"table-light"},um={key:0,class:"text-center progress position-relative bg-secondary",style:{height:"30px"}},dm={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},mm=["aria-valuemax","aria-valuenow","title"],cm={key:1,class:"text-center"},hm={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},pm={key:0},fm={key:1},bm=["innerHTML"],vm={class:"container"},_m={class:"row"},gm={class:"col-12"},ym={class:"table mt-3 table-bordered"},xm={class:"table-light"},Cm={colspan:"2"},Vm={colspan:"2"},Sm={class:"table table-sm"},km={class:"detailHeure"},Pm={key:0,style:{width:"20%"}},Am=["title"],Dm={class:"number number-positif"},Tm=["title"],Mm={class:"number number-positif"},Um={key:1,style:{width:"20%"}},Em={class:"input-group col-1"},Fm=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],Rm={key:2},wm=["id"],Im={value:""},Hm=["label"],Lm=["selected","value"],jm=["innerHTML"],Nm=["innerHTML"],Om={style:{"font-size":"12px"}},qm={key:0},zm=["id","onClick"],Bm={key:1},$m=["id","onClick"],Gm={class:"table-light"},Jm={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},Ym={class:"container"},Qm={class:"row"},Wm={class:"col-12"},Xm={class:"table mt-3 table-bordered"},Km={colspan:"2"},Zm={class:"table table-sm"},ec={class:"detailHeure"},tc={key:0,style:{width:"20%"}},nc=["title"],rc={class:"number number-positif"},sc=["title"],ic={class:"number number-positif"},lc={key:1,style:{width:"20%"}},oc={class:"input-group col-1"},ac=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],uc={key:2},dc=["id"],mc={value:""},cc=["label"],hc=["selected","value"],pc=["innerHTML"],fc={key:4},bc=["id"],vc=["selected","value"],_c={key:5},gc=["innerHTML"],yc={style:{"font-size":"12px"}},xc={key:0},Cc=["id","onClick"],Vc={key:1},Sc=["id","onClick"],kc={class:"table-light"},Pc={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},Ac={class:"container"},Dc={class:"row"},Tc={class:"col-12"},Mc={class:"table mt-3 table-bordered"},Uc={colspan:"2"},Ec={class:"table table-sm"},Fc={class:"detailHeure"},Rc={key:0,style:{width:"20%"}},wc=["title"],Ic={class:"number number-positif"},Hc=["title"],Lc={class:"number number-positif"},jc={key:1,style:{width:"20%"}},Nc={class:"input-group col-1"},Oc=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],qc={key:2},zc=["id","onChange"],Bc={value:""},$c=["label"],Gc=["selected","value"],Jc=["innerHTML"],Yc={key:4},Qc=["id","onChange"],Wc=["selected","value"],Xc={key:5},Kc=["innerHTML"],Zc={style:{"font-size":"12px"}},eh={key:0},th=["id","onClick"],nh={key:1},rh=["id","onClick"],sh={class:"table-light"},ih={style:{"background-color":"#fbfbfb",padding:"10px","padding-right":"40px","text-align":"right"}},lh=["id"];function oh(n,e,r,p,i,s){const u=I;return l(),o("div",{id:"demande-mise-en-paiement-"+r.datas.code,class:"accordion-item"},[t("h2",{id:"dmep-heading-"+r.datas.code,class:"accordion-header"},[t("button",{"aria-controls":"dmep-collapse-"+r.datas.code,"data-bs-target":"#dmep-collapse-"+r.datas.code,"aria-expanded":"true",class:"accordion-button bg-light","data-bs-toggle":"collapse",type:"button"},d(r.datas.code+" - "+r.datas.libelle),9,nm)],8,tm),t("div",{id:"dmep-collapse-"+r.datas.code,"aria-labelledby":"dmep-heading-"+r.datas.code,class:"accordion-collapse collapse show"},[t("div",sm,[this.datas.budget.dotation.total>0?(l(),o("div",im,[e[1]||(e[1]=t("div",{class:"cartridge gray bordered",style:{"padding-bottom":"5px","margin-bottom":"20px"}},[t("span",null,"Budget")],-1)),t("div",lm,[t("table",om,[t("thead",am,[t("tr",null,[(l(!0),o(g,null,x(s.datasBudget,(c,m)=>(l(),o("th",{key:m,class:"fw-bold",scope:"col"},d(c.libelle),1))),128))])]),t("tbody",null,[t("tr",null,[(l(!0),o(g,null,x(s.datasBudget,(c,m)=>(l(),o("td",null,[c.dotation>0?(l(),o("div",um,[t("span",dm,d(c.consommation+" sur "+c.dotation)+" HETD",1),t("div",{"aria-valuemax":c.dotation,"aria-valuenow":c.consommation,class:A("progress-bar progress-bar-striped "+s.bgBudget(c)),style:W("width:"+s.pourcentageBudget(c)+"%;"),title:this.pourcentageBudget(c)+"%","aria-valuemin":"0",role:"progressbar"},null,14,mm)])):h("",!0),c.dotation==0?(l(),o("div",cm," Aucune dotation "+d(c.libelle),1)):h("",!0)]))),256))])])])])])):h("",!0),(l(!0),o(g,null,x(r.datas.etapes,(c,m)=>(l(),o("div",null,[(l(!0),o(g,null,x(c.enseignements,(a,C)=>(l(),o("div",null,[t("div",hm,[c.exterieur==0?(l(),o("span",pm,"Enseignement")):h("",!0),c.exterieur==1?(l(),o("span",fm,"Enseignement hors établissement")):h("",!0),t("span",{innerHTML:m+" - "+s.shorten(c.libelle,40)},null,8,bm),t("span",null,d(C+" - "+a.libelle),1)]),t("div",vm,[t("div",_m,[(l(!0),o(g,null,x(a.typeHeure,(v,V)=>(l(),o("div",gm,[t("table",ym,[t("thead",xm,[t("tr",null,[t("th",Cm,d(v.libelle),1)])]),t("tbody",null,[t("tr",null,[t("td",Vm,[t("table",Sm,[e[3]||(e[3]=t("thead",null,[t("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"Heures"),t("th",{scope:"col",style:{width:"40%","font-size":"12px"}},"Centre de coûts"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"État"),t("th",{style:{width:"15%","font-size":"12px"}})],-1)),t("tbody",null,[(l(!0),o(g,null,x(v.heures,(S,F)=>(l(),o("tr",km,[S.heuresDemandees!=0?(l(),o("td",Pm,[S.datePaiement?(l(),o("abbr",{key:0,title:"Payé en "+S.periodeLibelle+" le "+s.formatDate(S.datePaiement)},[t("span",Dm,d(Number(S.heuresPayees))+" hetd(s)",1)],8,Am)):h("",!0),S.datePaiement?h("",!0):(l(),o("abbr",{key:1,title:"Demandé le "+s.formatDate(S.dateDemande)},[t("span",Mm,d(Number(S.heuresDemandees))+" hetd(s)",1)],8,Tm))])):h("",!0),S.heuresDemandees==0?(l(),o("td",Um,[t("div",Em,[t("input",{id:"heures-"+m+"-"+C+"-"+V,"data-domaine-fonctionnel-id":S.domaineFonctionnelId,"data-mission-id":S.missionId,"data-service-id":S.serviceId,"data-service-referentiel-id":S.serviceReferentielId,"data-type-heures-id":S.typeHeureId,max:S.heuresAPayer,value:S.heuresAPayer,class:"form-control form-control-sm",min:"0",type:"number"},null,8,Fm),e[2]||(e[2]=t("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1))])])):h("",!0),S.heuresDemandees==0?(l(),o("td",Rm,[t("select",{id:"centreCout-"+m+"-"+C+"-"+V,class:"selectpicker","data-live-search":"true",name:"centreCout"},[t("option",Im,d(s.notValueCentreCoutValue(r.datas.centreCoutPaiement,S.typeHeureCode)),1),(l(!0),o(g,null,x(s.filtrerCentresCouts(r.datas.centreCoutPaiement,S.typeHeureCode),T=>(l(),o("optgroup",{key:T.group,label:T.group},[(l(!0),o(g,null,x(T.child,w=>(l(),o("option",{key:w.value,selected:w.centreCoutId==S.centreCout.centreCoutId,value:w.centreCoutId},d(w.centreCoutCode+" - "+w.centreCoutLibelle),9,Lm))),128))],8,Hm))),128))],8,wm)])):h("",!0),S.heuresDemandees!=0?(l(),o("td",{key:3,innerHTML:s.shorten(S.centreCout.code+" - "+S.centreCout.libelle,30)},null,8,jm)):h("",!0),t("td",{innerHTML:s.heuresStatutToString(S)},null,8,Nm),t("td",Om,[S.heuresPayees==0&&S.heuresDemandees>0?(l(),o("span",qm,[t("button",{id:"remove-"+S.mepId,class:"btn btn-danger",type:"button",onClick:T=>this.supprimerDemandeMiseEnPaiement(S.mepId)},[f(u,{id:"action",name:"trash",style:{color:"white"}}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,zm)])):h("",!0),S.heuresDemandees==0?(l(),o("span",Bm,[t("button",{id:"add-"+m+"-"+C+"-"+V,class:"btn btn-primary",type:"button",onClick:T=>this.ajouterDemandeMiseEnPaiement(m+"-"+C+"-"+V)},[f(u,{id:"action",name:"plus"}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,$m)])):h("",!0)])]))),256))])])])])]),t("tfoot",null,[t("tr",Gm,[e[4]||(e[4]=t("th",{scope:"row"},"Total heures à payer",-1)),t("td",null,d(s.totalHeure(v.heures))+" hetd(s)",1)])])])]))),256))])])]))),256))]))),256)),(l(!0),o(g,null,x(r.datas.fonctionsReferentiels,(c,m)=>(l(),o("div",null,[t("div",Jm,[e[5]||(e[5]=t("span",null,"Référentiel",-1)),t("span",null,d(c.libelle),1),t("span",null,d(this.substr(c.commentaires,40)),1)]),t("div",Ym,[t("div",Qm,[t("div",Wm,[t("table",Xm,[t("tbody",null,[t("tr",null,[t("td",Km,[t("table",Zm,[e[8]||(e[8]=t("thead",null,[t("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de coûts"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel "),t("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"État"),t("th",{style:{width:"15%","font-size":"12px"}})],-1)),t("tbody",null,[(l(!0),o(g,null,x(c.heures,(a,C)=>(l(),o("tr",ec,[a.heuresDemandees!=0?(l(),o("td",tc,[a.datePaiement?(l(),o("abbr",{key:0,title:"Payé en "+a.periodeLibelle+" le "+s.formatDate(a.datePaiement)},[t("span",rc,d(Number(a.heuresPayees))+" hetd(s)",1)],8,nc)):h("",!0),a.datePaiement?h("",!0):(l(),o("abbr",{key:1,title:"Demandé le "+s.formatDate(a.dateDemande)},[t("span",ic,d(Number(a.heuresDemandees))+" hetd(s)",1)],8,sc))])):h("",!0),a.heuresDemandees==0?(l(),o("td",lc,[t("div",oc,[t("input",{id:"heures-"+m,"data-domaine-fonctionnel-id":a.domaineFonctionnelId,"data-mission-id":a.missionId,"data-service-id":a.serviceId,"data-service-referentiel-id":a.serviceReferentielId,"data-type-heures-id":a.typeHeureId,max:a.heuresAPayer,value:a.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,ac),e[6]||(e[6]=t("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1))])])):h("",!0),a.heuresDemandees==0?(l(),o("td",uc,[t("select",{id:"centreCout-"+m,class:"selectpicker","data-live-search":"true",name:"centreCout"},[t("option",mc,d(s.notValueCentreCoutValue(r.datas.centreCoutPaiement,a.typeHeureCode)),1),(l(!0),o(g,null,x(s.filtrerCentresCouts(r.datas.centreCoutPaiement,"referentiel"),v=>(l(),o("optgroup",{key:v.group,label:v.group},[(l(!0),o(g,null,x(v.child,V=>(l(),o("option",{key:V.value,selected:V.centreCoutId==a.centreCout.centreCoutId,value:V.centreCoutId},d(V.centreCoutCode+" - "+V.centreCoutLibelle),9,hc))),128))],8,cc))),128))],8,dc)])):h("",!0),a.heuresDemandees!=0?(l(),o("td",{key:3,innerHTML:s.shorten(a.centreCout.code+" - "+a.centreCout.libelle,20)},null,8,pc)):h("",!0),a.heuresDemandees==0?(l(),o("td",fc,[t("select",{id:"domaineFonctionnel-"+m,class:"selectpicker","data-live-search":"true",name:"centreCout"},[e[7]||(e[7]=t("option",{value:""},"Aucun domaine fonctionnel",-1)),(l(!0),o(g,null,x(r.datas.domaineFonctionnelPaiement,v=>(l(),o("option",{selected:v.domaineFonctionnelId==a.domaineFonctionnel.domaineFonctionnelId,value:v.domaineFonctionnelId},d(v.domaineFonctionnelLibelle),9,vc))),256))],8,bc)])):h("",!0),a.heuresDemandees!=0?(l(),o("td",_c,d(a.domaineFonctionnel.libelle),1)):h("",!0),t("td",{innerHTML:s.heuresStatutToString(a)},null,8,gc),t("td",yc,[a.heuresPayees==0&&a.heuresDemandees>0?(l(),o("span",xc,[t("button",{id:"remove-"+a.mepId,class:"btn btn-danger",type:"button",onClick:v=>this.supprimerDemandeMiseEnPaiement(a.mepId)},[f(u,{id:"action",name:"trash",style:{color:"white"}}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,Cc)])):h("",!0),a.heuresDemandees==0?(l(),o("span",Vc,[t("button",{id:"add-"+m,class:"btn btn-primary",type:"button",onClick:v=>this.ajouterDemandeMiseEnPaiement(m)},[f(u,{id:"action",name:"plus"}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,Sc)])):h("",!0)])]))),256))])])])])]),t("tfoot",null,[t("tr",kc,[e[9]||(e[9]=t("th",{scope:"row"},"Total",-1)),t("td",null,d(s.totalHeure(c.heures))+" hetd(s)",1)])])])])])])]))),256)),(l(!0),o(g,null,x(r.datas.missions,c=>(l(),o("div",null,[t("div",Pc,[e[10]||(e[10]=t("span",null,"Mission",-1)),t("span",null,d(c.libelle),1)]),t("div",Ac,[t("div",Dc,[t("div",Tc,[t("table",Mc,[t("tbody",null,[t("tr",null,[t("td",Uc,[t("table",Ec,[e[13]||(e[13]=t("thead",null,[t("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de coûts"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel "),t("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"État"),t("th",{style:{width:"15%","font-size":"12px"}})],-1)),t("tbody",null,[(l(!0),o(g,null,x(c.heures,(m,a)=>(l(),o("tr",Fc,[m.heuresDemandees!=0?(l(),o("td",Rc,[m.datePaiement?(l(),o("abbr",{key:0,title:"Payé en "+m.periodeLibelle+" le "+s.formatDate(m.datePaiement)},[t("span",Ic,d(Number(m.heuresPayees))+" heure(s)",1)],8,wc)):h("",!0),m.datePaiement?h("",!0):(l(),o("abbr",{key:1,title:"Demandé le "+s.formatDate(m.dateDemande)},[t("span",Lc,d(Number(m.heuresDemandees))+" heure(s)",1)],8,Hc))])):h("",!0),m.heuresDemandees==0?(l(),o("td",jc,[t("div",Nc,[t("input",{id:"heures-"+c.missionId,"data-domaine-fonctionnel-id":m.domaineFonctionnelId,"data-mission-id":m.missionId,"data-service-id":m.serviceId,"data-service-referentiel-id":m.serviceReferentielId,"data-type-heures-id":m.typeHeureId,max:m.heuresAPayer,value:m.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,Oc),e[11]||(e[11]=t("span",{class:"input-group-text",style:{"font-size":"12px"}},"heure(s)",-1))])])):h("",!0),m.heuresDemandees==0?(l(),o("td",qc,[t("select",{id:"centreCout-"+c.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:C=>s.enabledPaiement(c.missionId,"mission")},[t("option",Bc,d(s.notValueCentreCoutValue(r.datas.centreCoutPaiement,m.typeHeureCode)),1),(l(!0),o(g,null,x(s.filtrerCentresCouts(r.datas.centreCoutPaiement,"mission"),C=>(l(),o("optgroup",{key:C.group,label:C.group},[(l(!0),o(g,null,x(C.child,v=>(l(),o("option",{key:v.value,selected:v.centreCoutId==m.centreCout.centreCoutId,value:v.centreCoutId},d(v.centreCoutCode+" - "+v.centreCoutLibelle),9,Gc))),128))],8,$c))),128))],40,zc)])):h("",!0),m.heuresDemandees!=0?(l(),o("td",{key:3,innerHTML:s.shorten(m.centreCout.code+" - "+m.centreCout.libelle,20)},null,8,Jc)):h("",!0),m.heuresDemandees==0?(l(),o("td",Yc,[t("select",{id:"domaineFonctionnel-"+c.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:C=>s.enabledPaiement(c.missionId,"mission")},[e[12]||(e[12]=t("option",{value:""},"Aucun domaine fonctionnel",-1)),(l(!0),o(g,null,x(r.datas.domaineFonctionnelPaiement,C=>(l(),o("option",{selected:C.domaineFonctionnelId==m.domaineFonctionnel.domaineFonctionnelId,value:C.domaineFonctionnelId},d(C.domaineFonctionnelLibelle),9,Wc))),256))],40,Qc)])):h("",!0),m.heuresDemandees!=0?(l(),o("td",Xc,d(m.domaineFonctionnel.libelle),1)):h("",!0),t("td",{innerHTML:s.heuresStatutToString(m)},null,8,Kc),t("td",Zc,[m.heuresPayees==0&&m.heuresDemandees>0?(l(),o("span",eh,[t("button",{id:"remove-"+m.mepId,class:"btn btn-danger",type:"button",onClick:C=>this.supprimerDemandeMiseEnPaiement(m.mepId)},[f(u,{id:"action",name:"trash",style:{color:"white"}}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,th)])):h("",!0),m.heuresDemandees==0?(l(),o("span",nh,[t("button",{id:"add-"+c.missionId,class:"btn btn-primary",type:"button",onClick:C=>this.ajouterDemandeMiseEnPaiement(c.missionId)},[f(u,{id:"action",name:"plus"}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,rh)])):h("",!0)])]))),256))])])])])]),t("tfoot",null,[t("tr",sh,[e[14]||(e[14]=t("th",{scope:"row"},"Total",-1)),t("td",null,d(s.totalHeure(c.heures))+" heure(s)",1)])])])])])])]))),256))]),t("div",ih,[t("button",{id:"add-all-"+r.datas.code,class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=c=>s.demanderToutesLesHeuresEnPaiement(r.datas.code,r.datas.libelle))},[f(u,{id:"action",name:"square-plus",style:{color:"white"}}),f(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}}),b(" DEMANDER TOUS LES PAIEMENTS POUR "+d(r.datas.libelleCourt),1)],8,lh)])],8,rm)],8,em)}const ae=k(Zd,[["render",oh]]),ah=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"})),uh={name:"DemandeMiseEnPaiement",components:{DemandeMiseEnPaiementStructure:ae},props:{intervenant:{required:!1},intervenantStructure:{required:!1}},data(){return{datasDemandesMiseEnPaiement:null,urlGetDemandesMiseEnPaiement:unicaenVue.url("intervenant/:intervenant/mise-en-paiement/get-demandes-mise-en-paiement",{intervenant:this.intervenant})}},methods:{getDemandesMiseEnPaiement(){unicaenVue.axios.get(this.urlGetDemandesMiseEnPaiement).then(n=>{this.datasDemandesMiseEnPaiement=n.data}).then(n=>{this.btnResetState()}).catch(n=>{this.btnResetState(),console.error(n)})},btnResetState(){Array.from(document.querySelectorAll('[id^="remove-"]')).forEach(p=>{p.disabled=!1,p.querySelector("#waiting").style.display="none",p.querySelector("#action").style.display="inline-block"}),Array.from(document.querySelectorAll('[id^="add-"]')).forEach(p=>{p.disabled=!1,p.querySelector("#waiting").style.display="none",p.querySelector("#action").style.display="inline-block"}),Array.from(document.querySelectorAll('[id^="add-all"]')).forEach(p=>{p.disabled=!1,p.querySelector("#waiting").style.display="none",p.querySelector("#action").style.display="inline-block"})}},computed:{haveDemandeMiseEnPaiement:function(){return this.datasDemandesMiseEnPaiement?Object.keys(this.datasDemandesMiseEnPaiement).length>0:!1}},mounted(){this.getDemandesMiseEnPaiement()},updated(){$(".selectpicker").selectpicker("render");var n=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));n.map(function(e){return new bootstrap.Tooltip(e)})}},dh={key:0,class:"text-center"},mh={key:1,id:"accordionPanelsStayOpenExample",class:"accordion"},ch={key:2,class:"text-center alert alert-secondary",role:"alert"};function hh(n,e,r,p,i,s){const u=D("demande-mise-en-paiement-structure");return l(),o(g,null,[this.datasDemandesMiseEnPaiement?h("",!0):(l(),o("div",dh,e[0]||(e[0]=[t("div",{class:"mt-5 spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Chargement des demandes de mise en paiement en cours...")],-1),b(" Chargement des demandes de mise en paiement en cours... ")]))),this.datasDemandesMiseEnPaiement?(l(),o("div",mh,[(l(!0),o(g,null,x(i.datasDemandesMiseEnPaiement,(c,m)=>(l(),U(u,{onRefreshBtnState:s.btnResetState,datas:c,intervenant:r.intervenant,onRefresh:s.getDemandesMiseEnPaiement},null,8,["onRefreshBtnState","datas","intervenant","onRefresh"]))),256))])):h("",!0),!s.haveDemandeMiseEnPaiement&&this.datasDemandesMiseEnPaiement?(l(),o("div",ch," Les demandes de mises en paiement sont effectuées par la composante : "+d(this.intervenantStructure),1)):h("",!0)],64)}const ph=k(uh,[["render",hh]]),fh=Object.freeze(Object.defineProperty({__proto__:null,default:ph},Symbol.toStringTag,{value:"Module"}));function bh(n){for(let e in n)for(let r in n[e])ue(n[e][r],e)}function vh(){let n=document.getElementById("unicaen-vue-toast-container");return n||(n=document.createElement("div"),n.id="unicaen-vue-toast-container",n.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(n)),n}function _h(n){return n=gh(n),n=yh(n),n}function gh(n){const e=document.createElement("div");e.innerHTML=n;const r=e.querySelector(".alert");return r?r.innerHTML:e.innerHTML}function yh(n){const e=document.createElement("div");return e.innerHTML=n,e.querySelectorAll("i.fas").forEach(p=>p.style.display="none"),e.innerHTML}function ue(n,e,r=null){const p={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},i={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"},s=document.createElement("button");s.classList.add("btn-close","btn-close-white","h5"),s.style.float="right",s.setAttribute("data-bs-dismiss","toast"),s.setAttribute("aria-label","Close");const u=document.createElement("i");u.classList.add("icon","fas",`fa-${i[e]}`),u.style.float="left",u.style.fontSize="26pt",u.style.paddingLeft=".4rem",u.style.marginTop=".4rem",u.style.paddingRight="1rem";const c=document.createElement("div");c.classList.add("toast-body"),c.innerHTML=_h(n);const m=document.createElement("div");m.appendChild(s),m.appendChild(u),m.appendChild(c);const a=document.createElement("div");a.classList.add("toast","text-white",p[e]?p[e]:"bg-secondary"),a.setAttribute("role","alert"),a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),e==="error"&&n.length>500&&a.setAttribute("style","width:700px"),a.appendChild(m),vh().appendChild(a),r==null&&(r={animation:!0,delay:e==="warning"?15e3:5e3,autohide:e!=="error"}),new bootstrap.Toast(a,r).show()}const O={toast:ue,toasts:bh};let j={..._e};j.interceptors.request.use(n=>{if(n.submitter){let e=n.msg?n.msg:"Action en cours";n.popover!=null&&n.popover.dispose(),n.popover=new bootstrap.Popover(n.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+e,html:!0,trigger:"focus"}),n.popover.show()}return n});j.interceptors.response.use(n=>{if(n.messages=n.data.messages,n.data=n.data.data,n.hasErrors=!!(n.messages&&n.messages.error&&n.messages.error.length>0),n.config.popover){var e=n.config.popover;let r="";for(ns in n.messages)for(mid in n.messages[ns])r+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+n.messages[ns][mid]+"</div>";r?(e._config.content=r,e.setContent(),setTimeout(()=>{e.dispose()},5e3)):e.dispose()}return n.messages&&O.toasts(n.messages),n},n=>{let e=n.response.data;n.response.status==403?e="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.":e=n.response.data,O.toast(e,"error")});j.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const xh={uvAxios:j},q={axios:xh.uvAxios,flashMessenger:O,url:(n,e,r)=>{let p=window.__unicaenVueBaseUrl;if(e)for(let s in e)n=n.replace(`:${s}`,e[s]);let i=r?q.encodeUrlQueryParam(r):null;return p+n+(i?`?${i}`:"")},encodeUrlQueryParam:(n,e)=>{var r=[];for(var p in n)if(n.hasOwnProperty(p)){var i=n[p],s=e?e+"["+encodeURIComponent(p)+"]":encodeURIComponent(p);if(typeof i=="object"&&i!==null)r.push(q.encodeUrlQueryParam(i,s));else{var u=encodeURIComponent(i);r.push(s+"="+u)}}return r.join("&")}};window.unicaenVue=q;const Ch={name:"DemandeMiseEnPaiementLot.vue",props:{structures:{type:Array,required:!0},canMiseEnPaiement:{type:Boolean,required:!0}},data(){return{selectedStructure:null,urlRechercheDemandeMiseEnPaiement:unicaenVue.url("paiement/demande-mise-en-paiement-lot"),urlProcessDemandeMiseEnPaiement:unicaenVue.url("paiement/process-demande-mise-en-paiement-lot"),urlMiseEnPaiement:unicaenVue.url("paiement/etat-demande-paiement"),permanents:[],vacataires:[],etudiants:[],autres:[],intervenants:[],dotation:!1,liquidation:null,totalConsommationPaieEtat:0,totalConsommationRessourcePropre:0,totalConsommation:0,alertDotation:!1}},computed:{haveDotation(){return this.dotation?this.dotation.total>0:!1},alertPaieEtat(){return this.dotation.paieEtat<this.totalConsommationPaieEtat?"text-danger fw-bold":""},alertRessourcePropre(){return this.dotation.ressourcePropre<this.totalConsommationRessourcePropre?"text-danger fw-bold":""}},methods:{findDemandeMiseEnPaiement(n){this.totalConsommationRessourcePropre=0,this.totalConsommationPaieEtat=0,this.dotation=null,this.liquidation=null;let e=document.getElementById("formRechercheDemandeMiseEnPaiement"),r=new FormData(e),p=document.getElementById("btn-rdmep"),i=document.getElementById("btn-rdmep-inprogress");i.classList.remove("d-none"),p.classList.add("d-none"),p.disabled=!0,unicaenVue.axios.post(this.urlRechercheDemandeMiseEnPaiement,r,{}).then(s=>{this.dispatchDatas(s.data),p.disabled=!1,i.classList.add("d-none"),p.classList.remove("d-none"),document.querySelectorAll('input[type="checkbox"]').forEach(function(c,m){c.checked=!0}),unicaenVue.axios.get(unicaenVue.url("budget/get-budget-structure/:structure",{structure:this.selectedStructure})).then(c=>{let m=c.data;this.dotation=m.dotation,this.liquidation=m.liquidation,this.refreshTotalConsommation()})}).catch(s=>{console.error(s)})},processDemandeMiseEnPaiement(n){let e=document.getElementById("formProcessDemandeMiseEnPaiement"),r=new FormData(e);if(this.dotation.paieEtat>=this.totalConsommationPaieEtat&&this.dotation.ressourcePropre>=this.totalConsommationRessourcePropre||!this.haveDotation){let p=document.getElementById("btn-pdmep"),i=document.getElementById("btn-pdmep-inprogress");i.classList.remove("d-none"),p.classList.add("d-none"),p.disabled=!0,unicaenVue.axios.post(this.urlProcessDemandeMiseEnPaiement,r,{}).then(s=>{this.findDemandeMiseEnPaiement(),p.disabled=!1,i.classList.add("d-none"),p.classList.remove("d-none")}).catch(s=>{console.error("Error process dmep")})}},refreshTotalConsommation(){let n=0,e=0,r=0;n=parseFloat(this.liquidation.paieEtat),e=parseFloat(this.liquidation.ressourcePropre),r+=parseFloat(this.liquidation.ressourcePropre),r+=parseFloat(this.liquidation.paieEtat),document.querySelectorAll('input[type="checkbox"]').forEach(function(i,s){i.hasAttribute("data-paie-etat")&&i.checked&&(n+=parseFloat(i.getAttribute("data-paie-etat")),r+=parseFloat(i.getAttribute("data-paie-etat"))),i.hasAttribute("data-ressource-propre")&&i.checked&&(e+=parseFloat(i.getAttribute("data-ressource-propre")),r+=parseFloat(i.getAttribute("data-ressource-propre")))}),this.totalConsommationPaieEtat=n.toFixed(2),this.totalConsommationRessourcePropre=e.toFixed(2),this.totalConsommation=r.toFixed(2),this.alertDotation=(this.dotation.paieEtat<this.totalConsommationPaieEtat||this.dotation.ressourcePropre<this.totalConsommationRessourcePropre)&&this.dotation.total>0},totalPayable(n){let e=0;return n.forEach((r,p)=>{r.centreCout.code!=""&&(r.missionId!=""||r.serviceRefId!=""?r.domaineFonctionnel.code!=""&&(e+=r.heuresAPayer):e+=r.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalNonPayable(n){let e=0;return n.forEach((r,p)=>{(r.centreCout.code==""||(r.missionId!=""||r.serviceRefId!="")&&r.domaineFonctionnel.code=="")&&(e+=r.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePaieEtat(n){let e=0;return n.forEach((r,p)=>{r.centreCout.typeRessourceCode=="paie-etat"&&(e+=r.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePropre(n){let e=0;return n.forEach((r,p)=>{r.centreCout.typeRessourceCode=="ressources-propres"&&(e+=r.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},dispatchDatas(n){this.vacataires=[],this.permanents=[],this.etudiants=[],this.autres=[],this.intervenants=[],console.log(n);for(const[e,r]of Object.entries(n))switch(r.datasIntervenant.typeIntervenant){case"Vacataire":this.vacataires.push(r),this.intervenants.push(r);break;case"Intervenant permanent":this.permanents.push(r),this.intervenants.push(r);break;case"Étudiant":this.etudiants.push(r),this.intervenants.push(r);break;default:this.autres.push(r),this.intervenants.push(r)}},toggleCheckbox(n){let e=Array.from(document.getElementsByClassName(n.target.className));n.target.checked?e.forEach(function(r,p){r.checked=!0}):e.forEach(function(r,p){r.checked=!1}),this.refreshTotalConsommation()},urlIntervenant(n){return unicaenVue.url("intervenant/code::intervenantCode/mise-en-paiement/demande",{intervenantCode:n.datasIntervenant.code})},formattedHETD(n){return Util.formattedHeures(n,!1)}}},Vh={class:"card text-dark bg-light"},Sh={class:"card-body"},kh={id:"formRechercheDemandeMiseEnPaiement",action:"",method:"post"},Ph={class:"mb-3"},Ah=["value"],Dh={class:"mb-3"},Th=["disabled"],Mh={key:0},Uh={key:0,class:"alert alert-danger",role:"alert"},Eh={class:"table table-bordered caption-top"},Fh={class:"fw-bold"},Rh={class:"fw-bold"},wh={id:"dmep",class:"accordion"},Ih={id:"formProcessDemandeMiseEnPaiement",action:"",method:"post"},Hh={key:0,class:"accordion-item"},Lh={id:"dmep-permanents-heading",class:"accordion-header"},jh={"aria-controls":"dmep-permanents-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-permanents-collapse","data-bs-toggle":"collapse",type:"button"},Nh={id:"dmep-permanents-collapse","aria-labelledby":"dmep-permanents-heading",class:"accordion-collapse collapse show"},Oh={class:"accordion-body"},qh={class:"table"},zh={scope:"col"},Bh=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],$h=["href"],Gh=["title"],Jh={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Yh={key:1,class:"accordion-item"},Qh={id:"dmep-vacataires-heading",class:"accordion-header"},Wh={"aria-controls":"dmep-vacataires-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-vacataires-collapse","data-bs-toggle":"collapse",type:"button"},Xh={id:"dmep-vacataires-collapse","aria-labelledby":"dmep-vacataires-heading",class:"accordion-collapse collapse show"},Kh={class:"accordion-body"},Zh={class:"table"},ep=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],tp=["href"],np=["title"],rp={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},sp={key:2,class:"accordion-item"},ip={id:"dmep-etudiants-heading",class:"accordion-header"},lp={"aria-controls":"dmep-etudiants-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-etudiants-collapse","data-bs-toggle":"collapse",type:"button"},op={id:"dmep-etudiants-collapse","aria-labelledby":"dmep-etudiants-heading",class:"accordion-collapse collapse show"},ap={class:"accordion-body"},up={class:"table"},dp=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],mp=["href"],cp=["title"],hp={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},pp={key:3,class:"accordion-item"},fp={id:"dmep-autres-heading",class:"accordion-header"},bp={"aria-controls":"dmep-autres-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-autres-collapse","data-bs-toggle":"collapse",type:"button"},vp={id:"dmep-autres-collapse","aria-labelledby":"dmep-autres-heading",class:"accordion-collapse collapse show"},_p={class:"accordion-body"},gp={class:"table"},yp=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],xp=["href"],Cp=["title"],Vp={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Sp=["value"],kp={key:4,class:"mt-3"},Pp=["disabled"],Ap=["href"];function Dp(n,e,r,p,i,s){return l(),o(g,null,[e[31]||(e[31]=t("h1",null,"Demande de mise en paiement par lots",-1)),t("div",Vh,[e[14]||(e[14]=t("div",{class:"card-header text-uppercase fw-bold"}," Recherchez des heures en attente de demande de mise en paiement : ",-1)),t("div",Sh,[t("form",kh,[t("div",Ph,[e[11]||(e[11]=t("label",{class:"form-label",for:"modele"},"Choisissez une structure ",-1)),e[12]||(e[12]=b("  ")),_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=u=>i.selectedStructure=u),class:"form-select",name:"structure"},[(l(!0),o(g,null,x(r.structures,u=>(l(),o("option",{value:u.id},d(u.libelle),9,Ah))),256))],512),[[R,i.selectedStructure]])]),t("div",Dh,[e[13]||(e[13]=t("button",{id:"btn-rdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[t("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),b("  Veuillez patienter... ")],-1)),t("button",{id:"btn-rdmep",disabled:!i.selectedStructure,class:"btn btn-primary",type:"button",onClick:e[1]||(e[1]=(...u)=>s.findDemandeMiseEnPaiement&&s.findDemandeMiseEnPaiement(...u))}," Lancer la recherche ",8,Th)])])])]),e[32]||(e[32]=t("div",{class:"alert alert-info",role:"alert"},[b(" Seules les HETD "),t("strong",null,"(hors référentiel)"),b(" avec des centres de coûts pré-paramètrés peuvent bénéficier d'une demande de mise en paiement automatisées. Pour les autres, il faudra passer sur chaque fiches intervenant pour faire les demandes en sélectionnant le centre de coût manuellement. ")],-1)),s.haveDotation?(l(),o("div",Mh,[i.alertDotation?(l(),o("div",Uh," Attention vous dépassez vos dotations, vous ne pourrez pas lancer les demandes de mise en paiement par lot. Veuillez ajuster votre sélection d'intervenants pour faire les demandes de mise en paiement. ")):h("",!0),t("table",Eh,[e[17]||(e[17]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-bold",scope:"col"},"Budget"),t("th",{class:"fw-bold",scope:"col"},"Paie etat"),t("th",{class:"fw-bold",scope:"col"},"Ressource propre"),t("th",{class:"fw-bold",scope:"col"},"Total")])],-1)),t("tbody",null,[t("tr",null,[e[15]||(e[15]=t("td",null,"Dotation",-1)),t("td",null,d(s.formattedHETD(this.dotation.paieEtat))+" HETD",1),t("td",null,d(s.formattedHETD(this.dotation.ressourcePropre))+" HETD",1),t("td",Fh,d(s.formattedHETD(this.dotation.total))+" HETD",1)]),t("tr",null,[e[16]||(e[16]=t("td",null,"Consommation",-1)),t("td",null,[t("span",{class:A(s.alertPaieEtat)},d(s.formattedHETD(this.totalConsommationPaieEtat))+" HETD",3)]),t("td",null,[t("span",{class:A(s.alertRessourcePropre)},d(s.formattedHETD(this.totalConsommationRessourcePropre))+" HETD",3)]),t("td",Rh,d(s.formattedHETD(this.totalConsommation))+" HETD",1)])])])])):h("",!0),t("div",wh,[t("form",Ih,[this.permanents.length>0?(l(),o("div",Hh,[t("h2",Lh,[t("button",jh,d(this.permanents.length)+" Permanent(s) ",1)]),t("div",Nh,[t("div",Oh,[t("table",qh,[t("thead",null,[t("tr",null,[t("th",zh,[t("input",{id:"allPermanents",checked:"checked",class:"checkbox-permanent",name:"allPermanents",type:"checkbox",onClick:e[2]||(e[2]=(...u)=>s.toggleCheckbox&&s.toggleCheckbox(...u))})]),e[18]||(e[18]=t("th",{scope:"col"},"Intervenant",-1)),e[19]||(e[19]=t("th",null,"HETD payables",-1)),e[20]||(e[20]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(l(!0),o(g,null,x(this.permanents,u=>(l(),o("tr",null,[t("td",null,[t("input",{id:"permanent-"+u.datasIntervenant.id,"data-paie-etat":s.totalRessourcePaieEtat(u.heures),"data-ressource-propre":s.totalRessourcePropre(u.heures),disabled:s.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:s.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-permanent",type:"checkbox",onChange:e[3]||(e[3]=c=>s.refreshTotalConsommation())},null,40,Bh)]),t("td",null,[t("a",{href:s.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,$h)]),t("td",null,[t("span",{title:s.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+s.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(s.totalPayable(u.heures))+" h",9,Gh)]),t("td",null,[t("span",Jh,d(s.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.vacataires.length>0?(l(),o("div",Yh,[t("h2",Qh,[t("button",Wh,d(this.vacataires.length)+" Vacataire(s) ",1)]),t("div",Xh,[t("div",Kh,[t("table",Zh,[t("thead",null,[t("tr",null,[t("th",null,[t("input",{id:"allVacataire",checked:"checked",class:"checkbox-vacataire",name:"allVacataire",type:"checkbox",onClick:e[4]||(e[4]=(...u)=>s.toggleCheckbox&&s.toggleCheckbox(...u))})]),e[21]||(e[21]=t("th",null,"Intervenant",-1)),e[22]||(e[22]=t("th",null,"HETD payables",-1)),e[23]||(e[23]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(l(!0),o(g,null,x(this.vacataires,u=>(l(),o("tr",null,[t("td",null,[t("input",{id:"vacataire-"+u.datasIntervenant.id,"data-paie-etat":s.totalRessourcePaieEtat(u.heures),"data-ressource-propre":s.totalRessourcePropre(u.heures),disabled:s.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:s.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-vacataire",type:"checkbox",onChange:e[5]||(e[5]=c=>s.refreshTotalConsommation())},null,40,ep)]),t("td",null,[t("a",{href:s.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,tp)]),t("td",null,[t("span",{title:s.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+s.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(s.totalPayable(u.heures))+" h",9,np)]),t("td",null,[t("span",rp,d(s.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.etudiants.length>0?(l(),o("div",sp,[t("h2",ip,[t("button",lp,d(this.etudiants.length)+" Etudiant(s) ",1)]),t("div",op,[t("div",ap,[t("table",up,[t("thead",null,[t("tr",null,[t("th",null,[t("input",{id:"allEtudiants",checked:"checked",class:"checkbox-etudiant",name:"allEtudiants",type:"checkbox",onClick:e[6]||(e[6]=(...u)=>s.toggleCheckbox&&s.toggleCheckbox(...u))})]),e[24]||(e[24]=t("th",null,"Intervenant",-1)),e[25]||(e[25]=t("th",null,"HETD payables",-1)),e[26]||(e[26]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(l(!0),o(g,null,x(this.etudiants,u=>(l(),o("tr",null,[t("td",null,[t("input",{id:"etudiant-"+u.datasIntervenant.id,"data-paie-etat":s.totalRessourcePaieEtat(u.heures),"data-ressource-propre":s.totalRessourcePropre(u.heures),disabled:s.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:s.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-etudiant",type:"checkbox",onChange:e[7]||(e[7]=c=>s.refreshTotalConsommation())},null,40,dp)]),t("td",null,[t("a",{href:s.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,mp)]),t("td",null,[t("span",{title:s.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+s.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(s.totalPayable(u.heures))+" h",9,cp)]),t("td",null,[t("span",hp,d(s.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.autres.length>0?(l(),o("div",pp,[t("h2",fp,[t("button",bp,d(this.autres.length)+" Autre(s) ",1)]),t("div",vp,[t("div",_p,[t("table",gp,[t("thead",null,[t("tr",null,[t("th",null,[t("input",{id:"allAutres",checked:"checked",class:"checkbox-autre",name:"allAutres",type:"checkbox",onClick:e[8]||(e[8]=(...u)=>s.toggleCheckbox&&s.toggleCheckbox(...u))})]),e[27]||(e[27]=t("th",null,"Intervenant",-1)),e[28]||(e[28]=t("th",null,"HETD payables",-1)),e[29]||(e[29]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(l(!0),o(g,null,x(this.etudiants,u=>(l(),o("tr",null,[t("td",null,[t("input",{id:"autre-"+u.datasIntervenant.id,"data-paie-etat":s.totalRessourcePaieEtat(u.heures),"data-ressource-propre":s.totalRessourcePropre(u.heures),disabled:s.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:s.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-autre",type:"checkbox",onChange:e[9]||(e[9]=c=>s.refreshTotalConsommation())},null,40,yp)]),t("td",null,[t("a",{href:s.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,xp)]),t("td",null,[t("span",{title:s.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+s.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(s.totalPayable(u.heures))+" h",9,Cp)]),t("td",null,[t("span",Vp,d(s.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),t("input",{value:i.selectedStructure,name:"selectedStructure",type:"hidden"},null,8,Sp),this.intervenants.length>0?(l(),o("div",kp,[e[30]||(e[30]=t("button",{id:"btn-pdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[t("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),b("  Veuillez patienter... ")],-1)),t("button",{id:"btn-pdmep",disabled:this.alertDotation,class:"btn btn-primary",type:"button",onClick:e[10]||(e[10]=(...u)=>s.processDemandeMiseEnPaiement&&s.processDemandeMiseEnPaiement(...u))}," Enregistrer les demandes de paiement ",8,Pp),this.canMiseEnPaiement?(l(),o("a",{key:0,id:"btn-mep",href:this.urlMiseEnPaiement,class:"ms-2 btn btn-secondary"}," Aller au mise en paiement ",8,Ap)):h("",!0)])):h("",!0)])])],64)}const Tp=k(Ch,[["render",Dp]]),Mp=Object.freeze(Object.defineProperty({__proto__:null,default:Tp},Symbol.toStringTag,{value:"Module"})),Up={components:{},props:{parametres:{type:Array,required:!0},servicesAPayer:{type:Array,required:!0}}},Ep={class:"table table-bordered table-condensed table-extra-condensed"},Fp={class:"card"},Rp={class:"card-header"},wp={class:"badge bg-primary"},Ip={class:"card-body"},Hp={class:"row lap"},Lp={class:"col-md-6"},jp={class:"table table-bordered table-xs"},Np={key:0,rowspan:"2"},Op={key:1,rowspan:"2"},qp=["title"],zp={class:"col-md-6"},Bp={class:"table table-bordered table-xs"},$p=["title"],Gp=["title"],Jp={key:0},Yp={class:"badge bg-info"},Qp={key:0,class:"row"},Wp={class:"col-md-6"},Xp={class:"table table-bordered table-xs"},Kp=["title"],Zp=["title"];function ef(n,e,r,p,i,s){return l(),o(g,null,[e[10]||(e[10]=t("h2",null,"Paramètres généraux ou bien selon le statut",-1)),t("table",Ep,[e[0]||(e[0]=t("tr",null,[t("th",null,"Paramètre général"),t("th",null,"Valeur")],-1)),(l(!0),o(g,null,x(r.parametres,(u,c)=>(l(),o("tr",{key:c},[t("th",null,d(c),1),t("td",null,d(u),1)]))),128))]),e[11]||(e[11]=t("h2",null,"Services à payer",-1)),(l(!0),o(g,null,x(r.servicesAPayer,(u,c)=>(l(),o("div",{key:c},[t("div",Fp,[t("div",Rp,[t("span",wp,d(u.type),1),b(" "+d(u.libelle),1)]),t("div",Ip,[t("ul",null,[(l(!0),o(g,null,x(u.parametres,(m,a)=>(l(),o("li",{key:a},d(a)+" : "+d(m),1))),128))]),(l(!0),o(g,null,x(u.laps,m=>(l(),o("div",Hp,[t("div",Lp,[e[4]||(e[4]=t("h6",null,"Heures à payer",-1)),t("table",jp,[t("thead",null,[t("tr",null,[u.type!="Référentiel"?(l(),o("th",Np,"Volume horaire")):(l(),o("th",Op,"Volumes horaires")),e[1]||(e[1]=t("th",{colspan:"2"},"Taux de rému.",-1)),e[2]||(e[2]=t("th",{colspan:"3"},"Heures",-1))]),e[3]||(e[3]=t("tr",null,[t("th",null,"Nom"),t("th",null,"Valeur"),t("th",null,"Total"),t("th",null,"AA"),t("th",null,"AC")],-1))]),t("tbody",null,[t("tr",null,[t("td",null,[t("abbr",{class:"badge bg-secondary",title:m.volumeHoraireHisto},d(m.volumeHoraireId),9,qp),b(" "+d(m.volumeHoraire),1)]),t("td",null,d(m.tauxRemu),1),t("td",null,d(m.tauxValeur)+"€",1),t("td",null,d(m.heures),1),t("td",null,d(m.heuresAA),1),t("td",null,d(m.heuresAC),1)])])])]),t("div",zp,[e[6]||(e[6]=t("h6",null,[t("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),b(" correspondantes")],-1)),t("table",Bp,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",{rowspan:"2"},"Id"),t("th",{rowspan:"2"},"Centre de coûts"),t("th",{colspan:"2"},"Période"),t("th",{colspan:"3"},"Heures")]),t("tr",null,[t("th",null,"Mois"),t("th",null,"Date"),t("th",null,"Total"),t("th",null,"AA"),t("th",null,"AC")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(m.misesEnPaiement,a=>(l(),o("tr",{key:a.id},[t("td",null,[t("abbr",{class:"badge bg-secondary",title:"Nombre d'heures total concernées : "+a.heuresTotal+`
Domaine fonctionnel : `+a.domaineFonctionnel+`
`+a.historique},d(a.id),9,$p)]),t("td",null,[t("abbr",{title:a.centreCoutLibelle},d(a.centreCoutCode),9,Gp)]),t("td",null,d(a.periodePaiement),1),t("td",null,d(a.date),1),t("td",null,d(a.heures),1),t("td",null,d(a.heuresAA),1),t("td",null,d(a.heuresAC),1)]))),128))])]),m.heuresRestantes!="0,00"?(l(),o("div",Jp,[t("span",Yp,d(m.heuresRestantes)+"h n'ont pas été demandées en paiement",1)])):h("",!0)])]))),256)),u.misesEnPaiement&&u.misesEnPaiement.length>0?(l(),o("div",Qp,[e[9]||(e[9]=t("div",{class:"col-md-6"},null,-1)),t("div",Wp,[e[8]||(e[8]=t("h6",null,[t("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),b(" en trop")],-1)),t("table",Xp,[e[7]||(e[7]=t("thead",{class:"bg-danger"},[t("tr",null,[t("th",{rowspan:"2"},"Id"),t("th",{rowspan:"2"},"Centre de coûts"),t("th",{colspan:"2"},"Période"),t("th",{rowspan:"2"},"Heures")]),t("tr",null,[t("th",null,"Mois"),t("th",null,"Date")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(u.misesEnPaiement,m=>(l(),o("tr",{key:m.id},[t("td",null,[t("abbr",{class:"badge bg-danger",title:"Domaine fonctionnel : "+m.domaineFonctionnel+`
`+m.historique},d(m.id),9,Kp)]),t("td",null,[t("abbr",{title:m.centreCoutLibelle},d(m.centreCoutCode),9,Zp)]),t("td",null,d(m.periodePaiement),1),t("td",null,d(m.date),1),t("td",null,d(m.heures),1)]))),128))])])])])):h("",!0)])])]))),128))],64)}const tf=k(Up,[["render",ef],["__scopeId","data-v-6001d54b"]]),nf=Object.freeze(Object.defineProperty({__proto__:null,default:tf},Symbol.toStringTag,{value:"Module"})),rf={props:{canImportPec:{type:Boolean,required:!1}},data(){return{selectedFile:null,importUrl:unicaenVue.url("paiement/import-numero-pec"),fileErrors:null,intervenantMissing:null,messageErrors:null,messageConfirm:null}},mounted(){},methods:{handleFileUpload(n){this.selectedFile=n.target.files[0],this.fileErrors=null,this.intervenantMissing=null,this.messageErrors=null,this.messageConfirm=null,document.getElementById("btn-import").disabled=!1},importFile(n){n.preventDefault(),this.messageErrors=null,this.messageConfirm=null;let e=document.getElementById("btn-import"),r=document.getElementById("btn-import-inprogress");r.classList.remove("d-none"),e.classList.add("d-none"),e.disabled=!0;let p=document.getElementById("formImport"),i=new FormData(p);unicaenVue.axios.post(this.importUrl,i,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>{let u=s.data;this.fileErrors=u.file,this.intervenantMissing=u.intervenant,u.message.length!=0?this.messageErrors=u.message:this.messageConfirm="Importation des numéros de prise en charge réalisée avec succés !",e.disabled=!1,r.classList.add("d-none"),e.classList.remove("d-none")}).catch(s=>{console.error("Error uploading")})}}},sf={class:"card text-dark bg-light"},lf={class:"card-body"},of={key:0,class:"alert alert-danger",role:"alert"},af={key:1,class:"alert alert-success",role:"alert"},uf={id:"formImport",action:"",enctype:"multipart/form-data",method:"post"},df={class:"mb-3"},mf={class:"mb-3"},cf={key:0,id:"fileErrors",class:"card text-dark bg-light"},hf={class:"card-body"},pf={key:0},ff={key:1};function bf(n,e,r,p,i,s){return l(),o(g,null,[t("div",sf,[e[7]||(e[7]=t("div",{class:"card-header text-uppercase fw-bold"}," Importation des numéros de prise en charge ",-1)),t("div",lf,[this.messageErrors?(l(),o("div",of,d(this.messageErrors),1)):h("",!0),this.messageConfirm?(l(),o("div",af,d(this.messageConfirm),1)):h("",!0),t("form",uf,[e[5]||(e[5]=t("p",{class:"fs-9 text"},[b(" Vous pouvez utiliser le modèle directement extrait de winpaie "),t("strong",null,"(format .xlsx ou .ods)"),b(" ou créer votre modèle générique de classeur "),t("strong",null,"(format .xlsx ou .ods)"),b(" incluant 3 colonnes : insee,numero pec, nom. ")],-1)),t("div",df,[e[2]||(e[2]=t("label",{class:"form-label",for:"importFile"},"Choisissez le fichier à importer :",-1)),e[3]||(e[3]=b("  ")),t("input",{class:"form-control",name:"importFile",type:"file",onChange:e[0]||(e[0]=(...u)=>s.handleFileUpload&&s.handleFileUpload(...u))},null,32)]),e[6]||(e[6]=B('<div class="mb-3"><label class="form-label" for="modele">Choisissez le modèle d&#39;import :</label>  <select id="modeleImport" class="form-select" name="modeleImport"><option value="winpaie">Winpaie</option><option value="generic">Generique (Modèle à 3 colonnes)</option></select></div>',1)),t("div",mf,[e[4]||(e[4]=t("button",{id:"btn-import-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[t("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),b("  Veuillez patienter... ")],-1)),t("button",{id:"btn-import",class:"btn btn-primary",disabled:"",type:"button",onClick:e[1]||(e[1]=(...u)=>s.importFile&&s.importFile(...u))}," Importer les numéros de prise en charge ")])])])]),this.fileErrors||this.intervenantMissing?(l(),o("div",cf,[e[10]||(e[10]=t("div",{class:"card-header text-uppercase fw-bold"}," Rapport de chargement du fichier ",-1)),t("div",hf,[this.fileErrors.length!=0?(l(),o("div",pf,[e[8]||(e[8]=t("p",null,"Listes des intervenants du fichier dont le numéro INSEE n'est pas valide : ",-1)),t("ul",null,[(l(!0),o(g,null,x(this.fileErrors,u=>(l(),o("li",null,d(),1))),256))])])):h("",!0),this.intervenantMissing.length!=0?(l(),o("div",ff,[e[9]||(e[9]=t("p",null,"Listes des intervenants présents dans le fichier mais non trouvés dans OSE : ",-1)),t("ul",null,[(l(!0),o(g,null,x(this.intervenantMissing,u=>(l(),o("li",null,d(u),1))),256))])])):h("",!0)])])):h("",!0)],64)}const vf=k(rf,[["render",bf]]),_f=Object.freeze(Object.defineProperty({__proto__:null,default:vf},Symbol.toStringTag,{value:"Module"})),gf={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(n){modAjax(n.target,e=>{this.$emit("refreshListe")})},ajoutValeur(n){modAjax(n.target,e=>{this.$emit("refreshListe")})},saisieValeur(n){n.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:n.currentTarget.dataset.id}),modAjax(n.currentTarget,e=>{this.$emit("refreshListe")})},refreshListe(n){this.$emit("refreshListe")},supprimer(n){popConfirm(n.currentTarget,e=>{this.$emit("refreshListe")})},supprimerValeur(n){n.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,e=>{this.$emit("refreshListe")})},refresh(n){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:n.id})).then(e=>{this.$emit("refresh",e.data)})}}},yf={class:"card-header"},xf={style:{display:"inline"}},Cf={class:"float-end"},Vf=["href"],Sf=["href"],kf={class:"card-body"},Pf={key:0},Af={class:""},Df={class:"row align-items-start"},Tf={class:"col-md-6"},Mf={class:"col"},Uf=["data-id"],Ef=["data-id"],Ff=["href"],Rf={key:1,class:"row"},wf={class:"col-md-7"},If={class:"row align-items-start"},Hf={class:"col-md-8"},Lf={class:"col-md-auto"},jf=["data-id"],Nf=["data-id"],Of=["href"],qf={class:"col"},zf={key:0},Bf={key:0};function $f(n,e,r,p,i,s){const u=I,c=D("u-heures"),m=H,a=D("taux",!0);return l(),o(g,null,[t("div",{class:A(["card",{"ms-5":r.taux.tauxRemu}])},[t("div",yf,[t("h3",xf,d(r.taux.libelle)+" ("+d(r.taux.code)+")",1),t("div",Cf,[r.taux.canEdit?(l(),o("a",{key:0,href:i.saisieUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=P((...C)=>s.saisie&&s.saisie(...C),["prevent"]))},[f(u,{name:"pen-to-square"}),e[8]||(e[8]=b(" Modifier"))],8,Vf)):h("",!0),e[10]||(e[10]=b("   ")),r.taux.canDelete?(l(),o("a",{key:1,href:i.supprimerUrl,class:"btn btn-danger",onClick:e[1]||(e[1]=P((...C)=>s.supprimer&&s.supprimer(...C),["prevent"]))},[f(u,{name:"trash-can"}),e[9]||(e[9]=b(" Supprimer"))],8,Sf)):h("",!0)])]),t("div",kf,[r.taux.tauxRemu?h("",!0):(l(),o("div",Pf,[e[14]||(e[14]=b(" Modification :")),e[15]||(e[15]=t("br",null,null,-1)),t("ul",null,[(l(!0),o(g,null,x(r.taux.tauxRemuValeurs,C=>(l(),o("div",{key:C.id},[t("li",Af,[t("div",Df,[t("div",Tf,[f(c,{valeur:C.valeur},null,8,["valeur"]),e[11]||(e[11]=b("€/h à partir du ")),f(m,{value:C.dateEffet},null,8,["value"])]),t("div",Mf,[r.taux.canEdit?(l(),o("a",{key:0,class:"text-primary",onClick:e[2]||(e[2]=P((...v)=>s.saisieValeur&&s.saisieValeur(...v),["prevent"])),"data-id":C.id},[f(u,{name:"pen-to-square"})],8,Uf)):h("",!0),e[12]||(e[12]=b("   ")),r.taux.canEdit?(l(),o("a",{key:1,class:"text-primary",onClick:e[3]||(e[3]=P((...v)=>s.supprimerValeur&&s.supprimerValeur(...v),["prevent"])),"data-id":C.id},[f(u,{name:"trash-can"})],8,Ef)):h("",!0)])])])]))),128))]),r.taux.canEdit?(l(),o("a",{key:0,href:i.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:e[4]||(e[4]=P((...C)=>s.ajoutValeur&&s.ajoutValeur(...C),["prevent"]))},[f(u,{name:"plus"}),e[13]||(e[13]=b(" Ajouter une valeur "))],8,Ff)):h("",!0)])),r.taux.tauxRemu?(l(),o("div",Rf,[t("div",wf,[e[19]||(e[19]=b(" Modification :")),e[20]||(e[20]=t("br",null,null,-1)),t("ul",null,[(l(!0),o(g,null,x(r.taux.tauxRemuValeurs,C=>(l(),o("div",null,[t("li",null,[t("div",If,[t("div",Hf,[e[16]||(e[16]=b(" Coéfficient de ")),f(c,{valeur:C.valeur},null,8,["valeur"]),e[17]||(e[17]=b(" à partir du ")),f(m,{value:C.dateEffet},null,8,["value"])]),t("div",Lf,[r.taux.canEdit?(l(),o("a",{key:0,class:"text-primary",onClick:e[5]||(e[5]=P((...v)=>s.saisieValeur&&s.saisieValeur(...v),["prevent"])),"data-id":C.id},[f(u,{name:"pen-to-square"})],8,jf)):h("",!0),e[18]||(e[18]=b("   ")),r.taux.canEdit?(l(),o("a",{key:1,class:"text-primary",onClick:e[6]||(e[6]=P((...v)=>s.supprimerValeur&&s.supprimerValeur(...v),["prevent"])),"data-id":C.id},[f(u,{name:"trash-can"})],8,Nf)):h("",!0)])])])]))),256))]),r.taux.canEdit?(l(),o("a",{key:0,href:i.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:e[7]||(e[7]=P((...C)=>s.ajoutValeur&&s.ajoutValeur(...C),["prevent"]))},[f(u,{name:"plus"})],8,Of)):h("",!0)]),t("div",qf,[b(" Valeurs calculées (indexées sur le taux "+d(r.taux.tauxRemu.libelle)+") : ",1),t("ul",null,[(l(!0),o(g,null,x(r.taux.tauxRemuValeursIndex,C=>(l(),o("div",null,[t("li",null,[f(c,{valeur:C.valeur},null,8,["valeur"]),e[21]||(e[21]=b("€/h à partir du ")),f(m,{value:C.date},null,8,["value"])])]))),256))]),e[22]||(e[22]=t("br",null,null,-1))])])):h("",!0)])],2),r.taux.tauxRemu?h("",!0):(l(),o("div",zf,[(l(!0),o(g,null,x(r.listeTaux,C=>(l(),o("div",{key:C},[C.tauxRemu&&C.tauxRemu.id===r.taux.id?(l(),o("div",Bf,[(l(),U(a,{onSupprimer:s.supprimer,onRefreshListe:s.refreshListe,key:r.taux.id,taux:C,listeTaux:r.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):h("",!0)]))),128))]))],64)}const de=k(gf,[["render",$f]]),Gf=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"})),Jf={components:{taux:de},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(n){let e=Util.json.indexById(this.listeTaux,n.id);this.listeTaux[e]=n},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(n=>{this.listeTaux=n.data})}}},Yf=["href"];function Qf(n,e,r,p,i,s){const u=D("taux");return l(),o(g,null,[(l(!0),o(g,null,x(i.listeTaux,c=>(l(),o("div",null,[c.tauxRemu?h("",!0):(l(),U(u,{onSupprimer:s.supprimer,onRefreshListe:s.refreshListe,key:c.id,taux:c,listeTaux:i.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),r.canEditTaux?(l(),o("a",{key:0,class:"btn btn-primary",href:i.ajoutUrl,onClick:e[0]||(e[0]=P((...c)=>s.ajout&&s.ajout(...c),["prevent"]))},"Ajout d'un nouveau taux",8,Yf)):h("",!0)],64)}const Wf=k(Jf,[["render",Qf]]),Xf=Object.freeze(Object.defineProperty({__proto__:null,default:Wf},Symbol.toStringTag,{value:"Module"})),Kf={name:"listeContrat",data(){return{dataUrl:unicaenVue.url("signature/data-contrat"),lines:[]}},methods:{contratUrl(n){return unicaenVue.url("intervenant/:intervenant/contrat",{intervenant:n})},getDocumentUrl(n){return unicaenVue.url("signature/:signature/get-document",{signature:n})},updateSignatureUrl(n){return unicaenVue.url("signature/:signature/update-signature",{signature:n})}}},Zf=["href"],e1=["href"],t1=["href"];function n1(n,e,r,p,i,s){const u=H,c=G;return l(),o(g,null,[e[7]||(e[7]=t("h1",{class:"page-header"},"Liste des signatures électroniques de contrat",-1)),f(c,{ref:"signatures",modelValue:i.lines,"onUpdate:modelValue":e[0]||(e[0]=m=>i.lines=m),"data-url":this.dataUrl},{default:M(()=>[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",{column:"ID_SIGNATURE"},"Id"),t("th",{column:"NOM"},"Nom"),t("th",{column:"PRENOM"},"Prénom"),t("th",{column:"DATE_CREATION_SIGNATURE_ELECTRONIQUE"},"Date signature électronique"),t("th",{column:"STATUT_SIGNATURE_ELECTRONIQUE"},"Statut"),t("th",null," ")])],-1)),t("tbody",null,[(l(!0),o(g,null,x(i.lines,(m,a)=>(l(),o("tr",{key:a},[t("td",null,d(m.ID_SIGNATURE),1),t("td",null,d(m.NOM),1),t("td",null,d(m.PRENOM),1),t("td",null,[f(u,{value:m.DATE_CREATION_SIGNATURE_ELECTRONIQUE},null,8,["value"])]),t("td",null,d(m.STATUT_SIGNATURE_ELECTRONIQUE),1),t("td",null,[t("a",{href:s.getDocumentUrl(m.ID_SIGNATURE),class:"btn btn-info"},e[1]||(e[1]=[t("i",{class:"fas fa-download"},null,-1)]),8,Zf),e[4]||(e[4]=b("   ")),t("a",{href:s.contratUrl(m.ID_INTERVENANT),class:"btn btn-info"},e[2]||(e[2]=[t("i",{class:"fas fa-eye"},null,-1)]),8,e1),e[5]||(e[5]=b("   ")),t("a",{href:s.updateSignatureUrl(m.ID_SIGNATURE),class:"btn btn-info"},e[3]||(e[3]=[t("i",{class:"fas fa-rotate"},null,-1)]),8,t1)])]))),128))])]),_:1},8,["modelValue","data-url"])],64)}const r1=k(Kf,[["render",n1]]),s1=Object.freeze(Object.defineProperty({__proto__:null,default:r1},Symbol.toStringTag,{value:"Module"})),i1={UHeures:"Application/UI/UHeures",UInputFloat:"Application/UI/UInputFloat",UConfirmDialog:"Application/UI/UConfirmDialog",Utilisateur:"Application/Utilisateur"};function l1(n,e){const r={};e===void 0&&(e={});for(const s in n){let c=s.slice(2,-4).replaceAll("/","");r[c]=n[s].default}function p(s){let u=ge({template:s.innerHTML,components:r});if(e.beforeMount!==void 0&&e.beforeMount(u),e.autoloads!==void 0)for(const c in e.autoloads){let m=e.autoloads[c].replaceAll("/","");u.component(c,r[m])}u.use(ye({components:!0,directives:!0})),u.mount(s),e.afterMount!==void 0&&e.afterMount(u)}for(const s of document.getElementsByClassName("vue-app"))p(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList"){for(const c of u.addedNodes)if(c.nodeType===Node.ELEMENT_NODE){const m=c.querySelectorAll?c.querySelectorAll(".vue-app"):[];for(const a of m)p(a);c.classList.contains("vue-app")&&p(c)}}}).observe(document.body,{childList:!0,subtree:!0})}const o1={init:l1},a1=Object.assign({"./Application/Connexion.vue":je,"./Application/UI/UConfirmDialog.vue":We,"./Application/UI/UHeures.vue":tt,"./Application/UI/UInputFloat.vue":lt,"./Application/Utilisateur.vue":mt,"./Employeur/ListeEmployeur.vue":Pt,"./Formule/Administration/Details.vue":Ft,"./Formule/Administration/Formulator.vue":Bt,"./Formule/Administration/Index.vue":pn,"./Formule/Details.vue":Wr,"./Formule/DetailsHetd.vue":or,"./Formule/DetailsHetds.vue":dr,"./Formule/DetailsServiceEnseignement.vue":Sn,"./Formule/DetailsServiceReferentiel.vue":Tn,"./Formule/DetailsVolumeHoraireEnseignement.vue":Bn,"./Formule/DetailsVolumeHoraireReferentiel.vue":rr,"./Formule/Test/Index.vue":os,"./Formule/Test/Test.vue":nl,"./Formule/TotauxHetd.vue":al,"./Intervenant/Recherche.vue":xl,"./Lieu/Structure.vue":Jl,"./Lieu/StructuresAdmin.vue":Zl,"./Mission/Liste.vue":da,"./Mission/ListeCandidatures.vue":Ta,"./Mission/ListeOffreEmploi.vue":Au,"./Mission/ListePrime.vue":_d,"./Mission/Mission.vue":ia,"./Mission/OffreEmploi.vue":gu,"./Mission/Prime.vue":dd,"./Mission/Suivi.vue":Kd,"./Mission/SuiviEvent.vue":Yd,"./Paiement/DemandeMiseEnPaiement.vue":fh,"./Paiement/DemandeMiseEnPaiementLot.vue":Mp,"./Paiement/DemandeMiseEnPaiementStructure.vue":ah,"./Paiement/DetailsCalculs.vue":nf,"./Paiement/ImportNumeroPec.vue":_f,"./Paiement/ListeTaux.vue":Xf,"./Paiement/Taux.vue":Gf,"./Signature/ListeContrat.vue":s1}),u1={autoloads:i1};o1.init(a1,u1);
