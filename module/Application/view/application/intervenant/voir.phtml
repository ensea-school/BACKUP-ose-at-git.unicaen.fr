<?php

use Application\Provider\Privilege\Privileges;

/* @var $intervenant \Application\Entity\Db\Intervenant */
/* @var $tab string */

$this->intervenant($intervenant)->renderTitle('Fiche');


$tabs = [
    [
        'id'            => 'fiche',
        'label'         => '<span class="fa-solid fa-eye"></span> Fiche',
        'content'       => $this->partial('application/intervenant/fiche.phtml', compact('intervenant')),
        'url'           => $this->url('intervenant/fiche', ['intervenant' => $intervenant->getId()]),
        'force-refresh' => true,
    ],
];

if ($this->isAllowed(Privileges::getResourceId(Privileges::INTERVENANT_EDITION))) {
    $tabs[] = [
        'id'    => 'edition',
        'label' => '<i class="fa-solid fa-pencil"></span> Ã‰dition',
        'url'   => $this->url('intervenant/saisir', ['intervenant' => $intervenant->getId()]),
    ];
}

if ($this->isAllowed(Privileges::getResourceId(Privileges::INTERVENANT_EDITION))) {
    $tabs[] = [
        'id'            => 'synchronisation',
        'label'         => '<span class="fa-solid fa-download"></span> Synchronisation',
        'url'           => $this->url('intervenant/synchronisation', ['intervenant' => $intervenant->getId()]),
        'force-refresh' => true,
    ];
}

if ($this->isAllowed($intervenant, \ExportRh\Assertion\ExportRhAssertion::PRIV_CAN_INTERVENANT_EXPORT_RH)) {
    $tabs[] = [
        'id'            => 'export-rh',
        'label'         => '<span class="fa-solid fa-upload"></span> Export RH',
        'url'           => $this->url('intervenant/exporter', ['intervenant' => $intervenant->getId()]),
        'force-refresh' => true,
    ];
}


if ($this->isAllowed(Privileges::getResourceId(Privileges::INTERVENANT_SUPPRESSION))) {
    $tabs[] = [
        'id'            => 'suppression',
        'label'         => '<i class="fa-solid fa-trash-can"></i> Suppression',
        'url'           => $this->url('intervenant/supprimer', ['intervenant' => $intervenant->getId()]),
        'force-refresh' => true,
    ];
}


if ($this->isAllowed(Privileges::getResourceId(Privileges::PLAFONDS_DEROGATIONS_VISUALISATION))) {
    $tabs[] = [
        'id'            => 'derogations',
        'label'         => '<span class="fa-solid fa-shuffle"></span> DÃ©rogations',
        'url'           => $this->url('derogations', ['intervenant' => $intervenant->getId()]),
        'force-refresh' => true,
    ];
}

echo $this->tabajax($tabs, $tab);