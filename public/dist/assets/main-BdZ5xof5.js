import{c as a,o as r,t as c,a as p,w as R,b as m,d as e,e as w,F as b,r as g,v as z,f as re,g as B,U as ae,h as oe,i as le,j as C,k as h,l as F,n as V,m as T,p as E,q as W,s as Q,u as G,x as de,y as ue,z as ce,A as he,B as me,_ as _e}from"./vendor-BpVnjg7q.js";const k=(t,n)=>{const s=t.__vccOpts||t;for(const[_,l]of n)s[_]=l;return s},fe={props:{valeur:{required:!0,type:Number}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},pe=["innerHTML"];function be(t,n,s,_,l,i){return r(),a("span",{class:"heures",innerHTML:i.affichage},null,8,pe)}const ve=k(fe,[["render",be]]),ge=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"})),ye={name:"Utilisateur",props:{nom:String,mail:String}},xe=["href"];function Ce(t,n,s,_,l,i){return r(),a("a",{href:`mailto:${s.mail}`},c(s.nom),9,xe)}const ke=k(ye,[["render",Ce]]),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"})),Ee={name:"UTableAjax",emits:["update:modelValue"],props:{modelValue:{required:!0},id:{required:!1,type:String},size:{required:!1,default:10},count:{required:!1},search:{required:!1},dataUrl:{required:!0,type:String}},data(){return{page:1,pageSizes:[10,25,50,100,"Tous"],defaultSize:10,dSize:this.size,dCount:this.count,dSearch:this.search,searchTimer:null,columns:{},loading:!1,orderCol:void 0,orderDir:"asc"}},computed:{cSize(){return isNaN(this.dSize)?9999999999999:this.dSize},storageIdentifier(){return"UTableAjax-"+this.id+"-"+window.location.href},elStart(){return isNaN(this.dSize)?1:(this.page-1)*this.dSize+1},elEnd(){return isNaN(this.dCount)?(this.page-1)*this.dSize+this.dSize:isNaN(this.dSize)?this.dCount:Math.min(this.dCount,(this.page-1)*this.dSize+this.dSize)}},watch:{dSize(t){localStorage.setItem(this.storageIdentifier,t),this.getData()},dSearch(t){const n=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.page>1?this.page=1:n.getData()},500)},page(t){this.getData()}},methods:{getData(){unicaenVue.axios.post(this.dataUrl,{page:this.page,size:this.dSize,elStart:this.elStart,elEnd:this.elEnd,search:this.dSearch,orderCol:this.orderCol,orderDir:this.orderDir}).then(t=>{let n=t.data;this.dCount=n.count,this.$emit("update:modelValue",n.data)})},orderBy(t){const n=this.columns[t];for(let _ in this.columns)_!=t&&(this.columns[_].classList.contains("sorting_asc")&&this.columns[_].classList.remove("sorting_asc"),this.columns[_].classList.contains("sorting_desc")&&this.columns[_].classList.remove("sorting_desc"),console.log(_));let s="asc";n.classList.contains("sorting_asc")?(s="desc",n.classList.remove("sorting_asc"),n.classList.add("sorting_desc")):(n.classList.contains("sorting_desc")&&n.classList.remove("sorting_desc"),n.classList.add("sorting_asc")),this.orderCol=t,this.orderDir=s,this.getData()}},mounted(){this.dSize=parseInt(localStorage.getItem(this.storageIdentifier))||this.defaultSize,this.page=1,this.dSize=this.size,this.dCount=this.count;const t=this.$refs.tableRef,n=this;t&&t.querySelectorAll("th[column]").forEach(_=>{Array.from(_.attributes).forEach(l=>{l.name=="column"&&(this.columns[l.value]=_,_.dataset.column=l.value,_.onclick=function(){n.orderBy(this.dataset.column)},_.removeAttribute(l.name),_.classList.add("sorting"))})}),this.getData()}},De={class:"dt-bootstrap5"},Se=["value"],Ve={class:"float-end"},Te={class:"table table-bordered dataTable mb-2",ref:"tableRef"},Me={class:"dataTables_paginate paging_simple_numbers"};function Ie(t,n,s,_,l,i){const o=ae,d=oe,u=le;return r(),a("div",De,[p(d,null,{default:R(()=>[p(o,null,{default:R(()=>[m(" Afficher "),e("label",null,[w(e("select",{"onUpdate:modelValue":n[0]||(n[0]=f=>l.dSize=f),class:"form-select form-select-sm"},[(r(!0),a(b,null,g(l.pageSizes,f=>(r(),a("option",{key:f,value:f},c(f),9,Se))),128))],512),[[z,l.dSize]])]),m(" éléments ")]),_:1}),p(o,null,{default:R(()=>[e("div",Ve,[m(" Rechercher : "),e("label",null,[w(e("input",{"onUpdate:modelValue":n[1]||(n[1]=f=>l.dSearch=f),class:"form-control form-inline form-control-sm"},null,512),[[re,l.dSearch]])])])]),_:1})]),_:1}),e("table",Te,[B(t.$slots,"default")],512),p(d,null,{default:R(()=>[p(o,null,{default:R(()=>[m("Affichage de l'élément "+c(i.elStart)+" à "+c(i.elEnd)+" sur "+c(l.dCount)+" éléments",1)]),_:1}),p(o,null,{default:R(()=>[e("div",Me,[p(u,{align:"end",page:l.page,modelValue:l.page,"onUpdate:modelValue":n[2]||(n[2]=f=>l.page=f),"total-rows":l.dCount,"per-page":i.cSize,"last-number":"true",firstNumber:"true","prev-text":"Précédent","next-text":"Suivant"},null,8,["page","modelValue","total-rows","per-page"])])]),_:1})]),_:1})])}const Re=k(Ee,[["render",Ie]]),we={name:"listeEmployeur",data(){return{dataUrl:unicaenVue.url("employeur/get-data"),lines:[]}},methods:{saisie(t){modAjax(t.currentTarget,n=>{this.$refs.employeurs.getData()})},editUrl(t){return unicaenVue.url("employeur/saisie/:id",{id:t})}}},$e=e("h1",{class:"page-header"},"Gestion des employeurs",-1),Ae=e("thead",null,[e("tr",null,[e("th",{column:"ID"},"Id"),e("th",{column:"RAISON_SOCIALE"},"Raison sociale"),e("th",{column:"NOM_COMMERCIAL"},"Nom commercial"),e("th",null,"Siren"),e("th",null," ")])],-1),je={key:0},Ue=["href"],Le={key:1};function He(t,n,s,_,l,i){const o=Re;return r(),a(b,null,[$e,p(o,{ref:"employeurs",modelValue:l.lines,"onUpdate:modelValue":n[1]||(n[1]=d=>l.lines=d),"data-url":this.dataUrl},{default:R(()=>[Ae,e("tbody",null,[(r(!0),a(b,null,g(l.lines,(d,u)=>(r(),a("tr",{key:u},[e("td",null,c(d.ID),1),e("td",null,c(d.RAISON_SOCIALE),1),e("td",null,c(d.NOM_COMMERCIAL),1),e("td",null,c(d.SIREN),1),d.IMPORTABLE==0?(r(),a("td",je,[d.IMPORTABLE==0?(r(),a("a",{key:0,href:i.editUrl(d.ID),onClick:n[0]||(n[0]=C((...f)=>i.saisie&&i.saisie(...f),["prevent"]))},"Modifier",8,Ue)):h("",!0)])):h("",!0),d.IMPORTABLE==1?(r(),a("td",Le," NON MODIFIABLE ")):h("",!0)]))),128))])]),_:1},8,["modelValue","data-url"])],64)}const qe=k(we,[["render",He]]),Fe=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"})),ze={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(t){this.formatted=this.formatage(t)}},methods:{formatage(t){if(t===void 0)return;let n=new Date(t);const s=n.getFullYear(),_=(n.getMonth()+1).toString().padStart(2,"0"),l=n.getDate().toString().padStart(2,"0"),i=n.getHours().toString().padStart(2,"0"),o=n.getMinutes().toString().padStart(2,"0"),d=n.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${l}/${_}/${s} à ${i}:${o}`;case"time":return`${i}:${o}:${d}`}return`${l}/${_}/${s}`}}};function Oe(t,n,s,_,l,i){return c(l.formatted)}const L=k(ze,[["render",Oe]]),Ne={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(t){this.searchTerm=t.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(t){return unicaenVue.url("intervenant/code:"+t+"/voir")},reload(){var t=document.getElementById("term");t.focus(),this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(n=>{let s=n.data,_=[];for(const l in s){if(s[l].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){_.push(s[l]);continue}if(s[l].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){_.push(s[l]);continue}if(s[l].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){_.push(s[l]);continue}}this.intervenants=_,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(n=>{console.log(n.message)})},800)}}},Be=e("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1),Ge={class:"intervenant-recherche"},Ye={class:"critere"},Je=e("br",null,null,-1),We=e("span",{class:"fw-bold"},"Types d'intervenant : ",-1),Qe=e("br",null,null,-1),Xe={key:0,class:"table table-bordered table-hover"},Ze=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),Ke=["title"],et={style:{}},tt=["href"],st=e("i",{class:"fas fa-eye"},null,-1),nt={key:1,class:"table table-bordered table-hover"},it=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),rt=e("tbody",null,[e("tr",null,[e("td",{colspan:"8",style:{"text-align":"center"}},"Aucun intervenant trouvé")])],-1),at=[it,rt];function ot(t,n,s,_,l,i){const o=L;return r(),a(b,null,[Be,e("div",Ge,[e("div",Ye,[e("div",null,[e("input",{id:"term",autofocus:"",class:"form-control input",placeholder:"votre recherche...",type:"text",onKeyup:n[0]||(n[0]=(...d)=>i.rechercher&&i.rechercher(...d))},null,32),Je]),e("div",null,[We,w(e("input",{"onUpdate:modelValue":n[1]||(n[1]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"permanent",onChange:n[2]||(n[2]=d=>i.reload())},null,544),[[F,l.checkedTypes]]),m(" Permanent "),w(e("input",{"onUpdate:modelValue":n[3]||(n[3]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"vacataire",onChange:n[4]||(n[4]=d=>i.reload())},null,544),[[F,l.checkedTypes]]),m(" Vacataire "),w(e("input",{"onUpdate:modelValue":n[5]||(n[5]=d=>l.checkedTypes=d),checked:"checked",name:"type[]",type:"checkbox",value:"etudiant",onChange:n[6]||(n[6]=d=>i.reload())},null,544),[[F,l.checkedTypes]]),m(" Etudiant ")]),Qe])]),l.intervenants.length>0?(r(),a("table",Xe,[Ze,e("tbody",null,[(r(!0),a(b,null,g(l.intervenants,(d,u)=>(r(),a("tr",{class:V({"bg-danger":d.destruction!==null}),title:d.destruction!==null?"Fiche historisé":""},[e("td",et,[e("a",{href:i.urlFiche(d.code)},[st,m(" Fiche")],8,tt)]),e("td",null,c(d.civilite),1),e("td",null,c(d.nom),1),e("td",null,c(d.prenom),1),e("td",null,c(d.structure),1),e("td",null,c(d.statut),1),e("td",null,[p(o,{value:d["date-naissance"]},null,8,["value"])]),e("td",null,c(d["numero-personnel"]),1)],10,Ke))),256))])])):h("",!0),l.intervenants.length==0&&l.noResult==1?(r(),a("table",nt,at)):h("",!0)],64)}const lt=k(Ne,[["render",ot]]),dt=Object.freeze(Object.defineProperty({__proto__:null,default:lt},Symbol.toStringTag,{value:"Module"})),ut={name:"Structure",props:{structure:{required:!0}},data(){return{saisieUrl:unicaenVue.url("structure/voir/:structure",{structure:this.structure.id})+"?tab=edition",deleteUrl:unicaenVue.url("structure/delete/:structure",{structure:this.structure.id}),liste:this.$parent.liste}},computed:{hasSousStructures:function(){return this.structure.structures.length>0}},methods:{saisie(t){modAjax(t.currentTarget,n=>{this.refresh()})},supprimer(t){popConfirm(t.currentTarget,n=>{this.refresh()})},refresh(){this.liste.reload()}}},A=t=>(W("data-v-a94dbf9e"),t=t(),Q(),t),ct={class:"accordion-item"},ht={class:"accordion-header"},mt=["data-bs-target","aria-controls"],_t=["href"],ft=A(()=>e("i",{class:"fas fa-pen-to-square"},null,-1)),pt=[ft],bt=["href"],vt=A(()=>e("i",{class:"fas fa-trash-can"},null,-1)),gt=[vt],yt=["id"],xt={class:"accordion-body"},Ct={class:"row"},kt=A(()=>e("div",{class:"col-md-5"},[e("strong",null,"Code"),m(" : ")],-1)),Pt={class:"col-md-5"},Et={class:"row"},Dt=A(()=>e("div",{class:"col-md-5"},[e("strong",null,"Source"),m(" : ")],-1)),St={class:"col-md-5"},Vt={class:"row"},Tt=A(()=>e("div",{class:"col-md-5"},[e("strong",null,"Composante d'enseignement"),m(" : ")],-1)),Mt={class:"col-md-5"},It={key:0,class:"fas fa-check text-success"},Rt={key:1,class:"fas fa-xmark text-danger"},wt={class:"row"},$t=A(()=>e("div",{class:"col-md-5"},[e("strong",null,"Affichage de l'adresse sur le contrat de travail"),m(" : ")],-1)),At={class:"col-md-5"},jt={key:0,class:"fas fa-check text-success"},Ut={key:1,class:"fas fa-xmark text-danger"},Lt={class:"row"},Ht=A(()=>e("div",{class:"col-md-5"},[e("strong",null,"Adresse"),m(" : ")],-1)),qt={class:"col-md-5"},Ft={key:0,class:"sous-structures"},zt=A(()=>e("h4",null,"Sous-structures",-1)),Ot={class:"accordion"};function Nt(t,n,s,_,l,i){const o=T("structure",!0);return r(),a("div",ct,[e("h2",ht,[e("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":`#str${s.structure.id}`,"aria-expanded":"true","aria-controls":s.structure.id},[s.structure.canEdit?(r(),a("a",{key:0,title:"Modifier la structure",href:l.saisieUrl,class:"btn btn-primary btn-sm",onClick:n[0]||(n[0]=C((...d)=>i.saisie&&i.saisie(...d),["prevent"]))},pt,8,_t)):h("",!0),s.structure.canDelete?(r(),a("a",{key:1,title:"Supprimer la structure",href:l.deleteUrl,class:"btn btn-danger btn-sm","data-content":"Êtes-vous sûr de vouloir supprimer la structure ?","data-title":"Suppression de la structure",onClick:n[1]||(n[1]=C((...d)=>i.supprimer&&i.supprimer(...d),["prevent"]))},gt,8,bt)):h("",!0),m("   "+c(s.structure.libelleLong)+" ("+c(s.structure.libelleCourt)+") ",1)],8,mt)]),e("div",{id:`str${s.structure.id}`,class:"accordion-collapse collapse show"},[e("div",xt,[e("div",Ct,[kt,e("div",Pt,c(s.structure.code),1)]),e("div",Et,[Dt,e("div",St,c(s.structure.source.libelle),1)]),e("div",Vt,[Tt,e("div",Mt,[s.structure.enseignement?(r(),a("i",It)):s.structure.enseignement?h("",!0):(r(),a("i",Rt))])]),e("div",wt,[$t,e("div",At,[s.structure.affAdresseContrat?(r(),a("i",jt)):s.structure.affAdresseContrat?h("",!0):(r(),a("i",Ut))])]),e("div",Lt,[Ht,e("div",qt,[e("pre",null,c(s.structure.adresse),1)])]),i.hasSousStructures?(r(),a("div",Ft,[zt,e("div",Ot,[(r(!0),a(b,null,g(s.structure.structures,d=>(r(),E(o,{onRefresh:i.refresh,key:d.id,structure:d},null,8,["onRefresh","structure"]))),128))])])):h("",!0)])],8,yt)])}const X=k(ut,[["render",Nt],["__scopeId","data-v-a94dbf9e"]]),Bt=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),Gt={components:{structure:X},props:{canAdd:{type:Boolean,required:!0}},data(){return{structures:[],ajoutUrl:unicaenVue.url("structure/saisie"),liste:this}},mounted(){this.reload()},methods:{ajout(t){modAjax(t.currentTarget,n=>{console.log("coucou"),this.reload()})},reload(){unicaenVue.axios.get(unicaenVue.url("structure/liste")).then(t=>{this.structures=t.data})}}},Yt=e("h1",null,"Administration des structures",-1),Jt={class:"accordion"},Wt=["href"],Qt=e("i",{class:"fas fa-pen-to-square"},null,-1);function Xt(t,n,s,_,l,i){const o=T("structure");return r(),a(b,null,[Yt,e("div",Jt,[(r(!0),a(b,null,g(l.structures,d=>(r(),E(o,{key:d.id,structure:d},null,8,["structure"]))),128))]),s.canAdd?(r(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:n[0]||(n[0]=C((...d)=>i.ajout&&i.ajout(...d),["prevent"])),title:"Ajouter une structure"},[Qt,m(" Ajouter une structure ")],8,Wt)):h("",!0)],64)}const Zt=k(Gt,[["render",Xt]]),Kt=Object.freeze(Object.defineProperty({__proto__:null,default:Zt},Symbol.toStringTag,{value:"Module"})),es={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},ts=["id"],ss={class:"modal-dialog"},is={class:"modal-content"},rs={class:"modal-header"},as={class:"modal-title"},os=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ls={class:"modal-body"},ds={class:"modal-footer"},us=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1);function cs(t,n,s,_,l,i){return r(),a("div",{class:"modal fade",id:s.id,tabindex:"-1","aria-hidden":"true"},[e("div",ss,[e("div",is,[e("div",rs,[e("h5",as,c(s.title),1),os]),e("div",ls,[B(t.$slots,"body")]),e("div",ds,[B(t.$slots,"footer"),us])])])],8,ts)}const hs=k(es,[["render",cs]]),ms={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String},rotate:{required:!1,type:String},id:{required:!1,type:String}}},_s=["id"];function fs(t,n,s,_,l,i){return r(),a("i",{class:V(`fas fa-${s.name} text-${s.variant} fa-rotate-${s.rotate}`),id:`${s.id}`},null,10,_s)}const j=k(ms,[["render",fs]]),ps={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(t){this.validationText=this.calcValidation(t)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":'<span class="bg-info">'+Util.formattedHeures(this.mission.heures)+"</span> heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(t){return t===null?"A valider":t.id===null?"Autovalidée":"Validation du "+Util.dateToString(t.histoCreation)+" par "},saisie(t){modAjax(t.currentTarget,n=>{this.refresh()})},supprimer(t){popConfirm(t.currentTarget,n=>{this.$emit("supprimer",this.mission)})},valider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},devalider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},volumeHoraireSupprimer(t){t.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},volumeHoraireValider(t){t.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},volumeHoraireDevalider(t){t.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(t=>{this.$emit("refresh",t.data)})}}},M=t=>(W("data-v-1735108d"),t=t(),Q(),t),bs=["id"],vs={class:"card-header card-header-h3"},gs={key:0},ys={class:"float-end"},xs={key:1},Cs={key:2},ks={class:"float-end"},Ps={class:"card-body"},Es={class:"row"},Ds={class:"col-md-8"},Ss={class:"row"},Vs={class:"col-md-12"},Ts=M(()=>e("label",{class:"form-label"},"Composante en charge du suivi",-1)),Ms={class:"form-control"},Is={class:"row"},Rs={class:"col-md-6"},ws=M(()=>e("label",{class:"form-label"},"Taux de rémunération",-1)),$s={class:"form-control"},As={class:"col-md-6"},js=M(()=>e("label",{class:"form-label"},"Taux majoré (dimanches/jours fériés)",-1)),Us={class:"form-control"},Ls={class:"col-md-7"},Hs=M(()=>e("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),qs={class:"input-group mb-3"},Fs=["innerHTML"],zs=["data-bs-target"],Os={key:0,class:"col-md-5"},Ns=M(()=>e("label",{class:"form-label"},"Heures de formation prévues",-1)),Bs={class:"form-control"},Gs={class:"row"},Ys={class:"col-md-12"},Js=M(()=>e("label",{class:"form-label"},"Descriptif de la mission",-1)),Ws={class:"form-control"},Qs={key:0,class:"row"},Xs={class:"col-md-12"},Zs=M(()=>e("label",{class:"form-label"},"Etudiants suivis",-1)),Ks={class:"form-control"},en=M(()=>e("div",{class:"row"},[e("div",{class:"col-md-12"}," ")],-1)),tn={class:"row"},sn={class:"col-md-12"},nn=["href"],rn=["href"],an=["href"],on=["href"],ln={class:"col-md-4"},dn=M(()=>e("div",null,[e("label",{class:"form-label"},"Suivi")],-1)),un={class:"table table-bordered table-condensed"},cn=M(()=>e("thead",null,[e("tr",null,[e("th",null,"Heures"),e("th",null,"Statut"),e("th",null,"Actions")])],-1)),hn={style:{"text-align":"right"}},mn=M(()=>e("br",null,null,-1)),_n={key:0},fn=["data-id"],pn=["data-id"],bn=["data-id"];function vn(t,n,s,_,l,i){const o=L,d=j,u=T("utilisateur"),f=T("u-heures"),y=hs;return r(),a(b,null,[e("div",{id:s.mission.id,class:V([{"bg-success":s.mission.valide,"bg-default":!s.mission.valide},"card"])},[e("form",{onSubmit:n[4]||(n[4]=C((...v)=>t.submitForm&&t.submitForm(...v),["prevent"]))},[e("div",vs,[s.mission.libelleMission?(r(),a("h5",gs,[m(c(s.mission.libelleMission)+" ",1),e("span",ys,[m("Du "),p(o,{value:s.mission.dateDebut},null,8,["value"]),m(" au "),p(o,{value:s.mission.dateFin},null,8,["value"])])])):h("",!0),s.mission.libelleMission?(r(),a("h6",xs,c(s.mission.typeMission.libelle),1)):h("",!0),s.mission.libelleMission?h("",!0):(r(),a("h5",Cs,[m(c(s.mission.typeMission.libelle)+" ",1),e("span",ks,[m("Du "),p(o,{value:s.mission.dateDebut},null,8,["value"]),m(" au "),p(o,{value:s.mission.dateFin},null,8,["value"])])]))]),e("div",Ps,[e("div",Es,[e("div",Ds,[e("div",Ss,[e("div",Vs,[Ts,e("div",Ms,c(s.mission.structure.libelle),1)])]),e("div",Is,[e("div",Rs,[ws,e("div",$s,c(s.mission.tauxRemu?s.mission.tauxRemu.libelle:null),1)]),e("div",As,[js,e("div",Us,c(s.mission.tauxRemuMajore?s.mission.tauxRemuMajore.libelle:s.mission.tauxRemu?"Idem ("+s.mission.tauxRemu.libelle+")":null),1)]),e("div",Ls,[Hs,e("div",qs,[e("div",{class:"form-control",innerHTML:i.heuresLib},null,8,Fs),e("button",{"data-bs-target":`#details-${s.mission.id}`,class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal"}," Détails ",8,zs)])]),s.mission.typeMission.besoinFormation?(r(),a("div",Os,[Ns,e("div",Bs,c(s.mission.heuresFormation),1)])):h("",!0)]),e("div",Gs,[e("div",Ys,[Js,e("div",Ws,c(s.mission.description),1)])]),s.mission.typeMission.accompagnementEtudiants?(r(),a("div",Qs,[e("div",Xs,[Zs,e("div",Ks,[e("pre",null,c(s.mission.etudiantsSuivis),1)])])])):h("",!0),en,e("div",tn,[e("div",sn,[s.mission.canSaisie?(r(),a("a",{key:0,href:l.saisieUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=C((...v)=>i.saisie&&i.saisie(...v),["prevent"]))},"Modifier",8,nn)):h("",!0),s.mission.canValider?(r(),a("a",{key:1,href:l.validerUrl,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider la mission ?","data-title":"Validation de la mission",onClick:n[1]||(n[1]=C((...v)=>i.valider&&i.valider(...v),["prevent"]))},"Valider",8,rn)):h("",!0),s.mission.canDevalider?(r(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider la mission ?","data-title":"Dévalidation de la mission",onClick:n[2]||(n[2]=C((...v)=>i.devalider&&i.devalider(...v),["prevent"]))},"Dévalider",8,an)):h("",!0),s.mission.canSupprimer?(r(),a("a",{key:3,href:l.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer la mission ?","data-title":"Suppression de la mission",onClick:n[3]||(n[3]=C((...v)=>i.supprimer&&i.supprimer(...v),["prevent"]))},"Supprimer",8,on)):h("",!0)])])]),e("div",ln,[dn,e("div",null,[p(d,{name:"thumbs-up",variant:"success"}),m(" Créé le "),p(o,{value:s.mission.histoCreation},null,8,["value"]),m(" par "),p(u,{mail:s.mission.histoCreateur.email,nom:s.mission.histoCreateur.displayName},null,8,["mail","nom"])]),e("div",null,[p(d,{name:s.mission.valide?"thumbs-up":"thumbs-down",variant:s.mission.valide?"success":"info"},null,8,["name","variant"]),m(" "+c(l.validationText)+" ",1),s.mission.validation&&s.mission.validation.histoCreateur?(r(),E(u,{key:0,mail:s.mission.validation.histoCreateur.email,nom:s.mission.validation.histoCreateur.displayName},null,8,["mail","nom"])):h("",!0)]),e("div",null,[p(d,{name:s.mission.contrat?"thumbs-up":"thumbs-down",variant:s.mission.contrat?"success":"info"},null,8,["name","variant"]),m(" "+c(s.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),e("div",null,c(s.mission.heuresRealisees)+" heure"+c(s.mission.heuresRealisees<2?"":"s")+" réalisée"+c(s.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,bs),p(y,{id:`details-${s.mission.id}`,title:"Détail des heures prévisionnelles"},{body:R(()=>[e("table",un,[cn,e("tbody",null,[(r(!0),a(b,null,g(s.mission.volumesHorairesPrevus,v=>(r(),a("tr",{key:v.id},[e("td",hn,[p(f,{valeur:v.heures},null,8,["valeur"])]),e("td",null,[p(d,{name:"thumbs-up",variant:"success"}),m(" Saisi par "),p(u,{mail:v.histoCreateur.email,nom:v.histoCreateur.displayName},null,8,["mail","nom"]),m(" le "),p(o,{value:v.histoCreation},null,8,["value"]),mn,p(d,{name:v.valide?"thumbs-up":"thumbs-down",variant:v.valide?"success":"info"},null,8,["name","variant"]),m(" "+c(v.validation&&v.validation.id==null?"Autovalidé":v.validation?"":"à valider")+" ",1),v.validation&&v.validation.histoCreateur?(r(),a("span",_n,[m(" Validé par "),p(u,{mail:v.validation.histoCreateur.email,nom:v.validation.histoCreateur.displayName},null,8,["mail","nom"]),m(" le "),p(o,{value:v.validation.histoCreation},null,8,["value"])])):h("",!0)]),e("td",null,[v.canValider?(r(),a("a",{key:0,"data-id":v.id,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?","data-title":"Validation du volume horaire",onClick:n[5]||(n[5]=C((...P)=>i.volumeHoraireValider&&i.volumeHoraireValider(...P),["prevent"]))},"Valider",8,fn)):h("",!0),v.canDevalider?(r(),a("a",{key:1,"data-id":v.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?","data-title":"Dévalidation du volume horaire",onClick:n[6]||(n[6]=C((...P)=>i.volumeHoraireDevalider&&i.volumeHoraireDevalider(...P),["prevent"]))},"Dévalider",8,pn)):h("",!0),v.canSupprimer?(r(),a("a",{key:2,"data-id":v.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?","data-title":"Suppression du volume horaire",onClick:n[7]||(n[7]=C((...P)=>i.volumeHoraireSupprimer&&i.volumeHoraireSupprimer(...P),["prevent"]))},"Supprimer",8,bn)):h("",!0)])]))),128))])])]),footer:R(()=>[]),_:1},8,["id"])],64)}const Z=k(ps,[["render",vn],["__scopeId","data-v-1735108d"]]),gn=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),yn={components:{mission:Z},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],isMounted:!1,ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(t){modAjax(t.currentTarget,n=>{this.reload()})},supprimer(t){this.reload()},refresh(t){let n=Util.json.indexById(this.missions,t.id);this.missions[n]=t,this.refreshPlafonds()},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(t=>{this.missions=t.data,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?($(".plafonds").refresh(),$("#sidebar").refresh()):this.isMounted=!0}}},xn=["href"];function Cn(t,n,s,_,l,i){const o=T("mission");return r(),a(b,null,[(r(!0),a(b,null,g(l.missions,d=>(r(),E(o,{onSupprimer:i.supprimer,onRefresh:i.refresh,key:d.id,mission:d},null,8,["onSupprimer","onRefresh","mission"]))),128)),s.canAddMission?(r(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:n[0]||(n[0]=C((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Ajout d'une nouvelle mission",8,xn)):h("",!0)],64)}const kn=k(yn,[["render",Cn]]),Pn=Object.freeze(Object.defineProperty({__proto__:null,default:kn},Symbol.toStringTag,{value:"Module"})),En={name:"ListeCandidatures.vue",props:{intervenant:{required:!0},canValiderCandidature:{type:Boolean,required:!1}},data(){return{candidatures:[],urlListeOffre:unicaenVue.url("offre-emploi")}},mounted(){this.reload()},methods:{reload(){unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/get-candidatures",{intervenant:this.intervenant})).then(t=>{this.candidatures=t.data})},validerCandidature(t){modAjax(t.currentTarget,n=>{this.reload()})},refuserCandidature(t){popConfirm(t.target,n=>{this.reload()})},urlOffre(t){return unicaenVue.url("offre-emploi/detail/:offre",{offre:t.offre.id})},urlAccepterCandidature:function(t){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:t.id})},urlRefuserCandidature:function(t){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:t.id})}}},Dn={class:"table table-bordered"},Sn=e("th",null,"Offre d'emploi",-1),Vn=e("th",null,"Composante",-1),Tn=e("th",null,"Etat",-1),Mn=e("th",null,"Date commission",-1),In={key:0},Rn={key:0},wn={key:0,colspan:"5",style:{"text-align":"center"}},$n={style:{"text-align":"center"}},An=["href"],jn={style:{"text-align":"center"}},Un={style:{"text-align":"center"}},Ln={key:0,class:"badge rounded-pill bg-success"},Hn={key:1,class:"badge rounded-pill bg-danger"},qn={key:2,class:"badge rounded-pill bg-warning"},Fn={key:0,style:{"text-align":"center"}},zn=["href"],On=e("i",{class:"fa-solid fa-check"},null,-1),Nn=[On],Bn=["href"],Gn=e("i",{class:"fa-sharp fa-solid fa-xmark"},null,-1),Yn=[Gn],Jn=["href"];function Wn(t,n,s,_,l,i){const o=L,d=j;return r(),a("div",null,[e("table",Dn,[e("thead",null,[e("tr",null,[Sn,Vn,Tn,Mn,s.canValiderCandidature?(r(),a("th",In,"Action")):h("",!0)])]),e("tbody",null,[l.candidatures.length==0?(r(),a("tr",Rn,[s.canValiderCandidature?(r(),a("td",wn,"Aucune candidature")):h("",!0)])):h("",!0),(r(!0),a(b,null,g(l.candidatures,u=>(r(),a("tr",{key:u.id},[e("td",$n,[e("a",{href:i.urlOffre(u)},c(u.offre.titre),9,An)]),e("td",jn,c(u.offre.structure.libelleCourt),1),e("td",Un,[u.validation?(r(),a("span",Ln,"Acceptée par "+c(u.validation.histoCreateur.displayName),1)):h("",!0),!u.validation&&u.motif!==null?(r(),a("span",Hn,c(u.motif),1)):h("",!0),!u.validation&&u.motif===null?(r(),a("span",qn,"En attente d'acceptation")):h("",!0)]),e("td",null,[u.dateCommission?(r(),E(o,{key:0,value:u.dateCommission},null,8,["value"])):h("",!0)]),this.canValiderCandidature?(r(),a("td",Fn,[u.validation?h("",!0):(r(),a("a",{key:0,href:i.urlAccepterCandidature(u),class:"btn btn-success","data-content":"Êtes vous sûr de vouloir accepter cette candidature ?","data-title":"Accepter la candidature",style:{color:"white"},title:"Accepter la candidature",onClick:n[0]||(n[0]=C((...f)=>i.validerCandidature&&i.validerCandidature(...f),["prevent"]))},Nn,8,zn)),m("  "),e("a",{href:i.urlRefuserCandidature(u),class:"btn btn-danger","data-content":"Êtes vous sûr de vouloir refuser cette candidature ?","data-title":"Refuser la candidature",style:{color:"white"},title:"Refuser la candidature",onClick:n[1]||(n[1]=C((...f)=>i.refuserCandidature&&i.refuserCandidature(...f),["prevent"]))},Yn,8,Bn)])):h("",!0)]))),128))])]),e("a",{href:l.urlListeOffre,class:"btn btn-primary",title:"Voir les offres d'emploi"},[p(d,{name:"eye"}),m(" Voir toutes les offres d'emploi ")],8,Jn),m("  ")])}const Qn=k(En,[["render",Wn]]),Xn=Object.freeze(Object.defineProperty({__proto__:null,default:Qn},Symbol.toStringTag,{value:"Module"})),Zn={name:"OffreEmploi.vue",props:{offre:{required:!0},utilisateur:{required:!1},extended:{type:Boolean,required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},decretText:{type:String,required:!1}},data(){return{saisirUrl:unicaenVue.url("offre-emploi/saisir/:offre",{offre:this.offre.id}),supprimerUrl:unicaenVue.url("offre-emploi/supprimer/:offre",{offre:this.offre.id}),validerUrl:unicaenVue.url("offre-emploi/valider/:offre",{offre:this.offre.id}),devaliderUrl:unicaenVue.url("offre-emploi/devalider/:offre",{offre:this.offre.id}),consulterUrl:unicaenVue.url("offre-emploi/detail/:offre",{offre:this.offre.id}),offreEmploiUrl:unicaenVue.url("offre-emploi"),postulerUrl:unicaenVue.url("offre-emploi/postuler/:id",{id:this.offre.id}),decret:!1}},computed:{isCandidat:function(){return!1},shortDesc:function(){if(!this.offre.description)return"";let t=this.offre.description.substr(0,200);return this.offre.description.length>200&&(t+="..."),t},descriptionHtml:function(){return this.offre.description?this.offre.description.replace(/(?:\r\n|\r|\n)/g,"<br />"):""},connectionLink:function(){let t="auth/connexion?redirect="+window.location.href;return unicaenVue.url(t)}},mounted(){this.decretText||(this.decret=!0)},methods:{saisir(t){modAjax(t.target,n=>{this.refresh()})},urlVoir:function(t){return unicaenVue.url("intervenant/:code/voir",{code:"code:"+t.intervenant.code})},urlVoirCandidature:function(t){return unicaenVue.url("intervenant/:code/candidature",{code:"code:"+t.intervenant.code})},urlAccepterCandidature:function(t){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:t.id})},urlRefuserCandidature:function(t){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:t.id})},refresh(){unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.offre.id})).then(t=>{this.$emit("refresh",t.data)})},supprimer(t){popConfirm(t.target,n=>{this.$emit("supprimer",this.offre)})},postuler(t){popConfirm(t.target,n=>{this.$emit("postuler",this.offre)})},valider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},devalider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},validerCandidature(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},refuserCandidature(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})}}},Kn={key:0,class:"col"},ei={class:"card h-100"},ti={class:"card-header"},si={class:"badge rounded-pill bg-info"},ni={key:0,class:"badge rounded-pill bg-success"},ii={key:1,class:"badge rounded-pill bg-warning"},ri={class:"card-body"},ai={class:"bg-light",style:{padding:"5px"}},oi=e("b",null,"Créée le : ",-1),li=e("br",null,null,-1),di=e("b",null,"Période à pourvoir : ",-1),ui=e("br",null,null,-1),ci=e("b",null,"Demandée par la composante :",-1),hi=e("br",null,null,-1),mi=e("b",null,"Type de mission :",-1),_i={class:"card-footer"},fi={class:"d-grid gap-2 d-md-flex justify-content-md-end"},pi=["href"],bi={key:1},vi={class:"page-header"},gi={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},yi=e("i",{class:"fa-solid fa-user"},null,-1),xi={class:"ms-2"},Ci=["href"],ki={key:1,class:"alert alert-primary d-flex align-items-center",role:"alert"},Pi=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Ei=e("div",{class:"ms-2"}," Vous n'avez pas les droits pour postuler à cette offre, merci de contacter votre administration de rattachement. ",-1),Di=[Pi,Ei],Si={key:2,class:"alert alert-primary d-flex align-items-center",role:"alert"},Vi=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Ti=e("div",{class:"ms-2"}," Vous avez déjà postulé à cette offre. ",-1),Mi=[Vi,Ti],Ii={class:"bg-light",style:{padding:"10px"}},Ri=e("b",null,"Créée le : ",-1),wi=e("br",null,null,-1),$i=e("b",null,"Période à pourvoir : ",-1),Ai=e("br",null,null,-1),ji=e("b",null,"Date limite de candidature :",-1),Ui=e("br",null,null,-1),Li=e("b",null,"Demandé par la composante :",-1),Hi=e("br",null,null,-1),qi=e("b",null,"Type de mission :",-1),Fi=e("br",null,null,-1),zi=e("b",null,"Nombre d'heures pour la mission :",-1),Oi=e("br",null,null,-1),Ni=e("b",null,"Nombre de postes à pourvoir :",-1),Bi=e("br",null,null,-1),Gi=["innerHTML"],Yi={key:3,class:"alert alert-info"},Ji=["innerHTML"],Wi=e("br",null,null,-1),Qi={key:4},Xi=e("h5",null,[e("strong",null,"Liste des candidats :")],-1),Zi={class:"table table-bordered"},Ki=e("th",null,"Intervenant",-1),er=e("th",null,"Etat",-1),tr={key:0},sr={key:0},nr={key:0,colspan:"4",style:{"text-align":"center"}},ir={key:1,colspan:"3",style:{"text-align":"center"}},rr=["href"],ar={key:0,class:"badge rounded-pill bg-success"},or={key:1,class:"badge rounded-pill bg-danger"},lr={key:2,class:"badge rounded-pill bg-warning"},dr={key:0},ur=["href"],cr={class:"mt-5"},hr=["href"],mr=["href"],_r=["href"],fr=["href"],pr=["href"],br=["href"];function vr(t,n,s,_,l,i){const o=L,d=j;return r(),a(b,null,[this.extended?h("",!0):(r(),a("div",Kn,[e("div",ei,[e("div",ti,[e("h4",null,c(s.offre.titre),1),e("span",si,c(s.offre.nombreHeures)+" heure(s)",1),m("   "),s.offre.validation?(r(),a("span",ni,[m("Validée le "),p(o,{value:s.offre.validation.histoCreation},null,8,["value"]),m(" par "+c(s.offre.validation.histoCreateur.displayName),1)])):h("",!0),s.offre.validation?h("",!0):(r(),a("span",ii," En attente de validation par la DRH")),m("  ")]),e("div",ri,[e("p",ai,[oi,p(o,{value:s.offre.histoCreation},null,8,["value"]),m(" par "+c(s.offre.histoCreateur.displayName),1),li,di,m("du "),p(o,{value:s.offre.dateDebut},null,8,["value"]),m(" au "),p(o,{value:s.offre.dateFin},null,8,["value"]),ui,ci,m(" "+c(s.offre.structure.libelleCourt)+" ",1),hi,mi,m(" "+c(s.offre.typeMission.libelle),1)]),m(" "+c(i.shortDesc),1)]),e("div",_i,[e("div",fi,[e("a",{href:l.consulterUrl,class:"btn btn-primary",title:"Consulter "},[p(d,{name:"eye"}),m(" Voir ")],8,pi)])])])])),this.extended?(r(),a("div",bi,[e("h1",vi,c(s.offre.titre),1),this.utilisateur?h("",!0):(r(),a("div",gi,[yi,e("div",xi,[m(" Vous devez "),e("a",{href:i.connectionLink,class:"text-decoration-underline alert-link"},"être identifé",8,Ci),m(" pour pouvoir postuler. ")])])),!s.offre.canPostuler&&this.utilisateur?(r(),a("div",ki,Di)):h("",!0),i.isCandidat&&this.utilisateur?(r(),a("div",Si,Mi)):h("",!0),e("p",Ii,[Ri,p(o,{value:s.offre.histoCreation},null,8,["value"]),m(" par "+c(s.offre.histoCreateur.displayName),1),wi,$i,m("du "),p(o,{value:s.offre.dateDebut},null,8,["value"]),m(" au "),p(o,{value:s.offre.dateFin},null,8,["value"]),Ai,ji,p(o,{value:s.offre.dateLimite},null,8,["value"]),Ui,Li,m(" "+c(s.offre.structure.libelleCourt)+" ",1),Hi,qi,m(" "+c(s.offre.typeMission.libelle)+" ",1),Fi,zi,m(" "+c(s.offre.nombreHeures)+" heure(s) ",1),Oi,Ni,m(" "+c(s.offre.nombrePostes)+" poste(s) ",1),Bi]),e("p",{innerHTML:this.descriptionHtml},null,8,Gi),this.decretText?(r(),a("p",Yi,[w(e("input",{id:"decret","onUpdate:modelValue":n[0]||(n[0]=u=>l.decret=u),name:"decret",type:"checkbox"},null,512),[[F,l.decret]]),m("  "),e("span",{innerHTML:this.decretText},null,8,Ji)])):h("",!0),Wi,this.canValiderCandidature?(r(),a("div",Qi,[Xi,e("table",Zi,[e("thead",null,[e("tr",null,[Ki,er,s.canValiderCandidature?(r(),a("th",tr,"Action")):h("",!0)])]),e("tbody",null,[s.offre.candidatures.length==0?(r(),a("tr",sr,[s.canValiderCandidature?(r(),a("td",nr,"Aucune candidature")):h("",!0),s.canValiderCandidature?h("",!0):(r(),a("td",ir,"Aucune candidature"))])):h("",!0),(r(!0),a(b,null,g(s.offre.candidatures,u=>(r(),a("tr",null,[e("td",null,[e("a",{href:i.urlVoir(u)},c(u.intervenant.prenom+" "+u.intervenant.nomUsuel),9,rr)]),e("td",null,[u.validation?(r(),a("span",ar,[m("Acceptée le "),p(o,{value:u.validation.histoCreation},null,8,["value"]),m(" par "+c(u.validation.histoCreateur.displayName),1)])):h("",!0),!u.validation&&u.motif!==null?(r(),a("span",or,c(u.motif),1)):h("",!0),!u.validation&&u.motif===null?(r(),a("span",lr,"En attente d'acceptation")):h("",!0)]),this.canValiderCandidature?(r(),a("td",dr,[e("a",{href:i.urlVoirCandidature(u),class:"btn btn-primary",title:"Consulter "},[p(d,{name:"eye"}),m(" Voir ")],8,ur)])):h("",!0)]))),256))])])])):h("",!0),e("div",cr,[e("a",{href:l.offreEmploiUrl,class:"btn btn-secondary"},"Retour aux offres",8,hr),m("  "),this.canPostuler?(r(),a("a",{key:0,class:V([l.decret?"":"disabled","btn btn-primary"]),href:l.postulerUrl,"data-bs-original-title":"Vous devez être connecté pour postuler","data-bs-placement":"top","data-bs-toggle":"tooltip"},"Postuler",10,mr)):h("",!0),m("  "),s.offre.canModifier?(r(),a("a",{key:1,href:l.saisirUrl,class:"btn btn-primary",title:"Modifier",onClick:n[1]||(n[1]=C((...u)=>i.saisir&&i.saisir(...u),["prevent"]))},[p(d,{name:"pen-to-square"}),m(" Modifier ")],8,_r)):h("",!0),m("  "),s.offre.validation&&s.offre.canValider?(r(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger",title:"Devalider",onClick:n[2]||(n[2]=C((...u)=>i.devalider&&i.devalider(...u),["prevent"]))},[p(d,{name:"thumbs-down"}),m(" Devalider ")],8,fr)):h("",!0),m("  "),!s.offre.validation&&s.offre.canValider?(r(),a("a",{key:3,href:l.validerUrl,class:"btn btn-success",title:"Valider",onClick:n[3]||(n[3]=C((...u)=>i.valider&&i.valider(...u),["prevent"]))},[p(d,{name:"thumbs-up"}),m(" Valider ")],8,pr)):h("",!0),m("  "),s.offre.canSupprimer?(r(),a("a",{key:4,href:l.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer l'offre ?","data-title":"Suppression de l'offre",title:"Supprimer",onClick:n[4]||(n[4]=C((...u)=>i.supprimer&&i.supprimer(...u),["prevent"]))},[p(d,{name:"trash"}),m(" Supprimer ")],8,br)):h("",!0)])])):h("",!0)],64)}const K=k(Zn,[["render",vr]]),gr=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),yr={components:{offreEmploi:K},props:{id:{type:Number,required:!1},utilisateur:{required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1}},data(){return{offres:[],ajoutUrl:unicaenVue.url("offre-emploi/saisir")}},mounted(){this.reload()},computed:{extended:function(){return!!this.id}},methods:{ajout(t){modAjax(t.target,n=>{this.reload()})},supprimer(){window.location.href=unicaenVue.url("offre-emploi")},refresh(t){let n=Util.json.indexById(this.offres,t.id);this.offres[n]=t},reload(){this.id?unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.id})).then(t=>{this.offres=[t.data]}):unicaenVue.axios.get(unicaenVue.url("offre-emploi/liste")).then(t=>{this.offres=t.data})}}},xr={key:0,class:"row row-cols-1 row-cols-md-2 g-4 mb-3"},Cr={key:1},kr=["href"],Pr={key:2};function Er(t,n,s,_,l,i){const o=T("offreEmploi");return r(),a(b,null,[i.extended?h("",!0):(r(),a("div",xr,[(r(!0),a(b,null,g(l.offres,d=>(r(),E(o,{key:d.id,canModifier:this.canModifier,canSupprimer:this.canSupprimer,canValider:this.canValider,canVoirCandidature:this.canVoirCandidature,offre:d,decretText:d.decretText,onRefresh:i.refresh,onSupprimer:i.supprimer},null,8,["canModifier","canSupprimer","canValider","canVoirCandidature","offre","decretText","onRefresh","onSupprimer"]))),128))])),i.extended?h("",!0):(r(),a("div",Cr,[this.canModifier?(r(),a("a",{key:0,href:l.ajoutUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=C((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Ajouter une nouvelle offre",8,kr)):h("",!0)])),i.extended?(r(),a("div",Pr,[(r(!0),a(b,null,g(l.offres,d=>(r(),E(o,{key:d.id,canModifier:this.canModifier,canPostuler:this.canPostuler,canSupprimer:this.canSupprimer,canValider:this.canValider,canValiderCandidature:this.canValiderCandidature,canVoirCandidature:this.canVoirCandidature,decretText:d.decretText,extended:i.extended,offre:d,utilisateur:this.utilisateur,onRefresh:i.refresh,onSupprimer:i.supprimer},null,8,["canModifier","canPostuler","canSupprimer","canValider","canValiderCandidature","canVoirCandidature","decretText","extended","offre","utilisateur","onRefresh","onSupprimer"]))),128))])):h("",!0)],64)}const Dr=k(yr,[["render",Er]]),Sr=Object.freeze(Object.defineProperty({__proto__:null,default:Dr},Symbol.toStringTag,{value:"Module"})),Vr={name:"Prime.vue",props:{prime:{required:!0},numero:{required:!1},intervenant:{required:!0},canGerer:{type:Boolean,required:!1}},data(){return{declarationUrl:unicaenVue.url("prime/:intervenant/declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerUrl:unicaenVue.url("prime/:intervenant/supprimer-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),validerUrl:unicaenVue.url("prime/:intervenant/valider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),devaliderUrl:unicaenVue.url("prime/:intervenant/devalider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),telechargerUrl:unicaenVue.url("prime/:intervenant/telecharger-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),refuserUrl:unicaenVue.url("prime/:intervenant/refuser-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),modifierPrimeUrl:unicaenVue.url("prime/:intervenant/saisie/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerPrimeUrl:unicaenVue.url("prime/:intervenant/supprimer-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id})}},computed:{},methods:{supprimer(t){popConfirm(t.target,n=>{this.$emit("reload")})},valider(t){popConfirm(t.target,n=>{this.$emit("reload")})},devalider(t){popConfirm(t.target,n=>{this.$emit("reload")})},refuser(){unicaenVue.axios.post(this.refuserUrl).then(t=>{this.$emit("reload")})},modifierPrime(t){modAjax(t.currentTarget,n=>{this.$emit("reload")})},supprimerPrime(t){popConfirm(t.target,n=>{this.$emit("reload")})}}},Tr={key:0},Mr=e("br",null,null,-1),Ir=e("u",null,"Mission(s) concernée(s)",-1),Rr={key:0},wr=["action"],$r={class:"card-body"},Ar={class:"row"},jr={key:0,class:"col-md-6"},Ur={class:"card text-dark bg-light"},Lr=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),Hr={class:"card-body"},qr=e("p",{class:"card-text"},[m(" Pour "),e("b",null,"bénéficier de votre indemnité de fin de contrat"),m(", vous devez déposer une déclaration sur l'honneur ("),e("a",{href:""},"exemple"),m(") signée précisant que vous ne débutez pas d'autre contrat dans la fonction au publique à la suite de ces missions. ")],-1),Fr=["disabled"],zr={class:"card-footer d-grid gap-2"},Or=["disabled"],Nr={key:1,class:"col-md-6"},Br={class:"card text-dark bg-light"},Gr=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),Yr={class:"card-body"},Jr=e("p",{class:"card-text"},"Vous pouvez télécharger votre déclaration sur l'honneur ci-dessous : ",-1),Wr=["href"],Qr={class:"card-footer",style:{"text-align":"right"}},Xr=["href"],Zr=["href"],Kr=["href"],ea={class:"col-md-6"},ta={key:0},sa=["checked","disabled"],na=e("b",null,"je déclare ne pas pouvoir bénéficier d'une indemnité",-1),ia=e("br",null,null,-1),ra=e("br",null,null,-1),aa=e("div",null,[e("label",{class:"form-label"},"Suivi de la déclaration : ")],-1),oa={key:0},la={key:1},da={key:2},ua={key:3},ca={key:4},ha={key:5},ma={key:6},_a={class:"row"},fa={class:"col-md-12"},pa={class:"float-end"},ba=["href"],va=["href"];function ga(t,n,s,_,l,i){const o=L,d=j;return r(),a("div",{class:V([{"bg-success":s.prime.validation,"bg-default":!s.prime.validation&&!s.prime.dateRefus,"bg-danger":s.prime.dateRefus},"card"])},[e("div",{class:V([{"text-white":s.prime.dateRefus},"card-header card-header-h3"])},[s.prime.id?(r(),a("h5",Tr,[m(" Indemnité de fin de contrat N°"+c(s.numero+1),1),Mr])):h("",!0),e("div",null,[Ir,m(" : "),(r(!0),a(b,null,g(s.prime.missions,(u,f)=>(r(),a("span",null,[m(c(u.typeMission.libelle)+" (Pour "+c(u.structure.libelleCourt)+" du ",1),p(o,{value:u.dateDebut},null,8,["value"]),m(" au "),p(o,{value:u.dateFin},null,8,["value"]),m(") "),f!=s.prime.missions.length-1?(r(),a("span",Rr,", ")):h("",!0)]))),256))])],2),e("form",{action:l.declarationUrl,enctype:"multipart/form-data",method:"post"},[e("div",$r,[e("div",Ar,[s.prime.declaration?h("",!0):(r(),a("div",jr,[e("div",Ur,[Lr,e("div",Hr,[qr,e("input",{ref:"file",disabled:!!s.prime.dateRefus,name:"files[]",type:"file"},null,8,Fr)]),e("div",zr,[e("input",{disabled:!!s.prime.dateRefus,class:"btn btn-primary",type:"submit",value:"Envoyer"},null,8,Or)])])])),s.prime.declaration?(r(),a("div",Nr,[e("div",Br,[Gr,e("div",Yr,[Jr,e("a",{href:l.telechargerUrl},c(s.prime.declaration.nom),9,Wr)]),e("div",Qr,[s.prime.declaration&&!s.prime.validation&&!s.prime.dateRefus?(r(),a("a",{key:0,href:l.supprimerUrl,class:"btn btn-danger",title:"Supprimer",onClick:n[0]||(n[0]=C((...u)=>i.supprimer&&i.supprimer(...u),["prevent"]))}," Supprimer ",8,Xr)):h("",!0),m("  "),s.prime.declaration&&!s.prime.validation&&this.canGerer&&!s.prime.dateRefus?(r(),a("a",{key:1,href:l.validerUrl,class:"btn btn-success",title:"Valider",onClick:n[1]||(n[1]=C((...u)=>i.valider&&i.valider(...u),["prevent"]))}," Valider ",8,Zr)):h("",!0),m("  "),s.prime.declaration&&s.prime.validation&&this.canGerer&&!s.prime.dateRefus?(r(),a("a",{key:2,href:l.devaliderUrl,class:"btn btn-danger d-grid gap-2",title:"Dévalider",onClick:n[2]||(n[2]=C((...u)=>i.devalider&&i.devalider(...u),["prevent"]))}," Dévalider ",8,Kr)):h("",!0),m("  ")])])])):h("",!0),e("div",ea,[s.prime.validation?h("",!0):(r(),a("div",ta,[e("input",{checked:s.prime.dateRefus,disabled:s.prime.validation,name:"prime",type:"checkbox",onChange:n[3]||(n[3]=(...u)=>i.refuser&&i.refuser(...u))},null,40,sa),m("  Ou en cochant cette case, "),na,m(" de fin de contrat en raison du démarrage d'un nouveau contrat au sein de la fonction publique à la suite de ces missions. "),ia,ra])),e("div",null,[aa,s.prime.dateRefus?(r(),a("div",oa,[p(d,{name:"thumbs-down",variant:"danger"}),m(" Indemnité refusée le "),p(o,{value:s.prime.dateRefus},null,8,["value"])])):h("",!0),s.prime.declaration&&!s.prime.dateRefus?(r(),a("div",la,[p(d,{name:"thumbs-up",variant:"success"}),m(" Déclaration déposée le "),p(o,{value:s.prime.declaration.histoCreation},null,8,["value"]),m(" par "+c(s.prime.declaration.histoCreateur.displayName),1)])):h("",!0),!s.prime.declaration&&!s.prime.dateRefus?(r(),a("div",da,[p(d,{name:"thumbs-down",variant:"info"}),m(" Aucune déclaration déposée ")])):h("",!0),s.prime.validation&&!s.prime.dateRefus?(r(),a("div",ua,[p(d,{name:"thumbs-up",variant:"success"}),m(" Déclaration validée le "),p(o,{value:s.prime.validation.histoCreation},null,8,["value"]),m(" par "+c(s.prime.validation.histoCreateur.displayName),1)])):h("",!0),!s.prime.validation&&!s.prime.dateRefus?(r(),a("div",ca,[p(d,{name:"thumbs-down",variant:"info"}),m(" Aucune déclaration validée ")])):h("",!0),s.prime.validation&&!s.prime.dateRefus?(r(),a("div",ha,[p(d,{name:"euro-sign",variant:"success"}),m(" Intervenant éligible à une indemnité de fin de contrat ")])):h("",!0),s.prime.dateRefus?(r(),a("div",ma,[p(d,{name:"euro-sign",variant:"info"}),m(" Intervenant non éligible à une indemnité de fin de contrat ")])):h("",!0)])])]),e("div",_a,[e("div",fa,[e("span",pa,[!s.prime.validation&&!s.prime.dateRefus&&this.canGerer?(r(),a("a",{key:0,href:l.modifierPrimeUrl,class:"btn btn-primary",onClick:n[4]||(n[4]=C((...u)=>i.modifierPrime&&i.modifierPrime(...u),["prevent"]))},"Modifier",8,ba)):h("",!0),m("   "),!s.prime.validation&&!s.prime.dateRefus&&this.canGerer?(r(),a("a",{key:1,href:l.supprimerPrimeUrl,class:"btn btn-danger",onClick:n[5]||(n[5]=C((...u)=>i.supprimerPrime&&i.supprimerPrime(...u),["prevent"]))},"Supprimer",8,va)):h("",!0)])])])])],8,wr)],2)}const ee=k(Vr,[["render",ga]]),ya=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"})),xa={components:{prime:ee},props:{intervenant:{type:Number,required:!0},numero:{type:Number,required:!1},missionsWithoutPrime:{type:Number,required:!1},canGerer:{type:Boolean,required:!1}},data(){return{load:!1,primes:[],ajoutUrl:unicaenVue.url("prime/:intervenant/saisie/",{intervenant:this.intervenant})}},mounted(){this.reload(),console.log(this.primes.length)},methods:{ajout(t){modAjax(t.currentTarget,n=>{this.reload()})},reload(){this.load=!1,this.primes=[],unicaenVue.axios.get(unicaenVue.url("prime/:intervenant/liste",{intervenant:this.intervenant})).then(t=>{this.primes=t.data,this.load=!0})}}},Ca={key:0,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},ka=e("br",null,null,-1),Pa=e("br",null,null,-1),Ea={key:1,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},Da=e("br",null,null,-1),Sa=e("br",null,null,-1),Va={key:2},Ta=["href"];function Ma(t,n,s,_,l,i){const o=T("prime");return r(),a(b,null,[(r(!0),a(b,null,g(l.primes,(d,u)=>(r(),E(o,{canGerer:s.canGerer,intervenant:this.intervenant,numero:u,prime:d,onReload:i.reload},null,8,["canGerer","intervenant","numero","prime","onReload"]))),256)),l.load?h("",!0):(r(),a("div",Ca,[m(" Chargement en cours..."),ka,Pa])),l.primes.length==0&&l.load?(r(),a("div",Ea,[m(" Aucune indemnité de fin de contrat actuellement..."),Da,Sa])):h("",!0),this.missionsWithoutPrime>0&&this.canGerer?(r(),a("div",Va,[e("a",{href:l.ajoutUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=C((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Créer une nouvelle indemnité",8,Ta)])):h("",!0)],64)}const Ia=k(xa,[["render",Ma]]),Ra=Object.freeze(Object.defineProperty({__proto__:null,default:Ia},Symbol.toStringTag,{value:"Module"})),wa={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0},addDateDebut:{type:String,required:!1},addDateFin:{type:String,required:!1}},data(){const t=new Date(this.date);return{mois:t.getMonth()+1,annee:t.getFullYear()}},computed:{listeJours(){const t=new Date(this.date);t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(t.getDate()-1);let n=t.getDate();return Array.from({length:n},(s,_)=>_+1)}},watch:{date:function(t,n){const s=new Date(this.date);this.mois=s.getMonth()+1,this.annee=s.getFullYear()},mois:function(t,n){const s=new Date(this.date);s.setMonth(t-1),this.$emit("changeDate",s)},annee:function(t,n){const s=new Date(this.date);s.setFullYear(t),this.$emit("changeDate",s)}},methods:{nomJour(t){const n=new Date(this.date);return n.setDate(t),n.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let t=[];const n=new Date;for(let s=1;s<=12;s++){n.setMonth(s-1);let _=n.toLocaleString("fr-FR",{month:"long"});t.push({id:s,libelle:_})}return t},listeAnnees(){const n=new Date().getFullYear(),s=1;let _=[];for(let l=n-s;l<=n+s;l++)_.push(l);return _},canAdd(t){if(!this.canAddEvent)return!1;let n=this.addDateDebut;n===void 0?n=new Date("2000-01-01"):n==="now"?n=new Date:n=new Date(n);let s=this.addDateFin;s===void 0?s=new Date("2500-01-01"):s==="now"?s=new Date:s=new Date(s);let _=new Date(this.date);return _.setDate(t),n=this.isoDateOnly(n),s=this.isoDateOnly(s),_=this.isoDateOnly(_),!(_<n||_>s)},addEvent(t){const n=new Date(this.date);n.setDate(t.currentTarget.dataset.jour),this.$emit("addEvent",n,t)},prevMois(){const t=new Date(this.date);t.setMonth(t.getMonth()-1),this.$emit("changeDate",t)},nextMois(){const t=new Date(this.date);t.setMonth(t.getMonth()+1),this.$emit("changeDate",t)},eventsByJour(t){const n=new Date(this.date);let s={};for(let _ in this.events){let l=this.events[_];l.date.getFullYear()===n.getFullYear()&&l.date.getMonth()+1===n.getMonth()+1&&l.date.getDate()===t&&(s[_]=l)}return s},isoDateOnly(t){const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),_=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${_}`}}},$a={class:"calendar"},Aa={class:"recherche"},ja={class:"recherche btn-group"},Ua=["value"],La=["value"],Ha={class:"table table-bordered table-hover table-sm"},qa=["data-jour"],Fa={class:"nom-jour"},za={class:"numero-jour"},Oa={class:"num-jour badge bg-secondary rounded-circle"},Na={key:0},Ba=["data-jour"];function Ga(t,n,s,_,l,i){const o=j;return r(),a("div",$a,[e("div",Aa,[e("div",ja,[e("button",{class:"btn btn-light",id:"prevMois",onClick:n[0]||(n[0]=(...d)=>i.prevMois&&i.prevMois(...d)),title:"Mois précédant"},[p(o,{name:"chevron-left"})]),w(e("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":n[1]||(n[1]=d=>l.mois=d)},[(r(!0),a(b,null,g(i.listeMois(),d=>(r(),a("option",{value:d.id},c(d.libelle),9,Ua))),256))],512),[[z,l.mois]]),w(e("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":n[2]||(n[2]=d=>l.annee=d)},[(r(!0),a(b,null,g(i.listeAnnees(),d=>(r(),a("option",{value:d},c(d),9,La))),256))],512),[[z,l.annee]]),e("button",{class:"btn btn-light",id:"nextMois",onClick:n[3]||(n[3]=(...d)=>i.nextMois&&i.nextMois(...d)),title:"Mois suivant"},[p(o,{name:"chevron-right"})])])]),e("table",Ha,[(r(!0),a(b,null,g(i.listeJours,d=>(r(),a("tr",{"data-jour":d},[e("th",Fa,c(i.nomJour(d)),1),e("th",za,[e("div",Oa,c(d<10?"0"+d.toString():d),1)]),e("td",null,[(r(!0),a(b,null,g(i.eventsByJour(d),(u,f)=>(r(),a("div",{class:"event",style:G("border-color:"+u.color+";background-color:"+u.bgcolor),key:f},[(r(),E(de(u.component),{event:u},null,8,["event"]))],4))),128)),i.canAdd(d)?(r(),a("div",Na,[e("button",{onClick:n[4]||(n[4]=(...u)=>i.addEvent&&i.addEvent(...u)),"data-jour":d,class:"btn btn-light btn-sm"},[p(o,{name:"plus"}),m(" Nouvel événement ")],8,Ba)])):h("",!0)])],8,qa))),256))])])}const Ya=k(wa,[["render",Ga],["__scopeId","data-v-51bbc42d"]]),Ja={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(t){modAjax(t.currentTarget,n=>{this.suivi.refresh()})},supprimer(t){popConfirm(t.currentTarget,n=>{this.suivi.refresh()})},valider(t){unicaenVue.axios.get(this.validerUrl).then(n=>{this.suivi.refresh()})},devalider(t){popConfirm(t.currentTarget,n=>{this.suivi.refresh()})}}},Wa={class:"event-content"},Qa={class:"mission"},Xa={key:0,class:"badge bg-success"},Za={class:"horaires"},Ka={key:0,class:"badge bg-secondary"},eo={key:0,class:"description"},to={class:"event-actions"},so={class:"btn-group btn-group-sm"},no=["data-url"],io=["data-url"],ro=["data-url"],ao=["data-url"];function oo(t,n,s,_,l,i){const o=j;return r(),a(b,null,[e("div",Wa,[e("p",Qa,[m(c(s.event.mission.libelleCourt)+" ",1),s.event.valide?(r(),a("span",Xa,"Validé")):h("",!0)]),e("p",Za,[m(" de "+c(i.heureDebut)+" à "+c(i.heureFin)+", soit "+c(i.heures)+" heure"+c(i.heures<2?"":"s")+" ",1),s.event.formation?(r(),a("span",Ka,"En formation")):h("",!0)]),s.event.description?(r(),a("p",eo,c(s.event.description),1)):h("",!0)]),e("div",to,[e("div",so,[s.event.canEdit?(r(),a("button",{key:0,class:"btn btn-light",onClick:n[0]||(n[0]=(...d)=>i.modifier&&i.modifier(...d)),title:"Modifier le suivi","data-url":l.modifierUrl},[p(o,{name:"pen-to-square"})],8,no)):h("",!0),s.event.canValider?(r(),a("button",{key:1,class:"btn btn-light",onClick:n[1]||(n[1]=(...d)=>i.valider&&i.valider(...d)),title:"Valider le suivi","data-url":l.validerUrl},[p(o,{name:"check",class:"text-success"})],8,io)):h("",!0),s.event.canDevalider?(r(),a("button",{key:2,class:"btn btn-light",onClick:n[2]||(n[2]=(...d)=>i.devalider&&i.devalider(...d)),title:"Dévalider le suivi","data-url":l.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[p(o,{name:"xmark",class:"text-danger"})],8,ro)):h("",!0),s.event.canSupprimer?(r(),a("button",{key:3,class:"btn btn-light",onClick:n[3]||(n[3]=(...d)=>i.supprimer&&i.supprimer(...d)),title:"Supprimer le suivi","data-url":l.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[p(o,{name:"trash-can",class:"text-danger"})],8,ao)):h("",!0)])])],64)}const te=k(Ja,[["render",oo],["__scopeId","data-v-17cb1f29"]]),lo=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"})),uo={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,isMounted:!1,suivi:[]}},methods:{changeDate(t){this.date=t},ajouter(t,n){const s={intervenant:this.intervenant,date:t.toISOString().slice(0,10)};n.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",s),modAjax(n.currentTarget,_=>{this.refresh()})},refresh(){const t=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let n=0,s=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(_=>{let l=[];for(let i in _.data){let o=_.data[i];s[o.mission.id]===void 0&&(s[o.mission.id]=t[n],n++),o.valide&&(o.bgcolor="#d0eddb"),o.color=s[o.mission.id],o.component=ue(te),o.date=new Date(o.date),o.intervenant=this.intervenant,l.push(o)}this.suivi=l,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?$(".plafonds").refresh():this.isMounted=!0}}};function co(t,n,s,_,l,i){const o=Ya;return r(),E(o,{date:l.date,onChangeDate:i.changeDate,onAddEvent:i.ajouter,"can-add-event":s.canAddMission,addDateFin:"now",events:l.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const ho=k(uo,[["render",co]]),mo=Object.freeze(Object.defineProperty({__proto__:null,default:ho},Symbol.toStringTag,{value:"Module"})),_o={name:"DemandeMiseEnPaiementStructure",props:{datas:{required:!0},intervenant:{required:!0}},data(){return{dotationPaieEtat:this.datas.budget.dotation.paieEtat,dotationRessourcesPropres:this.datas.budget.dotation.ressourcePropre,consommationPaieEtat:this.datas.budget.liquidation.paieEtat,consommationRessourcesPropres:this.datas.budget.liquidation.ressourcePropre}},watch:{datas:function(){this.dotationPaieEtat=this.datas.budget.dotation.paieEtat,this.dotationRessourcesPropres=this.datas.budget.dotation.ressourcePropre,this.consommationPaieEtat=this.datas.budget.liquidation.paieEtat,this.consommationRessourcesPropres=this.datas.budget.liquidation.ressourcePropre}},computed:{pourcentagePaieEtat(){return Math.round(this.consommationPaieEtat/this.dotationPaieEtat*100)},pourcentageRessourcePropre(){return Math.round(this.consommationRessourcesPropres/this.dotationRessourcesPropres*100)},bgPaieEtat(){return Math.round(this.consommationPaieEtat/this.dotationPaieEtat*100)>100?"bg-warning":"bg-success"},bgRessourcesPropres(){return Math.round(this.consommationRessourcesPropres/this.dotationRessourcesPropres*100)>100?"bg-warning":"bg-success"}},methods:{heuresStatutToString(t){if(t.heuresAPayer==t.heuresPayees&&t.heuresAPayer>0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-success">Paiement effectué</span>';if(t.heuresAPayer==t.heuresDemandees)return'<span style="font-size:12px;line-height:20px;" class="badge bg-secondary text-dark">Paiement demandé</span>';if(t.heuresDemandees==0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-light text-dark">A payer</span>';if(Number(t.heuresPayees)>Number(t.heuresAPayer)){let n=t.heuresPayees-t.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement effectué - '+parseFloat(n.toFixed(2))+" hetd(s) payées en trop. </span>"}if(Number(t.heuresDemandees)>Number(t.heuresAPayer)){let n=t.heuresDemandees-t.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement demandé - '+parseFloat(n.toFixed(2))+" hetd(s) demandées en trop. </span></span>"}return"indetermine"},supprimerDemandeMiseEnPaiement(t){this.btnState("remove-"+t,"disabled"),unicaenVue.axios.get(unicaenVue.url("paiement/:intervenant/supprimer-demande/:dmep",{intervenant:this.intervenant,dmep:t})).then(n=>{this.$emit("refresh"),setTimeout(()=>{this.btnState("remove-"+t,"enabled")},4500)}).catch(n=>{this.$emit("refresh"),setTimeout(()=>{this.btnState("remove-"+t,"enabled")},2500)})},disabledPaiement(t){return t.missionId!=""||t.formuleResServiceRefId!=""?!(t.centreCoutId&&t.domaineFonctionnel):!1},enabledPaiement(t,n){if(n=="mission"){let s=document.getElementById("add-"+t),_=document.getElementById("centreCout-"+t).value,l=document.getElementById("domaineFonctionnel-"+t).value;_!=""&&l!=""?s.disabled=!1:s.disabled=!0}},ajouterDemandeMiseEnPaiement(t){this.btnState("add-"+t,"disabled");let n={animation:!0,delay:15e3,autohide:!0},s=document.getElementById("heures-"+t),_=document.getElementById("centreCout-"+t),l=document.getElementById("domaineFonctionnel-"+t),i=Number(s.value),o=Number(s.getAttribute("max")),d=l?l.value:"",u=s.hasAttribute("data-type-heures-id")?s.getAttribute("data-type-heures-id"):"",f=s.hasAttribute("data-formule-res-service-id")?s.getAttribute("data-formule-res-service-id"):"",y=s.hasAttribute("data-formule-res-service-ref-id")?s.getAttribute("data-formule-res-service-ref-id"):"",v=s.hasAttribute("data-service-id")?s.getAttribute("data-service-id"):"",P=s.hasAttribute("data-service-referentiel-id")?s.getAttribute("data-service-referentiel-id"):"",x=s.hasAttribute("data-mission-id")?s.getAttribute("data-mission-id"):"",H=_.value,I=_.options[_.selectedIndex].getAttribute("data-ressources-propres"),S=_.options[_.selectedIndex].getAttribute("data-paie-etat");if(H=="")return unicaenVue.flashMessenger.toast("Vous devez sélectionner un centre de coût pour demander la mise en paiement de ces heures","error",n),this.btnState("add-"+t,"enabled"),!1;if(i>0&&i>o)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible, vous demandez "+i+" hetd(s) alors que vous pouvez demander maximum "+o+" hetd(s)","error",n),this.btnState("add-"+t,"enabled"),!1;if(S==1&&this.dotationPaieEtat>0&&this.dotationPaieEtat-(this.consommationPaieEtat+i)<=0)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible manque de dotation 'paie etat' pour ces heures","error",n),this.btnState("add-"+t,"enabled"),!1;if(I==1&&this.dotationRessourcesPropres>0&&this.dotationRessourcesPropres-(this.consommationRessourcesPropres+i)<=0)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible manque de dotation 'ressources propres' pour ces heures","error",n),this.btnState("add-"+t,"enabled"),!1;var q=[];let N={heures:i,centreCoutId:H,typeHeuresId:u,formuleResServiceId:f,formuleResServiceRefId:y,serviceId:v,serviceReferentielId:P,domaineFonctionnelId:d,missionId:x,structureId:this.datas.id};q.push(N),unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),q).then(U=>{this.$emit("refresh"),setTimeout(()=>{this.btnState("add-"+t,"enabled")},4e3)}).catch(U=>{console.error(U),setTimeout(()=>{this.btnState("add-"+t,"enabled")},2500)})},demanderToutesLesHeuresEnPaiement(t,n){this.btnState("add-all-"+t,"disabled");let s=[],l=document.getElementById("demande-mise-en-paiement-"+t).getElementsByTagName("tr");for(var i=0;i<l.length;i++)if(l[i].getElementsByTagName("input").length>0&&l[i].classList.contains("detailHeure")){let o=l[i].getElementsByTagName("input")[0],d=l[i].getElementsByTagName("select")[0],u=l[i].getElementsByTagName("select")[1],f=Number(o.value),y=Number(o.getAttribute("max"));if(f<=0||f>y)console.warn("Le nombre d'heures demandées en paiement n'est pas situé entre le max et min possible.");else{let v=d.value,P=o.hasAttribute("data-type-heures-id")?o.getAttribute("data-type-heures-id"):"",x=o.hasAttribute("data-formule-res-service-id")?o.getAttribute("data-formule-res-service-id"):"",H=o.hasAttribute("data-formule-res-service-ref-id")?o.getAttribute("data-formule-res-service-ref-id"):"",I=o.hasAttribute("data-mission-id")?o.getAttribute("data-mission-id"):"",S=o.hasAttribute("data-service-id")?o.getAttribute("data-service-id"):"",q=o.hasAttribute("data-service-referentiel-id")?o.getAttribute("data-service-referentiel-id"):"",N=u?u.value:"",U={heures:f,centreCoutId:v,typeHeuresId:P,formuleResServiceId:x,formuleResServiceRefId:H,serviceId:S,serviceReferentielId:q,domaineFonctionnelId:N,missionId:I,structureId:this.datas.id};s.push(U)}}unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),s).then(o=>{this.$emit("refresh"),setTimeout(()=>{this.btnState("add-all-"+t,"enabled")},2500)}).catch(o=>{this.$emit("refresh"),setTimeout(()=>{this.btnState("add-all-"+t,"enabled")},2500)})},filtrerCentresCouts(t,n){let s=[];for(var _ in t){let l=_,i=[];t[_].forEach(function(o,d){o[n]==1&&i.push(o)}),i.length!=0&&s.push({group:l,child:i})}return s},notValueCentreCoutValue(t,n){return this.filtrerCentresCouts(t,n).length!=0?"Choisir un centre de coût":"Aucun centre de coût disponible demande de paiement impossible"},totalHeure(t){let n=0;for(var s in t)n+=Number(t[s].heuresAPayer);return parseFloat(n.toFixed(2))},shorten(t,n=20){if(t.length>n){var s='<span title="'+t+'"';return s+='data-bs-placement="top" data-bs-toggle="tooltip">',s+=t.substring(0,n)+"...",s+="</span>",s}else return t},btnState(t,n){let s=document.getElementById(t);return s?(n=="enabled"&&(s.disabled=!1,s.querySelector("#waiting").style.display="none",s.querySelector("#action").style.display="inline-block"),n=="disabled"&&(s.disabled=!0,s.querySelector("#waiting").style.display="inline-block",s.querySelector("#action").style.display="none"),!0):!1},formatDate(t,n){return Util.dateToString(t)}}},fo=["id"],po=["id"],bo=["aria-controls","data-bs-target"],vo=["id","aria-labelledby"],go={class:"accordion-body"},yo={key:0},xo=e("div",{class:"cartridge gray bordered",style:{"padding-bottom":"5px","margin-bottom":"20px"}},[e("span",null,"Budget")],-1),Co={class:"container"},ko={class:"table table-bordered caption-top"},Po=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"fw-bold",scope:"col"},"Paie etat"),e("th",{class:"fw-bold",scope:"col"},"Ressources propres")])],-1),Eo={style:{width:"50%"}},Do={key:0,class:"text-center progress position-relative bg-secondary",style:{height:"30px"}},So={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},Vo=["aria-valuemax","aria-valuenow","title"],To={key:1,class:"text-center"},Mo={style:{width:"50%"}},Io={key:0,class:"progress position-relative bg-secondary",style:{height:"30px"}},Ro={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},wo=["aria-valuemax","aria-valuenow","title"],$o={key:1,class:"text-center"},Ao={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},jo=e("span",null,"Enseignement",-1),Uo=["innerHTML"],Lo={class:"container"},Ho={class:"row"},qo={class:"col-12"},Fo={class:"table mt-3 table-bordered"},zo={class:"table-light"},Oo={colspan:"2"},No={colspan:"2"},Bo={class:"table table-sm"},Go=e("thead",null,[e("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"Heures"),e("th",{scope:"col",style:{width:"40%","font-size":"12px"}},"Centre de cout"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Etat"),e("th",{style:{width:"15%","font-size":"12px"}})],-1),Yo={class:"detailHeure"},Jo={key:0,style:{width:"20%"}},Wo=["title"],Qo={class:"number number-positif"},Xo=["title"],Zo={class:"number number-positif"},Ko={key:1,style:{width:"20%"}},el={class:"input-group col-1"},tl=["id","data-domaine-fonctionnel-id","data-formule-res-service-id","data-formule-res-service-ref-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],sl=e("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1),nl={key:2},il=["id"],rl={value:""},al=["label"],ol=["data-paie-etat","data-ressources-propres","selected","value"],ll=["innerHTML"],dl=["innerHTML"],ul={style:{"font-size":"12px"}},cl={key:0},hl=["id","onClick"],ml={key:1},_l=["id","onClick"],fl={class:"table-light"},pl=e("th",{scope:"row"},"Total heures à payer",-1),bl={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},vl=e("span",null,"Référentiel",-1),gl={class:"container"},yl={class:"row"},xl={class:"col-12"},Cl={class:"table mt-3 table-bordered"},kl={colspan:"2"},Pl={class:"table table-sm"},El=e("thead",null,[e("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de cout"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel"),e("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"Etat"),e("th",{style:{width:"15%","font-size":"12px"}})],-1),Dl={class:"detailHeure"},Sl={key:0,style:{width:"20%"}},Vl=["title"],Tl={class:"number number-positif"},Ml=["title"],Il={class:"number number-positif"},Rl={key:1,style:{width:"20%"}},wl={class:"input-group col-1"},$l=["id","data-domaine-fonctionnel-id","data-formule-res-service-id","data-formule-res-service-ref-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],Al=e("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1),jl={key:2},Ul=["id"],Ll={value:""},Hl=["label"],ql=["data-paie-etat","data-ressources-propres","selected","value"],Fl=["innerHTML"],zl={key:4},Ol=["id"],Nl=e("option",{value:""},"Aucun domaine fonctionnel",-1),Bl=["selected","value"],Gl={key:5},Yl=["innerHTML"],Jl={style:{"font-size":"12px"}},Wl={key:0},Ql=["id","onClick"],Xl={key:1},Zl=["id","onClick"],Kl={class:"table-light"},ed=e("th",{scope:"row"},"Total",-1),td={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},sd=e("span",null,"Mission",-1),nd={class:"container"},id={class:"row"},rd={class:"col-12"},ad={class:"table mt-3 table-bordered"},od={colspan:"2"},ld={class:"table table-sm"},dd=e("thead",null,[e("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de cout"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel"),e("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"Etat"),e("th",{style:{width:"15%","font-size":"12px"}})],-1),ud={class:"detailHeure"},cd={key:0,style:{width:"20%"}},hd=["title"],md={class:"number number-positif"},_d=["title"],fd={class:"number number-positif"},pd={key:1,style:{width:"20%"}},bd={class:"input-group col-1"},vd=["id","data-domaine-fonctionnel-id","data-formule-res-service-id","data-formule-res-service-ref-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],gd=e("span",{class:"input-group-text",style:{"font-size":"12px"}},"heure(s)",-1),yd={key:2},xd=["id","onChange"],Cd={value:""},kd=["label"],Pd=["data-paie-etat","data-ressources-propres","selected","value"],Ed=["innerHTML"],Dd={key:4},Sd=["id","onChange"],Vd=e("option",{value:""},"Aucun domaine fonctionnel",-1),Td=["selected","value"],Md={key:5},Id=["innerHTML"],Rd={style:{"font-size":"12px"}},wd={key:0},$d=["id","onClick"],Ad={key:1},jd=["id","onClick"],Ud={class:"table-light"},Ld=e("th",{scope:"row"},"Total",-1),Hd={style:{"background-color":"#fbfbfb",padding:"10px","padding-right":"40px","text-align":"right"}},qd=["id"];function Fd(t,n,s,_,l,i){const o=j;return r(),a("div",{id:"demande-mise-en-paiement-"+s.datas.code,class:"accordion-item"},[e("h2",{id:"dmep-heading-"+s.datas.code,class:"accordion-header"},[e("button",{"aria-controls":"dmep-collapse-"+s.datas.code,"data-bs-target":"#dmep-collapse-"+s.datas.code,"aria-expanded":"true",class:"accordion-button bg-light","data-bs-toggle":"collapse",type:"button"},c(s.datas.code+" - "+s.datas.libelle),9,bo)],8,po),e("div",{id:"dmep-collapse-"+s.datas.code,"aria-labelledby":"dmep-heading-"+s.datas.code,class:"accordion-collapse collapse show"},[e("div",go,[this.dotationPaieEtat+l.dotationRessourcesPropres>0?(r(),a("div",yo,[xo,e("div",Co,[e("table",ko,[Po,e("tbody",null,[e("tr",null,[e("td",Eo,[this.dotationPaieEtat>0?(r(),a("div",Do,[e("span",So,c(this.consommationPaieEtat+" sur "+this.dotationPaieEtat)+" HETD",1),e("div",{"aria-valuemax":this.dotationPaieEtat,"aria-valuenow":this.consommationPaieEtat,class:V("progress-bar progress-bar-striped "+this.bgPaieEtat),style:G("width:"+this.pourcentagePaieEtat+"%;"),title:this.pourcentagePaieEtat+"%","aria-valuemin":"0",role:"progressbar"},null,14,Vo)])):h("",!0),this.dotationPaieEtat==0?(r(),a("div",To," Aucune dotation paie état ")):h("",!0)]),e("td",Mo,[this.dotationRessourcesPropres>0?(r(),a("div",Io,[e("span",Ro,c(this.consommationRessourcesPropres+" sur "+this.dotationRessourcesPropres)+" HETD",1),e("div",{"aria-valuemax":this.dotationRessourcesPropres,"aria-valuenow":this.consommationRessourcesPropres,class:V("progress-bar progress-bar-striped "+this.bgRessourcesPropres),style:G("width:"+this.pourcentageRessourcePropre+"%;"),title:this.pourcentageRessourcePropre+"%","aria-valuemin":"0",role:"progressbar"},null,14,wo)])):h("",!0),this.dotationRessourcesPropres==0?(r(),a("div",$o," Aucune dotation ressources propres ")):h("",!0)])])])])])])):h("",!0),(r(!0),a(b,null,g(s.datas.etapes,(d,u)=>(r(),a("div",null,[(r(!0),a(b,null,g(d.enseignements,(f,y)=>(r(),a("div",null,[e("div",Ao,[jo,e("span",{innerHTML:i.shorten(d.libelle,50)},null,8,Uo),e("span",null,c(f.libelle),1)]),e("div",Lo,[e("div",Ho,[(r(!0),a(b,null,g(f.typeHeure,(v,P)=>(r(),a("div",qo,[e("table",Fo,[e("thead",zo,[e("tr",null,[e("th",Oo,c(v.libelle),1)])]),e("tbody",null,[e("tr",null,[e("td",No,[e("table",Bo,[Go,e("tbody",null,[(r(!0),a(b,null,g(v.heures,(x,H)=>(r(),a("tr",Yo,[x.heuresDemandees!=0?(r(),a("td",Jo,[x.datePaiement?(r(),a("abbr",{key:0,title:"Payé en "+x.periodeLibelle+" le "+i.formatDate(x.datePaiement)},[e("span",Qo,c(Number(x.heuresPayees))+" hetd(s)",1)],8,Wo)):h("",!0),x.datePaiement?h("",!0):(r(),a("abbr",{key:1,title:"Demandé le "+i.formatDate(x.dateDemande)},[e("span",Zo,c(Number(x.heuresDemandees))+" hetd(s)",1)],8,Xo))])):h("",!0),x.heuresDemandees==0?(r(),a("td",Ko,[e("div",el,[e("input",{id:"heures-"+u+"-"+y+"-"+P,"data-domaine-fonctionnel-id":x.domaineFonctionnelId,"data-formule-res-service-id":x.formuleResServiceId,"data-formule-res-service-ref-id":x.formuleResServiceRefId,"data-mission-id":x.missionId,"data-service-id":x.serviceId,"data-service-referentiel-id":x.serviceReferentielId,"data-type-heures-id":x.typeHeureId,max:x.heuresAPayer,value:x.heuresAPayer,class:"form-control form-control-sm",min:"0",type:"number"},null,8,tl),sl])])):h("",!0),x.heuresDemandees==0?(r(),a("td",nl,[e("select",{id:"centreCout-"+u+"-"+y+"-"+P,class:"selectpicker","data-live-search":"true",name:"centreCout"},[e("option",rl,c(i.notValueCentreCoutValue(s.datas.centreCoutPaiement,x.typeHeureCode)),1),(r(!0),a(b,null,g(i.filtrerCentresCouts(s.datas.centreCoutPaiement,x.typeHeureCode),I=>(r(),a("optgroup",{key:I.group,label:I.group},[(r(!0),a(b,null,g(I.child,S=>(r(),a("option",{key:S.value,"data-paie-etat":S.paieEtat,"data-ressources-propres":S.ressourcesPropres,selected:S.centreCoutId==x.centreCout.centreCoutId,value:S.centreCoutId},c(S.centreCoutCode+" - "+S.centreCoutLibelle),9,ol))),128))],8,al))),128))],8,il)])):h("",!0),x.heuresDemandees!=0?(r(),a("td",{key:3,innerHTML:i.shorten(x.centreCout.code+" - "+x.centreCout.libelle,30)},null,8,ll)):h("",!0),e("td",{innerHTML:i.heuresStatutToString(x)},null,8,dl),e("td",ul,[x.heuresPayees==0&&x.heuresDemandees>0?(r(),a("span",cl,[e("button",{id:"remove-"+x.mepId,class:"btn btn-danger",type:"button",onClick:I=>this.supprimerDemandeMiseEnPaiement(x.mepId)},[p(o,{id:"action",name:"trash",style:{color:"white"}}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,hl)])):h("",!0),x.heuresDemandees==0?(r(),a("span",ml,[e("button",{id:"add-"+u+"-"+y+"-"+P,class:"btn btn-primary",type:"button",onClick:I=>this.ajouterDemandeMiseEnPaiement(u+"-"+y+"-"+P)},[p(o,{id:"action",name:"plus"}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,_l)])):h("",!0)])]))),256))])])])])]),e("tfoot",null,[e("tr",fl,[pl,e("td",null,c(i.totalHeure(v.heures))+" hetd(s)",1)])])])]))),256))])])]))),256))]))),256)),(r(!0),a(b,null,g(s.datas.fonctionsReferentiels,(d,u)=>(r(),a("div",null,[e("div",bl,[vl,e("span",null,c(d.libelle),1)]),e("div",gl,[e("div",yl,[e("div",xl,[e("table",Cl,[e("tbody",null,[e("tr",null,[e("td",kl,[e("table",Pl,[El,e("tbody",null,[(r(!0),a(b,null,g(d.heures,(f,y)=>(r(),a("tr",Dl,[f.heuresDemandees!=0?(r(),a("td",Sl,[f.datePaiement?(r(),a("abbr",{key:0,title:"Payé en "+f.periodeLibelle+" le "+i.formatDate(f.datePaiement)},[e("span",Tl,c(Number(f.heuresPayees))+" hetd(s)",1)],8,Vl)):h("",!0),f.datePaiement?h("",!0):(r(),a("abbr",{key:1,title:"Demandé le "+i.formatDate(f.dateDemande)},[e("span",Il,c(Number(f.heuresDemandees))+" hetd(s)",1)],8,Ml))])):h("",!0),f.heuresDemandees==0?(r(),a("td",Rl,[e("div",wl,[e("input",{id:"heures-"+u,"data-domaine-fonctionnel-id":f.domaineFonctionnelId,"data-formule-res-service-id":f.formuleResServiceId,"data-formule-res-service-ref-id":f.formuleResServiceRefId,"data-mission-id":f.missionId,"data-service-id":f.serviceId,"data-service-referentiel-id":f.serviceReferentielId,"data-type-heures-id":f.typeHeureId,max:f.heuresAPayer,value:f.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,$l),Al])])):h("",!0),f.heuresDemandees==0?(r(),a("td",jl,[e("select",{id:"centreCout-"+u,class:"selectpicker","data-live-search":"true",name:"centreCout"},[e("option",Ll,c(i.notValueCentreCoutValue(s.datas.centreCoutPaiement,f.typeHeureCode)),1),(r(!0),a(b,null,g(i.filtrerCentresCouts(s.datas.centreCoutPaiement,"referentiel"),v=>(r(),a("optgroup",{key:v.group,label:v.group},[(r(!0),a(b,null,g(v.child,P=>(r(),a("option",{key:P.value,"data-paie-etat":P.paieEtat,"data-ressources-propres":P.ressourcesPropres,selected:P.centreCoutId==f.centreCout.centreCoutId,value:P.centreCoutId},c(P.centreCoutCode+" - "+P.centreCoutLibelle),9,ql))),128))],8,Hl))),128))],8,Ul)])):h("",!0),f.heuresDemandees!=0?(r(),a("td",{key:3,innerHTML:i.shorten(f.centreCout.code+" - "+f.centreCout.libelle,20)},null,8,Fl)):h("",!0),f.heuresDemandees==0?(r(),a("td",zl,[e("select",{id:"domaineFonctionnel-"+u,class:"selectpicker","data-live-search":"true",name:"centreCout"},[Nl,(r(!0),a(b,null,g(s.datas.domaineFonctionnelPaiement,v=>(r(),a("option",{selected:v.domaineFonctionnelId==f.domaineFonctionnel.domaineFonctionnelId,value:v.domaineFonctionnelId},c(v.domaineFonctionnelLibelle),9,Bl))),256))],8,Ol)])):h("",!0),f.heuresDemandees!=0?(r(),a("td",Gl,c(f.domaineFonctionnel.libelle),1)):h("",!0),e("td",{innerHTML:i.heuresStatutToString(f)},null,8,Yl),e("td",Jl,[f.heuresPayees==0&&f.heuresDemandees>0?(r(),a("span",Wl,[e("button",{id:"remove-"+f.mepId,class:"btn btn-danger",type:"button",onClick:v=>this.supprimerDemandeMiseEnPaiement(f.mepId)},[p(o,{id:"action",name:"trash",style:{color:"white"}}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,Ql)])):h("",!0),f.heuresDemandees==0?(r(),a("span",Xl,[e("button",{id:"add-"+u,class:"btn btn-primary",type:"button",onClick:v=>this.ajouterDemandeMiseEnPaiement(u)},[p(o,{id:"action",name:"plus"}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,Zl)])):h("",!0)])]))),256))])])])])]),e("tfoot",null,[e("tr",Kl,[ed,e("td",null,c(i.totalHeure(d.heures))+" hetd(s)",1)])])])])])])]))),256)),(r(!0),a(b,null,g(s.datas.missions,d=>(r(),a("div",null,[e("div",td,[sd,e("span",null,c(d.libelle),1)]),e("div",nd,[e("div",id,[e("div",rd,[e("table",ad,[e("tbody",null,[e("tr",null,[e("td",od,[e("table",ld,[dd,e("tbody",null,[(r(!0),a(b,null,g(d.heures,(u,f)=>(r(),a("tr",ud,[u.heuresDemandees!=0?(r(),a("td",cd,[u.datePaiement?(r(),a("abbr",{key:0,title:"Payé en "+u.periodeLibelle+" le "+i.formatDate(u.datePaiement)},[e("span",md,c(Number(u.heuresPayees))+" heure(s)",1)],8,hd)):h("",!0),u.datePaiement?h("",!0):(r(),a("abbr",{key:1,title:"Demandé le "+i.formatDate(u.dateDemande)},[e("span",fd,c(Number(u.heuresDemandees))+" heure(s)",1)],8,_d))])):h("",!0),u.heuresDemandees==0?(r(),a("td",pd,[e("div",bd,[e("input",{id:"heures-"+d.missionId,"data-domaine-fonctionnel-id":u.domaineFonctionnelId,"data-formule-res-service-id":u.formuleResServiceId,"data-formule-res-service-ref-id":u.formuleResServiceRefId,"data-mission-id":u.missionId,"data-service-id":u.serviceId,"data-service-referentiel-id":u.serviceReferentielId,"data-type-heures-id":u.typeHeureId,max:u.heuresAPayer,value:u.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,vd),gd])])):h("",!0),u.heuresDemandees==0?(r(),a("td",yd,[e("select",{id:"centreCout-"+d.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:y=>i.enabledPaiement(d.missionId,"mission")},[e("option",Cd,c(i.notValueCentreCoutValue(s.datas.centreCoutPaiement,u.typeHeureCode)),1),(r(!0),a(b,null,g(i.filtrerCentresCouts(s.datas.centreCoutPaiement,"mission"),y=>(r(),a("optgroup",{key:y.group,label:y.group},[(r(!0),a(b,null,g(y.child,v=>(r(),a("option",{key:v.value,"data-paie-etat":v.paieEtat,"data-ressources-propres":v.ressourcesPropres,selected:v.centreCoutId==u.centreCout.centreCoutId,value:v.centreCoutId},c(v.centreCoutCode+" - "+v.centreCoutLibelle),9,Pd))),128))],8,kd))),128))],40,xd)])):h("",!0),u.heuresDemandees!=0?(r(),a("td",{key:3,innerHTML:i.shorten(u.centreCout.code+" - "+u.centreCout.libelle,20)},null,8,Ed)):h("",!0),u.heuresDemandees==0?(r(),a("td",Dd,[e("select",{id:"domaineFonctionnel-"+d.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:y=>i.enabledPaiement(d.missionId,"mission")},[Vd,(r(!0),a(b,null,g(s.datas.domaineFonctionnelPaiement,y=>(r(),a("option",{selected:y.domaineFonctionnelId==u.domaineFonctionnel.domaineFonctionnelId,value:y.domaineFonctionnelId},c(y.domaineFonctionnelLibelle),9,Td))),256))],40,Sd)])):h("",!0),u.heuresDemandees!=0?(r(),a("td",Md,c(u.domaineFonctionnel.libelle),1)):h("",!0),e("td",{innerHTML:i.heuresStatutToString(u)},null,8,Id),e("td",Rd,[u.heuresPayees==0&&u.heuresDemandees>0?(r(),a("span",wd,[e("button",{id:"remove-"+u.mepId,class:"btn btn-danger",type:"button",onClick:y=>this.supprimerDemandeMiseEnPaiement(u.mepId)},[p(o,{id:"action",name:"trash",style:{color:"white"}}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,$d)])):h("",!0),u.heuresDemandees==0?(r(),a("span",Ad,[e("button",{id:"add-"+d.missionId,class:"btn btn-primary",type:"button",onClick:y=>this.ajouterDemandeMiseEnPaiement(d.missionId)},[p(o,{id:"action",name:"plus"}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,jd)])):h("",!0)])]))),256))])])])])]),e("tfoot",null,[e("tr",Ud,[Ld,e("td",null,c(i.totalHeure(d.heures))+" heure(s)",1)])])])])])])]))),256))]),e("div",Hd,[e("button",{id:"add-all-"+s.datas.code,class:"btn btn-primary",type:"button",onClick:n[0]||(n[0]=d=>i.demanderToutesLesHeuresEnPaiement(s.datas.code,s.datas.libelle))},[p(o,{id:"action",name:"square-plus",style:{color:"white"}}),p(o,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}}),m(" DEMANDER TOUS LES PAIEMENTS POUR "+c(s.datas.libelleCourt),1)],8,qd)])],8,vo)],8,fo)}const se=k(_o,[["render",Fd]]),zd=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),Od={name:"DemandeMiseEnPaiement",components:{DemandeMiseEnPaiementStructure:se},props:{intervenant:{required:!1}},data(){return{datasDemandesMiseEnPaiement:null,urlGetDemandesMiseEnPaiement:unicaenVue.url("intervenant/:intervenant/mise-en-paiement/get-demandes-mise-en-paiement",{intervenant:this.intervenant})}},methods:{getDemandesMiseEnPaiement(){unicaenVue.axios.get(this.urlGetDemandesMiseEnPaiement).then(t=>{this.datasDemandesMiseEnPaiement=t.data}).catch(t=>{console.error(t)})}},mounted(){this.getDemandesMiseEnPaiement()},updated(){$(".selectpicker").selectpicker("render");var t=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));t.map(function(n){return new bootstrap.Tooltip(n)})}},Nd={key:0,class:"text-center"},Bd=e("div",{class:"mt-5 spinner-border spinner-border-sm",role:"status"},[e("span",{class:"visually-hidden"},"Chargement des demandes de mise en paiement en cours...")],-1),Gd={id:"accordionPanelsStayOpenExample",class:"accordion"};function Yd(t,n,s,_,l,i){const o=T("demande-mise-en-paiement-structure");return r(),a(b,null,[this.datasDemandesMiseEnPaiement?h("",!0):(r(),a("div",Nd,[Bd,m(" Chargement des demandes de mise en paiement en cours... ")])),e("div",Gd,[(r(!0),a(b,null,g(l.datasDemandesMiseEnPaiement,(d,u)=>(r(),E(o,{datas:d,intervenant:s.intervenant,onRefresh:i.getDemandesMiseEnPaiement},null,8,["datas","intervenant","onRefresh"]))),256))])],64)}const Jd=k(Od,[["render",Yd]]),Wd=Object.freeze(Object.defineProperty({__proto__:null,default:Jd},Symbol.toStringTag,{value:"Module"}));function Qd(t){for(let n in t)for(let s in t[n])ne(t[n][s],n)}function Xd(){let t=document.getElementById("unicaen-vue-toast-container");return t||(t=document.createElement("div"),t.id="unicaen-vue-toast-container",t.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(t)),t}function Zd(t){return t=Kd(t),t=eu(t),t}function Kd(t){const n=document.createElement("div");n.innerHTML=t;const s=n.querySelector(".alert");return s?s.innerHTML:n.innerHTML}function eu(t){const n=document.createElement("div");return n.innerHTML=t,n.querySelectorAll("i.fas").forEach(_=>_.style.display="none"),n.innerHTML}function ne(t,n,s=null){const _={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},l={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"},i=document.createElement("button");i.classList.add("btn-close","btn-close-white","h5"),i.style.float="right",i.setAttribute("data-bs-dismiss","toast"),i.setAttribute("aria-label","Close");const o=document.createElement("i");o.classList.add("icon","fas",`fa-${l[n]}`),o.style.float="left",o.style.fontSize="26pt",o.style.paddingLeft=".4rem",o.style.marginTop=".4rem",o.style.paddingRight="1rem";const d=document.createElement("div");d.classList.add("toast-body"),d.innerHTML=Zd(t);const u=document.createElement("div");u.appendChild(i),u.appendChild(o),u.appendChild(d);const f=document.createElement("div");f.classList.add("toast","text-white",_[n]?_[n]:"bg-secondary"),f.setAttribute("role","alert"),f.setAttribute("aria-live","assertive"),f.setAttribute("aria-atomic","true"),n==="error"&&t.length>500&&f.setAttribute("style","width:700px"),f.appendChild(u),Xd().appendChild(f),s==null&&(s={animation:!0,delay:n==="warning"?15e3:5e3,autohide:n!=="error"}),new bootstrap.Toast(f,s).show()}const Y={toast:ne,toasts:Qd};let O={...ce};O.interceptors.request.use(t=>{if(t.submitter){let n=t.msg?t.msg:"Action en cours";t.popover!=null&&t.popover.dispose(),t.popover=new bootstrap.Popover(t.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+n,html:!0,trigger:"focus"}),t.popover.show()}return t});O.interceptors.response.use(t=>{if(t.messages=t.data.messages,t.data=t.data.data,t.hasErrors=!!(t.messages&&t.messages.error&&t.messages.error.length>0),t.config.popover){var n=t.config.popover;let s="";for(ns in t.messages)for(mid in t.messages[ns])s+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+t.messages[ns][mid]+"</div>";s?(n._config.content=s,n.setContent(),setTimeout(()=>{n.dispose()},5e3)):n.dispose()}return t.messages&&Y.toasts(t.messages),t},t=>{let n=t.response.data;t.response.status==403?n="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.":n=t.response.data,Y.toast(n,"error")});O.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const tu={uvAxios:O},J={axios:tu.uvAxios,flashMessenger:Y,url:(t,n,s)=>{let _=window.__unicaenVueBaseUrl;if(n)for(let i in n)t=t.replace(`:${i}`,n[i]);let l=s?J.encodeUrlQueryParam(s):null;return _+t+(l?`?${l}`:"")},encodeUrlQueryParam:(t,n)=>{var s=[];for(var _ in t)if(t.hasOwnProperty(_)){var l=t[_],i=n?n+"["+encodeURIComponent(_)+"]":encodeURIComponent(_);if(typeof l=="object"&&l!==null)s.push(J.encodeUrlQueryParam(l,i));else{var o=encodeURIComponent(l);s.push(i+"="+o)}}return s.join("&")}};window.unicaenVue=J;const su={name:"DemandeMiseEnPaiementLot.vue",props:{structures:{type:Array,required:!0},canMiseEnPaiement:{type:Boolean,required:!0}},data(){return{selectedStructure:null,urlRechercheDemandeMiseEnPaiement:unicaenVue.url("paiement/demande-mise-en-paiement-lot"),urlProcessDemandeMiseEnPaiement:unicaenVue.url("paiement/process-demande-mise-en-paiement-lot"),urlMiseEnPaiement:unicaenVue.url("paiement/etat-demande-paiement"),permanents:[],vacataires:[],etudiants:[],autres:[],intervenants:[],dotation:!1,liquidation:null,totalConsommationPaieEtat:0,totalConsommationRessourcePropre:0,totalConsommation:0,alertDotation:!1}},computed:{haveDotation(){return this.dotation?this.dotation.total>0:!1},alertPaieEtat(){return this.dotation.paieEtat<this.totalConsommationPaieEtat?"text-danger fw-bold":""},alertRessourcePropre(){return this.dotation.ressourcePropre<this.totalConsommationRessourcePropre?"text-danger fw-bold":""}},methods:{findDemandeMiseEnPaiement(t){this.totalConsommationRessourcePropre=0,this.totalConsommationPaieEtat=0,this.dotation=null,this.liquidation=null;let n=document.getElementById("formRechercheDemandeMiseEnPaiement"),s=new FormData(n),_=document.getElementById("btn-rdmep"),l=document.getElementById("btn-rdmep-inprogress");l.classList.remove("d-none"),_.classList.add("d-none"),_.disabled=!0,unicaenVue.axios.post(this.urlRechercheDemandeMiseEnPaiement,s,{}).then(i=>{this.dispatchDatas(i.data),_.disabled=!1,l.classList.add("d-none"),_.classList.remove("d-none"),document.querySelectorAll('input[type="checkbox"]').forEach(function(d,u){d.checked=!0}),unicaenVue.axios.get(unicaenVue.url("budget/get-budget-structure/:structure",{structure:this.selectedStructure})).then(d=>{let u=d.data;this.dotation=u.dotation,this.liquidation=u.liquidation,this.refreshTotalConsommation()})}).catch(i=>{console.error(i)})},processDemandeMiseEnPaiement(t){let n=document.getElementById("formProcessDemandeMiseEnPaiement"),s=new FormData(n);if(this.dotation.paieEtat>=this.totalConsommationPaieEtat&&this.dotation.ressourcePropre>=this.totalConsommationRessourcePropre||!this.haveDotation){let _=document.getElementById("btn-pdmep"),l=document.getElementById("btn-pdmep-inprogress");l.classList.remove("d-none"),_.classList.add("d-none"),_.disabled=!0,unicaenVue.axios.post(this.urlProcessDemandeMiseEnPaiement,s,{}).then(i=>{this.findDemandeMiseEnPaiement(),_.disabled=!1,l.classList.add("d-none"),_.classList.remove("d-none")}).catch(i=>{console.error("Error process dmep")})}},refreshTotalConsommation(){let t=0,n=0,s=0;t=parseFloat(this.liquidation.paieEtat),n=parseFloat(this.liquidation.ressourcePropre),s+=parseFloat(this.liquidation.ressourcePropre),s+=parseFloat(this.liquidation.paieEtat),document.querySelectorAll('input[type="checkbox"]').forEach(function(l,i){l.hasAttribute("data-paie-etat")&&l.checked&&(t+=parseFloat(l.getAttribute("data-paie-etat")),s+=parseFloat(l.getAttribute("data-paie-etat"))),l.hasAttribute("data-ressource-propre")&&l.checked&&(n+=parseFloat(l.getAttribute("data-ressource-propre")),s+=parseFloat(l.getAttribute("data-ressource-propre")))}),this.totalConsommationPaieEtat=t.toFixed(2),this.totalConsommationRessourcePropre=n.toFixed(2),this.totalConsommation=s.toFixed(2),this.alertDotation=(this.dotation.paieEtat<this.totalConsommationPaieEtat||this.dotation.ressourcePropre<this.totalConsommationRessourcePropre)&&this.dotation.total>0},totalPayable(t){let n=0;return t.forEach((s,_)=>{s.centreCout.code!=""&&(s.missionId!=""||s.serviceRefId!=""?s.domaineFonctionnel.code!=""&&(n+=s.heuresAPayer):n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalNonPayable(t){let n=0;return t.forEach((s,_)=>{(s.centreCout.code==""||(s.missionId!=""||s.serviceRefId!="")&&s.domaineFonctionnel.code=="")&&(n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePaieEtat(t){let n=0;return t.forEach((s,_)=>{s.centreCout.typeRessourceCode=="paie-etat"&&(n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePropre(t){let n=0;return t.forEach((s,_)=>{s.centreCout.typeRessourceCode=="ressources-propres"&&(n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},dispatchDatas(t){this.vacataires=[],this.permanents=[],this.etudiants=[],this.autres=[],this.intervenants=[],console.log(t);for(const[n,s]of Object.entries(t))switch(s.datasIntervenant.typeIntervenant){case"Vacataire":this.vacataires.push(s),this.intervenants.push(s);break;case"Intervenant permanent":this.permanents.push(s),this.intervenants.push(s);break;case"Étudiant":this.etudiants.push(s),this.intervenants.push(s);break;default:this.autres.push(s),this.intervenants.push(s)}},toggleCheckbox(t){let n=Array.from(document.getElementsByClassName(t.target.className));t.target.checked?n.forEach(function(s,_){s.checked=!0}):n.forEach(function(s,_){s.checked=!1}),this.refreshTotalConsommation()},urlIntervenant(t){return unicaenVue.url("intervenant/code::intervenantCode/mise-en-paiement/demande",{intervenantCode:t.datasIntervenant.code})},formattedHETD(t){return Util.formattedHeures(t,!1)}}},nu=e("h1",null,"Demande de mise en paiement par lots",-1),iu={class:"card text-dark bg-light"},ru=e("div",{class:"card-header text-uppercase fw-bold"}," Recherchez des heures en attente de demande de mise en paiement : ",-1),au={class:"card-body"},ou={id:"formRechercheDemandeMiseEnPaiement",action:"",method:"post"},lu={class:"mb-3"},du=e("label",{class:"form-label",for:"modele"},"Choisissez une structure ",-1),uu=["value"],cu={class:"mb-3"},hu=e("button",{id:"btn-rdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),m("  Veuillez patienter... ")],-1),mu=["disabled"],_u=e("div",{class:"alert alert-info",role:"alert"},[m(" Seules les HETD "),e("strong",null,"(hors référentiel)"),m(" avec des centres de coûts pré-paramètrés peuvent bénéficier d'une demande de mise en paiement automatisées. Pour les autres, il faudra passer sur chaque fiches intervenant pour faire les demandes en sélectionnant le centre de coût manuellement. ")],-1),fu={key:0},pu={key:0,class:"alert alert-danger",role:"alert"},bu={class:"table table-bordered caption-top"},vu=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"fw-bold",scope:"col"},"Budget"),e("th",{class:"fw-bold",scope:"col"},"Paie etat"),e("th",{class:"fw-bold",scope:"col"},"Ressource propre"),e("th",{class:"fw-bold",scope:"col"},"Total")])],-1),gu=e("td",null,"Dotation",-1),yu={class:"fw-bold"},xu=e("td",null,"Consommation",-1),Cu={class:"fw-bold"},ku={id:"dmep",class:"accordion"},Pu={id:"formProcessDemandeMiseEnPaiement",action:"",method:"post"},Eu={key:0,class:"accordion-item"},Du={id:"dmep-permanents-heading",class:"accordion-header"},Su={"aria-controls":"dmep-permanents-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-permanents-collapse","data-bs-toggle":"collapse",type:"button"},Vu={id:"dmep-permanents-collapse","aria-labelledby":"dmep-permanents-heading",class:"accordion-collapse collapse show"},Tu={class:"accordion-body"},Mu={class:"table"},Iu={scope:"col"},Ru=e("th",{scope:"col"},"Intervenant",-1),wu=e("th",null,"HETD payables",-1),$u=e("th",null,"HETD non payables",-1),Au=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],ju=["href"],Uu=["title"],Lu={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Hu={key:1,class:"accordion-item"},qu={id:"dmep-vacataires-heading",class:"accordion-header"},Fu={"aria-controls":"dmep-vacataires-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-vacataires-collapse","data-bs-toggle":"collapse",type:"button"},zu={id:"dmep-vacataires-collapse","aria-labelledby":"dmep-vacataires-heading",class:"accordion-collapse collapse show"},Ou={class:"accordion-body"},Nu={class:"table"},Bu=e("th",null,"Intervenant",-1),Gu=e("th",null,"HETD payables",-1),Yu=e("th",null,"HETD non payables",-1),Ju=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],Wu=["href"],Qu=["title"],Xu={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Zu={key:2,class:"accordion-item"},Ku={id:"dmep-etudiants-heading",class:"accordion-header"},ec={"aria-controls":"dmep-etudiants-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-etudiants-collapse","data-bs-toggle":"collapse",type:"button"},tc={id:"dmep-etudiants-collapse","aria-labelledby":"dmep-etudiants-heading",class:"accordion-collapse collapse show"},sc={class:"accordion-body"},nc={class:"table"},ic=e("th",null,"Intervenant",-1),rc=e("th",null,"HETD payables",-1),ac=e("th",null,"HETD non payables",-1),oc=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],lc=["href"],dc=["title"],uc={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},cc={key:3,class:"accordion-item"},hc={id:"dmep-autres-heading",class:"accordion-header"},mc={"aria-controls":"dmep-autres-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-autres-collapse","data-bs-toggle":"collapse",type:"button"},_c={id:"dmep-autres-collapse","aria-labelledby":"dmep-autres-heading",class:"accordion-collapse collapse show"},fc={class:"accordion-body"},pc={class:"table"},bc=e("th",null,"Intervenant",-1),vc=e("th",null,"HETD payables",-1),gc=e("th",null,"HETD non payables",-1),yc=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],xc=["href"],Cc=["title"],kc={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Pc={key:4,class:"mt-3"},Ec=e("button",{id:"btn-pdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),m("  Veuillez patienter... ")],-1),Dc=["disabled"],Sc=["href"];function Vc(t,n,s,_,l,i){return r(),a(b,null,[nu,e("div",iu,[ru,e("div",au,[e("form",ou,[e("div",lu,[du,m("  "),w(e("select",{"onUpdate:modelValue":n[0]||(n[0]=o=>l.selectedStructure=o),class:"form-select",name:"structure"},[(r(!0),a(b,null,g(s.structures,o=>(r(),a("option",{value:o.id},c(o.libelle),9,uu))),256))],512),[[z,l.selectedStructure]])]),e("div",cu,[hu,e("button",{id:"btn-rdmep",disabled:!l.selectedStructure,class:"btn btn-primary",type:"button",onClick:n[1]||(n[1]=(...o)=>i.findDemandeMiseEnPaiement&&i.findDemandeMiseEnPaiement(...o))}," Lancer la recherche ",8,mu)])])])]),_u,i.haveDotation?(r(),a("div",fu,[l.alertDotation?(r(),a("div",pu," Attention vous dépassez vos dotations, vous ne pourrez pas lancer les demandes de mise en paiement par lot. Veuillez ajuster votre sélection d'intervenants pour faire les demandes de mise en paiement. ")):h("",!0),e("table",bu,[vu,e("tbody",null,[e("tr",null,[gu,e("td",null,c(i.formattedHETD(this.dotation.paieEtat))+" HETD",1),e("td",null,c(i.formattedHETD(this.dotation.ressourcePropre))+" HETD",1),e("td",yu,c(i.formattedHETD(this.dotation.total))+" HETD",1)]),e("tr",null,[xu,e("td",null,[e("span",{class:V(i.alertPaieEtat)},c(i.formattedHETD(this.totalConsommationPaieEtat))+" HETD",3)]),e("td",null,[e("span",{class:V(i.alertRessourcePropre)},c(i.formattedHETD(this.totalConsommationRessourcePropre))+" HETD",3)]),e("td",Cu,c(i.formattedHETD(this.totalConsommation))+" HETD",1)])])])])):h("",!0),e("div",ku,[e("form",Pu,[this.permanents.length>0?(r(),a("div",Eu,[e("h2",Du,[e("button",Su,c(this.permanents.length)+" Permanent(s) ",1)]),e("div",Vu,[e("div",Tu,[e("table",Mu,[e("thead",null,[e("tr",null,[e("th",Iu,[e("input",{id:"allPermanents",checked:"checked",class:"checkbox-permanent",name:"allPermanents",type:"checkbox",onClick:n[2]||(n[2]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),Ru,wu,$u])]),e("tbody",null,[(r(!0),a(b,null,g(this.permanents,o=>(r(),a("tr",null,[e("td",null,[e("input",{id:"permanent-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-permanent",type:"checkbox",onChange:n[3]||(n[3]=d=>i.refreshTotalConsommation())},null,40,Au)]),e("td",null,[e("a",{href:i.urlIntervenant(o),target:"_blank"},c(o.datasIntervenant.nom_usuel.toUpperCase()+" "+o.datasIntervenant.prenom),9,ju)]),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},c(i.totalPayable(o.heures))+" h",9,Uu)]),e("td",null,[e("span",Lu,c(i.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.vacataires.length>0?(r(),a("div",Hu,[e("h2",qu,[e("button",Fu,c(this.vacataires.length)+" Vacataire(s) ",1)]),e("div",zu,[e("div",Ou,[e("table",Nu,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allVacataire",checked:"checked",class:"checkbox-vacataire",name:"allVacataire",type:"checkbox",onClick:n[4]||(n[4]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),Bu,Gu,Yu])]),e("tbody",null,[(r(!0),a(b,null,g(this.vacataires,o=>(r(),a("tr",null,[e("td",null,[e("input",{id:"vacataire-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-vacataire",type:"checkbox",onChange:n[5]||(n[5]=d=>i.refreshTotalConsommation())},null,40,Ju)]),e("td",null,[e("a",{href:i.urlIntervenant(o),target:"_blank"},c(o.datasIntervenant.nom_usuel.toUpperCase()+" "+o.datasIntervenant.prenom),9,Wu)]),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},c(i.totalPayable(o.heures))+" h",9,Qu)]),e("td",null,[e("span",Xu,c(i.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.etudiants.length>0?(r(),a("div",Zu,[e("h2",Ku,[e("button",ec,c(this.etudiants.length)+" Etudiant(s) ",1)]),e("div",tc,[e("div",sc,[e("table",nc,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allEtudiants",checked:"checked",class:"checkbox-etudiant",name:"allEtudiants",type:"checkbox",onClick:n[6]||(n[6]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),ic,rc,ac])]),e("tbody",null,[(r(!0),a(b,null,g(this.etudiants,o=>(r(),a("tr",null,[e("td",null,[e("input",{id:"etudiant-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-etudiant",type:"checkbox",onChange:n[7]||(n[7]=d=>i.refreshTotalConsommation())},null,40,oc)]),e("td",null,[e("a",{href:i.urlIntervenant(o),target:"_blank"},c(o.datasIntervenant.nom_usuel.toUpperCase()+" "+o.datasIntervenant.prenom),9,lc)]),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},c(i.totalPayable(o.heures))+" h",9,dc)]),e("td",null,[e("span",uc,c(i.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.autres.length>0?(r(),a("div",cc,[e("h2",hc,[e("button",mc,c(this.autres.length)+" Autre(s) ",1)]),e("div",_c,[e("div",fc,[e("table",pc,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allAutres",checked:"checked",class:"checkbox-autre",name:"allAutres",type:"checkbox",onClick:n[8]||(n[8]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o))})]),bc,vc,gc])]),e("tbody",null,[(r(!0),a(b,null,g(this.etudiants,o=>(r(),a("tr",null,[e("td",null,[e("input",{id:"autre-"+o.datasIntervenant.id,"data-paie-etat":i.totalRessourcePaieEtat(o.heures),"data-ressource-propre":i.totalRessourcePropre(o.heures),disabled:i.totalPayable(o.heures)==0,name:"intervenant["+o.datasIntervenant.id+"]",title:i.totalPayable(o.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-autre",type:"checkbox",onChange:n[9]||(n[9]=d=>i.refreshTotalConsommation())},null,40,yc)]),e("td",null,[e("a",{href:i.urlIntervenant(o),target:"_blank"},c(o.datasIntervenant.nom_usuel.toUpperCase()+" "+o.datasIntervenant.prenom),9,xc)]),e("td",null,[e("span",{title:i.totalRessourcePaieEtat(o.heures)+" HETD en paie état / "+i.totalRessourcePropre(o.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},c(i.totalPayable(o.heures))+" h",9,Cc)]),e("td",null,[e("span",kc,c(i.totalNonPayable(o.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.intervenants.length>0?(r(),a("div",Pc,[Ec,e("button",{id:"btn-pdmep",disabled:this.alertDotation,class:"btn btn-primary",type:"button",onClick:n[10]||(n[10]=(...o)=>i.processDemandeMiseEnPaiement&&i.processDemandeMiseEnPaiement(...o))}," Enregistrer les demandes de paiement ",8,Dc),this.canMiseEnPaiement?(r(),a("a",{key:0,id:"btn-mep",href:this.urlMiseEnPaiement,class:"ms-2 btn btn-secondary"}," Aller au mise en paiement ",8,Sc)):h("",!0)])):h("",!0)])])],64)}const Tc=k(su,[["render",Vc]]),Mc=Object.freeze(Object.defineProperty({__proto__:null,default:Tc},Symbol.toStringTag,{value:"Module"})),Ic={components:{},props:{parametres:{type:Array,required:!0},servicesAPayer:{type:Array,required:!0}}},D=t=>(W("data-v-d4a24889"),t=t(),Q(),t),Rc=D(()=>e("h2",null,"Paramètres généraux ou bien selon le statut",-1)),wc={class:"table table-bordered table-condensed table-extra-condensed"},$c=D(()=>e("tr",null,[e("th",null,"Paramètre général"),e("th",null,"Valeur")],-1)),Ac=D(()=>e("h2",null,"Services à payer",-1)),jc={class:"card"},Uc={class:"card-header"},Lc={class:"badge bg-primary"},Hc={class:"card-body"},qc={class:"row lap"},Fc={class:"col-md-6"},zc=D(()=>e("h6",null,"Heures à payer",-1)),Oc={class:"table table-bordered table-xs"},Nc={key:0,rowspan:"2"},Bc={key:1,rowspan:"2"},Gc=D(()=>e("th",{colspan:"2"},"Taux de rému.",-1)),Yc=D(()=>e("th",{colspan:"3"},"Heures",-1)),Jc=D(()=>e("tr",null,[e("th",null,"Nom"),e("th",null,"Valeur"),e("th",null,"Total"),e("th",null,"AA"),e("th",null,"AC")],-1)),Wc={key:0},Qc=["title"],Xc={key:1},Zc=["title"],Kc={class:"col-md-6"},eh=D(()=>e("h6",null,[e("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),m(" correspondantes")],-1)),th={class:"table table-bordered table-xs"},sh=D(()=>e("thead",null,[e("tr",null,[e("th",{rowspan:"2"},"Id"),e("th",{rowspan:"2"},"Centre de coûts"),e("th",{colspan:"2"},"Période"),e("th",{colspan:"3"},"Heures")]),e("tr",null,[e("th",null,"Mois"),e("th",null,"Date"),e("th",null,"Total"),e("th",null,"AA"),e("th",null,"AC")])],-1)),nh=["title"],ih=["title"],rh={key:0},ah={class:"badge bg-info"},oh={key:0,class:"row"},lh=D(()=>e("div",{class:"col-md-6"},null,-1)),dh={class:"col-md-6"},uh=D(()=>e("h6",null,[e("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),m(" en trop")],-1)),ch={class:"table table-bordered table-xs"},hh=D(()=>e("thead",{class:"bg-danger"},[e("tr",null,[e("th",{rowspan:"2"},"Id"),e("th",{rowspan:"2"},"Centre de coûts"),e("th",{colspan:"2"},"Période"),e("th",{rowspan:"2"},"Heures")]),e("tr",null,[e("th",null,"Mois"),e("th",null,"Date")])],-1)),mh=["title"],_h=["title"];function fh(t,n,s,_,l,i){return r(),a(b,null,[Rc,e("table",wc,[$c,(r(!0),a(b,null,g(s.parametres,(o,d)=>(r(),a("tr",{key:d},[e("th",null,c(d),1),e("td",null,c(o),1)]))),128))]),Ac,(r(!0),a(b,null,g(s.servicesAPayer,(o,d)=>(r(),a("div",{key:d},[e("div",jc,[e("div",Uc,[e("span",Lc,c(o.type),1),m(" "+c(o.libelle),1)]),e("div",Hc,[e("ul",null,[(r(!0),a(b,null,g(o.parametres,(u,f)=>(r(),a("li",{key:f},c(f)+" : "+c(u),1))),128))]),(r(!0),a(b,null,g(o.laps,u=>(r(),a("div",qc,[e("div",Fc,[zc,e("table",Oc,[e("thead",null,[e("tr",null,[o.type!="Référentiel"?(r(),a("th",Nc,"Volume horaire")):(r(),a("th",Bc,"Volumes horaires")),Gc,Yc]),Jc]),e("tbody",null,[e("tr",null,[o.type!="Référentiel"?(r(),a("td",Wc,[e("abbr",{class:"badge bg-secondary",title:u.volumeHoraireHisto},c(u.volumeHoraireId),9,Qc),m(" "+c(u.volumeHoraire),1)])):(r(),a("td",Xc,[(r(!0),a(b,null,g(u.volumeHoraireId,f=>(r(),a("div",null,[e("abbr",{class:"badge bg-secondary",title:f.HISTO},c(f.ID),9,Zc),m(" "+c(f.HEURES)+"h ",1)]))),256))])),e("td",null,c(u.tauxRemu),1),e("td",null,c(u.tauxValeur)+"€",1),e("td",null,c(u.heures),1),e("td",null,c(u.heuresAA),1),e("td",null,c(u.heuresAC),1)])])])]),e("div",Kc,[eh,e("table",th,[sh,e("tbody",null,[(r(!0),a(b,null,g(u.misesEnPaiement,f=>(r(),a("tr",{key:f.id},[e("td",null,[e("abbr",{class:"badge bg-secondary",title:"Nombre d'heures total concernées : "+f.heuresTotal+`
Domaine fonctionnel : `+f.domaineFonctionnel+`
`+f.historique},c(f.id),9,nh)]),e("td",null,[e("abbr",{title:f.centreCoutLibelle},c(f.centreCoutCode),9,ih)]),e("td",null,c(f.periodePaiement),1),e("td",null,c(f.date),1),e("td",null,c(f.heures),1),e("td",null,c(f.heuresAA),1),e("td",null,c(f.heuresAC),1)]))),128))])]),u.heuresRestantes!="0,00"?(r(),a("div",rh,[e("span",ah,c(u.heuresRestantes)+"h n'ont pas été demandées en paiement",1)])):h("",!0)])]))),256)),o.misesEnPaiement&&o.misesEnPaiement.length>0?(r(),a("div",oh,[lh,e("div",dh,[uh,e("table",ch,[hh,e("tbody",null,[(r(!0),a(b,null,g(o.misesEnPaiement,u=>(r(),a("tr",{key:u.id},[e("td",null,[e("abbr",{class:"badge bg-danger",title:"Domaine fonctionnel : "+u.domaineFonctionnel+`
`+u.historique},c(u.id),9,mh)]),e("td",null,[e("abbr",{title:u.centreCoutLibelle},c(u.centreCoutCode),9,_h)]),e("td",null,c(u.periodePaiement),1),e("td",null,c(u.date),1),e("td",null,c(u.heures),1)]))),128))])])])])):h("",!0)])])]))),128))],64)}const ph=k(Ic,[["render",fh],["__scopeId","data-v-d4a24889"]]),bh=Object.freeze(Object.defineProperty({__proto__:null,default:ph},Symbol.toStringTag,{value:"Module"})),vh={props:{canImportPec:{type:Boolean,required:!1}},data(){return{selectedFile:null,importUrl:unicaenVue.url("paiement/import-numero-pec"),fileErrors:null,intervenantMissing:null,messageErrors:null,messageConfirm:null}},mounted(){},methods:{handleFileUpload(t){this.selectedFile=t.target.files[0],this.fileErrors=null,this.intervenantMissing=null,this.messageErrors=null,this.messageConfirm=null,document.getElementById("btn-import").disabled=!1},importFile(t){t.preventDefault(),this.messageErrors=null,this.messageConfirm=null;let n=document.getElementById("btn-import"),s=document.getElementById("btn-import-inprogress");s.classList.remove("d-none"),n.classList.add("d-none"),n.disabled=!0;let _=document.getElementById("formImport"),l=new FormData(_);unicaenVue.axios.post(this.importUrl,l,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{let o=i.data;this.fileErrors=o.file,this.intervenantMissing=o.intervenant,o.message.length!=0?this.messageErrors=o.message:this.messageConfirm="Importation des numéros de prise en charge réalisée avec succés !",n.disabled=!1,s.classList.add("d-none"),n.classList.remove("d-none")}).catch(i=>{console.error("Error uploading")})}}},gh={class:"card text-dark bg-light"},yh=e("div",{class:"card-header text-uppercase fw-bold"}," Importation des numéros de prise en charge ",-1),xh={class:"card-body"},Ch={key:0,class:"alert alert-danger",role:"alert"},kh={key:1,class:"alert alert-success",role:"alert"},Ph={id:"formImport",action:"",enctype:"multipart/form-data",method:"post"},Eh=e("p",{class:"fs-9 text"},[m(" Vous pouvez utiliser le modèle directement extrait de winpaie "),e("strong",null,"(format .xlsx ou .ods)"),m(" ou créer votre modèle générique de classeur "),e("strong",null,"(format .xlsx ou .ods)"),m(" incluant 3 colonnes : insee,numero pec, nom. ")],-1),Dh={class:"mb-3"},Sh=e("label",{class:"form-label",for:"importFile"},"Choisissez le fichier à importer :",-1),Vh=he('<div class="mb-3"><label class="form-label" for="modele">Choisissez le modèle d&#39;import :</label>  <select id="modeleImport" class="form-select" name="modeleImport"><option value="winpaie">Winpaie</option><option value="generic">Generique (Modèle à 3 colonnes)</option></select></div>',1),Th={class:"mb-3"},Mh=e("button",{id:"btn-import-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),m("  Veuillez patienter... ")],-1),Ih={key:0,id:"fileErrors",class:"card text-dark bg-light"},Rh=e("div",{class:"card-header text-uppercase fw-bold"}," Rapport de chargement du fichier ",-1),wh={class:"card-body"},$h={key:0},Ah=e("p",null,"Listes des intervenants du fichier dont le numéro INSEE n'est pas valide : ",-1),jh={key:1},Uh=e("p",null,"Listes des intervenants présents dans le fichier mais non trouvés dans OSE : ",-1);function Lh(t,n,s,_,l,i){return r(),a(b,null,[e("div",gh,[yh,e("div",xh,[this.messageErrors?(r(),a("div",Ch,c(this.messageErrors),1)):h("",!0),this.messageConfirm?(r(),a("div",kh,c(this.messageConfirm),1)):h("",!0),e("form",Ph,[Eh,e("div",Dh,[Sh,m("  "),e("input",{class:"form-control",name:"importFile",type:"file",onChange:n[0]||(n[0]=(...o)=>i.handleFileUpload&&i.handleFileUpload(...o))},null,32)]),Vh,e("div",Th,[Mh,e("button",{id:"btn-import",class:"btn btn-primary",disabled:"",type:"button",onClick:n[1]||(n[1]=(...o)=>i.importFile&&i.importFile(...o))}," Importer les numéros de prise en charge ")])])])]),this.fileErrors||this.intervenantMissing?(r(),a("div",Ih,[Rh,e("div",wh,[this.fileErrors.length!=0?(r(),a("div",$h,[Ah,e("ul",null,[(r(!0),a(b,null,g(this.fileErrors,o=>(r(),a("li",null,c(),1))),256))])])):h("",!0),this.intervenantMissing.length!=0?(r(),a("div",jh,[Uh,e("ul",null,[(r(!0),a(b,null,g(this.intervenantMissing,o=>(r(),a("li",null,c(o),1))),256))])])):h("",!0)])])):h("",!0)],64)}const Hh=k(vh,[["render",Lh]]),qh=Object.freeze(Object.defineProperty({__proto__:null,default:Hh},Symbol.toStringTag,{value:"Module"})),Fh={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(t){modAjax(t.target,n=>{this.$emit("refreshListe")})},ajoutValeur(t){modAjax(t.target,n=>{this.$emit("refreshListe")})},saisieValeur(t){t.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:t.currentTarget.dataset.id}),modAjax(t.currentTarget,n=>{this.$emit("refreshListe")})},refreshListe(t){this.$emit("refreshListe")},supprimer(t){popConfirm(t.target,n=>{this.$emit("refreshListe")})},supprimerValeur(t){t.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refreshListe")})},refresh(t){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:t.id})).then(n=>{this.$emit("refresh",n.data)})}}},zh={class:"card-header"},Oh={style:{display:"inline"}},Nh={class:"float-end"},Bh=["href"],Gh=["href"],Yh={class:"card-body"},Jh={key:0},Wh=e("br",null,null,-1),Qh={class:""},Xh={class:"row align-items-start"},Zh={class:"col-md-6"},Kh={class:"col"},em=["data-id"],tm=["data-id"],sm=["href"],nm={key:1,class:"row"},im={class:"col-md-7"},rm=e("br",null,null,-1),am={class:"row align-items-start"},om={class:"col-md-8"},lm={class:"col-md-auto"},dm=["data-id"],um=["data-id"],cm=["href"],hm={class:"col"},mm=e("br",null,null,-1),_m={key:0},fm={key:0};function pm(t,n,s,_,l,i){const o=j,d=T("u-heures"),u=L,f=T("taux",!0);return r(),a(b,null,[e("div",{class:V(["card",{"ms-5":s.taux.tauxRemu}])},[e("div",zh,[e("h3",Oh,c(s.taux.libelle)+" ("+c(s.taux.code)+")",1),e("div",Nh,[s.taux.canEdit?(r(),a("a",{key:0,href:l.saisieUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=C((...y)=>i.saisie&&i.saisie(...y),["prevent"]))},[p(o,{name:"pen-to-square"}),m(" Modifier")],8,Bh)):h("",!0),m("   "),s.taux.canDelete?(r(),a("a",{key:1,href:l.supprimerUrl,class:"btn btn-danger",onClick:n[1]||(n[1]=C((...y)=>i.supprimer&&i.supprimer(...y),["prevent"]))},[p(o,{name:"trash-can"}),m(" Supprimer")],8,Gh)):h("",!0)])]),e("div",Yh,[s.taux.tauxRemu?h("",!0):(r(),a("div",Jh,[m(" Modification :"),Wh,e("ul",null,[(r(!0),a(b,null,g(s.taux.tauxRemuValeurs,y=>(r(),a("div",{key:y.id},[e("li",Qh,[e("div",Xh,[e("div",Zh,[p(d,{valeur:y.valeur},null,8,["valeur"]),m("€/h à partir du "),p(u,{value:y.dateEffet},null,8,["value"])]),e("div",Kh,[s.taux.canEdit?(r(),a("a",{key:0,class:"text-primary",onClick:n[2]||(n[2]=C((...v)=>i.saisieValeur&&i.saisieValeur(...v),["prevent"])),"data-id":y.id},[p(o,{name:"pen-to-square"})],8,em)):h("",!0),m("   "),s.taux.canEdit?(r(),a("a",{key:1,class:"text-primary",onClick:n[3]||(n[3]=C((...v)=>i.supprimerValeur&&i.supprimerValeur(...v),["prevent"])),"data-id":y.id},[p(o,{name:"trash-can"})],8,tm)):h("",!0)])])])]))),128))]),s.taux.canEdit?(r(),a("a",{key:0,href:l.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:n[4]||(n[4]=C((...y)=>i.ajoutValeur&&i.ajoutValeur(...y),["prevent"]))},[p(o,{name:"plus"}),m(" Ajouter une valeur ")],8,sm)):h("",!0)])),s.taux.tauxRemu?(r(),a("div",nm,[e("div",im,[m(" Modification :"),rm,e("ul",null,[(r(!0),a(b,null,g(s.taux.tauxRemuValeurs,y=>(r(),a("div",null,[e("li",null,[e("div",am,[e("div",om,[m(" Coéfficient de "),p(d,{valeur:y.valeur},null,8,["valeur"]),m(" à partir du "),p(u,{value:y.dateEffet},null,8,["value"])]),e("div",lm,[s.taux.canEdit?(r(),a("a",{key:0,class:"text-primary",onClick:n[5]||(n[5]=C((...v)=>i.saisieValeur&&i.saisieValeur(...v),["prevent"])),"data-id":y.id},[p(o,{name:"pen-to-square"})],8,dm)):h("",!0),m("   "),s.taux.canEdit?(r(),a("a",{key:1,class:"text-primary",onClick:n[6]||(n[6]=C((...v)=>i.supprimerValeur&&i.supprimerValeur(...v),["prevent"])),"data-id":y.id},[p(o,{name:"trash-can"})],8,um)):h("",!0)])])])]))),256))]),s.taux.canEdit?(r(),a("a",{key:0,href:l.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:n[7]||(n[7]=C((...y)=>i.ajoutValeur&&i.ajoutValeur(...y),["prevent"]))},[p(o,{name:"plus"})],8,cm)):h("",!0)]),e("div",hm,[m(" Valeurs calculées (indexées sur le taux "+c(s.taux.tauxRemu.libelle)+") : ",1),e("ul",null,[(r(!0),a(b,null,g(s.taux.tauxRemuValeursIndex,y=>(r(),a("div",null,[e("li",null,[p(d,{valeur:y.valeur},null,8,["valeur"]),m("€/h à partir du "),p(u,{value:y.date},null,8,["value"])])]))),256))]),mm])])):h("",!0)])],2),s.taux.tauxRemu?h("",!0):(r(),a("div",_m,[(r(!0),a(b,null,g(s.listeTaux,y=>(r(),a("div",{key:y},[y.tauxRemu&&y.tauxRemu.id===s.taux.id?(r(),a("div",fm,[(r(),E(f,{onSupprimer:i.supprimer,onRefreshListe:i.refreshListe,key:s.taux.id,taux:y,listeTaux:s.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):h("",!0)]))),128))]))],64)}const ie=k(Fh,[["render",pm]]),bm=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),vm={components:{taux:ie},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(t){modAjax(t.currentTarget,n=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(t){let n=Util.json.indexById(this.listeTaux,t.id);this.listeTaux[n]=t},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(t=>{this.listeTaux=t.data})}}},gm=["href"];function ym(t,n,s,_,l,i){const o=T("taux");return r(),a(b,null,[(r(!0),a(b,null,g(l.listeTaux,d=>(r(),a("div",null,[d.tauxRemu?h("",!0):(r(),E(o,{onSupprimer:i.supprimer,onRefreshListe:i.refreshListe,key:d.id,taux:d,listeTaux:l.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),s.canEditTaux?(r(),a("a",{key:0,class:"btn btn-primary",href:l.ajoutUrl,onClick:n[0]||(n[0]=C((...d)=>i.ajout&&i.ajout(...d),["prevent"]))},"Ajout d'un nouveau taux",8,gm)):h("",!0)],64)}const xm=k(vm,[["render",ym]]),Cm=Object.freeze(Object.defineProperty({__proto__:null,default:xm},Symbol.toStringTag,{value:"Module"})),km={UHeures:"Application/UI/UHeures",Utilisateur:"Application/Utilisateur"};function Pm(t,n){const s={};n===void 0&&(n={});for(const _ in t){let i=_.slice(2,-4).replaceAll("/","");s[i]=t[_].default}for(const _ of document.getElementsByClassName("vue-app")){let l=me({template:_.innerHTML,components:s});if(n.beforeMount!==void 0&&n.beforeMount(l),n.autoloads!==void 0)for(const i in n.autoloads){let o=n.autoloads[i].replaceAll("/","");l.component(i,s[o])}l.use(_e({components:!0,directives:!0})),l.mount(_),n.afterMount!==void 0&&n.afterMount(l)}}const Em={init:Pm},Dm=Object.assign({"./Application/UI/UHeures.vue":ge,"./Application/Utilisateur.vue":Pe,"./Employeur/ListeEmployeur.vue":Fe,"./Intervenant/Recherche.vue":dt,"./Lieu/Structure.vue":Bt,"./Lieu/StructuresAdmin.vue":Kt,"./Mission/Liste.vue":Pn,"./Mission/ListeCandidatures.vue":Xn,"./Mission/ListeOffreEmploi.vue":Sr,"./Mission/ListePrime.vue":Ra,"./Mission/Mission.vue":gn,"./Mission/OffreEmploi.vue":gr,"./Mission/Prime.vue":ya,"./Mission/Suivi.vue":mo,"./Mission/SuiviEvent.vue":lo,"./Paiement/DemandeMiseEnPaiement.vue":Wd,"./Paiement/DemandeMiseEnPaiementLot.vue":Mc,"./Paiement/DemandeMiseEnPaiementStructure.vue":zd,"./Paiement/DetailsCalculs.vue":bh,"./Paiement/ImportNumeroPec.vue":qh,"./Paiement/ListeTaux.vue":Cm,"./Paiement/Taux.vue":bm}),Sm={autoloads:km};Em.init(Dm,Sm);
