CREATE OR REPLACE TRIGGER T_PJ_PJ_FOURNIE
AFTER INSERT 
OR UPDATE OF 
  annee_id,
	type_piece_jointe_id,
	intervenant_id,
	validation_id,
	fichier_id
OR DELETE ON TBL_PIECE_JOINTE_FOURNIE
FOR EACH ROW
BEGIN

  IF :NEW.intervenant_id IS NOT NULL THEN
    OSE_EVENT.DEMANDE_CALCUL( OSE_PIECE_JOINTE.package_sujet, :NEW.intervenant_id );
  END IF;
  
  IF :OLD.intervenant_id IS NOT NULL THEN
    OSE_EVENT.DEMANDE_CALCUL( OSE_PIECE_JOINTE.package_sujet, :OLD.intervenant_id );
  END IF;

END;

/

CREATE OR REPLACE TRIGGER T_PJ_PJ_DEMANDE
AFTER INSERT 
OR UPDATE OF 
  annee_id,
	type_piece_jointe_id,
	intervenant_id
OR DELETE ON TBL_PIECE_JOINTE_DEMANDE
FOR EACH ROW
BEGIN

  IF :NEW.intervenant_id IS NOT NULL THEN
    OSE_EVENT.DEMANDE_CALCUL( OSE_PIECE_JOINTE.package_sujet, :NEW.intervenant_id );
  END IF;
  
  IF :OLD.intervenant_id IS NOT NULL THEN
    OSE_EVENT.DEMANDE_CALCUL( OSE_PIECE_JOINTE.package_sujet, :OLD.intervenant_id );
  END IF;

END;

/

CREATE OR REPLACE TRIGGER T_PJ_PJ_DEMANDE_S
AFTER INSERT OR UPDATE OR DELETE ON TBL_PIECE_JOINTE_DEMANDE
BEGIN
  OSE_EVENT.CALCULER_DEMANDES;
END;

/


CREATE OR REPLACE TRIGGER T_PJ_PJ_FOURNIE_S
AFTER INSERT OR UPDATE OR DELETE ON TBL_PIECE_JOINTE_FOURNIE
BEGIN
  OSE_EVENT.CALCULER_DEMANDES;
END;

/


