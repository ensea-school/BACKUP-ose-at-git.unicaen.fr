import{c as a,a as t,n as A,t as d,b as f,d as c,e as h,w as T,F as g,B as ce,o as i,r as x,f as _,v as pe,g as R,h as U,_ as G,i as O,j as Q,k as W,l as he,m as k,p as J,q as M,s as X,u as E,x as y,y as N,z as q,A as fe,C as be,D as ve,E as _e,G as ge}from"./vendor-KzP7jRq0.js";const S=(n,e)=>{const s=n.__vccOpts||n;for(const[v,r]of e)s[v]=r;return s},ye={name:"Connexion",props:{data:Object},data(){return{identity:"",currentRoleId:null,selectedStructures:{}}},mounted(){this.currentRoleId=this.data.roleId;for(let n in this.data.roles)this.selectedStructures[n]=-1;this.selectedStructures[this.currentRoleId]=this.data.structureId??-1},methods:{userProfileChange(n){let e=this.selectedStructures[n];e==-1&&(e=null),n!=this.currentRoleId&&(this.currentRoleId=n),document.body.classList.add("wait-cursor"),unicaenVue.axios.post(this.selectionProfilUrl,{role:n,structure:e}).then(s=>{window.location.href=unicaenVue.url("")})}},computed:{roleIcon(){return this.data.usurpationEnCours?"fa fa-theater-masks":"fa fa-user"},roleContent(){return"coucou!!!"},connexionUrl(){return this.data.connecte?unicaenVue.url("auth/deconnexion"):unicaenVue.url("auth/connexion")},connexionTitle(){return this.data.connecte?"Supprime les informations de connexion":"Affiche le formulaire d'authentification"},connexionContent(){return this.data.connecte?"Déconnexion":"Connexion"},startUsurpationUrl(){return unicaenVue.url("utilisateur/usurper-identite")},stopUsurpationUrl(){return unicaenVue.url("utilisateur/stopper-usurpation")},selectionProfilUrl(){return unicaenVue.url("utilisateur/selectionner-profil")}}},xe={key:0,class:"navbar-link",id:"user-current-info",href:"#"},Ce={id:"user-status"},Ve={id:"user-status-name"},Se={key:1},Pe=["href","title"],ke={method:"POST",class:"user-profile-select-form"},Ae=["value","onClick"],De=["onUpdate:modelValue","onChange"],Te=["value"],Ee={key:0},Me=["action"],Ue={class:"mb-2"},Fe={class:"mb-2"},Re=["disabled"],Ie={key:1};function we(n,e,s,v,r,l){const u=G,p=ce;return i(),a(g,null,[s.data.connecte?(i(),a("a",xe,[t("span",Ce,[t("span",{class:A(l.roleIcon)},null,2),e[2]||(e[2]=t("span",{class:"caret"}," ",-1)),t("span",Ve,[t("strong",null,d(s.data.utilisateurNom),1),f(", "+d(s.data.roleNom),1)])])])):c("",!0),s.data.connecte?(i(),a("span",Se,"|")):c("",!0),t("a",{class:"navbar-link user-connection",href:l.connexionUrl,title:l.connexionUrl},d(l.connexionContent),9,Pe),h(p,{click:!0,"close-on-hide":!0,delay:{show:0,hide:0},target:"user-current-info"},{title:T(()=>e[3]||(e[3]=[f("Utilisateur connecté à l'application")])),default:T(()=>[e[8]||(e[8]=t("div",null,[t("strong",null,"Profil utilisateur :")],-1)),t("div",null,[t("form",ke,[(i(!0),a(g,null,x(s.data.roles,(m,o)=>(i(),a("div",{key:o,class:"radio"},[t("label",null,[_(t("input",{type:"radio",name:"role",class:"user-profile-select-input",title:"Cliquez pour changer de profil courant",value:o,onClick:C=>l.userProfileChange(o),"onUpdate:modelValue":e[0]||(e[0]=C=>r.currentRoleId=C)},null,8,Ae),[[pe,r.currentRoleId]]),f(d(m.libelle),1)]),e[5]||(e[5]=f("  ")),s.data.roles[o].peutChangerStructure?_((i(),a("select",{key:0,class:"user-profile-select-input-structure","onUpdate:modelValue":C=>r.selectedStructures[o]=C,onChange:C=>l.userProfileChange(o),title:"Cliquez pour sélectionner la structure associée au profil Administrateur"},[e[4]||(e[4]=t("option",{value:"-1"},"- toutes structures -",-1)),(i(!0),a(g,null,x(s.data.structures,(C,b)=>(i(),a("option",{key:b,value:b},d(C),9,Te))),128))],40,De)),[[R,r.selectedStructures[o]]]):c("",!0)]))),128))])]),s.data.usurpationEnabled&&!s.data.usurpationEnCours?(i(),a("div",Ee,[t("form",{action:l.startUsurpationUrl},[e[6]||(e[6]=t("div",null,[t("strong",null,"Usurpation d'identité :")],-1)),t("div",Ue,[_(t("input",{type:"text",name:"identity","onUpdate:modelValue":e[1]||(e[1]=m=>r.identity=m),class:"user-usurpation-input form-control",placeholder:"Identifiant utilisateur",value:""},null,512),[[U,r.identity]])]),t("div",Fe,[t("input",{type:"submit",name:"submit",disabled:!r.identity,class:"user-usurpation-submit btn btn-danger form-control",value:"Usurper"},null,8,Re)])],8,Me)])):c("",!0),s.data.usurpationEnabled&&s.data.usurpationEnCours?(i(),a("div",Ie,[h(u,{variant:"danger",href:l.stopUsurpationUrl},{default:T(()=>e[7]||(e[7]=[f("Stopper l'usurpation")])),_:1},8,["href"])])):c("",!0)]),_:1})],64)}const He=S(ye,[["render",we],["__scopeId","data-v-cbfe77c3"]]),Le=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"})),Ne={props:{valeur:{required:!0,type:Number}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},je=["innerHTML"];function Oe(n,e,s,v,r,l){return i(),a("span",{class:"heures",innerHTML:l.affichage},null,8,je)}const qe=S(Ne,[["render",Oe]]),ze=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"})),Be={name:"UInputFloat",props:{modelValue:{},isPourc:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},class:{type:String,required:!1,default:""},fraction:{type:Boolean,required:!1,default:!1},maximumDigits:{required:!1,default:8}},data(){return{fractions:{.333333:"1/3",.166667:"1/6",.142857:"1/7",.111111:"1/9",.666667:"2/3",.285714:"2/7",.222222:"2/9",.428571:"3/7",1.333333:"4/3",.571429:"4/7",.444444:"4/9",1.666667:"5/3",.833333:"5/6",.714286:"5/7",.555556:"5/9",.857143:"6/7",2.333333:"7/3",1.166667:"7/6",.777778:"7/9",2.666667:"8/3",1.142857:"8/7",.888889:"8/9",1.285714:"9/7"},inError:!1}},emits:["update:modelValue"],computed:{value:{get(){let n=this.modelValue;return this.isPourc&&(n*=100),this.floatToString(n)},set(n){const e=/^-?\d*\.?\d+$/;if(this.inError=n!==void 0&&n!==""&&!e.test(n.replace("/","").replace(",","").replace(".","")),!this.inError){let s=this.stringToFloat(n);this.isPourc&&(s/=100),(s===void 0||!isNaN(s)&&isFinite(s))&&this.$emit("update:modelValue",s)}}},cclass(){let n=this.class;return this.inError&&(n+=" is-invalid"),n}},methods:{floatToString(n){if(n==null)return;const e=Math.round(n*1e6)/1e6;if(this.fraction&&this.fractions[e]!==void 0)return this.fractions[e];var s="fr",v={minimumFractionDigits:0,maximumFractionDigits:this.maximumDigits,useGrouping:!1},r=new Intl.NumberFormat(s,v);return r.format(n)},stringToFloat(n){if(!(n===null||n===""||n===void 0))return n.indexOf("/")!==-1?(n=n.split("/"),n=Util.stringToFloat(n[0])/Util.stringToFloat(n[1])):n=parseFloat(n.replace(",",".")),n}},mounted(){}},Ge=["disabled"];function $e(n,e,s,v,r,l){return _((i(),a("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>l.value=u),disabled:s.disabled,ref:"inputFloat",class:A(l.cclass)},null,10,Ge)),[[U,l.value]])}const Je=S(Be,[["render",$e],["__scopeId","data-v-29c90e6d"]]),Ye=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"})),Qe={name:"Utilisateur",props:{nom:String,mail:String}},We=["href"];function Xe(n,e,s,v,r,l){return i(),a("a",{href:`mailto:${s.mail}`},d(s.nom),9,We)}const Ke=S(Qe,[["render",Xe]]),Ze=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"})),et={name:"UTableAjax",emits:["update:modelValue"],props:{modelValue:{required:!0},id:{required:!1,type:String},size:{required:!1,default:10},count:{required:!1},search:{required:!1},dataUrl:{required:!0,type:String}},data(){return{page:1,pageSizes:[10,25,50,100,"Tous"],defaultSize:10,dSize:this.size,dCount:this.count,dSearch:this.search,searchTimer:null,columns:{},loading:!1,orderCol:void 0,orderDir:"asc"}},computed:{cSize(){return isNaN(this.dSize)?9999999999999:this.dSize},storageIdentifier(){return"UTableAjax-"+this.id+"-"+window.location.href},elStart(){return isNaN(this.dSize)?1:(this.page-1)*this.dSize+1},elEnd(){return isNaN(this.dCount)?(this.page-1)*this.dSize+this.dSize:isNaN(this.dSize)?this.dCount:Math.min(this.dCount,(this.page-1)*this.dSize+this.dSize)}},watch:{dSize(n){localStorage.setItem(this.storageIdentifier,n),this.getData()},dSearch(n){const e=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.page>1?this.page=1:e.getData()},500)},page(n){this.getData()}},methods:{getData(){unicaenVue.axios.post(this.dataUrl,{page:this.page,size:this.dSize,elStart:this.elStart,elEnd:this.elEnd,search:this.dSearch,orderCol:this.orderCol,orderDir:this.orderDir}).then(n=>{let e=n.data;this.dCount=e.count,this.$emit("update:modelValue",e.data)})},orderBy(n){const e=this.columns[n];for(let v in this.columns)v!=n&&(this.columns[v].classList.contains("sorting_asc")&&this.columns[v].classList.remove("sorting_asc"),this.columns[v].classList.contains("sorting_desc")&&this.columns[v].classList.remove("sorting_desc"),console.log(v));let s="asc";e.classList.contains("sorting_asc")?(s="desc",e.classList.remove("sorting_asc"),e.classList.add("sorting_desc")):(e.classList.contains("sorting_desc")&&e.classList.remove("sorting_desc"),e.classList.add("sorting_asc")),this.orderCol=n,this.orderDir=s,this.getData()}},mounted(){this.dSize=parseInt(localStorage.getItem(this.storageIdentifier))||this.defaultSize,this.page=1,this.dSize=this.size,this.dCount=this.count;const n=this.$refs.tableRef,e=this;n&&n.querySelectorAll("th[column]").forEach(v=>{Array.from(v.attributes).forEach(r=>{r.name=="column"&&(this.columns[r.value]=v,v.dataset.column=r.value,v.onclick=function(){e.orderBy(this.dataset.column)},v.removeAttribute(r.name),v.classList.add("sorting"))})}),this.getData()}},tt={class:"dt-bootstrap5"},nt=["value"],st={class:"float-end"},rt={class:"table table-bordered dataTable mb-2",ref:"tableRef"},it={class:"dataTables_paginate paging_simple_numbers"};function lt(n,e,s,v,r,l){const u=Q,p=W,m=he;return i(),a("div",tt,[h(p,null,{default:T(()=>[h(u,null,{default:T(()=>[e[3]||(e[3]=f(" Afficher ")),t("label",null,[_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.dSize=o),class:"form-select form-select-sm"},[(i(!0),a(g,null,x(r.pageSizes,o=>(i(),a("option",{key:o,value:o},d(o),9,nt))),128))],512),[[R,r.dSize]])]),e[4]||(e[4]=f(" éléments "))]),_:1}),h(u,null,{default:T(()=>[t("div",st,[e[5]||(e[5]=f(" Rechercher : ")),t("label",null,[_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.dSearch=o),class:"form-control form-inline form-control-sm"},null,512),[[U,r.dSearch]])])])]),_:1})]),_:1}),t("table",rt,[O(n.$slots,"default")],512),h(p,null,{default:T(()=>[h(u,null,{default:T(()=>[f("Affichage de l'élément "+d(l.elStart)+" à "+d(l.elEnd)+" sur "+d(r.dCount)+" éléments",1)]),_:1}),h(u,null,{default:T(()=>[t("div",it,[h(m,{align:"end",page:r.page,modelValue:r.page,"onUpdate:modelValue":e[2]||(e[2]=o=>r.page=o),"total-rows":r.dCount,"per-page":l.cSize,"last-number":"true",firstNumber:"true","prev-text":"Précédent","next-text":"Suivant"},null,8,["page","modelValue","total-rows","per-page"])])]),_:1})]),_:1})])}const Y=S(et,[["render",lt]]),at={name:"listeEmployeur",data(){return{dataUrl:unicaenVue.url("employeur/get-data"),lines:[]}},methods:{saisie(n){modAjax(n.currentTarget,e=>{this.$refs.employeurs.getData()})},editUrl(n){return unicaenVue.url("employeur/saisie/:id",{id:n})}}},ot={key:0},ut=["href"],dt={key:1};function mt(n,e,s,v,r,l){const u=Y;return i(),a(g,null,[e[3]||(e[3]=t("h1",{class:"page-header"},"Gestion des employeurs",-1)),h(u,{ref:"employeurs",modelValue:r.lines,"onUpdate:modelValue":e[1]||(e[1]=p=>r.lines=p),"data-url":this.dataUrl},{default:T(()=>[e[2]||(e[2]=t("thead",null,[t("tr",null,[t("th",{column:"ID"},"Id"),t("th",{column:"RAISON_SOCIALE"},"Raison sociale"),t("th",{column:"NOM_COMMERCIAL"},"Nom commercial"),t("th",null,"Siren"),t("th",null," ")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(r.lines,(p,m)=>(i(),a("tr",{key:m},[t("td",null,d(p.ID),1),t("td",null,d(p.RAISON_SOCIALE),1),t("td",null,d(p.NOM_COMMERCIAL),1),t("td",null,d(p.SIREN),1),p.IMPORTABLE==0?(i(),a("td",ot,[p.IMPORTABLE==0?(i(),a("a",{key:0,href:l.editUrl(p.ID),onClick:e[0]||(e[0]=k((...o)=>l.saisie&&l.saisie(...o),["prevent"]))},"Modifier",8,ut)):c("",!0)])):c("",!0),p.IMPORTABLE==1?(i(),a("td",dt," NON MODIFIABLE ")):c("",!0)]))),128))])]),_:1},8,["modelValue","data-url"])],64)}const ct=S(at,[["render",mt]]),pt=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"})),ht={name:"Details",components:{},props:{formule:{type:Object},phpClass:{type:String}},methods:{indexUrl(){return unicaenVue.url("formule/administration")}}},ft=["innerHTML"],bt={class:"mb-2"},vt=["href"];function _t(n,e,s,v,r,l){return i(),a(g,null,[t("h1",null,"Code source de "+d(s.formule.code),1),t("div",{innerHTML:s.phpClass,class:"code"},null,8,ft),t("div",bt,[t("a",{class:"btn btn-secondary",href:this.indexUrl()},e[0]||(e[0]=[t("i",{class:"fas fa-rotate-left"},null,-1),f(" Retour à l'administration des formules")]),8,vt)])],64)}const gt=S(ht,[["render",_t]]),yt=Object.freeze(Object.defineProperty({__proto__:null,default:gt},Symbol.toStringTag,{value:"Module"})),xt={name:"Formulator",components:{},props:{phpClass:{type:String},error:{type:String}},methods:{indexUrl(){return unicaenVue.url("formule/administration")}}},Ct={class:"mb-2"},Vt=["href"],St={key:0},Pt={class:"alert alert-danger"},kt={key:1},At={key:2},Dt=["innerHTML"];function Tt(n,e,s,v,r,l){return i(),a(g,null,[e[3]||(e[3]=t("h1",null,"Formulator",-1)),t("div",Ct,[t("a",{class:"btn btn-secondary",href:this.indexUrl()},e[0]||(e[0]=[t("i",{class:"fas fa-rotate-left"},null,-1),f(" Retour à l'administration des formules")]),8,Vt)]),s.error?(i(),a("div",St,[t("div",Pt,d(s.error),1)])):(i(),a("div",kt,e[1]||(e[1]=[t("div",{class:"alert alert-success"},"Formule bien intégrée",-1)]))),s.phpClass?(i(),a("div",At,[e[2]||(e[2]=t("h3",null,"Code généré :",-1)),t("div",{innerHTML:s.phpClass},null,8,Dt)])):c("",!0),f(" "+d(s.error),1)],64)}const Et=S(xt,[["render",Tt]]),Mt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Ut={name:"Index",components:{},props:{formules:{required:!0,type:Array},canEdit:{required:!0,type:Boolean}},methods:{telechargementUrl(n){return unicaenVue.url("formule/administration/telecharger-tableur/"+n)},televersementUrl(){return unicaenVue.url("formule/administration/televerser-tableur")},detailsUrl(n){return unicaenVue.url("formule/administration/details/"+n)}}},Ft={class:"table table-bordered table-hover table-sort"},Rt=["title"],It={key:0,class:"cartridge"},wt={key:1,class:"cartridge"},Ht={key:2,class:"cartridge"},Lt={key:3,class:"cartridge"},Nt={key:4,class:"cartridge"},jt={key:5,class:"cartridge"},Ot={key:6,class:"cartridge"},qt={key:7,class:"cartridge"},zt={key:8,class:"cartridge"},Bt={key:9,class:"cartridge"},Gt={key:0},$t={key:1},Jt=["href"],Yt=["href"],Qt={key:0,class:"card bg-warning"},Wt={class:"card-body"},Xt=["action"];function Kt(n,e,s,v,r,l){return i(),a(g,null,[e[28]||(e[28]=t("h1",null,"Formules de calcul",-1)),t("table",Ft,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",null,"Libellé"),t("th",null,"Paramètres"),t("th",null,"Règle de délégation"),t("th",null,"Ressources")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(s.formules,u=>(i(),a("tr",{key:n.id,class:A({desactivee:!u.active}),title:u.active?"":"Cette formule est désactivée"},[t("td",null,[f(d(u.libelle),1),e[0]||(e[0]=t("br",null,null,-1)),t("i",null,d(u.code),1)]),t("td",null,[u.iParam1Libelle?(i(),a("div",It,[e[1]||(e[1]=t("span",null,"intervenant",-1)),e[2]||(e[2]=t("span",null,"param1",-1)),f(" "+d(u.iParam1Libelle),1)])):c("",!0),u.iParam2Libelle?(i(),a("div",wt,[e[3]||(e[3]=t("span",null,"intervenant",-1)),e[4]||(e[4]=t("span",null,"param2",-1)),f(" "+d(u.iParam2Libelle),1)])):c("",!0),u.iParam3Libelle?(i(),a("div",Ht,[e[5]||(e[5]=t("span",null,"intervenant",-1)),e[6]||(e[6]=t("span",null,"param3",-1)),f(" "+d(u.iParam3Libelle),1)])):c("",!0),u.iParam4Libelle?(i(),a("div",Lt,[e[7]||(e[7]=t("span",null,"intervenant",-1)),e[8]||(e[8]=t("span",null,"param4",-1)),f(" "+d(u.iParam4Libelle),1)])):c("",!0),u.iParam5Libelle?(i(),a("div",Nt,[e[9]||(e[9]=t("span",null,"intervenant",-1)),e[10]||(e[10]=t("span",null,"param5",-1)),f(" "+d(u.iParam5Libelle),1)])):c("",!0),u.vhParam1Libelle?(i(),a("div",jt,[e[11]||(e[11]=t("span",null,"volume horaire",-1)),e[12]||(e[12]=t("span",null,"param1",-1)),f(" "+d(u.vhParam1Libelle),1)])):c("",!0),u.vhParam2Libelle?(i(),a("div",Ot,[e[13]||(e[13]=t("span",null,"volume horaire",-1)),e[14]||(e[14]=t("span",null,"param2",-1)),f(" "+d(u.vhParam2Libelle),1)])):c("",!0),u.vhParam3Libelle?(i(),a("div",qt,[e[15]||(e[15]=t("span",null,"volume horaire",-1)),e[16]||(e[16]=t("span",null,"param3",-1)),f(" "+d(u.vhParam3Libelle),1)])):c("",!0),u.vhParam4Libelle?(i(),a("div",zt,[e[17]||(e[17]=t("span",null,"volume horaire",-1)),e[18]||(e[18]=t("span",null,"param4",-1)),f(" "+d(u.vhParam4Libelle),1)])):c("",!0),u.vhParam5Libelle?(i(),a("div",Bt,[e[19]||(e[19]=t("span",null,"volume horaire",-1)),e[20]||(e[20]=t("span",null,"param5",-1)),f(" "+d(u.vhParam5Libelle),1)])):c("",!0)]),u.delegationAnnee?(i(),a("td",Gt,[f("Avant "+d(u.delegationAnnee)+"/"+d(u.delegationAnnee+1)+", utilise ",1),t("i",null,d(u.delegationFormule),1)])):(i(),a("td",$t)),t("td",null,[t("a",{href:this.telechargementUrl(u.id)},e[21]||(e[21]=[t("i",{class:"fas fa-table-cells"},null,-1),f(" tableur")]),8,Jt),e[23]||(e[23]=t("br",null,null,-1)),this.canEdit?(i(),a("a",{key:0,href:this.detailsUrl(u.id)},e[22]||(e[22]=[t("i",{class:"fas fa-table-cells"},null,-1),f(" code PHP")]),8,Yt)):c("",!0)])],10,Rt))),128))])]),e[29]||(e[29]=t("br",null,null,-1)),this.canEdit?(i(),a("div",Qt,[e[27]||(e[27]=t("div",{class:"card-header"},[t("h3",null,"Création/Modification d'une formule à partir d'un tableur")],-1)),t("div",Wt,[e[26]||(e[26]=t("div",{class:"alert alert-warning"},[t("span",{class:"icon iconly icon-attention"}),t("strong",null,"Attention :"),f(" cette opération peut avoir un impact déterminant sur le calcul de vos heures complémentaires et par extension sur tous vos paiements. En outre, le fichier doit être bâti selon un modèle bien précis. Vous êtes invités à ne téléverser que des tableurs préparés ou validés par l'équipe OSE. ")],-1)),t("form",{method:"post",enctype:"multipart/form-data",action:this.televersementUrl()},e[25]||(e[25]=[J('<div class="form-group mb-3" data-v-ba77464f><label for="formule-name" data-v-ba77464f>Feuille de calcul (format Excel ou Calc)</label><input class="form-control" id="formule-fichier" type="file" name="fichier" data-v-ba77464f></div><div class="form-group" data-v-ba77464f><button type="submit" class="btn btn-primary" data-v-ba77464f>Ajout/Modification à partir d&#39;un tableur</button></div>',2)]),8,Xt)])])):c("",!0)],64)}const Zt=S(Ut,[["render",Kt],["__scopeId","data-v-ba77464f"]]),en=Object.freeze(Object.defineProperty({__proto__:null,default:Zt},Symbol.toStringTag,{value:"Module"})),tn={name:"DetailsServiceEnseignement",components:{},props:{enseignement:{type:Object}},computed:{tauxFi(){return Util.floatToString(this.enseignement.tauxFi*100)+"% FI"},tauxFa(){return Util.floatToString(this.enseignement.tauxFa*100)+"% FA"},tauxFc(){return Util.floatToString(this.enseignement.tauxFc*100)+"% FC"}}},nn={key:0},sn={key:1},rn={key:0,class:"cartridge"},ln={class:"code"},an={class:"code"},on={key:1,class:"cartridge gray"},un={key:0};function dn(n,e,s,v,r,l){const u=X;return i(),a(g,null,[t("h6",null,[e[0]||(e[0]=f(" Enseignement ")),s.enseignement.elementPedagogique?c("",!0):(i(),a("span",nn," extérieur")),s.enseignement.elementPedagogique?(i(),a("span",sn,[h(u,null,{default:T(()=>[f(d(s.enseignement.structure.libelle),1)]),_:1}),s.enseignement.tauxFi>0?(i(),M(u,{key:0,variant:"light"},{default:T(()=>[f(d(l.tauxFi),1)]),_:1})):c("",!0),s.enseignement.tauxFa>0?(i(),M(u,{key:1,variant:"light"},{default:T(()=>[f(d(l.tauxFa),1)]),_:1})):c("",!0),s.enseignement.tauxFc>0?(i(),M(u,{key:2,variant:"light"},{default:T(()=>[f(d(l.tauxFc),1)]),_:1})):c("",!0)])):c("",!0)]),s.enseignement.elementPedagogique?(i(),a("div",rn,[t("span",null,[t("span",ln,d(s.enseignement.etape.code),1),f(" "+d(s.enseignement.etape.libelle),1)]),t("span",null,[t("span",an,d(s.enseignement.elementPedagogique.code),1),f(" "+d(s.enseignement.elementPedagogique.libelle),1)])])):(i(),a("div",on,[t("span",null,d(s.enseignement.etablissement.libelle),1),s.enseignement.description?(i(),a("span",un,d(s.enseignement.description),1)):c("",!0)]))],64)}const K=S(tn,[["render",dn],["__scopeId","data-v-f6c21cf6"]]),mn=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),cn={name:"DetailsServiceEnseignement",components:{},props:{referentiel:{type:Object}}},pn={class:"cartridge"},hn={key:0};function fn(n,e,s,v,r,l){const u=X;return i(),a(g,null,[t("h6",null,[e[0]||(e[0]=f(" Référentiel ")),h(u,null,{default:T(()=>[f(d(s.referentiel.structure.libelle),1)]),_:1})]),t("div",pn,[t("span",null,d(s.referentiel.fonction.libelle),1),s.referentiel.description?(i(),a("span",hn,d(s.referentiel.description),1)):c("",!0)])],64)}const Z=S(cn,[["render",fn]]),bn=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),vn={name:"DetailsVolumeHoraireEnseignement",components:{},props:{vh:{type:Object},visibilite:{type:Object}},methods:{histoTooltip(){return"Créé le "+Util.dateToString(this.vh.histo.creation)+" par "+this.vh.histo.createur.libelle+`
Modifié le `+Util.dateToString(this.vh.histo.modification)+" par "+this.vh.histo.modificateur.libelle+`
`},typeInterventionTooltip(){return"Taux en service : "+Util.floatToString(this.vh.tauxServiceDu)+`
Taux en HC : `+Util.floatToString(this.vh.tauxServiceCompl)+`
`},motifNonPaiement(){return this.vh.motifNonPaiement?this.vh.motifNonPaiement.libelle:this.vh.nonPayable?"Non payable":""},floatToString(n){return Util.floatToString(n)}}},_n={style:{"text-align":"center"}},gn=["title"],yn={key:0},xn={key:1},Cn={style:{"text-align":"center"}},Vn={key:2},Sn=["title"],Pn={key:3},kn={key:0,class:"fa fa-check text-success"},An={key:1,class:"fa fa-xmark text-danger"},Dn={key:4},Tn={key:5};function En(n,e,s,v,r,l){const u=E("u-heures");return i(),a(g,null,[t("td",_n,[t("abbr",{title:l.histoTooltip()},e[0]||(e[0]=[t("i",{class:"fa-regular fa-user"},null,-1)]),8,gn)]),s.visibilite.horaires?(i(),a("td",yn,d(s.vh.horaireDebut),1)):c("",!0),s.visibilite.horaires?(i(),a("td",xn,d(s.vh.horaireFin),1)):c("",!0),t("td",Cn,d(s.vh.periode.libelle),1),(i(!0),a(g,null,x(s.vh.params,(p,m)=>(i(),a("td",{key:m},d(p),1))),128)),s.visibilite.motifsNonPaiement?(i(),a("td",Vn,d(l.motifNonPaiement()),1)):c("",!0),t("td",null,[t("abbr",{title:l.typeInterventionTooltip()},d(s.vh.typeIntervention.code),9,Sn)]),s.visibilite.servicesStatutaire?(i(),a("td",Pn,[s.vh.serviceStatutaire?(i(),a("i",kn)):(i(),a("i",An))])):c("",!0),s.visibilite.majorations?(i(),a("td",Dn,d(l.floatToString(s.vh.ponderationServiceDu)),1)):c("",!0),s.visibilite.majorations?(i(),a("td",Tn,d(l.floatToString(s.vh.ponderationServiceCompl)),1)):c("",!0),t("td",null,[h(u,{valeur:s.vh.heures},null,8,["valeur"])]),e[1]||(e[1]=t("td",null," ",-1))],64)}const ee=S(vn,[["render",En]]),Mn=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"})),Un={name:"DetailsVolumeHoraireReferentiel",components:{},props:{vhr:{type:Object},visibilite:{type:Object}},methods:{histoTooltip(){return"Créé le "+Util.dateToString(this.vhr.histo.creation)+" par "+this.vhr.histo.createur.libelle+`
Modifié le `+Util.dateToString(this.vhr.histo.modification)+" par "+this.vhr.histo.modificateur.libelle+`
`},motifNonPaiement(){return this.vhr.motifNonPaiement?this.vhr.motifNonPaiement.libelle:this.vhr.nonPayable?"Non payable":""},floatToString(n){return Util.floatToString(n)}}},Fn={style:{"text-align":"center"}},Rn=["title"],In={key:0},wn={key:1},Hn={key:2},Ln={key:3},Nn={key:0,class:"fa fa-check text-success"},jn={key:1,class:"fa fa-xmark text-danger"},On={key:4},qn={key:5};function zn(n,e,s,v,r,l){const u=E("u-heures");return i(),a(g,null,[t("td",Fn,[t("abbr",{title:l.histoTooltip()},e[0]||(e[0]=[t("i",{class:"fa-regular fa-user"},null,-1)]),8,Rn)]),s.visibilite.horaires?(i(),a("td",In)):c("",!0),s.visibilite.horaires?(i(),a("td",wn)):c("",!0),e[1]||(e[1]=t("td",null,null,-1)),(i(!0),a(g,null,x(s.vhr.params,(p,m)=>(i(),a("td",{key:m},d(p),1))),128)),s.visibilite.motifsNonPaiement?(i(),a("td",Hn,d(l.motifNonPaiement()),1)):c("",!0),e[2]||(e[2]=t("td",null,"Référentiel",-1)),s.visibilite.servicesStatutaire?(i(),a("td",Ln,[n.vh.serviceStatutaire?(i(),a("i",Nn)):(i(),a("i",jn))])):c("",!0),s.visibilite.majorations?(i(),a("td",On,d(l.floatToString(s.vhr.ponderationServiceDu)),1)):c("",!0),s.visibilite.majorations?(i(),a("td",qn,d(l.floatToString(s.vhr.ponderationServiceCompl)),1)):c("",!0),t("td",null,[h(u,{valeur:s.vhr.heures},null,8,["valeur"])]),e[3]||(e[3]=t("td",null," ",-1))],64)}const te=S(Un,[["render",zn]]),Bn=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"})),Gn={name:"DetailsHetd",components:{},props:{type:{type:String},hetd:{type:Object}},computed:{arrondiClass(){switch(this.hetd.arrondi){case-1:return"arrondi-defaut";case 1:return"arrondi-exces"}return this.hetd.original!=this.hetd.valeur?"arrondi":""},legende(){let n="";return this.hetd.arrondi==1?n="L'arrondisseur de règle de calcul a procédé à un arrondi à l'excès":this.hetd.arrondi==-1&&(n="L'arrondisseur de règle de calcul a procédé à un arrondi par troncature"),this.hetd.original!=this.hetd.valeur&&(n!=""&&(n+=`
`),n+="Valeur originale : "+Util.floatToString(this.hetd.original,15)),n}}},$n=["title"];function Jn(n,e,s,v,r,l){const u=E("u-heures");return i(),a("td",{class:A(l.arrondiClass),title:l.legende},[h(u,{valeur:s.hetd.valeur},null,8,["valeur"])],10,$n)}const ne=S(Gn,[["render",Jn],["__scopeId","data-v-717df7b7"]]),Yn=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"})),Qn={name:"DetailsHetds",components:{DetailsHetd:ne},props:{hetds:{type:Object}}};function Wn(n,e,s,v,r,l){const u=E("details-hetd");return i(!0),a(g,null,x(s.hetds,(p,m)=>(i(),M(u,{key:m,type:m,hetd:p},null,8,["type","hetd"]))),128)}const se=S(Qn,[["render",Wn]]),Xn=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),Kn={name:"Details",components:{DetailsVolumeHoraireReferentiel:te,DetailsVolumeHoraireEnseignement:ee,DetailsServiceEnseignement:K,DetailsServiceReferentiel:Z,DetailsHetds:se},props:{intervenant:{type:Number},typesVolumesHoraires:{type:Object},canReporter:{type:Boolean}},data(){return{data:{},typeVolumeHoraire:null,etatVolumeHoraire:null}},mounted(){if(this.countChoix()==1){for(let n in this.typesVolumesHoraires){this.typeVolumeHoraire=n;for(let e in this.typesVolumesHoraires[n].etats)this.etatVolumeHoraire=e}this.load(this.typeVolumeHoraire,this.etatVolumeHoraire)}},methods:{load(n,e){this.typeVolumeHoraire=n,this.etatVolumeHoraire=e;const s={intervenant:this.intervenant,typeVolumeHoraire:this.typeVolumeHoraire,etatVolumeHoraire:this.etatVolumeHoraire};unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/formule/details-data/:typeVolumeHoraire/:etatVolumeHoraire",s)).then(v=>{this.data=v.data})},reportUrl(){const n={intervenant:this.intervenant,typeVolumeHoraire:this.data.intervenant.typeVolumeHoraireId,etatVolumeHoraire:this.data.intervenant.etatVolumeHoraireId};return unicaenVue.url("formule-test/creer-from-reel/:intervenant/:typeVolumeHoraire/:etatVolumeHoraire",n)},totalColSpan(){let n=4;return this.data.visibilite.horaires&&(n+=2),this.data.visibilite.motifsNonPaiement&&(n+=1),this.data.visibilite.servicesStatutaire&&(n+=1),this.data.visibilite.majorations&&(n+=2),n},countChoix(){let n=0;for(let e in this.typesVolumesHoraires)for(let s in this.typesVolumesHoraires[e].etats)n++;return n}},computed:{listeTypes(){let n={};for(let e in this.typesVolumesHoraires)n[e]=this.typesVolumesHoraires[e].libelle;return n},listeEtats(){let n={};for(let s in this.typesVolumesHoraires)for(let v in this.typesVolumesHoraires[s].etats)n[v]=this.typesVolumesHoraires[s].etats[v];return Object.keys(n).sort((s,v)=>s-v).reduce((s,v)=>(s[v]=n[v],s),{})}}},Zn={key:0},es={key:1},ts={class:"d-flex justify-content-center align-items-center"},ss={class:"table table-borderless table-xs"},rs={key:0},is=["onClick"],ls={key:0,class:"alert alert-info"},as={key:2},os={key:3},us={key:0},ds={class:"table table-bordered"},ms={key:0},cs={key:1},ps={key:0},hs={key:1},fs={key:2},bs={key:0},vs={key:1},_s={key:1,class:"alert alert-info"},gs={key:2,class:"alert alert-info"},ys={class:"table table-bordered table-xs table-details"},xs={class:"service",colspan:"999"},Cs={class:"details"},Vs={key:0,colspan:"2"},Ss={key:1,rowspan:"2"},Ps={key:2,rowspan:"2"},ks={key:3,colspan:"2"},As=["rowspan","colspan"],Ds={class:"details"},Ts={key:0},Es={key:1},Ms={key:2},Us={key:3},Fs=["colspan"],Rs=["colspan"],Is=["href"];function ws(n,e,s,v,r,l){const u=E("u-heures"),p=E("details-service-enseignement"),m=E("details-service-referentiel"),o=E("details-volume-horaire-enseignement"),C=E("details-volume-horaire-referentiel"),b=E("details-hetds");return i(),a(g,null,[l.countChoix()==0?(i(),a("div",Zn,e[0]||(e[0]=[t("div",{class:"alert alert-info"},"Aucun service saisi",-1)]))):c("",!0),l.countChoix()>1?(i(),a("div",es,[t("div",ts,[t("div",null,[t("table",ss,[(i(!0),a(g,null,x(l.listeTypes,(P,V)=>(i(),a("tr",{key:V},[(i(!0),a(g,null,x(l.listeEtats,(F,D)=>(i(),a("td",{key:D},[s.typesVolumesHoraires[V].etats[D]?(i(),a("div",rs,[t("a",{class:A({"btn btn-outline-secondary btn-choixtevh":!0,active:!(V==r.typeVolumeHoraire&&D==r.etatVolumeHoraire)}),onClick:I=>l.load(V,D)},d(P)+" "+d(F),11,is)])):c("",!0)]))),128))]))),128))])])]),r.typeVolumeHoraire?c("",!0):(i(),a("div",ls,"Veuillez cliquer sur un des boutons ci-dessus pour afficher de détail de calcul des HETD "))])):(i(),a("div",as,[t("h2",null,d(l.listeTypes[r.typeVolumeHoraire])+" "+d(l.listeEtats[r.etatVolumeHoraire]),1)])),Object.keys(this.data).length>0?(i(),a("div",os,[r.data.typesHetd.length==0?(i(),a("div",us,e[1]||(e[1]=[t("div",{class:"alert alert-warning"},"Aucune heure HETD n'a été calculée",-1)]))):c("",!0),e[18]||(e[18]=t("h2",null,"Paramètres intervenant",-1)),t("table",ds,[t("tbody",null,[t("tr",null,[e[3]||(e[3]=t("th",null,"Structure",-1)),r.data.intervenant.structure?(i(),a("td",ms,d(r.data.intervenant.structure.libelle),1)):(i(),a("td",cs,e[2]||(e[2]=[t("span",{class:"text-secondary"},"Aucune structure d'affectation",-1)])))]),r.data.intervenant.heuresServiceStatutaire>0&&r.data.intervenant.heuresServiceStatutaire!=r.data.intervenant.serviceDu?(i(),a("tr",ps,[e[4]||(e[4]=t("th",null,"Heures de service statutaire",-1)),t("td",null,[h(u,{valeur:r.data.intervenant.heuresServiceStatutaire},null,8,["valeur"])])])):c("",!0),r.data.intervenant.heuresServiceModifie>0?(i(),a("tr",hs,[e[5]||(e[5]=t("th",null,"Heures de service modifié",-1)),t("td",null,[h(u,{valeur:r.data.intervenant.heuresServiceModifie},null,8,["valeur"])])])):c("",!0),r.data.intervenant.serviceDu>0?(i(),a("tr",fs,[e[6]||(e[6]=t("th",null,"Heures de service dû",-1)),t("td",null,[h(u,{valeur:r.data.intervenant.serviceDu},null,8,["valeur"])])])):c("",!0),t("tr",null,[e[7]||(e[7]=t("th",null,"Dépassement de service dû sans HC",-1)),r.data.intervenant.depassementServiceDuSansHC?(i(),a("td",bs,"Oui")):(i(),a("td",vs,"Non"))]),(i(!0),a(g,null,x(r.data.iParams,(P,V)=>(i(),a("tr",{key:V},[t("th",null,d(P)+" "+d(V),1),t("td",null,d(r.data.intervenant.params[V]),1)]))),128))])]),e[19]||(e[19]=t("h2",null,[f("Données utilisées pour le calcul des "),t("abbr",{title:"Heures équivalent TD"},"HETD")],-1)),r.data.intervenant.arrondisseur==0?(i(),a("div",_s,"L'arrondisseur de calcul HETD est désactivé ")):c("",!0),r.data.intervenant.arrondisseur==1?(i(),a("div",gs,`L'arrondisseur de calcul HETD est ici activé en mode "minimal" : les opérations d'arrondissage ne se font ici qu'au niveau des volumes horaires et ne prennent pas en compte la totalisation des heures au niveau de la fiche de l'intervenant. `)):c("",!0),t("table",ys,[e[17]||(e[17]=t("thead",null,null,-1)),t("tbody",null,[(i(!0),a(g,null,x(r.data.services,(P,V)=>(i(),a(g,{key:V},[t("tr",null,[t("th",xs,[P.type=="enseignement"?(i(),M(p,{key:0,enseignement:P},null,8,["enseignement"])):(i(),M(m,{key:1,referentiel:P},null,8,["referentiel"]))])]),t("tr",Cs,[e[9]||(e[9]=t("th",{rowspan:"2"}," ",-1)),r.data.visibilite.horaires?(i(),a("th",Vs,"Horaire")):c("",!0),e[10]||(e[10]=t("th",{rowspan:"2"},"Période",-1)),(i(!0),a(g,null,x(r.data.vhParams,(F,D)=>(i(),a("th",{rowspan:"2",key:D},d(F),1))),128)),r.data.visibilite.motifsNonPaiement?(i(),a("th",Ss,"Motif non paiement")):c("",!0),e[11]||(e[11]=t("th",{rowspan:"2"},"Type d'intervention",-1)),r.data.visibilite.servicesStatutaire?(i(),a("th",Ps,e[8]||(e[8]=[t("abbr",{title:"Détermine si les heures peuvent être comptées dans le service statutaire de l'intervenant ou non"},"Peut dans serv.",-1)]))):c("",!0),r.data.visibilite.majorations?(i(),a("th",ks,"Majoration")):c("",!0),e[12]||(e[12]=t("th",{rowspan:"2"},"Heures",-1)),e[13]||(e[13]=t("th",{rowspan:"2"}," ",-1)),(i(!0),a(g,null,x(r.data.typesHetd,(F,D)=>(i(),a("th",{key:D,rowspan:F.length==0?2:1,colspan:Math.max(F.length,1)},d(D),9,As))),128))]),t("tr",Ds,[r.data.visibilite.horaires?(i(),a("th",Ts,"Début")):c("",!0),r.data.visibilite.horaires?(i(),a("th",Es,"Fin")):c("",!0),r.data.visibilite.majorations?(i(),a("th",Ms,"Service")):c("",!0),r.data.visibilite.majorations?(i(),a("th",Us,"Compl.")):c("",!0),(i(!0),a(g,null,x(r.data.typesHetd,F=>(i(),a(g,{key:F},[(i(!0),a(g,null,x(F,(D,I)=>(i(),a("th",{key:I},d(D),1))),128))],64))),128))]),(i(!0),a(g,null,x(P.volumesHoraires,(F,D)=>(i(),a("tr",{key:D},[P.type=="enseignement"?(i(),M(o,{key:0,vh:F,visibilite:r.data.visibilite},null,8,["vh","visibilite"])):(i(),M(C,{key:1,vhr:F,visibilite:r.data.visibilite},null,8,["vhr","visibilite"])),h(b,{hetds:F.hetd},null,8,["hetds"])]))),128)),t("tr",null,[t("th",{class:"total",colspan:l.totalColSpan()},"Total",8,Fs),e[14]||(e[14]=t("th",null," ",-1)),h(b,{hetds:P.hetd},null,8,["hetds"])])],64))),128)),e[16]||(e[16]=t("tr",null,[t("th",{class:"service",colspan:"999"}," ")],-1)),t("tr",null,[t("th",{class:"total",colspan:l.totalColSpan()},"Total intervenant",8,Rs),e[15]||(e[15]=t("th",null," ",-1)),h(b,{hetds:r.data.intervenant.hetd},null,8,["hetds"])])])]),s.canReporter?(i(),a("a",{key:3,href:l.reportUrl(),class:"btn btn-secondary"},"Reporter les données de cet intervenant dans l'interface de tests de formule",8,Is)):c("",!0)])):c("",!0)],64)}const Hs=S(Kn,[["render",ws],["__scopeId","data-v-599f94c4"]]),Ls=Object.freeze(Object.defineProperty({__proto__:null,default:Hs},Symbol.toStringTag,{value:"Module"})),Ns={data(){return{dataUrl:unicaenVue.url("formule-test/data"),lines:[]}},methods:{addUrl(){return unicaenVue.url("formule-test/saisir")},editUrl(n){return unicaenVue.url("formule-test/saisir/:id",{id:n})},deleteUrl(n){return unicaenVue.url("formule-test/supprimer/:id",{id:n})},importUrl(){return unicaenVue.url("formule-test/import")},supprimerTest(n){return popConfirm(n.currentTarget,e=>{this.$refs.testsFormules.getData()}),!1}}},js={style:{width:"1%","white-space":"nowrap"}},Os=["href"],qs=["href"],zs={class:"card bg-warning"},Bs={class:"card-body"},Gs=["action"];function $s(n,e,s,v,r,l){const u=Y,p=G;return i(),a(g,null,[e[9]||(e[9]=t("h1",{class:"page-header"},"Page de tests de formule de calcul des HETD",-1)),h(u,{"data-url":this.dataUrl,modelValue:r.lines,"onUpdate:modelValue":e[1]||(e[1]=m=>r.lines=m),ref:"testsFormules"},{default:T(()=>[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",{column:"ID"},"Id"),t("th",{column:"LIBELLE"},"Libellé"),t("th",{column:"FORMULE"},"Formule"),t("th",{column:"ANNEE"},"Année"),t("th",null," ")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(r.lines,(m,o)=>(i(),a("tr",{key:o},[t("td",null,d(m.ID),1),t("td",null,d(m.LIBELLE),1),t("td",null,d(m.FORMULE),1),t("td",null,d(m.ANNEE),1),t("td",js,[t("a",{href:l.editUrl(m.ID),title:"Modification du test de formule"},e[2]||(e[2]=[t("i",{class:"fas fa-pencil"},null,-1)]),8,Os),e[4]||(e[4]=f("   ")),t("a",{href:l.deleteUrl(m.ID),title:"Suppression du test de formule","data-content":"Êtes-vous sur de vouloir supprimer ce test ?","data-title":"Suppression du test de formule",onClick:e[0]||(e[0]=k((...C)=>l.supprimerTest&&l.supprimerTest(...C),["prevent"]))},e[3]||(e[3]=[t("i",{class:"fas fa-trash-can"},null,-1)]),8,qs)])]))),128))])]),_:1},8,["data-url","modelValue"]),h(p,{variant:"primary",href:l.addUrl()},{default:T(()=>e[6]||(e[6]=[f("Ajout d'un nouveau test")])),_:1},8,["href"]),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=t("br",null,null,-1)),t("div",zs,[e[8]||(e[8]=t("div",{class:"card-header"},[t("h3",null,"Import d'un nouveau test à partir d'un tableur")],-1)),t("div",Bs,[t("form",{method:"post",enctype:"multipart/form-data",action:this.importUrl()},e[7]||(e[7]=[J('<div class="form-group mb-3"><label for="formule-name">Feuille de calcul (format Excel ou Calc)</label><input class="form-control" id="formule-fichier" type="file" name="fichier"></div><div class="form-group"><button type="submit" class="btn btn-primary">Import d&#39;un test à partir d&#39;un tableur</button></div>',2)]),8,Gs)])])],64)}const Js=S(Ns,[["render",$s]]),Ys=Object.freeze(Object.defineProperty({__proto__:null,default:Js},Symbol.toStringTag,{value:"Module"})),Qs={props:{id:{type:Number},formules:{type:Object},annees:{type:Object},typesIntervenants:{type:Object},typesVolumesHoraires:{type:Object},etatsVolumesHoraires:{type:Object},defaultFormule:{type:Number}},data(){return{indexUrl:unicaenVue.url("formule-test"),dataUrl:unicaenVue.url("formule-test/data"),tauxAutre1Visibility:!0,tauxAutre2Visibility:!1,tauxAutre3Visibility:!1,tauxAutre4Visibility:!1,tauxAutre5Visibility:!1,resMode:"hetd",debug:{},intervenant:{formule:void 0,tauxCmServiceDu:1.5,tauxCmServiceCompl:1.5,tauxTpServiceDu:1,tauxTpServiceCompl:.6666666666667},volumesHoraires:[],formule:{iParam1Libelle:void 0,iParam2Libelle:void 0,iParam3Libelle:void 0,iParam4Libelle:void 0,iParam5Libelle:void 0,vhParam1Libelle:void 0,vhParam2Libelle:void 0,vhParam3Libelle:void 0,vhParam4Libelle:void 0,vhParam5Libelle:void 0},structures:{},typesIntervention:["CM","TD","TP",void 0,void 0,void 0,void 0,void 0,"Référentiel"]}},watch:{"intervenant.tauxAutre1Code"(n){this.tauxAutre2Visibility=n||this.intervenant.tauxAutre1Code||this.intervenant.tauxAutre2ServiceDu||this.intervenant.tauxAutre2ServiceCompl,this.typesIntervention[3]=n},"intervenant.tauxAutre2Code"(n){this.tauxAutre3Visibility=n||this.intervenant.tauxAutre2Code||this.intervenant.tauxAutre3ServiceDu||this.intervenant.tauxAutre3ServiceCompl,this.typesIntervention[4]=n},"intervenant.tauxAutre3Code"(n){this.tauxAutre4Visibility=n||this.intervenant.tauxAutre3Code||this.intervenant.tauxAutre4ServiceDu||this.intervenant.tauxAutre4ServiceCompl,this.typesIntervention[5]=n},"intervenant.tauxAutre4Code"(n){this.tauxAutre5Visibility=n||this.intervenant.tauxAutre4Code||this.intervenant.tauxAutre5ServiceDu||this.intervenant.tauxAutre5ServiceCompl,this.typesIntervention[6]=n},"intervenant.tauxAutre5Code"(n){this.typesIntervention[7]=n},"intervenant.formule"(n){n&&(this.formule=this.formules[n])}},computed:{filteredTypesIntervention(){let n=Object.values(this.typesIntervention).filter(e=>e);return n.unshift(""),n},vhParamCount(){let n=0;for(let e=1;e<6;e++)this.formule["vhParam"+e+"Libelle"]&&n++;return n}},methods:{charger(){unicaenVue.axios.get(unicaenVue.url("formule-test/saisir-data/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0})).then(n=>{this.intervenant=this.dropTauxNonUtilises(n.data.intervenant),this.volumesHoraires=n.data.volumesHoraires,this.debug={},this.addVolumeHoraire(),this.updateStructures()})},enregistrer(){unicaenVue.axios.post(unicaenVue.url("formule-test/enregistrer/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0}),{intervenant:this.intervenant,volumesHoraires:this.volumesHoraires}).then(n=>{this.intervenant=this.dropTauxNonUtilises(n.data.intervenant),this.volumesHoraires=n.data.volumesHoraires,n.data.debug?this.debug=n.data.debug:this.debug={},this.addVolumeHoraire(),this.updateStructures()})},calculer(){unicaenVue.axios.post(unicaenVue.url("formule-test/enregistrer/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0}),{intervenant:this.intervenant,volumesHoraires:this.volumesHoraires,simpleCalcul:!0}).then(n=>{this.intervenant=this.dropTauxNonUtilises(n.data.intervenant),this.volumesHoraires=n.data.volumesHoraires,n.data.debug?this.debug=n.data.debug:this.debug={},this.addVolumeHoraire(),this.updateStructures()})},exporter:function(){const n={intervenant:this.intervenant,volumesHoraires:this.volumesHoraires},e=this.intervenant.libelle;var s=document.createElement("a"),v=new Blob([JSON.stringify(n)],{type:"text/json"});s.href=window.URL.createObjectURL(v),s.download="Test de formule "+e+".json",s.click()},exporterCsv:function(){let n=`Structure;Compte dans le service statutaire;Heures non payables;Type d’intervention;Taux FI;Taux FA;Taux FC;Modulation service dû;Modulation service compl.;Param 1;Param 2;Param 3;Param 4;Param 5;Heures;Service FI;Service FA;Service FC;Service Référentiel;HC FI;HC FA;HC FC;HC Référentiel;Primes;Non payable FI;Non payable FA;Non payable FC;Non payable Référentiel
`;for(const r in this.volumesHoraires){const l=this.volumesHoraires[r];n+=(l.structureCode?l.structureCode:"")+";"+(l.nonPayable?"Oui":"Non")+";"+(l.serviceStatutaire?"Oui":"Non")+";"+(l.nonPayable?"Oui":"Non")+";"+(l.referentiel?"Référentiel":l.typeInterventionCode?l.typeInterventionCode:"")+";"+(l.tauxFi?l.tauxFi.toLocaleString("fr-FR"):"")+";"+(l.tauxFa?l.tauxFa.toLocaleString("fr-FR"):"")+";"+(l.tauxFc?l.tauxFc.toLocaleString("fr-FR"):"")+";"+(l.ponderationServiceDu?l.ponderationServiceDu.toLocaleString("fr-FR"):"")+";"+(l.ponderationServiceCompl?l.ponderationServiceCompl.toLocaleString("fr-FR"):"")+";"+(l.param1?l.param1:"")+";"+(l.param2?l.param2:"")+";"+(l.param3?l.param3:"")+";"+(l.param4?l.param4:"")+";"+(l.param5?l.param5:"")+";"+(l.heures?l.heures.toLocaleString("fr-FR"):"")+";"+(l.heuresServiceFi?l.heuresServiceFi.toLocaleString("fr-FR"):"")+";"+(l.heuresServiceFa?l.heuresServiceFa.toLocaleString("fr-FR"):"")+";"+(l.heuresServiceFc?l.heuresServiceFc.toLocaleString("fr-FR"):"")+";"+(l.heuresServiceReferentiel?l.heuresServiceReferentiel.toLocaleString("fr-FR"):"")+";"+(l.heuresComplFi?l.heuresComplFi.toLocaleString("fr-FR"):"")+";"+(l.heuresComplFa?l.heuresComplFa.toLocaleString("fr-FR"):"")+";"+(l.heuresComplFc?l.heuresComplFc.toLocaleString("fr-FR"):"")+";"+(l.heuresComplReferentiel?l.heuresComplReferentiel.toLocaleString("fr-FR"):"")+";"+(l.heuresPrimes?l.heuresPrimes.toLocaleString("fr-FR"):"")+";"+(l.heuresNonPayableFi?l.heuresNonPayableFi.toLocaleString("fr-FR"):"")+";"+(l.heuresNonPayableFa?l.heuresNonPayableFa.toLocaleString("fr-FR"):"")+";"+(l.heuresNonPayableFc?l.heuresNonPayableFc.toLocaleString("fr-FR"):"")+";"+(l.heuresNonPayableReferentiel?l.heuresNonPayableReferentiel.toLocaleString("fr-FR"):"")+`;
`}const e=this.intervenant.libelle;var s=document.createElement("a"),v=new Blob([n],{type:"text/csv"});s.href=window.URL.createObjectURL(v),s.download="Test de formule "+e+".csv",s.click()},importer:function(n){const e=n.target.files[0];if(!e.type.match("application/json")){console.error("Le fichier n'est pas de type JSON.");return}const s=new FileReader;s.onload=v=>{try{const r=JSON.parse(v.target.result);this.intervenant=r.intervenant,this.volumesHoraires=r.volumesHoraires,this.updateStructures()}catch(r){console.error("Erreur lors de l'analyse du contenu JSON :",r)}},s.readAsText(e)},dropTauxNonUtilises(n){return n.tauxAutre1Code||(n.tauxAutre1ServiceDu=void 0,n.tauxAutre1ServiceCompl=void 0),n.tauxAutre2Code||(n.tauxAutre2ServiceDu=void 0,n.tauxAutre2ServiceCompl=void 0),n.tauxAutre3Code||(n.tauxAutre3ServiceDu=void 0,n.tauxAutre3ServiceCompl=void 0),n.tauxAutre4Code||(n.tauxAutre4ServiceDu=void 0,n.tauxAutre4ServiceCompl=void 0),n.tauxAutre5Code||(n.tauxAutre5ServiceDu=void 0,n.tauxAutre5ServiceCompl=void 0),n},updateStructures(){let n={"":""};this.intervenant.structureCode&&(n[this.intervenant.structureCode]=this.intervenant.structureCode);for(let e in this.volumesHoraires){const s=this.volumesHoraires[e].structureCode;s&&(n[s]=s)}n.__UNIV__="Université (établissement)",n.__EXTERIEUR__="Extérieur (autre établissement)",n.__new_structure__="- Ajout d'une nouvelle structure -",this.structures=n},selectStructure(n){if(n.target.value=="__new_structure__"&&this.addStructure(n.target),n.target.dataset.variable!="intervenant"){const e=parseInt(n.target.dataset.variable);e==this.lastVolumeHoraireIndex()&&this.volumesHoraires[e].structureCode&&this.addVolumeHoraire()}},majTauxFi(n){const e=n.target.dataset.variable;this.volumesHoraires[e].tauxFi=1-this.volumesHoraires[e].tauxFa-this.volumesHoraires[e].tauxFc},lastVolumeHoraireIndex(){return this.volumesHoraires.length==0?-1:parseInt(Object.keys(this.volumesHoraires).pop())},addVolumeHoraire(){this.volumesHoraires.push({structureCode:null,typeInterventionCode:null,tauxFi:1,tauxFa:0,tauxFc:0,ponderationServiceDu:1,ponderationServiceCompl:1,serviceStatutaire:!0,heures:null})},addStructure(n){const e=prompt("Ajout d'une nouvelle structure");this.structures[e]=e,setTimeout(()=>{const s=n.dataset.variable;s=="intervenant"?this.intervenant.structureCode=e:this.volumesHoraires[s].structureCode=e},200)}},mounted(){this.charger()}},Ws={class:"row"},Xs={class:"col-md-6"},Ks={class:"table table-xs table-bordered fti"},Zs={class:"saisie"},er={class:"saisie"},tr=["value"],nr={class:"saisie"},sr=["value"],rr={class:"saisie"},ir=["value"],lr={class:"saisie"},ar=["value"],or={class:"saisie"},ur=["value"],dr={class:"saisie"},mr=["value"],cr={class:"saisie"},pr={class:"saisie"},hr={class:"saisie"},fr={class:"i-param i-param-1"},br={class:"i-param"},vr={class:"saisie"},_r={class:"i-param i-param-2"},gr={class:"i-param"},yr={class:"saisie"},xr={class:"i-param i-param-3"},Cr={class:"i-param"},Vr={class:"saisie"},Sr={class:"i-param i-param-4"},Pr={class:"i-param"},kr={class:"saisie"},Ar={class:"i-param i-param-5"},Dr={class:"i-param"},Tr={class:"saisie"},Er={class:"actions"},Mr={class:"row mb-4"},Ur={class:"col-md-6"},Fr={class:"col-md-6"},Rr={class:"row mb-4"},Ir={class:"col-md-6"},wr={class:"col-md-6"},Hr={for:"importbtn"},Lr={class:"row"},Nr={class:"col-md-6"},jr={class:"col-md-5"},Or={class:"types-interventions"},qr={class:"table table-bordered table-xs"},zr={style:{width:"10%"}},Br={style:{width:"10%"}},Gr={style:{width:"10%"}},$r={style:{width:"10%"}},Jr={style:{width:"10%"}},Yr={class:"saisie"},Qr={class:"saisie"},Wr={class:"saisie"},Xr={class:"saisie"},Kr={class:"saisie"},Zr={class:"saisie"},ei={class:"saisie"},ti={class:"saisie"},ni={class:"saisie"},si={class:"saisie"},ri={class:"saisie"},ii={class:"saisie"},li={class:"saisie"},ai={class:"saisie"},oi={class:"table table-xs table-bordered resultats"},ui={class:"table table-bordered table-xs table-hover fvh"},di=["colspan"],mi={colspan:"13"},ci=["colspan"],pi={colspan:"4"},hi={colspan:"4"},fi={rowspan:"2"},bi={colspan:"4"},vi={colspan:"4"},_i={colspan:"4"},gi={rowspan:"2"},yi={colspan:"4"},xi={rowspan:"2"},Ci=["onUpdate:modelValue","data-variable"],Vi=["value"],Si=["onUpdate:modelValue"],Pi=["onUpdate:modelValue"],ki=["onUpdate:modelValue"],Ai=["value"],Di=["onUpdate:modelValue"],Ti=["onUpdate:modelValue"],Ei=["onUpdate:modelValue"],Mi=["onUpdate:modelValue"],Ui=["onUpdate:modelValue"],Fi={class:"debug-td"},Ri={key:0},Ii={class:"debug-cell"},wi={class:"debug-val"},Hi={key:0},Li={class:"debug-cell"},Ni={class:"debug-val"},ji=["href"];function Oi(n,e,s,v,r,l){const u=E("u-input-float"),p=G,m=E("u-heures");return i(),a(g,null,[e[114]||(e[114]=t("h1",{class:"page-header"},"Modification d'un test de formule",-1)),t("div",Ws,[t("div",Xs,[e[54]||(e[54]=t("h2",null,"Intervenant",-1)),t("table",Ks,[t("tr",null,[e[40]||(e[40]=t("th",null,"Libellé",-1)),t("td",Zs,[_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.intervenant.libelle=o),class:"dinput"},null,512),[[U,r.intervenant.libelle]])])]),t("tr",null,[e[41]||(e[41]=t("th",null,"Formule",-1)),t("td",er,[_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.intervenant.formule=o),class:"dinput"},[(i(!0),a(g,null,x(s.formules,o=>(i(),a("option",{value:o.id},d(o.libelle),9,tr))),256))],512),[[R,r.intervenant.formule]])])]),t("tr",null,[e[42]||(e[42]=t("th",null,"Année",-1)),t("td",nr,[_(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.intervenant.annee=o),class:"dinput"},[(i(!0),a(g,null,x(s.annees,o=>(i(),a("option",{value:o.id},d(o.libelle),9,sr))),256))],512),[[R,r.intervenant.annee]])])]),t("tr",null,[e[43]||(e[43]=t("th",null,"Type",-1)),t("td",rr,[_(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.intervenant.typeIntervenant=o),class:"dinput"},[(i(!0),a(g,null,x(s.typesIntervenants,o=>(i(),a("option",{value:o.id},d(o.libelle),9,ir))),256))],512),[[R,r.intervenant.typeIntervenant]])])]),t("tr",null,[e[44]||(e[44]=t("th",null,"Structure",-1)),t("td",lr,[_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.intervenant.structureCode=o),"data-variable":"intervenant",class:"dinput",onChange:e[5]||(e[5]=(...o)=>l.selectStructure&&l.selectStructure(...o))},[(i(!0),a(g,null,x(r.structures,(o,C)=>(i(),a("option",{value:C,key:C},d(o),9,ar))),128))],544),[[R,r.intervenant.structureCode]])])]),t("tr",null,[e[45]||(e[45]=t("th",null,"Type de volume horaire",-1)),t("td",or,[_(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>r.intervenant.typeVolumeHoraire=o),class:"dinput"},[(i(!0),a(g,null,x(s.typesVolumesHoraires,o=>(i(),a("option",{value:o.id},d(o.libelle),9,ur))),256))],512),[[R,r.intervenant.typeVolumeHoraire]])])]),t("tr",null,[e[46]||(e[46]=t("th",null,"État de volume horaire",-1)),t("td",dr,[_(t("select",{"onUpdate:modelValue":e[7]||(e[7]=o=>r.intervenant.etatVolumeHoraire=o),class:"dinput"},[(i(!0),a(g,null,x(s.etatsVolumesHoraires,o=>(i(),a("option",{value:o.id},d(o.libelle),9,mr))),256))],512),[[R,r.intervenant.etatVolumeHoraire]])])]),t("tr",null,[e[47]||(e[47]=t("th",null,"Heures de service statutaire",-1)),t("td",cr,[h(u,{modelValue:r.intervenant.heuresServiceStatutaire,"onUpdate:modelValue":e[8]||(e[8]=o=>r.intervenant.heuresServiceStatutaire=o),class:"dinput"},null,8,["modelValue"])])]),t("tr",null,[e[48]||(e[48]=t("th",null,"Heures de service modifié",-1)),t("td",pr,[h(u,{modelValue:r.intervenant.heuresServiceModifie,"onUpdate:modelValue":e[9]||(e[9]=o=>r.intervenant.heuresServiceModifie=o),class:"dinput"},null,8,["modelValue"])])]),t("tr",null,[e[50]||(e[50]=t("th",null,"Dépassement de service dû sans HC",-1)),t("td",hr,[_(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>r.intervenant.depassementServiceDuSansHC=o),class:"dinput"},e[49]||(e[49]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)]),512),[[R,r.intervenant.depassementServiceDuSansHC]])])]),_(t("tr",fr,[t("th",br,d(r.formule.iParam1Libelle),1),t("td",vr,[_(t("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>r.intervenant.param1=o),class:"dinput"},null,512),[[U,r.intervenant.param1]])])],512),[[y,r.formule.iParam1Libelle]]),_(t("tr",_r,[t("th",gr,d(r.formule.iParam2Libelle),1),t("td",yr,[_(t("input",{"onUpdate:modelValue":e[12]||(e[12]=o=>r.intervenant.param2=o),class:"dinput"},null,512),[[U,r.intervenant.param2]])])],512),[[y,r.formule.iParam2Libelle]]),_(t("tr",xr,[t("th",Cr,d(r.formule.iParam3Libelle),1),t("td",Vr,[_(t("input",{"onUpdate:modelValue":e[13]||(e[13]=o=>r.intervenant.param3=o),class:"dinput"},null,512),[[U,r.intervenant.param3]])])],512),[[y,r.formule.iParam3Libelle]]),_(t("tr",Sr,[t("th",Pr,d(r.formule.iParam4Libelle),1),t("td",kr,[_(t("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>r.intervenant.param4=o),class:"dinput"},null,512),[[U,r.intervenant.param4]])])],512),[[y,r.formule.iParam4Libelle]]),_(t("tr",Ar,[t("th",Dr,d(r.formule.iParam5Libelle),1),t("td",Tr,[_(t("input",{"onUpdate:modelValue":e[15]||(e[15]=o=>r.intervenant.param5=o),class:"dinput"},null,512),[[U,r.intervenant.param5]])])],512),[[y,r.formule.iParam5Libelle]])]),t("div",Er,[t("div",Mr,[t("div",Ur,[h(p,{variant:"primary",onClick:l.enregistrer},{default:T(()=>e[51]||(e[51]=[f("Enregistrer les données")])),_:1},8,["onClick"])]),t("div",Fr,[h(p,{variant:"secondary",onClick:l.calculer},{default:T(()=>e[52]||(e[52]=[f("Calculer les HETD")])),_:1},8,["onClick"])])]),t("div",Rr,[t("div",Ir,[t("button",{class:"exporter btn btn-secondary",onClick:e[16]||(e[16]=(...o)=>l.exporter&&l.exporter(...o))},"Télécharger les données")]),t("div",wr,[t("label",Hr,[e[53]||(e[53]=t("span",{class:"btn btn-secondary"},"Téléverser un jeu de données",-1)),t("input",{type:"file",id:"importbtn",class:"importer",onChange:e[17]||(e[17]=(...o)=>l.importer&&l.importer(...o))},null,32)])])]),t("div",Lr,[t("div",Nr,[t("button",{class:"exporter btn btn-secondary",onClick:e[18]||(e[18]=(...o)=>l.exporterCsv&&l.exporterCsv(...o))},"Télécharger les données en CSV ")])])])]),t("div",jr,[e[84]||(e[84]=t("h2",null,"Types d'intervention (HETD)",-1)),t("div",Or,[t("table",qr,[e[63]||(e[63]=t("tr",null,[t("th"),t("th",{colspan:"3"},"Standards"),t("th",{colspan:"5"},"Personnalisés")],-1)),t("tr",null,[e[55]||(e[55]=t("th",{style:{width:"20%"}},null,-1)),e[56]||(e[56]=t("th",{style:{width:"5%"}},"CM",-1)),e[57]||(e[57]=t("th",{style:{width:"5%"}},"TD",-1)),e[58]||(e[58]=t("th",{style:{width:"5%"}},"TP",-1)),_(t("th",zr,[_(t("input",{"onUpdate:modelValue":e[19]||(e[19]=o=>r.intervenant.tauxAutre1Code=o),class:"dinput"},null,512),[[U,r.intervenant.tauxAutre1Code]])],512),[[y,r.tauxAutre1Visibility]]),_(t("th",Br,[_(t("input",{"onUpdate:modelValue":e[20]||(e[20]=o=>r.intervenant.tauxAutre2Code=o),class:"dinput"},null,512),[[U,r.intervenant.tauxAutre2Code]])],512),[[y,r.tauxAutre2Visibility]]),_(t("th",Gr,[_(t("input",{"onUpdate:modelValue":e[21]||(e[21]=o=>r.intervenant.tauxAutre3Code=o),class:"dinput"},null,512),[[U,r.intervenant.tauxAutre3Code]])],512),[[y,r.tauxAutre3Visibility]]),_(t("th",$r,[_(t("input",{"onUpdate:modelValue":e[22]||(e[22]=o=>r.intervenant.tauxAutre4Code=o),class:"dinput"},null,512),[[U,r.intervenant.tauxAutre4Code]])],512),[[y,r.tauxAutre4Visibility]]),_(t("th",Jr,[_(t("input",{"onUpdate:modelValue":e[23]||(e[23]=o=>r.intervenant.tauxAutre5Code=o),class:"dinput"},null,512),[[U,r.intervenant.tauxAutre5Code]])],512),[[y,r.tauxAutre5Visibility]])]),t("tr",null,[e[59]||(e[59]=t("th",null,"En service",-1)),t("td",Yr,[h(u,{modelValue:r.intervenant.tauxCmServiceDu,"onUpdate:modelValue":e[24]||(e[24]=o=>r.intervenant.tauxCmServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])]),e[60]||(e[60]=t("td",null,"1",-1)),t("td",Qr,[h(u,{modelValue:r.intervenant.tauxTpServiceDu,"onUpdate:modelValue":e[25]||(e[25]=o=>r.intervenant.tauxTpServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])]),_(t("td",Wr,[h(u,{modelValue:r.intervenant.tauxAutre1ServiceDu,"onUpdate:modelValue":e[26]||(e[26]=o=>r.intervenant.tauxAutre1ServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre1Visibility]]),_(t("td",Xr,[h(u,{modelValue:r.intervenant.tauxAutre2ServiceDu,"onUpdate:modelValue":e[27]||(e[27]=o=>r.intervenant.tauxAutre2ServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre2Visibility]]),_(t("td",Kr,[h(u,{modelValue:r.intervenant.tauxAutre3ServiceDu,"onUpdate:modelValue":e[28]||(e[28]=o=>r.intervenant.tauxAutre3ServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre3Visibility]]),_(t("td",Zr,[h(u,{modelValue:r.intervenant.tauxAutre4ServiceDu,"onUpdate:modelValue":e[29]||(e[29]=o=>r.intervenant.tauxAutre4ServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre4Visibility]]),_(t("td",ei,[h(u,{modelValue:r.intervenant.tauxAutre5ServiceDu,"onUpdate:modelValue":e[30]||(e[30]=o=>r.intervenant.tauxAutre5ServiceDu=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre5Visibility]])]),t("tr",null,[e[61]||(e[61]=t("th",null,"Au-delà du service",-1)),t("td",ti,[h(u,{modelValue:r.intervenant.tauxCmServiceCompl,"onUpdate:modelValue":e[31]||(e[31]=o=>r.intervenant.tauxCmServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])]),e[62]||(e[62]=t("td",null,"1",-1)),t("td",ni,[h(u,{modelValue:r.intervenant.tauxTpServiceCompl,"onUpdate:modelValue":e[32]||(e[32]=o=>r.intervenant.tauxTpServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])]),_(t("td",si,[h(u,{modelValue:r.intervenant.tauxAutre1ServiceCompl,"onUpdate:modelValue":e[33]||(e[33]=o=>r.intervenant.tauxAutre1ServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre1Visibility]]),_(t("td",ri,[h(u,{modelValue:r.intervenant.tauxAutre2ServiceCompl,"onUpdate:modelValue":e[34]||(e[34]=o=>r.intervenant.tauxAutre2ServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre2Visibility]]),_(t("td",ii,[h(u,{modelValue:r.intervenant.tauxAutre3ServiceCompl,"onUpdate:modelValue":e[35]||(e[35]=o=>r.intervenant.tauxAutre3ServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre3Visibility]]),_(t("td",li,[h(u,{modelValue:r.intervenant.tauxAutre4ServiceCompl,"onUpdate:modelValue":e[36]||(e[36]=o=>r.intervenant.tauxAutre4ServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre4Visibility]]),_(t("td",ai,[h(u,{modelValue:r.intervenant.tauxAutre5ServiceCompl,"onUpdate:modelValue":e[37]||(e[37]=o=>r.intervenant.tauxAutre5ServiceCompl=o),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[y,r.tauxAutre5Visibility]])])])]),e[85]||(e[85]=t("h2",null,"Résultat",-1)),t("table",oi,[t("tr",null,[e[64]||(e[64]=t("th",{colspan:"2"},"Service dû",-1)),t("td",null,[h(m,{valeur:r.intervenant.serviceDu??NaN},null,8,["valeur"])])]),t("tr",null,[e[65]||(e[65]=t("th",{rowspan:"4"},"Service",-1)),e[66]||(e[66]=t("th",null,"FI",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresServiceFi??NaN},null,8,["valeur"])])]),t("tr",null,[e[67]||(e[67]=t("th",null,"FA",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresServiceFa??NaN},null,8,["valeur"])])]),t("tr",null,[e[68]||(e[68]=t("th",null,"FC",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresServiceFc??NaN},null,8,["valeur"])])]),t("tr",null,[e[69]||(e[69]=t("th",null,"Référentiel",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresServiceReferentiel??NaN},null,8,["valeur"])])]),t("tr",null,[e[70]||(e[70]=t("th",{colspan:"2"},"Total service dû assuré",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresService??NaN},null,8,["valeur"])])]),t("tr",null,[e[71]||(e[71]=t("th",{rowspan:"4"},"Heures compl.",-1)),e[72]||(e[72]=t("th",null,"FI",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresComplFi??NaN},null,8,["valeur"])])]),t("tr",null,[e[73]||(e[73]=t("th",null,"FA",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresComplFa??NaN},null,8,["valeur"])])]),t("tr",null,[e[74]||(e[74]=t("th",null,"FC",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresComplFc??NaN},null,8,["valeur"])])]),t("tr",null,[e[75]||(e[75]=t("th",null,"Référentiel",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresComplReferentiel??NaN},null,8,["valeur"])])]),t("tr",null,[e[76]||(e[76]=t("th",{colspan:"2"},"Total heures compl. à payer",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresCompl??NaN},null,8,["valeur"])])]),t("tr",null,[e[77]||(e[77]=t("th",{colspan:"2"},"Primes",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresPrimes??NaN},null,8,["valeur"])])]),t("tr",null,[e[78]||(e[78]=t("th",{rowspan:"4"},"Heures non payables",-1)),e[79]||(e[79]=t("th",null,"FI",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresNonPayableFi??NaN},null,8,["valeur"])])]),t("tr",null,[e[80]||(e[80]=t("th",null,"FA",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresNonPayableFa??NaN},null,8,["valeur"])])]),t("tr",null,[e[81]||(e[81]=t("th",null,"FC",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresNonPayableFc??NaN},null,8,["valeur"])])]),t("tr",null,[e[82]||(e[82]=t("th",null,"Référentiel",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresNonPayableReferentiel??NaN},null,8,["valeur"])])]),t("tr",null,[e[83]||(e[83]=t("th",{colspan:"2"},"Total heures non payables",-1)),t("td",null,[h(m,{valeur:r.intervenant.heuresNonPayable??NaN},null,8,["valeur"])])])])]),e[113]||(e[113]=t("h2",null,"Heures effectuées (A saisir de manière chronologique)",-1)),t("table",ui,[t("thead",null,[t("tr",null,[e[87]||(e[87]=t("th",{rowspan:"3"},null,-1)),t("th",{colspan:10+l.vhParamCount,class:"vh-donnees"},"Données",8,di),e[88]||(e[88]=t("th",{rowspan:"3",class:"spacer"}," ",-1)),t("th",mi,[_(t("select",{"onUpdate:modelValue":e[38]||(e[38]=o=>r.resMode=o),class:"form-select res-mode"},e[86]||(e[86]=[t("option",{value:"attendu"},"Résultats attendus (en HETD)",-1),t("option",{value:"hetd",selected:"selected"},"Résultats calculés (en HETD)",-1),t("option",{value:"debug"},"Informations de débogage",-1)]),512),[[R,r.resMode]])])]),t("tr",null,[e[89]||(e[89]=t("th",{rowspan:"2",style:{"min-width":"10em"}},"Structure",-1)),e[90]||(e[90]=t("th",{rowspan:"2"},"Non payable",-1)),e[91]||(e[91]=t("th",{rowspan:"2"},"Compte dans le service statutaire",-1)),e[92]||(e[92]=t("th",{rowspan:"2",style:{"min-width":"5em"}},"Type d'intervention",-1)),e[93]||(e[93]=t("th",{colspan:"3"},"Répartition",-1)),e[94]||(e[94]=t("th",{colspan:"2"},"Modulation",-1)),_(t("th",{colspan:l.vhParamCount},"Paramètres",8,ci),[[y,l.vhParamCount>0]]),e[95]||(e[95]=t("th",{rowspan:"2"},"Heures",-1)),_(t("th",pi,"Service",512),[[y,r.resMode=="attendu"]]),_(t("th",hi,"Heures compl.",512),[[y,r.resMode=="attendu"]]),_(t("th",fi,"Primes",512),[[y,r.resMode=="attendu"]]),_(t("th",bi,"Heures non payables",512),[[y,r.resMode=="attendu"]]),_(t("th",vi,"Service",512),[[y,r.resMode=="hetd"]]),_(t("th",_i,"Heures compl.",512),[[y,r.resMode=="hetd"]]),_(t("th",gi,"Primes",512),[[y,r.resMode=="hetd"]]),_(t("th",yi,"Heures non payables",512),[[y,r.resMode=="hetd"]]),_(t("th",xi,"Informations de débogage",512),[[y,r.resMode=="debug"]])]),t("tr",null,[e[96]||(e[96]=t("th",null,"Fi",-1)),e[97]||(e[97]=t("th",null,"Fa",-1)),e[98]||(e[98]=t("th",null,"Fc",-1)),e[99]||(e[99]=t("th",null,"Service dû",-1)),e[100]||(e[100]=t("th",null,"Service compl.",-1)),(i(),a(g,null,x([1,2,3,4,5],o=>_(t("th",{key:o},d(r.formule["vhParam"+o+"Libelle"]),1),[[y,r.formule["vhParam"+o+"Libelle"]]])),64)),_(t("th",null,"Fi",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fa",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fc",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Référentiel",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fi",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fa",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fc",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Référentiel",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fi",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fa",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fc",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Référentiel",512),[[y,r.resMode=="attendu"]]),_(t("th",null,"Fi",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fa",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fc",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Référentiel",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fi",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fa",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fc",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Référentiel",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fi",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fa",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Fc",512),[[y,r.resMode=="hetd"]]),_(t("th",null,"Référentiel",512),[[y,r.resMode=="hetd"]])])]),t("tbody",null,[(i(!0),a(g,null,x(r.volumesHoraires,(o,C)=>(i(),a("tr",{key:C},[t("th",null,d(C+1),1),t("td",null,[_(t("select",{"onUpdate:modelValue":b=>o.structureCode=b,"data-variable":C,class:"dinput",onChange:e[39]||(e[39]=(...b)=>l.selectStructure&&l.selectStructure(...b))},[(i(!0),a(g,null,x(r.structures,(b,P)=>(i(),a("option",{value:P,key:P},d(b),9,Vi))),128))],40,Ci),[[R,o.structureCode]])]),t("td",null,[_(t("select",{"onUpdate:modelValue":b=>o.nonPayable=b,class:"dinput"},e[101]||(e[101]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)]),8,Si),[[R,o.nonPayable],[y,o.structureCode]])]),t("td",null,[_(t("select",{"onUpdate:modelValue":b=>o.serviceStatutaire=b,class:"dinput"},e[102]||(e[102]=[t("option",{value:!0},"Oui",-1),t("option",{value:!1},"Non",-1)]),8,Pi),[[R,o.serviceStatutaire],[y,o.structureCode]])]),t("td",null,[_(t("select",{"onUpdate:modelValue":b=>o.typeInterventionCode=b,class:"dinput"},[(i(!0),a(g,null,x(l.filteredTypesIntervention,b=>(i(),a("option",{value:b,key:b},d(b),9,Ai))),128))],8,ki),[[R,o.typeInterventionCode],[y,o.structureCode]])]),t("td",null,[_(t("div",null,[h(u,{modelValue:o.tauxFi,"onUpdate:modelValue":b=>o.tauxFi=b,"is-pourc":"",class:"doutput",readonly:"",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),e[103]||(e[103]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(o.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[h(u,{modelValue:o.tauxFa,"onUpdate:modelValue":b=>o.tauxFa=b,"is-pourc":"",class:"dinput","data-variable":C,onChange:l.majTauxFi,style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue","data-variable","onChange"]),e[104]||(e[104]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(o.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[h(u,{modelValue:o.tauxFc,"onUpdate:modelValue":b=>o.tauxFc=b,"is-pourc":"",class:"dinput","data-variable":C,onChange:l.majTauxFi,style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue","data-variable","onChange"]),e[105]||(e[105]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(o.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[h(u,{modelValue:o.ponderationServiceDu,"onUpdate:modelValue":b=>o.ponderationServiceDu=b,"is-pourc":"",class:"dinput",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),e[106]||(e[106]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(o.typeInterventionCode)]])]),t("td",null,[_(t("div",null,[h(u,{modelValue:o.ponderationServiceCompl,"onUpdate:modelValue":b=>o.ponderationServiceCompl=b,"is-pourc":"",class:"dinput",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),e[107]||(e[107]=t("span",{class:"pourc"},"%",-1))],512),[[y,!["",null,"Référentiel"].includes(o.typeInterventionCode)]])]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":b=>o.param1=b,class:"dinput"},null,8,Di),[[U,o.param1],[y,o.structureCode]])],512),[[y,r.formule.vhParam1Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":b=>o.param2=b,class:"dinput"},null,8,Ti),[[U,o.param2],[y,o.structureCode]])],512),[[y,r.formule.vhParam2Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":b=>o.param3=b,class:"dinput"},null,8,Ei),[[U,o.param3],[y,o.structureCode]])],512),[[y,r.formule.vhParam3Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":b=>o.param4=b,class:"dinput"},null,8,Mi),[[U,o.param4],[y,o.structureCode]])],512),[[y,r.formule.vhParam4Libelle]]),_(t("td",null,[_(t("input",{"onUpdate:modelValue":b=>o.param5=b,class:"dinput"},null,8,Ui),[[U,o.param5],[y,o.structureCode]])],512),[[y,r.formule.vhParam5Libelle]]),t("td",null,[_(h(u,{modelValue:o.heures,"onUpdate:modelValue":b=>o.heures=b,class:"dinput",onChange:l.calculer},null,8,["modelValue","onUpdate:modelValue","onChange"]),[[y,!["",null].includes(o.typeInterventionCode)]])]),e[109]||(e[109]=t("td",{class:"spacer"},null,-1)),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesServiceFi,"onUpdate:modelValue":b=>o.heuresAttenduesServiceFi=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesServiceFa,"onUpdate:modelValue":b=>o.heuresAttenduesServiceFa=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesServiceFc,"onUpdate:modelValue":b=>o.heuresAttenduesServiceFc=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesServiceReferentiel,"onUpdate:modelValue":b=>o.heuresAttenduesServiceReferentiel=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesComplFi,"onUpdate:modelValue":b=>o.heuresAttenduesComplFi=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesComplFa,"onUpdate:modelValue":b=>o.heuresAttenduesComplFa=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesComplFc,"onUpdate:modelValue":b=>o.heuresAttenduesComplFc=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesComplReferentiel,"onUpdate:modelValue":b=>o.heuresAttenduesComplReferentiel=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesPrimes,"onUpdate:modelValue":b=>o.heuresAttenduesPrimes=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesNonPayableFi,"onUpdate:modelValue":b=>o.heuresAttenduesNonPayableFi=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesNonPayableFa,"onUpdate:modelValue":b=>o.heuresAttenduesNonPayableFa=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesNonPayableFc,"onUpdate:modelValue":b=>o.heuresAttenduesNonPayableFc=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresAttenduesNonPayableReferentiel,"onUpdate:modelValue":b=>o.heuresAttenduesNonPayableReferentiel=b,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[y,r.resMode=="attendu"]]),_(t("td",null,[h(u,{modelValue:o.heuresServiceFi,"onUpdate:modelValue":b=>o.heuresServiceFi=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesServiceFi!=null&&Math.round(o.heuresAttenduesServiceFi*100)!=Math.round(o.heuresServiceFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresServiceFa,"onUpdate:modelValue":b=>o.heuresServiceFa=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesServiceFa!=null&&Math.round(o.heuresAttenduesServiceFa*100)!=Math.round(o.heuresServiceFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresServiceFc,"onUpdate:modelValue":b=>o.heuresServiceFc=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesServiceFc!=null&&Math.round(o.heuresAttenduesServiceFc*100)!=Math.round(o.heuresServiceFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresServiceReferentiel,"onUpdate:modelValue":b=>o.heuresServiceReferentiel=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesServiceReferentiel!=null&&Math.round(o.heuresAttenduesServiceReferentiel*100)!=Math.round(o.heuresServiceReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresComplFi,"onUpdate:modelValue":b=>o.heuresComplFi=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesComplFi!=null&&Math.round(o.heuresAttenduesComplFi*100)!=Math.round(o.heuresComplFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresComplFa,"onUpdate:modelValue":b=>o.heuresComplFa=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesComplFa!=null&&Math.round(o.heuresAttenduesComplFa*100)!=Math.round(o.heuresComplFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresComplFc,"onUpdate:modelValue":b=>o.heuresComplFc=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesComplFc!=null&&Math.round(o.heuresAttenduesComplFc*100)!=Math.round(o.heuresComplFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresComplReferentiel,"onUpdate:modelValue":b=>o.heuresComplReferentiel=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesComplReferentiel!=null&&Math.round(o.heuresAttenduesComplReferentiel*100)!=Math.round(o.heuresComplReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresPrimes,"onUpdate:modelValue":b=>o.heuresPrimes=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesPrimes!=null&&Math.round(o.heuresAttenduesPrimes*100)!=Math.round(o.heuresPrimes*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresNonPayableFi,"onUpdate:modelValue":b=>o.heuresNonPayableFi=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesNonPayableFi!=null&&Math.round(o.heuresAttenduesNonPayableFi*100)!=Math.round(o.heuresNonPayableFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresNonPayableFa,"onUpdate:modelValue":b=>o.heuresNonPayableFa=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesNonPayableFa!=null&&Math.round(o.heuresAttenduesNonPayableFa*100)!=Math.round(o.heuresNonPayableFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresNonPayableFc,"onUpdate:modelValue":b=>o.heuresNonPayableFc=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesNonPayableFc!=null&&Math.round(o.heuresAttenduesNonPayableFc*100)!=Math.round(o.heuresNonPayableFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",null,[h(u,{modelValue:o.heuresNonPayableReferentiel,"onUpdate:modelValue":b=>o.heuresNonPayableReferentiel=b,"maximum-digits":"2",tabindex:"-1",readonly:"",class:A({doutput:!0,"bg-danger":o.heuresAttenduesNonPayableReferentiel!=null&&Math.round(o.heuresAttenduesNonPayableReferentiel*100)!=Math.round(o.heuresNonPayableReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[y,r.resMode=="hetd"]]),_(t("td",Fi,[r.debug.vh&&r.debug.vh[C]?(i(),a("div",Ri,[(i(!0),a(g,null,x(r.debug.vh[C],(b,P)=>(i(),a("span",Ii,[f(d(P)+" ",1),t("span",wi,d(Math.round(b*100)/100),1)]))),256)),e[108]||(e[108]=f("  "))])):c("",!0)],512),[[y,r.resMode=="debug"]])]))),128))])]),r.resMode=="debug"&&r.debug.global?(i(),a("div",Hi,[e[110]||(e[110]=t("h4",null,"Débogage : calculs globaux",-1)),(i(!0),a(g,null,x(r.debug.global,(o,C)=>(i(),a("span",Li,[f(d(C)+" ",1),t("span",Ni,d(Math.round(o*100)/100),1)]))),256)),e[111]||(e[111]=f("  "))])):c("",!0),t("div",null,[t("a",{class:"btn btn-secondary",href:r.indexUrl},e[112]||(e[112]=[t("i",{class:"fas fa-rotate-left","aria-hidden":"true"},null,-1),f(" Retour à la liste des formules")]),8,ji)])])],64)}const qi=S(Qs,[["render",Oi],["__scopeId","data-v-060f5e4b"]]),zi=Object.freeze(Object.defineProperty({__proto__:null,default:qi},Symbol.toStringTag,{value:"Module"})),Bi={name:"TotauxHetd",props:{intervenant:{type:Number},typeVolumeHoraire:{type:Number}},data(){return{data:{types:[]},serviceLigne:""}},mounted(){this.load(),window.addEventListener("Formule/TotauxHetd.refresh",n=>{this.load()})},methods:{load(){unicaenVue.axios.get(unicaenVue.url("intervenant/formule-totaux-hetd/:intervenant/:typeVolumeHoraire",{intervenant:this.intervenant,typeVolumeHoraire:this.typeVolumeHoraire})).then(n=>{this.data=n.data.data,this.data.serviceStatutaire>0&&(this.data.serviceDu!=this.data.serviceStatutaire?this.serviceLigne="* "+this.data.serviceDu+"h de service dû en tenant compte des modifications de service":this.serviceLigne="* "+this.data.serviceStatutaire+"h de service statutaire")})},tradType(n){switch(n){case"fi":return"FI";case"fa":return"FA";case"fc":return"FC";case"enseignement":return"Enseignement";case"referentiel":return"Référentiel";case"total":return"Total";default:return n}},tradCategorie(n){switch(n){case"service":return"Service*";case"compl":return"Heures complémentaires";case"payable":return"Heures";case"non-payable":return"Non payable";case"primes":return"Primes";case"total":return"Total";default:return n}}}},Gi={class:"table table-bordered"},$i=["colspan"];function Ji(n,e,s,v,r,l){const u=E("u-heures"),p=Q,m=W;return i(),a(g,null,[r.data.types.length>0?(i(),M(m,{key:0},{default:T(()=>[h(p,{cols:"6"},{default:T(()=>[e[1]||(e[1]=t("h2",null,"Totaux en heures équivalent TD",-1)),t("table",Gi,[t("tr",null,[e[0]||(e[0]=t("th",null," ",-1)),(i(!0),a(g,null,x(r.data.types,o=>(i(),a("th",{key:o},d(l.tradType(o)),1))),128))]),(i(!0),a(g,null,x(r.data.heures,(o,C)=>(i(),a("tr",{key:C},[t("th",null,d(l.tradCategorie(C)),1),C!=="primes"?(i(!0),a(g,{key:0},x(o,(b,P)=>(i(),a("td",{class:"nombre",key:P},[h(u,{valeur:b},null,8,["valeur"])]))),128)):(i(),a("td",{key:1,class:"nombre",colspan:o.length},[h(u,{valeur:r.data.heures.primes.total},null,8,["valeur"])],8,$i))]))),128))]),f(" "+d(r.serviceLigne),1)]),_:1})]),_:1})):c("",!0),e[2]||(e[2]=t("br",null,null,-1))],64)}const Yi=S(Bi,[["render",Ji],["__scopeId","data-v-f852d328"]]),Qi=Object.freeze(Object.defineProperty({__proto__:null,default:Yi},Symbol.toStringTag,{value:"Module"})),Wi={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(n){this.formatted=this.formatage(n)}},methods:{formatage(n){if(n===void 0)return;let e=new Date(n);const s=e.getFullYear(),v=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),u=e.getMinutes().toString().padStart(2,"0"),p=e.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${r}/${v}/${s} à ${l}:${u}`;case"time":return`${l}:${u}:${p}`}return`${r}/${v}/${s}`}}};function Xi(n,e,s,v,r,l){return d(r.formatted)}const H=S(Wi,[["render",Xi]]),Ki={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(n){this.searchTerm=n.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(n){return unicaenVue.url("intervenant/code:"+n+"/voir")},reload(){var n=document.getElementById("term");n.focus(),this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(e=>{let s=e.data,v=[];for(const r in s){if(s[r].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){v.push(s[r]);continue}if(s[r].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){v.push(s[r]);continue}if(s[r].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){v.push(s[r]);continue}}this.intervenants=v,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(e=>{console.log(e.message)})},800)}}},Zi={class:"intervenant-recherche"},el={class:"critere"},tl={key:0,class:"table table-bordered table-hover"},nl=["title"],sl={style:{}},rl=["href"],il={key:1,class:"table table-bordered table-hover"};function ll(n,e,s,v,r,l){const u=H;return i(),a(g,null,[e[16]||(e[16]=t("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1)),t("div",Zi,[t("div",el,[t("div",null,[t("input",{id:"term",autofocus:"",class:"form-control input",placeholder:"votre recherche...",type:"text",onKeyup:e[0]||(e[0]=(...p)=>l.rechercher&&l.rechercher(...p))},null,32),e[7]||(e[7]=t("br",null,null,-1))]),t("div",null,[e[8]||(e[8]=t("span",{class:"fw-bold"},"Types d'intervenant : ",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=p=>r.checkedTypes=p),checked:"checked",name:"type[]",type:"checkbox",value:"permanent",onChange:e[2]||(e[2]=p=>l.reload())},null,544),[[N,r.checkedTypes]]),e[9]||(e[9]=f(" Permanent ")),_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=p=>r.checkedTypes=p),checked:"checked",name:"type[]",type:"checkbox",value:"vacataire",onChange:e[4]||(e[4]=p=>l.reload())},null,544),[[N,r.checkedTypes]]),e[10]||(e[10]=f(" Vacataire ")),_(t("input",{"onUpdate:modelValue":e[5]||(e[5]=p=>r.checkedTypes=p),checked:"checked",name:"type[]",type:"checkbox",value:"etudiant",onChange:e[6]||(e[6]=p=>l.reload())},null,544),[[N,r.checkedTypes]]),e[11]||(e[11]=f(" Etudiant "))]),e[12]||(e[12]=t("br",null,null,-1))])]),r.intervenants.length>0?(i(),a("table",tl,[e[14]||(e[14]=t("thead",null,[t("tr",null,[t("th",{style:{width:"90px"}}),t("th",null,"Civilité"),t("th",null,"Nom"),t("th",null,"Prenom"),t("th",null,"Structure"),t("th",null,"Statut"),t("th",null,"Date de naissance"),t("th",null,"N° Personnel")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(r.intervenants,(p,m)=>(i(),a("tr",{class:A({"bg-danger":p.destruction!==null}),title:p.destruction!==null?"Fiche historisé":""},[t("td",sl,[t("a",{href:l.urlFiche(p.code)},e[13]||(e[13]=[t("i",{class:"fas fa-eye"},null,-1),f(" Fiche")]),8,rl)]),t("td",null,d(p.civilite),1),t("td",null,d(p.nom),1),t("td",null,d(p.prenom),1),t("td",null,d(p.structure),1),t("td",null,d(p.statut),1),t("td",null,[h(u,{value:p["date-naissance"]},null,8,["value"])]),t("td",null,d(p["numero-personnel"]),1)],10,nl))),256))])])):c("",!0),r.intervenants.length==0&&r.noResult==1?(i(),a("table",il,e[15]||(e[15]=[t("thead",null,[t("tr",null,[t("th",{style:{width:"90px"}}),t("th",null,"Civilité"),t("th",null,"Nom"),t("th",null,"Prenom"),t("th",null,"Structure"),t("th",null,"Statut"),t("th",null,"Date de naissance"),t("th",null,"N° Personnel")])],-1),t("tbody",null,[t("tr",null,[t("td",{colspan:"8",style:{"text-align":"center"}},"Aucun intervenant trouvé")])],-1)]))):c("",!0)],64)}const al=S(Ki,[["render",ll]]),ol=Object.freeze(Object.defineProperty({__proto__:null,default:al},Symbol.toStringTag,{value:"Module"})),ul={name:"Structure",props:{structure:{required:!0}},data(){return{saisieUrl:unicaenVue.url("structure/voir/:structure",{structure:this.structure.id})+"?tab=edition",deleteUrl:unicaenVue.url("structure/delete/:structure",{structure:this.structure.id}),liste:this.$parent.liste}},computed:{hasSousStructures:function(){return Object.keys(this.structure.structures).length>0}},methods:{saisie(n){modAjax(n.currentTarget,e=>{this.refresh()})},supprimer(n){popConfirm(n.currentTarget,e=>{this.refresh()})},refresh(){this.liste.reload()}}},dl={class:"accordion-item"},ml={class:"accordion-header"},cl=["aria-controls","data-bs-target"],pl=["href"],hl=["href"],fl=["id"],bl={class:"accordion-body"},vl={class:"row"},_l={class:"col-md-5"},gl={class:"row"},yl={class:"col-md-5"},xl={class:"row"},Cl={class:"col-md-5"},Vl={key:0,class:"fas fa-check text-success"},Sl={key:1,class:"fas fa-xmark text-danger"},Pl={class:"row"},kl={class:"col-md-5"},Al={key:0,class:"fas fa-check text-success"},Dl={key:1,class:"fas fa-xmark text-danger"},Tl={class:"row"},El={class:"col-md-5"},Ml={key:0,class:"sous-structures"},Ul={class:"accordion"};function Fl(n,e,s,v,r,l){const u=E("structure",!0);return i(),a("div",dl,[t("h2",ml,[t("button",{"aria-controls":s.structure.id,"data-bs-target":`#str${s.structure.id}`,"aria-expanded":"true",class:"accordion-button","data-bs-toggle":"collapse",type:"button"},[s.structure.canEdit?(i(),a("a",{key:0,href:r.saisieUrl,class:"btn btn-primary btn-sm",title:"Modifier la structure",onClick:e[0]||(e[0]=k((...p)=>l.saisie&&l.saisie(...p),["prevent"]))},e[2]||(e[2]=[t("i",{class:"fas fa-pen-to-square"},null,-1)]),8,pl)):c("",!0),s.structure.canDelete?(i(),a("a",{key:1,href:r.deleteUrl,class:"btn btn-danger btn-sm","data-content":"Êtes-vous sûr de vouloir supprimer la structure ?","data-title":"Suppression de la structure",title:"Supprimer la structure",onClick:e[1]||(e[1]=k((...p)=>l.supprimer&&l.supprimer(...p),["prevent"]))},e[3]||(e[3]=[t("i",{class:"fas fa-trash-can"},null,-1)]),8,hl)):c("",!0),f("   "+d(s.structure.libelleLong)+" ("+d(s.structure.libelleCourt)+") ",1)],8,cl)]),t("div",{id:`str${s.structure.id}`,class:"accordion-collapse collapse show"},[t("div",bl,[t("div",vl,[e[4]||(e[4]=t("div",{class:"col-md-5"},[t("strong",null,"Code"),f(" :")],-1)),t("div",_l,d(s.structure.code),1)]),t("div",gl,[e[5]||(e[5]=t("div",{class:"col-md-5"},[t("strong",null,"Source"),f(" :")],-1)),t("div",yl,d(s.structure.source.libelle),1)]),t("div",xl,[e[6]||(e[6]=t("div",{class:"col-md-5"},[t("strong",null,"Composante d'enseignement"),f(" :")],-1)),t("div",Cl,[s.structure.enseignement?(i(),a("i",Vl)):s.structure.enseignement?c("",!0):(i(),a("i",Sl))])]),t("div",Pl,[e[7]||(e[7]=t("div",{class:"col-md-5"},[t("strong",null,"Affichage de l'adresse sur le contrat de travail"),f(" :")],-1)),t("div",kl,[s.structure.affAdresseContrat?(i(),a("i",Al)):s.structure.affAdresseContrat?c("",!0):(i(),a("i",Dl))])]),t("div",Tl,[e[8]||(e[8]=t("div",{class:"col-md-5"},[t("strong",null,"Adresse"),f(" :")],-1)),t("div",El,[t("pre",null,d(s.structure.adresse),1)])]),l.hasSousStructures?(i(),a("div",Ml,[e[9]||(e[9]=t("h4",null,"Sous-structures",-1)),t("div",Ul,[(i(!0),a(g,null,x(s.structure.structures,p=>(i(),M(u,{key:p.id,structure:p,onRefresh:l.refresh},null,8,["structure","onRefresh"]))),128))])])):c("",!0)])],8,fl)])}const re=S(ul,[["render",Fl],["__scopeId","data-v-046af32d"]]),Rl=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"})),Il={components:{structure:re},props:{canAdd:{type:Boolean,required:!0}},data(){return{structures:[],ajoutUrl:unicaenVue.url("structure/saisie"),liste:this}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},reload(){unicaenVue.axios.get(unicaenVue.url("structure/liste")).then(n=>{this.structures=n.data})}}},wl={class:"accordion no-intranavigation"},Hl=["href"];function Ll(n,e,s,v,r,l){const u=E("structure");return i(),a(g,null,[e[2]||(e[2]=t("h1",null,"Administration des structures",-1)),t("div",wl,[(i(!0),a(g,null,x(r.structures,p=>(i(),M(u,{key:p.id,structure:p},null,8,["structure"]))),128))]),s.canAdd?(i(),a("a",{key:0,class:"btn btn-primary no-intranavigation",href:r.ajoutUrl,onClick:e[0]||(e[0]=k((...p)=>l.ajout&&l.ajout(...p),["prevent"])),title:"Ajouter une structure"},e[1]||(e[1]=[t("i",{class:"fas fa-pen-to-square"},null,-1),f(" Ajouter une structure ")]),8,Hl)):c("",!0)],64)}const Nl=S(Il,[["render",Ll]]),jl=Object.freeze(Object.defineProperty({__proto__:null,default:Nl},Symbol.toStringTag,{value:"Module"})),Ol={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},ql=["id"],zl={class:"modal-dialog"},Bl={class:"modal-content"},Gl={class:"modal-header"},$l={class:"modal-title"},Jl={class:"modal-body"},Yl={class:"modal-footer"};function Ql(n,e,s,v,r,l){return i(),a("div",{class:"modal fade",id:s.id,tabindex:"-1","aria-hidden":"true"},[t("div",zl,[t("div",Bl,[t("div",Gl,[t("h5",$l,d(s.title),1),e[0]||(e[0]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",Jl,[O(n.$slots,"body")]),t("div",Yl,[O(n.$slots,"footer"),e[1]||(e[1]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1))])])])],8,ql)}const Wl=S(Ol,[["render",Ql]]),Xl={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String},rotate:{required:!1,type:String},id:{required:!1,type:String}}},Kl=["id"];function Zl(n,e,s,v,r,l){return i(),a("i",{class:A(`fas fa-${s.name} text-${s.variant} fa-rotate-${s.rotate}`),id:`${s.id}`},null,10,Kl)}const w=S(Xl,[["render",Zl]]),ea={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(n){this.validationText=this.calcValidation(n)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":'<span class="bg-info">'+Util.formattedHeures(this.mission.heures)+"</span> heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(n){return n===null?"A valider":n.id===null?"Autovalidée":"Validation du "+Util.dateToString(n.histoCreation)+" par "},saisie(n){modAjax(n.currentTarget,e=>{this.refresh()})},supprimer(n){popConfirm(n.currentTarget,e=>{this.$emit("supprimer",this.mission)})},valider(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},devalider(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},volumeHoraireSupprimer(n){n.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},volumeHoraireValider(n){n.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},volumeHoraireDevalider(n){n.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(n=>{this.$emit("refresh",n.data)})}}},ta=["id"],na={class:"card-header card-header-h3"},sa={key:0},ra={class:"float-end"},ia={key:1},la={key:2},aa={class:"float-end"},oa={class:"card-body"},ua={class:"row"},da={class:"col-md-8"},ma={class:"row"},ca={class:"col-md-12"},pa={class:"form-control"},ha={class:"row"},fa={class:"col-md-6"},ba={class:"form-control"},va={class:"col-md-6"},_a={class:"form-control"},ga={class:"col-md-7"},ya={class:"input-group mb-3"},xa=["innerHTML"],Ca=["data-bs-target"],Va={key:0,class:"col-md-5"},Sa={class:"form-control"},Pa={class:"row"},ka={class:"col-md-12"},Aa={class:"form-control"},Da={key:0,class:"row"},Ta={class:"col-md-12"},Ea={class:"form-control"},Ma={class:"row"},Ua={class:"col-md-12"},Fa=["href"],Ra=["href"],Ia=["href"],wa=["href"],Ha={class:"col-md-4"},La={class:"table table-bordered table-condensed"},Na={style:{"text-align":"right"}},ja={key:0},Oa=["data-id"],qa=["data-id"],za=["data-id"];function Ba(n,e,s,v,r,l){const u=H,p=w,m=E("utilisateur"),o=E("u-heures"),C=Wl;return i(),a(g,null,[t("div",{id:s.mission.id,class:A([{"bg-success":s.mission.valide,"bg-default":!s.mission.valide},"card"])},[t("form",{onSubmit:e[4]||(e[4]=k((...b)=>n.submitForm&&n.submitForm(...b),["prevent"]))},[t("div",na,[s.mission.libelleMission?(i(),a("h5",sa,[f(d(s.mission.libelleMission)+" ",1),t("span",ra,[e[8]||(e[8]=f("Du ")),h(u,{value:s.mission.dateDebut},null,8,["value"]),e[9]||(e[9]=f(" au ")),h(u,{value:s.mission.dateFin},null,8,["value"])])])):c("",!0),s.mission.libelleMission?(i(),a("h6",ia,d(s.mission.typeMission.libelle),1)):c("",!0),s.mission.libelleMission?c("",!0):(i(),a("h5",la,[f(d(s.mission.typeMission.libelle)+" ",1),t("span",aa,[e[10]||(e[10]=f("Du ")),h(u,{value:s.mission.dateDebut},null,8,["value"]),e[11]||(e[11]=f(" au ")),h(u,{value:s.mission.dateFin},null,8,["value"])])]))]),t("div",oa,[t("div",ua,[t("div",da,[t("div",ma,[t("div",ca,[e[12]||(e[12]=t("label",{class:"form-label"},"Composante en charge du suivi",-1)),t("div",pa,d(s.mission.structure.libelle),1)])]),t("div",ha,[t("div",fa,[e[13]||(e[13]=t("label",{class:"form-label"},"Taux de rémunération",-1)),t("div",ba,d(s.mission.tauxRemu?s.mission.tauxRemu.libelle:null),1)]),t("div",va,[e[14]||(e[14]=t("label",{class:"form-label"},"Taux majoré (dimanches/jours fériés)",-1)),t("div",_a,d(s.mission.tauxRemuMajore?s.mission.tauxRemuMajore.libelle:s.mission.tauxRemu?"Idem ("+s.mission.tauxRemu.libelle+")":null),1)]),t("div",ga,[e[15]||(e[15]=t("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),t("div",ya,[t("div",{class:"form-control",innerHTML:l.heuresLib},null,8,xa),t("button",{"data-bs-target":`#details-${s.mission.id}`,class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal"}," Détails ",8,Ca)])]),s.mission.typeMission.besoinFormation?(i(),a("div",Va,[e[16]||(e[16]=t("label",{class:"form-label"},"Heures de formation prévues",-1)),t("div",Sa,d(s.mission.heuresFormation),1)])):c("",!0)]),t("div",Pa,[t("div",ka,[e[17]||(e[17]=t("label",{class:"form-label"},"Descriptif de la mission",-1)),t("div",Aa,d(s.mission.description),1)])]),s.mission.typeMission.accompagnementEtudiants?(i(),a("div",Da,[t("div",Ta,[e[18]||(e[18]=t("label",{class:"form-label"},"Etudiants suivis",-1)),t("div",Ea,[t("pre",null,d(s.mission.etudiantsSuivis),1)])])])):c("",!0),e[19]||(e[19]=t("div",{class:"row"},[t("div",{class:"col-md-12"}," ")],-1)),t("div",Ma,[t("div",Ua,[s.mission.canSaisie?(i(),a("a",{key:0,href:r.saisieUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=k((...b)=>l.saisie&&l.saisie(...b),["prevent"]))},"Modifier",8,Fa)):c("",!0),s.mission.canValider?(i(),a("a",{key:1,href:r.validerUrl,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider la mission ?","data-title":"Validation de la mission",onClick:e[1]||(e[1]=k((...b)=>l.valider&&l.valider(...b),["prevent"]))},"Valider",8,Ra)):c("",!0),s.mission.canDevalider?(i(),a("a",{key:2,href:r.devaliderUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider la mission ?","data-title":"Dévalidation de la mission",onClick:e[2]||(e[2]=k((...b)=>l.devalider&&l.devalider(...b),["prevent"]))},"Dévalider",8,Ia)):c("",!0),s.mission.canSupprimer?(i(),a("a",{key:3,href:r.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer la mission ?","data-title":"Suppression de la mission",onClick:e[3]||(e[3]=k((...b)=>l.supprimer&&l.supprimer(...b),["prevent"]))},"Supprimer",8,wa)):c("",!0)])])]),t("div",Ha,[e[22]||(e[22]=t("div",null,[t("label",{class:"form-label"},"Suivi")],-1)),t("div",null,[h(p,{name:"thumbs-up",variant:"success"}),e[20]||(e[20]=f(" Créé le ")),h(u,{value:s.mission.histoCreation},null,8,["value"]),e[21]||(e[21]=f(" par ")),h(m,{mail:s.mission.histoCreateur.email,nom:s.mission.histoCreateur.displayName},null,8,["mail","nom"])]),t("div",null,[h(p,{name:s.mission.valide?"thumbs-up":"thumbs-down",variant:s.mission.valide?"success":"info"},null,8,["name","variant"]),f(" "+d(r.validationText)+" ",1),s.mission.validation&&s.mission.validation.histoCreateur?(i(),M(m,{key:0,mail:s.mission.validation.histoCreateur.email,nom:s.mission.validation.histoCreateur.displayName},null,8,["mail","nom"])):c("",!0)]),t("div",null,[h(p,{name:s.mission.contrat?"thumbs-up":"thumbs-down",variant:s.mission.contrat?"success":"info"},null,8,["name","variant"]),f(" "+d(s.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),t("div",null,d(s.mission.heuresRealisees)+" heure"+d(s.mission.heuresRealisees<2?"":"s")+" réalisée"+d(s.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,ta),h(C,{id:`details-${s.mission.id}`,title:"Détail des heures prévisionnelles"},{body:T(()=>[t("table",La,[e[28]||(e[28]=t("thead",null,[t("tr",null,[t("th",null,"Heures"),t("th",null,"Statut"),t("th",null,"Actions")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(s.mission.volumesHorairesPrevus,b=>(i(),a("tr",{key:b.id},[t("td",Na,[h(o,{valeur:b.heures},null,8,["valeur"])]),t("td",null,[h(p,{name:"thumbs-up",variant:"success"}),e[25]||(e[25]=f(" Saisi par ")),h(m,{mail:b.histoCreateur.email,nom:b.histoCreateur.displayName},null,8,["mail","nom"]),e[26]||(e[26]=f(" le ")),h(u,{value:b.histoCreation},null,8,["value"]),e[27]||(e[27]=t("br",null,null,-1)),h(p,{name:b.valide?"thumbs-up":"thumbs-down",variant:b.valide?"success":"info"},null,8,["name","variant"]),f(" "+d(b.validation&&b.validation.id==null?"Autovalidé":b.validation?"":"à valider")+" ",1),b.validation&&b.validation.histoCreateur?(i(),a("span",ja,[e[23]||(e[23]=f(" Validé par ")),h(m,{mail:b.validation.histoCreateur.email,nom:b.validation.histoCreateur.displayName},null,8,["mail","nom"]),e[24]||(e[24]=f(" le ")),h(u,{value:b.validation.histoCreation},null,8,["value"])])):c("",!0)]),t("td",null,[b.canValider?(i(),a("a",{key:0,"data-id":b.id,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?","data-title":"Validation du volume horaire",onClick:e[5]||(e[5]=k((...P)=>l.volumeHoraireValider&&l.volumeHoraireValider(...P),["prevent"]))},"Valider",8,Oa)):c("",!0),b.canDevalider?(i(),a("a",{key:1,"data-id":b.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?","data-title":"Dévalidation du volume horaire",onClick:e[6]||(e[6]=k((...P)=>l.volumeHoraireDevalider&&l.volumeHoraireDevalider(...P),["prevent"]))},"Dévalider",8,qa)):c("",!0),b.canSupprimer?(i(),a("a",{key:2,"data-id":b.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?","data-title":"Suppression du volume horaire",onClick:e[7]||(e[7]=k((...P)=>l.volumeHoraireSupprimer&&l.volumeHoraireSupprimer(...P),["prevent"]))},"Supprimer",8,za)):c("",!0)])]))),128))])])]),footer:T(()=>e[29]||(e[29]=[])),_:1},8,["id"])],64)}const ie=S(ea,[["render",Ba],["__scopeId","data-v-1735108d"]]),Ga=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),$a={components:{mission:ie},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],isMounted:!1,ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},supprimer(n){this.reload()},refresh(n){let e=Util.json.indexById(this.missions,n.id);this.missions[e]=n,this.refreshPlafonds()},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(n=>{this.missions=n.data,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?($(".plafonds").refresh(),$("#sidebar").refresh()):this.isMounted=!0}}},Ja=["href"];function Ya(n,e,s,v,r,l){const u=E("mission");return i(),a(g,null,[(i(!0),a(g,null,x(r.missions,p=>(i(),M(u,{onSupprimer:l.supprimer,onRefresh:l.refresh,key:p.id,mission:p},null,8,["onSupprimer","onRefresh","mission"]))),128)),s.canAddMission?(i(),a("a",{key:0,class:"btn btn-primary",href:r.ajoutUrl,onClick:e[0]||(e[0]=k((...p)=>l.ajout&&l.ajout(...p),["prevent"]))},"Ajout d'une nouvelle mission",8,Ja)):c("",!0)],64)}const Qa=S($a,[["render",Ya]]),Wa=Object.freeze(Object.defineProperty({__proto__:null,default:Qa},Symbol.toStringTag,{value:"Module"})),Xa={name:"ListeCandidatures.vue",props:{intervenant:{required:!0},canValiderCandidature:{type:Boolean,required:!1},canRefuserCandidature:{type:Boolean,required:!1},renseignerDonneesPersonnelles:{type:Boolean,required:!1}},data(){return{candidatures:[],urlListeOffre:unicaenVue.url("offre-emploi")}},mounted(){this.reload()},computed:{urlDonneesPersonnelles:function(){return unicaenVue.url("intervenant/:intervenant/dossier",{intervenant:this.intervenant})}},methods:{reload(){unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/get-candidatures",{intervenant:this.intervenant})).then(n=>{this.candidatures=n.data})},validerCandidature(n){modAjax(n.currentTarget,e=>{this.reload()})},refuserCandidature(n){popConfirm(n.target,e=>{this.reload()})},urlOffre(n){return unicaenVue.url("offre-emploi/detail/:offre",{offre:n.offre.id})},urlAccepterCandidature:function(n){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:n.id})},urlRefuserCandidature:function(n){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:n.id})}}},Ka={key:0,class:"alert alert-primary",role:"alert"},Za=["href"],eo={class:"table table-bordered"},to={key:0},no={key:0},so={key:0,colspan:"5",style:{"text-align":"center"}},ro={style:{"text-align":"center"}},io=["href"],lo={style:{"text-align":"center"}},ao={style:{"text-align":"center"}},oo={key:0,class:"badge rounded-pill bg-success"},uo={key:1,class:"badge rounded-pill bg-danger"},mo={key:2,class:"badge rounded-pill bg-warning"},co={key:0,style:{"text-align":"center"}},po=["href"],ho=["href"],fo=["href"];function bo(n,e,s,v,r,l){const u=H,p=w;return i(),a("div",null,[this.renseignerDonneesPersonnelles?(i(),a("div",Ka,[e[2]||(e[2]=f(" Afin que vos candidatures soient étudiées, veuillez compléter ")),t("a",{href:this.urlDonneesPersonnelles},"vos données personnelles",8,Za),e[3]||(e[3]=f(" et fournir les pièces justificatives qui vous seront demandées. "))])):c("",!0),t("table",eo,[t("thead",null,[t("tr",null,[e[4]||(e[4]=t("th",null,"Offre d'emploi",-1)),e[5]||(e[5]=t("th",null,"Composante",-1)),e[6]||(e[6]=t("th",null,"Etat",-1)),e[7]||(e[7]=t("th",null,"Date commission",-1)),s.canValiderCandidature||s.canRefuserCandidature?(i(),a("th",to,"Action")):c("",!0)])]),t("tbody",null,[r.candidatures.length==0?(i(),a("tr",no,[s.canValiderCandidature?(i(),a("td",so,"Aucune candidature")):c("",!0)])):c("",!0),(i(!0),a(g,null,x(r.candidatures,m=>(i(),a("tr",{key:m.id},[t("td",ro,[t("a",{href:l.urlOffre(m)},d(m.offre.titre),9,io)]),t("td",lo,d(m.offre.structure.libelleCourt),1),t("td",ao,[m.validation?(i(),a("span",oo,"Acceptée par "+d(m.validation.histoCreateur.displayName),1)):c("",!0),!m.validation&&m.motif!==null?(i(),a("span",uo,d(m.motif),1)):c("",!0),!m.validation&&m.motif===null?(i(),a("span",mo,"En attente d'acceptation")):c("",!0)]),t("td",null,[m.dateCommission?(i(),M(u,{key:0,value:m.dateCommission},null,8,["value"])):c("",!0)]),this.canValiderCandidature||this.canRefuserCandidature?(i(),a("td",co,[!m.validation&&this.canValiderCandidature?(i(),a("a",{key:0,href:l.urlAccepterCandidature(m),class:"btn btn-success","data-content":"Êtes vous sûr de vouloir accepter cette candidature ?","data-title":"Accepter la candidature",style:{color:"white"},title:"Accepter la candidature",onClick:e[0]||(e[0]=k((...o)=>l.validerCandidature&&l.validerCandidature(...o),["prevent"]))},e[8]||(e[8]=[t("i",{class:"fa-solid fa-check"},null,-1)]),8,po)):c("",!0),e[10]||(e[10]=f("  ")),this.canRefuserCandidature?(i(),a("a",{key:1,href:l.urlRefuserCandidature(m),class:"btn btn-danger","data-content":"Êtes vous sûr de vouloir refuser cette candidature ?","data-title":"Refuser la candidature",style:{color:"white"},title:"Refuser la candidature",onClick:e[1]||(e[1]=k((...o)=>l.refuserCandidature&&l.refuserCandidature(...o),["prevent"]))},e[9]||(e[9]=[t("i",{class:"fa-sharp fa-solid fa-xmark"},null,-1)]),8,ho)):c("",!0)])):c("",!0)]))),128))])]),t("a",{href:r.urlListeOffre,class:"btn btn-primary",title:"Voir les offres d'emploi"},[h(p,{name:"eye"}),e[11]||(e[11]=f(" Voir toutes les offres d'emploi "))],8,fo),e[12]||(e[12]=f("  "))])}const vo=S(Xa,[["render",bo]]),_o=Object.freeze(Object.defineProperty({__proto__:null,default:vo},Symbol.toStringTag,{value:"Module"})),go={name:"OffreEmploi.vue",props:{offre:{required:!0},utilisateur:{required:!1},extended:{type:Boolean,required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},decretText:{type:String,required:!1}},data(){return{saisirUrl:unicaenVue.url("offre-emploi/saisir/:offre",{offre:this.offre.id}),supprimerUrl:unicaenVue.url("offre-emploi/supprimer/:offre",{offre:this.offre.id}),validerUrl:unicaenVue.url("offre-emploi/valider/:offre",{offre:this.offre.id}),devaliderUrl:unicaenVue.url("offre-emploi/devalider/:offre",{offre:this.offre.id}),consulterUrl:unicaenVue.url("offre-emploi/detail/:offre",{offre:this.offre.id}),offreEmploiUrl:unicaenVue.url("offre-emploi"),postulerUrl:unicaenVue.url("offre-emploi/postuler/:id",{id:this.offre.id}),decret:!1}},computed:{isCandidat:function(){return!1},shortDesc:function(){if(!this.offre.description)return"";let n=this.offre.description.substr(0,200);return this.offre.description.length>200&&(n+="..."),n},descriptionHtml:function(){return this.offre.description?this.offre.description.replace(/(?:\r\n|\r|\n)/g,"<br />"):""},connectionLink:function(){let n="auth/connexion?redirect="+window.location.href;return unicaenVue.url(n)}},mounted(){this.decretText||(this.decret=!0)},methods:{saisir(n){modAjax(n.target,e=>{this.refresh()})},urlVoir:function(n){return unicaenVue.url("intervenant/:code/voir",{code:"code:"+n.intervenant.code})},urlVoirCandidature:function(n){return unicaenVue.url("intervenant/:code/candidature",{code:"code:"+n.intervenant.code})},urlAccepterCandidature:function(n){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:n.id})},urlRefuserCandidature:function(n){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:n.id})},refresh(){unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.offre.id})).then(n=>{this.$emit("refresh",n.data)})},supprimer(n){popConfirm(n.target,e=>{this.$emit("supprimer",this.offre)})},postuler(n){popConfirm(n.target,e=>{this.$emit("postuler",this.offre)})},valider(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},devalider(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},validerCandidature(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})},refuserCandidature(n){popConfirm(n.currentTarget,e=>{this.$emit("refresh",e.data)})}}},yo={key:0,class:"col"},xo={class:"card h-100"},Co={class:"card-header"},Vo={class:"badge rounded-pill bg-info"},So={key:0,class:"badge rounded-pill bg-success"},Po={key:1,class:"badge rounded-pill bg-warning"},ko={class:"card-body"},Ao={class:"bg-light",style:{padding:"5px"}},Do={class:"card-footer"},To={class:"d-grid gap-2 d-md-flex justify-content-md-end"},Eo=["href"],Mo={key:1},Uo={class:"page-header"},Fo={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},Ro={class:"ms-2"},Io=["href"],wo={key:1,class:"alert alert-primary d-flex align-items-center",role:"alert"},Ho={key:2,class:"alert alert-primary d-flex align-items-center",role:"alert"},Lo={class:"bg-light",style:{padding:"10px"}},No=["innerHTML"],jo={key:3,class:"alert alert-info"},Oo=["innerHTML"],qo={key:4},zo={class:"table table-bordered"},Bo={key:0},Go={key:0},$o={key:0,colspan:"4",style:{"text-align":"center"}},Jo={key:1,colspan:"3",style:{"text-align":"center"}},Yo=["href"],Qo={key:0,class:"badge rounded-pill bg-success"},Wo={key:1,class:"badge rounded-pill bg-danger"},Xo={key:2,class:"badge rounded-pill bg-warning"},Ko={key:0},Zo=["href"],eu={class:"mt-5"},tu=["href"],nu=["href"],su=["href"],ru=["href"],iu=["href"],lu=["href"];function au(n,e,s,v,r,l){const u=H,p=w;return i(),a(g,null,[this.extended?c("",!0):(i(),a("div",yo,[t("div",xo,[t("div",Co,[t("h4",null,d(s.offre.titre),1),t("span",Vo,d(s.offre.nombreHeures)+" heure(s)",1),e[6]||(e[6]=f("   ")),s.offre.validation?(i(),a("span",So,[e[5]||(e[5]=f("Validée le ")),h(u,{value:s.offre.validation.histoCreation},null,8,["value"]),f(" par "+d(s.offre.validation.histoCreateur.displayName),1)])):c("",!0),s.offre.validation?c("",!0):(i(),a("span",Po," En attente de validation par la DRH")),e[7]||(e[7]=f("  "))]),t("div",ko,[t("p",Ao,[e[8]||(e[8]=t("b",null,"Créée le : ",-1)),h(u,{value:s.offre.histoCreation},null,8,["value"]),f(" par "+d(s.offre.histoCreateur.displayName),1),e[9]||(e[9]=t("br",null,null,-1)),e[10]||(e[10]=t("b",null,"Période à pourvoir : ",-1)),e[11]||(e[11]=f("du ")),h(u,{value:s.offre.dateDebut},null,8,["value"]),e[12]||(e[12]=f(" au ")),h(u,{value:s.offre.dateFin},null,8,["value"]),e[13]||(e[13]=t("br",null,null,-1)),e[14]||(e[14]=t("b",null,"Demandée par la composante :",-1)),f(" "+d(s.offre.structure.libelleCourt)+" ",1),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=t("b",null,"Type de mission :",-1)),f(" "+d(s.offre.typeMission.libelle),1)]),f(" "+d(l.shortDesc),1)]),t("div",Do,[t("div",To,[t("a",{href:r.consulterUrl,class:"btn btn-primary",title:"Consulter "},[h(p,{name:"eye"}),e[17]||(e[17]=f(" Voir "))],8,Eo)])])])])),this.extended?(i(),a("div",Mo,[t("h1",Uo,d(s.offre.titre),1),this.utilisateur?c("",!0):(i(),a("div",Fo,[e[20]||(e[20]=t("i",{class:"fa-solid fa-user"},null,-1)),t("div",Ro,[e[18]||(e[18]=f(" Vous devez ")),t("a",{href:l.connectionLink,class:"text-decoration-underline alert-link"},"être identifé",8,Io),e[19]||(e[19]=f(" pour pouvoir postuler. "))])])),!s.offre.canPostuler&&this.utilisateur?(i(),a("div",wo,e[21]||(e[21]=[t("i",{class:"fa-solid fa-circle-xmark"},null,-1),t("div",{class:"ms-2"}," Vous n'avez pas les droits pour postuler à cette offre, merci de contacter votre administration de rattachement. ",-1)]))):c("",!0),l.isCandidat&&this.utilisateur?(i(),a("div",Ho,e[22]||(e[22]=[t("i",{class:"fa-solid fa-circle-xmark"},null,-1),t("div",{class:"ms-2"}," Vous avez déjà postulé à cette offre. ",-1)]))):c("",!0),t("p",Lo,[e[23]||(e[23]=t("b",null,"Créée le : ",-1)),h(u,{value:s.offre.histoCreation},null,8,["value"]),f(" par "+d(s.offre.histoCreateur.displayName),1),e[24]||(e[24]=t("br",null,null,-1)),e[25]||(e[25]=t("b",null,"Période à pourvoir : ",-1)),e[26]||(e[26]=f("du ")),h(u,{value:s.offre.dateDebut},null,8,["value"]),e[27]||(e[27]=f(" au ")),h(u,{value:s.offre.dateFin},null,8,["value"]),e[28]||(e[28]=t("br",null,null,-1)),e[29]||(e[29]=t("b",null,"Date limite de candidature :",-1)),h(u,{value:s.offre.dateLimite},null,8,["value"]),e[30]||(e[30]=t("br",null,null,-1)),e[31]||(e[31]=t("b",null,"Demandé par la composante :",-1)),f(" "+d(s.offre.structure.libelleCourt)+" ",1),e[32]||(e[32]=t("br",null,null,-1)),e[33]||(e[33]=t("b",null,"Type de mission :",-1)),f(" "+d(s.offre.typeMission.libelle)+" ",1),e[34]||(e[34]=t("br",null,null,-1)),e[35]||(e[35]=t("b",null,"Nombre d'heures pour la mission :",-1)),f(" "+d(s.offre.nombreHeures)+" heure(s) ",1),e[36]||(e[36]=t("br",null,null,-1)),e[37]||(e[37]=t("b",null,"Nombre de postes à pourvoir :",-1)),f(" "+d(s.offre.nombrePostes)+" poste(s) ",1),e[38]||(e[38]=t("br",null,null,-1))]),t("p",{innerHTML:this.descriptionHtml},null,8,No),this.decretText?(i(),a("p",jo,[_(t("input",{id:"decret","onUpdate:modelValue":e[0]||(e[0]=m=>r.decret=m),name:"decret",type:"checkbox"},null,512),[[N,r.decret]]),e[39]||(e[39]=f("  ")),t("span",{innerHTML:this.decretText},null,8,Oo)])):c("",!0),e[54]||(e[54]=t("br",null,null,-1)),this.canVoirCandidature?(i(),a("div",qo,[e[44]||(e[44]=t("h5",null,[t("strong",null,"Liste des candidats :")],-1)),t("table",zo,[t("thead",null,[t("tr",null,[e[40]||(e[40]=t("th",null,"Intervenant",-1)),e[41]||(e[41]=t("th",null,"Etat",-1)),s.canValiderCandidature?(i(),a("th",Bo,"Action")):c("",!0)])]),t("tbody",null,[s.offre.candidatures.length==0?(i(),a("tr",Go,[s.canValiderCandidature?(i(),a("td",$o,"Aucune candidature")):c("",!0),s.canValiderCandidature?c("",!0):(i(),a("td",Jo,"Aucune candidature"))])):c("",!0),(i(!0),a(g,null,x(s.offre.candidatures,m=>(i(),a("tr",null,[t("td",null,[t("a",{href:l.urlVoir(m)},d(m.intervenant.prenom+" "+m.intervenant.nomUsuel),9,Yo)]),t("td",null,[m.validation?(i(),a("span",Qo,[e[42]||(e[42]=f("Acceptée le ")),h(u,{value:m.validation.histoCreation},null,8,["value"]),f(" par "+d(m.validation.histoCreateur.displayName),1)])):c("",!0),!m.validation&&m.motif!==null?(i(),a("span",Wo,d(m.motif),1)):c("",!0),!m.validation&&m.motif===null?(i(),a("span",Xo,"En attente d'acceptation")):c("",!0)]),this.canValiderCandidature?(i(),a("td",Ko,[t("a",{href:l.urlVoirCandidature(m),class:"btn btn-primary",title:"Consulter "},[h(p,{name:"eye"}),e[43]||(e[43]=f(" Voir "))],8,Zo)])):c("",!0)]))),256))])])])):c("",!0),t("div",eu,[t("a",{href:r.offreEmploiUrl,class:"btn btn-secondary"},"Retour aux offres",8,tu),e[49]||(e[49]=f("  ")),this.canPostuler?(i(),a("a",{key:0,class:A([r.decret?"":"disabled","btn btn-primary"]),href:r.postulerUrl,"data-bs-original-title":"Vous devez être connecté pour postuler","data-bs-placement":"top","data-bs-toggle":"tooltip"},"Postuler",10,nu)):c("",!0),e[50]||(e[50]=f("  ")),s.offre.canModifier?(i(),a("a",{key:1,href:r.saisirUrl,class:"btn btn-primary",title:"Modifier",onClick:e[1]||(e[1]=k((...m)=>l.saisir&&l.saisir(...m),["prevent"]))},[h(p,{name:"pen-to-square"}),e[45]||(e[45]=f(" Modifier "))],8,su)):c("",!0),e[51]||(e[51]=f("  ")),s.offre.validation&&s.offre.canValider?(i(),a("a",{key:2,href:r.devaliderUrl,class:"btn btn-danger",title:"Devalider",onClick:e[2]||(e[2]=k((...m)=>l.devalider&&l.devalider(...m),["prevent"]))},[h(p,{name:"thumbs-down"}),e[46]||(e[46]=f(" Devalider "))],8,ru)):c("",!0),e[52]||(e[52]=f("  ")),!s.offre.validation&&s.offre.canValider?(i(),a("a",{key:3,href:r.validerUrl,class:"btn btn-success",title:"Valider",onClick:e[3]||(e[3]=k((...m)=>l.valider&&l.valider(...m),["prevent"]))},[h(p,{name:"thumbs-up"}),e[47]||(e[47]=f(" Valider "))],8,iu)):c("",!0),e[53]||(e[53]=f("  ")),s.offre.canSupprimer?(i(),a("a",{key:4,href:r.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer l'offre ?","data-title":"Suppression de l'offre",title:"Supprimer",onClick:e[4]||(e[4]=k((...m)=>l.supprimer&&l.supprimer(...m),["prevent"]))},[h(p,{name:"trash"}),e[48]||(e[48]=f(" Supprimer "))],8,lu)):c("",!0)])])):c("",!0)],64)}const le=S(go,[["render",au]]),ou=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"})),uu={components:{offreEmploi:le},props:{id:{type:Number,required:!1},utilisateur:{required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1}},data(){return{offres:[],ajoutUrl:unicaenVue.url("offre-emploi/saisir")}},mounted(){this.reload()},computed:{extended:function(){return!!this.id}},methods:{ajout(n){modAjax(n.target,e=>{this.reload()})},supprimer(){window.location.href=unicaenVue.url("offre-emploi")},refresh(n){let e=Util.json.indexById(this.offres,n.id);this.offres[e]=n},reload(){this.id?unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.id})).then(n=>{this.offres=[n.data]}):unicaenVue.axios.get(unicaenVue.url("offre-emploi/liste")).then(n=>{this.offres=n.data})}}},du={key:0,class:"row row-cols-1 row-cols-md-2 g-4 mb-3"},mu={key:1},cu=["href"],pu={key:2};function hu(n,e,s,v,r,l){const u=E("offreEmploi");return i(),a(g,null,[l.extended?c("",!0):(i(),a("div",du,[(i(!0),a(g,null,x(r.offres,p=>(i(),M(u,{key:p.id,canModifier:this.canModifier,canSupprimer:this.canSupprimer,canValider:this.canValider,canVoirCandidature:this.canVoirCandidature,offre:p,decretText:p.decretText,onRefresh:l.refresh,onSupprimer:l.supprimer},null,8,["canModifier","canSupprimer","canValider","canVoirCandidature","offre","decretText","onRefresh","onSupprimer"]))),128))])),l.extended?c("",!0):(i(),a("div",mu,[this.canModifier?(i(),a("a",{key:0,href:r.ajoutUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=k((...p)=>l.ajout&&l.ajout(...p),["prevent"]))},"Ajouter une nouvelle offre",8,cu)):c("",!0)])),l.extended?(i(),a("div",pu,[(i(!0),a(g,null,x(r.offres,p=>(i(),M(u,{key:p.id,canModifier:this.canModifier,canPostuler:this.canPostuler,canSupprimer:this.canSupprimer,canValider:this.canValider,canValiderCandidature:this.canValiderCandidature,canVoirCandidature:this.canVoirCandidature,decretText:p.decretText,extended:l.extended,offre:p,utilisateur:this.utilisateur,onRefresh:l.refresh,onSupprimer:l.supprimer},null,8,["canModifier","canPostuler","canSupprimer","canValider","canValiderCandidature","canVoirCandidature","decretText","extended","offre","utilisateur","onRefresh","onSupprimer"]))),128))])):c("",!0)],64)}const fu=S(uu,[["render",hu]]),bu=Object.freeze(Object.defineProperty({__proto__:null,default:fu},Symbol.toStringTag,{value:"Module"})),vu={name:"Prime.vue",props:{prime:{required:!0},numero:{required:!1},intervenant:{required:!0},canGerer:{type:Boolean,required:!1}},data(){return{declarationUrl:unicaenVue.url("prime/:intervenant/declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerUrl:unicaenVue.url("prime/:intervenant/supprimer-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),validerUrl:unicaenVue.url("prime/:intervenant/valider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),devaliderUrl:unicaenVue.url("prime/:intervenant/devalider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),telechargerUrl:unicaenVue.url("prime/:intervenant/telecharger-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),refuserUrl:unicaenVue.url("prime/:intervenant/refuser-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),modifierPrimeUrl:unicaenVue.url("prime/:intervenant/saisie/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerPrimeUrl:unicaenVue.url("prime/:intervenant/supprimer-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id})}},computed:{},methods:{supprimer(n){popConfirm(n.target,e=>{this.$emit("reload")})},valider(n){popConfirm(n.target,e=>{this.$emit("reload")})},devalider(n){popConfirm(n.target,e=>{this.$emit("reload")})},refuser(){unicaenVue.axios.post(this.refuserUrl).then(n=>{this.$emit("reload")})},modifierPrime(n){modAjax(n.currentTarget,e=>{this.$emit("reload")})},supprimerPrime(n){popConfirm(n.target,e=>{this.$emit("reload")})}}},_u={key:0},gu={key:0},yu=["action"],xu={class:"card-body"},Cu={class:"row"},Vu={key:0,class:"col-md-6"},Su={class:"card text-dark bg-light"},Pu={class:"card-body"},ku=["disabled"],Au={class:"card-footer d-grid gap-2"},Du=["disabled"],Tu={key:1,class:"col-md-6"},Eu={class:"card text-dark bg-light"},Mu={class:"card-body"},Uu=["href"],Fu={class:"card-footer",style:{"text-align":"right"}},Ru=["href"],Iu=["href"],wu=["href"],Hu={class:"col-md-6"},Lu={key:0},Nu=["checked","disabled"],ju={key:0},Ou={key:1},qu={key:2},zu={key:3},Bu={key:4},Gu={key:5},$u={key:6},Ju={class:"row"},Yu={class:"col-md-12"},Qu={class:"float-end"},Wu=["href"],Xu=["href"];function Ku(n,e,s,v,r,l){const u=H,p=w;return i(),a("div",{class:A([{"bg-success":s.prime.validation,"bg-default":!s.prime.validation&&!s.prime.dateRefus,"bg-danger":s.prime.dateRefus},"card"])},[t("div",{class:A([{"text-white":s.prime.dateRefus},"card-header card-header-h3"])},[s.prime.id?(i(),a("h5",_u,[f(" Indemnité de fin de contrat N°"+d(s.numero+1),1),e[6]||(e[6]=t("br",null,null,-1))])):c("",!0),t("div",null,[e[9]||(e[9]=t("u",null,"Mission(s) concernée(s)",-1)),e[10]||(e[10]=f(" : ")),(i(!0),a(g,null,x(s.prime.missions,(m,o)=>(i(),a("span",null,[f(d(m.typeMission.libelle)+" (Pour "+d(m.structure.libelleCourt)+" du ",1),h(u,{value:m.dateDebut},null,8,["value"]),e[7]||(e[7]=f(" au ")),h(u,{value:m.dateFin},null,8,["value"]),e[8]||(e[8]=f(") ")),o!=s.prime.missions.length-1?(i(),a("span",gu,", ")):c("",!0)]))),256))])],2),t("form",{action:r.declarationUrl,enctype:"multipart/form-data",method:"post"},[t("div",xu,[t("div",Cu,[s.prime.declaration?c("",!0):(i(),a("div",Vu,[t("div",Su,[e[12]||(e[12]=t("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1)),t("div",Pu,[e[11]||(e[11]=t("p",{class:"card-text"},[f(" Pour "),t("b",null,"bénéficier de votre indemnité de fin de contrat"),f(", vous devez déposer une déclaration sur l'honneur ("),t("a",{href:""},"exemple"),f(") signée précisant que vous ne débutez pas d'autre contrat dans la fonction au publique à la suite de ces missions. ")],-1)),t("input",{ref:"file",disabled:!!s.prime.dateRefus,name:"files[]",type:"file"},null,8,ku)]),t("div",Au,[t("input",{disabled:!!s.prime.dateRefus,class:"btn btn-primary",type:"submit",value:"Envoyer"},null,8,Du)])])])),s.prime.declaration?(i(),a("div",Tu,[t("div",Eu,[e[17]||(e[17]=t("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1)),t("div",Mu,[e[13]||(e[13]=t("p",{class:"card-text"},"Vous pouvez télécharger votre déclaration sur l'honneur ci-dessous : ",-1)),t("a",{href:r.telechargerUrl},d(s.prime.declaration.nom),9,Uu)]),t("div",Fu,[s.prime.declaration&&!s.prime.validation&&!s.prime.dateRefus?(i(),a("a",{key:0,href:r.supprimerUrl,class:"btn btn-danger",title:"Supprimer",onClick:e[0]||(e[0]=k((...m)=>l.supprimer&&l.supprimer(...m),["prevent"]))}," Supprimer ",8,Ru)):c("",!0),e[14]||(e[14]=f("  ")),s.prime.declaration&&!s.prime.validation&&this.canGerer&&!s.prime.dateRefus?(i(),a("a",{key:1,href:r.validerUrl,class:"btn btn-success",title:"Valider",onClick:e[1]||(e[1]=k((...m)=>l.valider&&l.valider(...m),["prevent"]))}," Valider ",8,Iu)):c("",!0),e[15]||(e[15]=f("  ")),s.prime.declaration&&s.prime.validation&&this.canGerer&&!s.prime.dateRefus?(i(),a("a",{key:2,href:r.devaliderUrl,class:"btn btn-danger d-grid gap-2",title:"Dévalider",onClick:e[2]||(e[2]=k((...m)=>l.devalider&&l.devalider(...m),["prevent"]))}," Dévalider ",8,wu)):c("",!0),e[16]||(e[16]=f("  "))])])])):c("",!0),t("div",Hu,[s.prime.validation?c("",!0):(i(),a("div",Lu,[t("input",{checked:s.prime.dateRefus,disabled:s.prime.validation,name:"prime",type:"checkbox",onChange:e[3]||(e[3]=(...m)=>l.refuser&&l.refuser(...m))},null,40,Nu),e[18]||(e[18]=f("  Ou en cochant cette case, ")),e[19]||(e[19]=t("b",null,"je déclare ne pas pouvoir bénéficier d'une indemnité",-1)),e[20]||(e[20]=f(" de fin de contrat en raison du démarrage d'un nouveau contrat au sein de la fonction publique à la suite de ces missions. ")),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=t("br",null,null,-1))])),t("div",null,[e[30]||(e[30]=t("div",null,[t("label",{class:"form-label"},"Suivi de la déclaration : ")],-1)),s.prime.dateRefus?(i(),a("div",ju,[h(p,{name:"thumbs-down",variant:"danger"}),e[23]||(e[23]=f(" Indemnité refusée le ")),h(u,{value:s.prime.dateRefus},null,8,["value"])])):c("",!0),s.prime.declaration&&!s.prime.dateRefus?(i(),a("div",Ou,[h(p,{name:"thumbs-up",variant:"success"}),e[24]||(e[24]=f(" Déclaration déposée le ")),h(u,{value:s.prime.declaration.histoCreation},null,8,["value"]),f(" par "+d(s.prime.declaration.histoCreateur.displayName),1)])):c("",!0),!s.prime.declaration&&!s.prime.dateRefus?(i(),a("div",qu,[h(p,{name:"thumbs-down",variant:"info"}),e[25]||(e[25]=f(" Aucune déclaration déposée "))])):c("",!0),s.prime.validation&&!s.prime.dateRefus?(i(),a("div",zu,[h(p,{name:"thumbs-up",variant:"success"}),e[26]||(e[26]=f(" Déclaration validée le ")),h(u,{value:s.prime.validation.histoCreation},null,8,["value"]),f(" par "+d(s.prime.validation.histoCreateur.displayName),1)])):c("",!0),!s.prime.validation&&!s.prime.dateRefus?(i(),a("div",Bu,[h(p,{name:"thumbs-down",variant:"info"}),e[27]||(e[27]=f(" Aucune déclaration validée "))])):c("",!0),s.prime.validation&&!s.prime.dateRefus?(i(),a("div",Gu,[h(p,{name:"euro-sign",variant:"success"}),e[28]||(e[28]=f(" Intervenant éligible à une indemnité de fin de contrat "))])):c("",!0),s.prime.dateRefus?(i(),a("div",$u,[h(p,{name:"euro-sign",variant:"info"}),e[29]||(e[29]=f(" Intervenant non éligible à une indemnité de fin de contrat "))])):c("",!0)])])]),t("div",Ju,[t("div",Yu,[t("span",Qu,[!s.prime.validation&&!s.prime.dateRefus&&this.canGerer?(i(),a("a",{key:0,href:r.modifierPrimeUrl,class:"btn btn-primary",onClick:e[4]||(e[4]=k((...m)=>l.modifierPrime&&l.modifierPrime(...m),["prevent"]))},"Modifier",8,Wu)):c("",!0),e[31]||(e[31]=f("   ")),!s.prime.validation&&!s.prime.dateRefus&&this.canGerer?(i(),a("a",{key:1,href:r.supprimerPrimeUrl,class:"btn btn-danger",onClick:e[5]||(e[5]=k((...m)=>l.supprimerPrime&&l.supprimerPrime(...m),["prevent"]))},"Supprimer",8,Xu)):c("",!0)])])])])],8,yu)],2)}const ae=S(vu,[["render",Ku]]),Zu=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"})),ed={components:{prime:ae},props:{intervenant:{type:Number,required:!0},numero:{type:Number,required:!1},missionsWithoutPrime:{type:Number,required:!1},canGerer:{type:Boolean,required:!1}},data(){return{load:!1,primes:[],ajoutUrl:unicaenVue.url("prime/:intervenant/saisie/",{intervenant:this.intervenant})}},mounted(){this.reload(),console.log(this.primes.length)},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},reload(){this.load=!1,this.primes=[],unicaenVue.axios.get(unicaenVue.url("prime/:intervenant/liste",{intervenant:this.intervenant})).then(n=>{this.primes=n.data,this.load=!0})}}},td={key:0,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},nd={key:1,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},sd={key:2},rd=["href"];function id(n,e,s,v,r,l){const u=E("prime");return i(),a(g,null,[(i(!0),a(g,null,x(r.primes,(p,m)=>(i(),M(u,{canGerer:s.canGerer,intervenant:this.intervenant,numero:m,prime:p,onReload:l.reload},null,8,["canGerer","intervenant","numero","prime","onReload"]))),256)),r.load?c("",!0):(i(),a("div",td,e[1]||(e[1]=[f(" Chargement en cours..."),t("br",null,null,-1),t("br",null,null,-1)]))),r.primes.length==0&&r.load?(i(),a("div",nd,e[2]||(e[2]=[f(" Aucune indemnité de fin de contrat actuellement..."),t("br",null,null,-1),t("br",null,null,-1)]))):c("",!0),this.missionsWithoutPrime>0&&this.canGerer?(i(),a("div",sd,[t("a",{href:r.ajoutUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=k((...p)=>l.ajout&&l.ajout(...p),["prevent"]))},"Créer une nouvelle indemnité",8,rd)])):c("",!0)],64)}const ld=S(ed,[["render",id]]),ad=Object.freeze(Object.defineProperty({__proto__:null,default:ld},Symbol.toStringTag,{value:"Module"})),od={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0},addDateDebut:{type:String,required:!1},addDateFin:{type:String,required:!1}},data(){const n=new Date(this.date);return{mois:n.getMonth()+1,annee:n.getFullYear()}},computed:{listeJours(){const n=new Date(this.date);n.setDate(1),n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1);let e=n.getDate();return Array.from({length:e},(s,v)=>v+1)}},watch:{date:function(n,e){const s=new Date(this.date);this.mois=s.getMonth()+1,this.annee=s.getFullYear()},mois:function(n,e){const s=new Date(this.date);s.setMonth(n-1),this.$emit("changeDate",s)},annee:function(n,e){const s=new Date(this.date);s.setFullYear(n),this.$emit("changeDate",s)}},methods:{nomJour(n){const e=new Date(this.date);return e.setDate(n),e.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let n=[];const e=new Date;for(let s=1;s<=12;s++){e.setMonth(s-1);let v=e.toLocaleString("fr-FR",{month:"long"});n.push({id:s,libelle:v})}return n},listeAnnees(){const e=new Date().getFullYear(),s=1;let v=[];for(let r=e-s;r<=e+s;r++)v.push(r);return v},canAdd(n){if(!this.canAddEvent)return!1;let e=this.addDateDebut;e===void 0?e=new Date("2000-01-01"):e==="now"?e=new Date:e=new Date(e);let s=this.addDateFin;s===void 0?s=new Date("2500-01-01"):s==="now"?s=new Date:s=new Date(s);let v=new Date(this.date);return v.setDate(n),e=this.isoDateOnly(e),s=this.isoDateOnly(s),v=this.isoDateOnly(v),!(v<e||v>s)},addEvent(n){const e=new Date(this.date);e.setDate(n.currentTarget.dataset.jour),this.$emit("addEvent",e,n)},prevMois(){const n=new Date(this.date);n.setMonth(n.getMonth()-1),this.$emit("changeDate",n)},nextMois(){const n=new Date(this.date);n.setMonth(n.getMonth()+1),this.$emit("changeDate",n)},eventsByJour(n){const e=new Date(this.date);let s={};for(let v in this.events){let r=this.events[v];r.date.getFullYear()===e.getFullYear()&&r.date.getMonth()+1===e.getMonth()+1&&r.date.getDate()===n&&(s[v]=r)}return s},isoDateOnly(n){const e=n.getFullYear(),s=String(n.getMonth()+1).padStart(2,"0"),v=String(n.getDate()).padStart(2,"0");return`${e}-${s}-${v}`}}},ud={class:"calendar"},dd={class:"recherche"},md={class:"recherche btn-group"},cd=["value"],pd=["value"],hd={class:"table table-bordered table-hover table-sm"},fd=["data-jour"],bd={class:"nom-jour"},vd={class:"numero-jour"},_d={class:"num-jour badge bg-secondary rounded-circle"},gd={key:0},yd=["data-jour"];function xd(n,e,s,v,r,l){const u=w;return i(),a("div",ud,[t("div",dd,[t("div",md,[t("button",{class:"btn btn-light",id:"prevMois",onClick:e[0]||(e[0]=(...p)=>l.prevMois&&l.prevMois(...p)),title:"Mois précédant"},[h(u,{name:"chevron-left"})]),_(t("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":e[1]||(e[1]=p=>r.mois=p)},[(i(!0),a(g,null,x(l.listeMois(),p=>(i(),a("option",{value:p.id},d(p.libelle),9,cd))),256))],512),[[R,r.mois]]),_(t("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":e[2]||(e[2]=p=>r.annee=p)},[(i(!0),a(g,null,x(l.listeAnnees(),p=>(i(),a("option",{value:p},d(p),9,pd))),256))],512),[[R,r.annee]]),t("button",{class:"btn btn-light",id:"nextMois",onClick:e[3]||(e[3]=(...p)=>l.nextMois&&l.nextMois(...p)),title:"Mois suivant"},[h(u,{name:"chevron-right"})])])]),t("table",hd,[(i(!0),a(g,null,x(l.listeJours,p=>(i(),a("tr",{"data-jour":p},[t("th",bd,d(l.nomJour(p)),1),t("th",vd,[t("div",_d,d(p<10?"0"+p.toString():p),1)]),t("td",null,[(i(!0),a(g,null,x(l.eventsByJour(p),(m,o)=>(i(),a("div",{class:"event",style:q("border-color:"+m.color+";background-color:"+m.bgcolor),key:o},[(i(),M(fe(m.component),{event:m},null,8,["event"]))],4))),128)),l.canAdd(p)?(i(),a("div",gd,[t("button",{onClick:e[4]||(e[4]=(...m)=>l.addEvent&&l.addEvent(...m)),"data-jour":p,class:"btn btn-light btn-sm"},[h(u,{name:"plus"}),e[5]||(e[5]=f(" Nouvel événement "))],8,yd)])):c("",!0)])],8,fd))),256))])])}const Cd=S(od,[["render",xd],["__scopeId","data-v-0606e4c1"]]),Vd={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(n){modAjax(n.currentTarget,e=>{this.suivi.refresh()})},supprimer(n){popConfirm(n.currentTarget,e=>{this.suivi.refresh()})},valider(n){unicaenVue.axios.get(this.validerUrl).then(e=>{this.suivi.refresh()})},devalider(n){popConfirm(n.currentTarget,e=>{this.suivi.refresh()})}}},Sd={class:"event-content"},Pd={class:"mission"},kd={key:0,class:"badge bg-success"},Ad={class:"horaires"},Dd={key:0,class:"badge bg-secondary"},Td={key:0,class:"description"},Ed={class:"event-actions"},Md={class:"btn-group btn-group-sm"},Ud=["data-url"],Fd=["data-url"],Rd=["data-url"],Id=["data-url"];function wd(n,e,s,v,r,l){const u=w;return i(),a(g,null,[t("div",Sd,[t("p",Pd,[f(d(s.event.mission.libelleCourt)+" ",1),s.event.valide?(i(),a("span",kd,"Validé")):c("",!0)]),t("p",Ad,[f(" de "+d(l.heureDebut)+" à "+d(l.heureFin)+", soit "+d(l.heures)+" heure"+d(l.heures<2?"":"s")+" ",1),s.event.formation?(i(),a("span",Dd,"En formation")):c("",!0)]),s.event.description?(i(),a("p",Td,d(s.event.description),1)):c("",!0)]),t("div",Ed,[t("div",Md,[s.event.canEdit?(i(),a("button",{key:0,class:"btn btn-light",onClick:e[0]||(e[0]=(...p)=>l.modifier&&l.modifier(...p)),title:"Modifier le suivi","data-url":r.modifierUrl},[h(u,{name:"pen-to-square"})],8,Ud)):c("",!0),s.event.canValider?(i(),a("button",{key:1,class:"btn btn-light",onClick:e[1]||(e[1]=(...p)=>l.valider&&l.valider(...p)),title:"Valider le suivi","data-url":r.validerUrl},[h(u,{name:"check",class:"text-success"})],8,Fd)):c("",!0),s.event.canDevalider?(i(),a("button",{key:2,class:"btn btn-light",onClick:e[2]||(e[2]=(...p)=>l.devalider&&l.devalider(...p)),title:"Dévalider le suivi","data-url":r.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[h(u,{name:"xmark",class:"text-danger"})],8,Rd)):c("",!0),s.event.canSupprimer?(i(),a("button",{key:3,class:"btn btn-light",onClick:e[3]||(e[3]=(...p)=>l.supprimer&&l.supprimer(...p)),title:"Supprimer le suivi","data-url":r.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[h(u,{name:"trash-can",class:"text-danger"})],8,Id)):c("",!0)])])],64)}const oe=S(Vd,[["render",wd],["__scopeId","data-v-17cb1f29"]]),Hd=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),Ld={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,isMounted:!1,suivi:[]}},methods:{changeDate(n){this.date=n},ajouter(n,e){const s={intervenant:this.intervenant,date:n.toISOString().slice(0,10)};e.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",s),modAjax(e.currentTarget,v=>{this.refresh()})},refresh(){const n=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let e=0,s=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(v=>{let r=[];for(let l in v.data){let u=v.data[l];s[u.mission.id]===void 0&&(s[u.mission.id]=n[e],e++),u.valide&&(u.bgcolor="#d0eddb"),u.color=s[u.mission.id],u.component=be(oe),u.date=new Date(u.date),u.intervenant=this.intervenant,r.push(u)}this.suivi=r,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?$(".plafonds").refresh():this.isMounted=!0}}};function Nd(n,e,s,v,r,l){const u=Cd;return i(),M(u,{date:r.date,onChangeDate:l.changeDate,onAddEvent:l.ajouter,"can-add-event":s.canAddMission,addDateFin:"now",events:r.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const jd=S(Ld,[["render",Nd]]),Od=Object.freeze(Object.defineProperty({__proto__:null,default:jd},Symbol.toStringTag,{value:"Module"})),qd={name:"DemandeMiseEnPaiementStructure",props:{datas:{required:!0},intervenant:{required:!0}},data(){return{dotationPaieEtat:this.datas.budget.dotation.paieEtat,dotationRessourcesPropres:this.datas.budget.dotation.ressourcePropre,consommationPaieEtat:this.datas.budget.liquidation.paieEtat,consommationRessourcesPropres:this.datas.budget.liquidation.ressourcePropre}},watch:{datas:function(){this.dotationPaieEtat=this.datas.budget.dotation.paieEtat,this.dotationRessourcesPropres=this.datas.budget.dotation.ressourcePropre,this.consommationPaieEtat=this.datas.budget.liquidation.paieEtat,this.consommationRessourcesPropres=this.datas.budget.liquidation.ressourcePropre}},computed:{pourcentagePaieEtat(){return Math.round(this.consommationPaieEtat/this.dotationPaieEtat*100)},pourcentageRessourcePropre(){return Math.round(this.consommationRessourcesPropres/this.dotationRessourcesPropres*100)},bgPaieEtat(){return Math.round(this.consommationPaieEtat/this.dotationPaieEtat*100)>100?"bg-warning":"bg-success"},bgRessourcesPropres(){return Math.round(this.consommationRessourcesPropres/this.dotationRessourcesPropres*100)>100?"bg-warning":"bg-success"}},methods:{heuresStatutToString(n){if(n.heuresAPayer==n.heuresPayees&&n.heuresAPayer>0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-success">Paiement effectué</span>';if(n.heuresAPayer==n.heuresDemandees)return'<span style="font-size:12px;line-height:20px;" class="badge bg-secondary text-dark">Paiement demandé</span>';if(n.heuresDemandees==0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-light text-dark">A payer</span>';if(Number(n.heuresPayees)>Number(n.heuresAPayer)){let e=n.heuresPayees-n.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement effectué - '+parseFloat(e.toFixed(2))+" hetd(s) payées en trop. </span>"}if(Number(n.heuresDemandees)>Number(n.heuresAPayer)){let e=n.heuresDemandees-n.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement demandé - '+parseFloat(e.toFixed(2))+" hetd(s) demandées en trop. </span></span>"}return"indetermine"},supprimerDemandeMiseEnPaiement(n){this.btnState("remove-"+n,"disabled"),unicaenVue.axios.get(unicaenVue.url("paiement/:intervenant/supprimer-demande/:dmep",{intervenant:this.intervenant,dmep:n})).then(e=>{this.$emit("refresh")}).catch(e=>{this.$emit("refresh")})},disabledPaiement(n){return n.missionId!=""||n.formuleResServiceRefId!=""?!(n.centreCoutId&&n.domaineFonctionnel):!1},enabledPaiement(n,e){if(e=="mission"){let s=document.getElementById("add-"+n),v=document.getElementById("centreCout-"+n).value,r=document.getElementById("domaineFonctionnel-"+n).value;v!=""&&r!=""?s.disabled=!1:s.disabled=!0}},ajouterDemandeMiseEnPaiement(n){this.btnState("add-"+n,"disabled");let e={animation:!0,delay:15e3,autohide:!0},s=document.getElementById("heures-"+n),v=document.getElementById("centreCout-"+n),r=document.getElementById("domaineFonctionnel-"+n),l=Number(s.value),u=Number(s.getAttribute("max")),p=r?r.value:"",m=s.hasAttribute("data-type-heures-id")?s.getAttribute("data-type-heures-id"):"",o=s.hasAttribute("data-service-id")?s.getAttribute("data-service-id"):"",C=s.hasAttribute("data-service-referentiel-id")?s.getAttribute("data-service-referentiel-id"):"",b=s.hasAttribute("data-mission-id")?s.getAttribute("data-mission-id"):"",P=v.value,V=v.options[v.selectedIndex].getAttribute("data-ressources-propres"),F=v.options[v.selectedIndex].getAttribute("data-paie-etat");if(P=="")return unicaenVue.flashMessenger.toast("Vous devez sélectionner un centre de coût pour demander la mise en paiement de ces heures","error",e),this.btnResetState(),!1;if(l>0&&l>u)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible, vous demandez "+l+" hetd(s) alors que vous pouvez demander maximum "+u+" hetd(s)","error",e),this.btnResetState(),!1;if(F==1&&this.dotationPaieEtat>0&&this.dotationPaieEtat-(this.consommationPaieEtat+l)<=0)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible manque de dotation 'paie etat' pour ces heures","error",e),this.btnResetState(),!1;if(V==1&&this.dotationRessourcesPropres>0&&this.dotationRessourcesPropres-(this.consommationRessourcesPropres+l)<=0)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible manque de dotation 'ressources propres' pour ces heures","error",e),this.btnResetState(),!1;var D=[];let I={heures:l,centreCoutId:P,typeHeuresId:m,serviceId:o,serviceReferentielId:C,domaineFonctionnelId:p,missionId:b,structureId:this.datas.id};D.push(I),unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),D).then(L=>{this.$emit("refresh")}).catch(L=>{this.$emit("refresh"),console.error(L)})},demanderToutesLesHeuresEnPaiement(n,e){this.btnState("add-all-"+n,"disabled");let s=[],r=document.getElementById("demande-mise-en-paiement-"+n).getElementsByTagName("tr");for(var l=0;l<r.length;l++)if(r[l].getElementsByTagName("input").length>0&&r[l].classList.contains("detailHeure")){let u=r[l].getElementsByTagName("input")[0],p=r[l].getElementsByTagName("select")[0],m=r[l].getElementsByTagName("select")[1],o=Number(u.value),C=Number(u.getAttribute("max"));if(o<=0||o>C)console.warn("Le nombre d'heures demandées en paiement n'est pas situé entre le max et min possible.");else{let b=p.value,P=u.hasAttribute("data-type-heures-id")?u.getAttribute("data-type-heures-id"):"",V=u.hasAttribute("data-mission-id")?u.getAttribute("data-mission-id"):"",F=u.hasAttribute("data-service-id")?u.getAttribute("data-service-id"):"",D=u.hasAttribute("data-service-referentiel-id")?u.getAttribute("data-service-referentiel-id"):"",I=m?m.value:"",L={heures:o,centreCoutId:b,typeHeuresId:P,serviceId:F,serviceReferentielId:D,domaineFonctionnelId:I,missionId:V,structureId:this.datas.id};s.push(L)}}unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),s).then(u=>{this.$emit("refresh")}).catch(u=>{this.$emit("refresh")})},filtrerCentresCouts(n,e){let s=[];for(var v in n){let r=v,l=[];n[v].forEach(function(u,p){u[e]==1&&l.push(u)}),l.length!=0&&s.push({group:r,child:l})}return s},notValueCentreCoutValue(n,e){return this.filtrerCentresCouts(n,e).length!=0?"Choisir un centre de coût":"Aucun centre de coût disponible demande de paiement impossible"},totalHeure(n){let e=0;for(var s in n)e+=Number(n[s].heuresAPayer);return parseFloat(e.toFixed(2))},shorten(n,e=20){if(n.length>e){var s='<span title="'+n+'"';return s+='data-bs-placement="top" data-bs-toggle="tooltip">',s+=n.substring(0,e)+"...",s+="</span>",s}else return n},btnState(n,e){let s=document.getElementById(n);return s?(e=="enabled"&&(s.disabled=!1,s.querySelector("#waiting").style.display="none",s.querySelector("#action").style.display="inline-block"),e=="disabled"&&(s.disabled=!0,s.querySelector("#waiting").style.display="inline-block",s.querySelector("#action").style.display="none"),!0):!1},formatDate(n,e){return Util.dateToString(n)}}},zd=["id"],Bd=["id"],Gd=["aria-controls","data-bs-target"],$d=["id","aria-labelledby"],Jd={class:"accordion-body"},Yd={key:0},Qd={class:"container"},Wd={class:"table table-bordered caption-top"},Xd={style:{width:"50%"}},Kd={key:0,class:"text-center progress position-relative bg-secondary",style:{height:"30px"}},Zd={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},em=["aria-valuemax","aria-valuenow","title"],tm={key:1,class:"text-center"},nm={style:{width:"50%"}},sm={key:0,class:"progress position-relative bg-secondary",style:{height:"30px"}},rm={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},im=["aria-valuemax","aria-valuenow","title"],lm={key:1,class:"text-center"},am={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},om=["innerHTML"],um={class:"container"},dm={class:"row"},mm={class:"col-12"},cm={class:"table mt-3 table-bordered"},pm={class:"table-light"},hm={colspan:"2"},fm={colspan:"2"},bm={class:"table table-sm"},vm={class:"detailHeure"},_m={key:0,style:{width:"20%"}},gm=["title"],ym={class:"number number-positif"},xm=["title"],Cm={class:"number number-positif"},Vm={key:1,style:{width:"20%"}},Sm={class:"input-group col-1"},Pm=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],km={key:2},Am=["id"],Dm={value:""},Tm=["label"],Em=["data-paie-etat","data-ressources-propres","selected","value"],Mm=["innerHTML"],Um=["innerHTML"],Fm={style:{"font-size":"12px"}},Rm={key:0},Im=["id","onClick"],wm={key:1},Hm=["id","onClick"],Lm={class:"table-light"},Nm={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},jm={class:"container"},Om={class:"row"},qm={class:"col-12"},zm={class:"table mt-3 table-bordered"},Bm={colspan:"2"},Gm={class:"table table-sm"},$m={class:"detailHeure"},Jm={key:0,style:{width:"20%"}},Ym=["title"],Qm={class:"number number-positif"},Wm=["title"],Xm={class:"number number-positif"},Km={key:1,style:{width:"20%"}},Zm={class:"input-group col-1"},ec=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],tc={key:2},nc=["id"],sc={value:""},rc=["label"],ic=["data-paie-etat","data-ressources-propres","selected","value"],lc=["innerHTML"],ac={key:4},oc=["id"],uc=["selected","value"],dc={key:5},mc=["innerHTML"],cc={style:{"font-size":"12px"}},pc={key:0},hc=["id","onClick"],fc={key:1},bc=["id","onClick"],vc={class:"table-light"},_c={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},gc={class:"container"},yc={class:"row"},xc={class:"col-12"},Cc={class:"table mt-3 table-bordered"},Vc={colspan:"2"},Sc={class:"table table-sm"},Pc={class:"detailHeure"},kc={key:0,style:{width:"20%"}},Ac=["title"],Dc={class:"number number-positif"},Tc=["title"],Ec={class:"number number-positif"},Mc={key:1,style:{width:"20%"}},Uc={class:"input-group col-1"},Fc=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],Rc={key:2},Ic=["id","onChange"],wc={value:""},Hc=["label"],Lc=["data-paie-etat","data-ressources-propres","selected","value"],Nc=["innerHTML"],jc={key:4},Oc=["id","onChange"],qc=["selected","value"],zc={key:5},Bc=["innerHTML"],Gc={style:{"font-size":"12px"}},$c={key:0},Jc=["id","onClick"],Yc={key:1},Qc=["id","onClick"],Wc={class:"table-light"},Xc={style:{"background-color":"#fbfbfb",padding:"10px","padding-right":"40px","text-align":"right"}},Kc=["id"];function Zc(n,e,s,v,r,l){const u=w;return i(),a("div",{id:"demande-mise-en-paiement-"+s.datas.code,class:"accordion-item"},[t("h2",{id:"dmep-heading-"+s.datas.code,class:"accordion-header"},[t("button",{"aria-controls":"dmep-collapse-"+s.datas.code,"data-bs-target":"#dmep-collapse-"+s.datas.code,"aria-expanded":"true",class:"accordion-button bg-light","data-bs-toggle":"collapse",type:"button"},d(s.datas.code+" - "+s.datas.libelle),9,Gd)],8,Bd),t("div",{id:"dmep-collapse-"+s.datas.code,"aria-labelledby":"dmep-heading-"+s.datas.code,class:"accordion-collapse collapse show"},[t("div",Jd,[this.dotationPaieEtat+r.dotationRessourcesPropres>0?(i(),a("div",Yd,[e[2]||(e[2]=t("div",{class:"cartridge gray bordered",style:{"padding-bottom":"5px","margin-bottom":"20px"}},[t("span",null,"Budget")],-1)),t("div",Qd,[t("table",Wd,[e[1]||(e[1]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-bold",scope:"col"},"Paie état"),t("th",{class:"fw-bold",scope:"col"},"Ressources propres")])],-1)),t("tbody",null,[t("tr",null,[t("td",Xd,[this.dotationPaieEtat>0?(i(),a("div",Kd,[t("span",Zd,d(this.consommationPaieEtat+" sur "+this.dotationPaieEtat)+" HETD",1),t("div",{"aria-valuemax":this.dotationPaieEtat,"aria-valuenow":this.consommationPaieEtat,class:A("progress-bar progress-bar-striped "+this.bgPaieEtat),style:q("width:"+this.pourcentagePaieEtat+"%;"),title:this.pourcentagePaieEtat+"%","aria-valuemin":"0",role:"progressbar"},null,14,em)])):c("",!0),this.dotationPaieEtat==0?(i(),a("div",tm," Aucune dotation paie état ")):c("",!0)]),t("td",nm,[this.dotationRessourcesPropres>0?(i(),a("div",sm,[t("span",rm,d(this.consommationRessourcesPropres+" sur "+this.dotationRessourcesPropres)+" HETD",1),t("div",{"aria-valuemax":this.dotationRessourcesPropres,"aria-valuenow":this.consommationRessourcesPropres,class:A("progress-bar progress-bar-striped "+this.bgRessourcesPropres),style:q("width:"+this.pourcentageRessourcePropre+"%;"),title:this.pourcentageRessourcePropre+"%","aria-valuemin":"0",role:"progressbar"},null,14,im)])):c("",!0),this.dotationRessourcesPropres==0?(i(),a("div",lm," Aucune dotation ressources propres ")):c("",!0)])])])])])])):c("",!0),(i(!0),a(g,null,x(s.datas.etapes,(p,m)=>(i(),a("div",null,[(i(!0),a(g,null,x(p.enseignements,(o,C)=>(i(),a("div",null,[t("div",am,[e[3]||(e[3]=t("span",null,"Enseignement",-1)),t("span",{innerHTML:l.shorten(p.libelle,50)},null,8,om),t("span",null,d(o.libelle),1)]),t("div",um,[t("div",dm,[(i(!0),a(g,null,x(o.typeHeure,(b,P)=>(i(),a("div",mm,[t("table",cm,[t("thead",pm,[t("tr",null,[t("th",hm,d(b.libelle),1)])]),t("tbody",null,[t("tr",null,[t("td",fm,[t("table",bm,[e[5]||(e[5]=t("thead",null,[t("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"Heures"),t("th",{scope:"col",style:{width:"40%","font-size":"12px"}},"Centre de coûts"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"État"),t("th",{style:{width:"15%","font-size":"12px"}})],-1)),t("tbody",null,[(i(!0),a(g,null,x(b.heures,(V,F)=>(i(),a("tr",vm,[V.heuresDemandees!=0?(i(),a("td",_m,[V.datePaiement?(i(),a("abbr",{key:0,title:"Payé en "+V.periodeLibelle+" le "+l.formatDate(V.datePaiement)},[t("span",ym,d(Number(V.heuresPayees))+" hetd(s)",1)],8,gm)):c("",!0),V.datePaiement?c("",!0):(i(),a("abbr",{key:1,title:"Demandé le "+l.formatDate(V.dateDemande)},[t("span",Cm,d(Number(V.heuresDemandees))+" hetd(s)",1)],8,xm))])):c("",!0),V.heuresDemandees==0?(i(),a("td",Vm,[t("div",Sm,[t("input",{id:"heures-"+m+"-"+C+"-"+P,"data-domaine-fonctionnel-id":V.domaineFonctionnelId,"data-mission-id":V.missionId,"data-service-id":V.serviceId,"data-service-referentiel-id":V.serviceReferentielId,"data-type-heures-id":V.typeHeureId,max:V.heuresAPayer,value:V.heuresAPayer,class:"form-control form-control-sm",min:"0",type:"number"},null,8,Pm),e[4]||(e[4]=t("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1))])])):c("",!0),V.heuresDemandees==0?(i(),a("td",km,[t("select",{id:"centreCout-"+m+"-"+C+"-"+P,class:"selectpicker","data-live-search":"true",name:"centreCout"},[t("option",Dm,d(l.notValueCentreCoutValue(s.datas.centreCoutPaiement,V.typeHeureCode)),1),(i(!0),a(g,null,x(l.filtrerCentresCouts(s.datas.centreCoutPaiement,V.typeHeureCode),D=>(i(),a("optgroup",{key:D.group,label:D.group},[(i(!0),a(g,null,x(D.child,I=>(i(),a("option",{key:I.value,"data-paie-etat":I.paieEtat,"data-ressources-propres":I.ressourcesPropres,selected:I.centreCoutId==V.centreCout.centreCoutId,value:I.centreCoutId},d(I.centreCoutCode+" - "+I.centreCoutLibelle),9,Em))),128))],8,Tm))),128))],8,Am)])):c("",!0),V.heuresDemandees!=0?(i(),a("td",{key:3,innerHTML:l.shorten(V.centreCout.code+" - "+V.centreCout.libelle,30)},null,8,Mm)):c("",!0),t("td",{innerHTML:l.heuresStatutToString(V)},null,8,Um),t("td",Fm,[V.heuresPayees==0&&V.heuresDemandees>0?(i(),a("span",Rm,[t("button",{id:"remove-"+V.mepId,class:"btn btn-danger",type:"button",onClick:D=>this.supprimerDemandeMiseEnPaiement(V.mepId)},[h(u,{id:"action",name:"trash",style:{color:"white"}}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,Im)])):c("",!0),V.heuresDemandees==0?(i(),a("span",wm,[t("button",{id:"add-"+m+"-"+C+"-"+P,class:"btn btn-primary",type:"button",onClick:D=>this.ajouterDemandeMiseEnPaiement(m+"-"+C+"-"+P)},[h(u,{id:"action",name:"plus"}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,Hm)])):c("",!0)])]))),256))])])])])]),t("tfoot",null,[t("tr",Lm,[e[6]||(e[6]=t("th",{scope:"row"},"Total heures à payer",-1)),t("td",null,d(l.totalHeure(b.heures))+" hetd(s)",1)])])])]))),256))])])]))),256))]))),256)),(i(!0),a(g,null,x(s.datas.fonctionsReferentiels,(p,m)=>(i(),a("div",null,[t("div",Nm,[e[7]||(e[7]=t("span",null,"Référentiel",-1)),t("span",null,d(p.libelle),1)]),t("div",jm,[t("div",Om,[t("div",qm,[t("table",zm,[t("tbody",null,[t("tr",null,[t("td",Bm,[t("table",Gm,[e[10]||(e[10]=t("thead",null,[t("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de coûts"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel "),t("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"État"),t("th",{style:{width:"15%","font-size":"12px"}})],-1)),t("tbody",null,[(i(!0),a(g,null,x(p.heures,(o,C)=>(i(),a("tr",$m,[o.heuresDemandees!=0?(i(),a("td",Jm,[o.datePaiement?(i(),a("abbr",{key:0,title:"Payé en "+o.periodeLibelle+" le "+l.formatDate(o.datePaiement)},[t("span",Qm,d(Number(o.heuresPayees))+" hetd(s)",1)],8,Ym)):c("",!0),o.datePaiement?c("",!0):(i(),a("abbr",{key:1,title:"Demandé le "+l.formatDate(o.dateDemande)},[t("span",Xm,d(Number(o.heuresDemandees))+" hetd(s)",1)],8,Wm))])):c("",!0),o.heuresDemandees==0?(i(),a("td",Km,[t("div",Zm,[t("input",{id:"heures-"+m,"data-domaine-fonctionnel-id":o.domaineFonctionnelId,"data-mission-id":o.missionId,"data-service-id":o.serviceId,"data-service-referentiel-id":o.serviceReferentielId,"data-type-heures-id":o.typeHeureId,max:o.heuresAPayer,value:o.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,ec),e[8]||(e[8]=t("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1))])])):c("",!0),o.heuresDemandees==0?(i(),a("td",tc,[t("select",{id:"centreCout-"+m,class:"selectpicker","data-live-search":"true",name:"centreCout"},[t("option",sc,d(l.notValueCentreCoutValue(s.datas.centreCoutPaiement,o.typeHeureCode)),1),(i(!0),a(g,null,x(l.filtrerCentresCouts(s.datas.centreCoutPaiement,"referentiel"),b=>(i(),a("optgroup",{key:b.group,label:b.group},[(i(!0),a(g,null,x(b.child,P=>(i(),a("option",{key:P.value,"data-paie-etat":P.paieEtat,"data-ressources-propres":P.ressourcesPropres,selected:P.centreCoutId==o.centreCout.centreCoutId,value:P.centreCoutId},d(P.centreCoutCode+" - "+P.centreCoutLibelle),9,ic))),128))],8,rc))),128))],8,nc)])):c("",!0),o.heuresDemandees!=0?(i(),a("td",{key:3,innerHTML:l.shorten(o.centreCout.code+" - "+o.centreCout.libelle,20)},null,8,lc)):c("",!0),o.heuresDemandees==0?(i(),a("td",ac,[t("select",{id:"domaineFonctionnel-"+m,class:"selectpicker","data-live-search":"true",name:"centreCout"},[e[9]||(e[9]=t("option",{value:""},"Aucun domaine fonctionnel",-1)),(i(!0),a(g,null,x(s.datas.domaineFonctionnelPaiement,b=>(i(),a("option",{selected:b.domaineFonctionnelId==o.domaineFonctionnel.domaineFonctionnelId,value:b.domaineFonctionnelId},d(b.domaineFonctionnelLibelle),9,uc))),256))],8,oc)])):c("",!0),o.heuresDemandees!=0?(i(),a("td",dc,d(o.domaineFonctionnel.libelle),1)):c("",!0),t("td",{innerHTML:l.heuresStatutToString(o)},null,8,mc),t("td",cc,[o.heuresPayees==0&&o.heuresDemandees>0?(i(),a("span",pc,[t("button",{id:"remove-"+o.mepId,class:"btn btn-danger",type:"button",onClick:b=>this.supprimerDemandeMiseEnPaiement(o.mepId)},[h(u,{id:"action",name:"trash",style:{color:"white"}}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,hc)])):c("",!0),o.heuresDemandees==0?(i(),a("span",fc,[t("button",{id:"add-"+m,class:"btn btn-primary",type:"button",onClick:b=>this.ajouterDemandeMiseEnPaiement(m)},[h(u,{id:"action",name:"plus"}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,bc)])):c("",!0)])]))),256))])])])])]),t("tfoot",null,[t("tr",vc,[e[11]||(e[11]=t("th",{scope:"row"},"Total",-1)),t("td",null,d(l.totalHeure(p.heures))+" hetd(s)",1)])])])])])])]))),256)),(i(!0),a(g,null,x(s.datas.missions,p=>(i(),a("div",null,[t("div",_c,[e[12]||(e[12]=t("span",null,"Mission",-1)),t("span",null,d(p.libelle),1)]),t("div",gc,[t("div",yc,[t("div",xc,[t("table",Cc,[t("tbody",null,[t("tr",null,[t("td",Vc,[t("table",Sc,[e[15]||(e[15]=t("thead",null,[t("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de coûts"),t("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel "),t("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"État"),t("th",{style:{width:"15%","font-size":"12px"}})],-1)),t("tbody",null,[(i(!0),a(g,null,x(p.heures,(m,o)=>(i(),a("tr",Pc,[m.heuresDemandees!=0?(i(),a("td",kc,[m.datePaiement?(i(),a("abbr",{key:0,title:"Payé en "+m.periodeLibelle+" le "+l.formatDate(m.datePaiement)},[t("span",Dc,d(Number(m.heuresPayees))+" heure(s)",1)],8,Ac)):c("",!0),m.datePaiement?c("",!0):(i(),a("abbr",{key:1,title:"Demandé le "+l.formatDate(m.dateDemande)},[t("span",Ec,d(Number(m.heuresDemandees))+" heure(s)",1)],8,Tc))])):c("",!0),m.heuresDemandees==0?(i(),a("td",Mc,[t("div",Uc,[t("input",{id:"heures-"+p.missionId,"data-domaine-fonctionnel-id":m.domaineFonctionnelId,"data-mission-id":m.missionId,"data-service-id":m.serviceId,"data-service-referentiel-id":m.serviceReferentielId,"data-type-heures-id":m.typeHeureId,max:m.heuresAPayer,value:m.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,Fc),e[13]||(e[13]=t("span",{class:"input-group-text",style:{"font-size":"12px"}},"heure(s)",-1))])])):c("",!0),m.heuresDemandees==0?(i(),a("td",Rc,[t("select",{id:"centreCout-"+p.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:C=>l.enabledPaiement(p.missionId,"mission")},[t("option",wc,d(l.notValueCentreCoutValue(s.datas.centreCoutPaiement,m.typeHeureCode)),1),(i(!0),a(g,null,x(l.filtrerCentresCouts(s.datas.centreCoutPaiement,"mission"),C=>(i(),a("optgroup",{key:C.group,label:C.group},[(i(!0),a(g,null,x(C.child,b=>(i(),a("option",{key:b.value,"data-paie-etat":b.paieEtat,"data-ressources-propres":b.ressourcesPropres,selected:b.centreCoutId==m.centreCout.centreCoutId,value:b.centreCoutId},d(b.centreCoutCode+" - "+b.centreCoutLibelle),9,Lc))),128))],8,Hc))),128))],40,Ic)])):c("",!0),m.heuresDemandees!=0?(i(),a("td",{key:3,innerHTML:l.shorten(m.centreCout.code+" - "+m.centreCout.libelle,20)},null,8,Nc)):c("",!0),m.heuresDemandees==0?(i(),a("td",jc,[t("select",{id:"domaineFonctionnel-"+p.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:C=>l.enabledPaiement(p.missionId,"mission")},[e[14]||(e[14]=t("option",{value:""},"Aucun domaine fonctionnel",-1)),(i(!0),a(g,null,x(s.datas.domaineFonctionnelPaiement,C=>(i(),a("option",{selected:C.domaineFonctionnelId==m.domaineFonctionnel.domaineFonctionnelId,value:C.domaineFonctionnelId},d(C.domaineFonctionnelLibelle),9,qc))),256))],40,Oc)])):c("",!0),m.heuresDemandees!=0?(i(),a("td",zc,d(m.domaineFonctionnel.libelle),1)):c("",!0),t("td",{innerHTML:l.heuresStatutToString(m)},null,8,Bc),t("td",Gc,[m.heuresPayees==0&&m.heuresDemandees>0?(i(),a("span",$c,[t("button",{id:"remove-"+m.mepId,class:"btn btn-danger",type:"button",onClick:C=>this.supprimerDemandeMiseEnPaiement(m.mepId)},[h(u,{id:"action",name:"trash",style:{color:"white"}}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,Jc)])):c("",!0),m.heuresDemandees==0?(i(),a("span",Yc,[t("button",{id:"add-"+p.missionId,class:"btn btn-primary",type:"button",onClick:C=>this.ajouterDemandeMiseEnPaiement(p.missionId)},[h(u,{id:"action",name:"plus"}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,Qc)])):c("",!0)])]))),256))])])])])]),t("tfoot",null,[t("tr",Wc,[e[16]||(e[16]=t("th",{scope:"row"},"Total",-1)),t("td",null,d(l.totalHeure(p.heures))+" heure(s)",1)])])])])])])]))),256))]),t("div",Xc,[t("button",{id:"add-all-"+s.datas.code,class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=p=>l.demanderToutesLesHeuresEnPaiement(s.datas.code,s.datas.libelle))},[h(u,{id:"action",name:"square-plus",style:{color:"white"}}),h(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}}),f(" DEMANDER TOUS LES PAIEMENTS POUR "+d(s.datas.libelleCourt),1)],8,Kc)])],8,$d)],8,zd)}const ue=S(qd,[["render",Zc]]),ep=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),tp={name:"DemandeMiseEnPaiement",components:{DemandeMiseEnPaiementStructure:ue},props:{intervenant:{required:!1}},data(){return{datasDemandesMiseEnPaiement:null,urlGetDemandesMiseEnPaiement:unicaenVue.url("intervenant/:intervenant/mise-en-paiement/get-demandes-mise-en-paiement",{intervenant:this.intervenant})}},methods:{getDemandesMiseEnPaiement(){unicaenVue.axios.get(this.urlGetDemandesMiseEnPaiement).then(n=>{this.datasDemandesMiseEnPaiement=n.data}).then(n=>{this.btnResetState()}).catch(n=>{this.btnResetState(),console.error(n)})},btnResetState(){Array.from(document.querySelectorAll('[id^="remove-"]')).forEach(v=>{v.disabled=!1,v.querySelector("#waiting").style.display="none",v.querySelector("#action").style.display="inline-block"}),Array.from(document.querySelectorAll('[id^="add-"]')).forEach(v=>{v.disabled=!1,v.querySelector("#waiting").style.display="none",v.querySelector("#action").style.display="inline-block"}),Array.from(document.querySelectorAll('[id^="add-all"]')).forEach(v=>{v.disabled=!1,v.querySelector("#waiting").style.display="none",v.querySelector("#action").style.display="inline-block"})}},mounted(){this.getDemandesMiseEnPaiement()},updated(){$(".selectpicker").selectpicker("render");var n=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));n.map(function(e){return new bootstrap.Tooltip(e)})}},np={key:0,class:"text-center"},sp={id:"accordionPanelsStayOpenExample",class:"accordion"};function rp(n,e,s,v,r,l){const u=E("demande-mise-en-paiement-structure");return i(),a(g,null,[this.datasDemandesMiseEnPaiement?c("",!0):(i(),a("div",np,e[0]||(e[0]=[t("div",{class:"mt-5 spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Chargement des demandes de mise en paiement en cours...")],-1),f(" Chargement des demandes de mise en paiement en cours... ")]))),t("div",sp,[(i(!0),a(g,null,x(r.datasDemandesMiseEnPaiement,(p,m)=>(i(),M(u,{datas:p,intervenant:s.intervenant,onRefresh:l.getDemandesMiseEnPaiement},null,8,["datas","intervenant","onRefresh"]))),256))])],64)}const ip=S(tp,[["render",rp]]),lp=Object.freeze(Object.defineProperty({__proto__:null,default:ip},Symbol.toStringTag,{value:"Module"}));function ap(n){for(let e in n)for(let s in n[e])de(n[e][s],e)}function op(){let n=document.getElementById("unicaen-vue-toast-container");return n||(n=document.createElement("div"),n.id="unicaen-vue-toast-container",n.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(n)),n}function up(n){return n=dp(n),n=mp(n),n}function dp(n){const e=document.createElement("div");e.innerHTML=n;const s=e.querySelector(".alert");return s?s.innerHTML:e.innerHTML}function mp(n){const e=document.createElement("div");return e.innerHTML=n,e.querySelectorAll("i.fas").forEach(v=>v.style.display="none"),e.innerHTML}function de(n,e,s=null){const v={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},r={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"},l=document.createElement("button");l.classList.add("btn-close","btn-close-white","h5"),l.style.float="right",l.setAttribute("data-bs-dismiss","toast"),l.setAttribute("aria-label","Close");const u=document.createElement("i");u.classList.add("icon","fas",`fa-${r[e]}`),u.style.float="left",u.style.fontSize="26pt",u.style.paddingLeft=".4rem",u.style.marginTop=".4rem",u.style.paddingRight="1rem";const p=document.createElement("div");p.classList.add("toast-body"),p.innerHTML=up(n);const m=document.createElement("div");m.appendChild(l),m.appendChild(u),m.appendChild(p);const o=document.createElement("div");o.classList.add("toast","text-white",v[e]?v[e]:"bg-secondary"),o.setAttribute("role","alert"),o.setAttribute("aria-live","assertive"),o.setAttribute("aria-atomic","true"),e==="error"&&n.length>500&&o.setAttribute("style","width:700px"),o.appendChild(m),op().appendChild(o),s==null&&(s={animation:!0,delay:e==="warning"?15e3:5e3,autohide:e!=="error"}),new bootstrap.Toast(o,s).show()}const z={toast:de,toasts:ap};let j={...ve};j.interceptors.request.use(n=>{if(n.submitter){let e=n.msg?n.msg:"Action en cours";n.popover!=null&&n.popover.dispose(),n.popover=new bootstrap.Popover(n.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+e,html:!0,trigger:"focus"}),n.popover.show()}return n});j.interceptors.response.use(n=>{if(n.messages=n.data.messages,n.data=n.data.data,n.hasErrors=!!(n.messages&&n.messages.error&&n.messages.error.length>0),n.config.popover){var e=n.config.popover;let s="";for(ns in n.messages)for(mid in n.messages[ns])s+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+n.messages[ns][mid]+"</div>";s?(e._config.content=s,e.setContent(),setTimeout(()=>{e.dispose()},5e3)):e.dispose()}return n.messages&&z.toasts(n.messages),n},n=>{let e=n.response.data;n.response.status==403?e="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.":e=n.response.data,z.toast(e,"error")});j.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const cp={uvAxios:j},B={axios:cp.uvAxios,flashMessenger:z,url:(n,e,s)=>{let v=window.__unicaenVueBaseUrl;if(e)for(let l in e)n=n.replace(`:${l}`,e[l]);let r=s?B.encodeUrlQueryParam(s):null;return v+n+(r?`?${r}`:"")},encodeUrlQueryParam:(n,e)=>{var s=[];for(var v in n)if(n.hasOwnProperty(v)){var r=n[v],l=e?e+"["+encodeURIComponent(v)+"]":encodeURIComponent(v);if(typeof r=="object"&&r!==null)s.push(B.encodeUrlQueryParam(r,l));else{var u=encodeURIComponent(r);s.push(l+"="+u)}}return s.join("&")}};window.unicaenVue=B;const pp={name:"DemandeMiseEnPaiementLot.vue",props:{structures:{type:Array,required:!0},canMiseEnPaiement:{type:Boolean,required:!0}},data(){return{selectedStructure:null,urlRechercheDemandeMiseEnPaiement:unicaenVue.url("paiement/demande-mise-en-paiement-lot"),urlProcessDemandeMiseEnPaiement:unicaenVue.url("paiement/process-demande-mise-en-paiement-lot"),urlMiseEnPaiement:unicaenVue.url("paiement/etat-demande-paiement"),permanents:[],vacataires:[],etudiants:[],autres:[],intervenants:[],dotation:!1,liquidation:null,totalConsommationPaieEtat:0,totalConsommationRessourcePropre:0,totalConsommation:0,alertDotation:!1}},computed:{haveDotation(){return this.dotation?this.dotation.total>0:!1},alertPaieEtat(){return this.dotation.paieEtat<this.totalConsommationPaieEtat?"text-danger fw-bold":""},alertRessourcePropre(){return this.dotation.ressourcePropre<this.totalConsommationRessourcePropre?"text-danger fw-bold":""}},methods:{findDemandeMiseEnPaiement(n){this.totalConsommationRessourcePropre=0,this.totalConsommationPaieEtat=0,this.dotation=null,this.liquidation=null;let e=document.getElementById("formRechercheDemandeMiseEnPaiement"),s=new FormData(e),v=document.getElementById("btn-rdmep"),r=document.getElementById("btn-rdmep-inprogress");r.classList.remove("d-none"),v.classList.add("d-none"),v.disabled=!0,unicaenVue.axios.post(this.urlRechercheDemandeMiseEnPaiement,s,{}).then(l=>{this.dispatchDatas(l.data),v.disabled=!1,r.classList.add("d-none"),v.classList.remove("d-none"),document.querySelectorAll('input[type="checkbox"]').forEach(function(p,m){p.checked=!0}),unicaenVue.axios.get(unicaenVue.url("budget/get-budget-structure/:structure",{structure:this.selectedStructure})).then(p=>{let m=p.data;this.dotation=m.dotation,this.liquidation=m.liquidation,this.refreshTotalConsommation()})}).catch(l=>{console.error(l)})},processDemandeMiseEnPaiement(n){let e=document.getElementById("formProcessDemandeMiseEnPaiement"),s=new FormData(e);if(this.dotation.paieEtat>=this.totalConsommationPaieEtat&&this.dotation.ressourcePropre>=this.totalConsommationRessourcePropre||!this.haveDotation){let v=document.getElementById("btn-pdmep"),r=document.getElementById("btn-pdmep-inprogress");r.classList.remove("d-none"),v.classList.add("d-none"),v.disabled=!0,unicaenVue.axios.post(this.urlProcessDemandeMiseEnPaiement,s,{}).then(l=>{this.findDemandeMiseEnPaiement(),v.disabled=!1,r.classList.add("d-none"),v.classList.remove("d-none")}).catch(l=>{console.error("Error process dmep")})}},refreshTotalConsommation(){let n=0,e=0,s=0;n=parseFloat(this.liquidation.paieEtat),e=parseFloat(this.liquidation.ressourcePropre),s+=parseFloat(this.liquidation.ressourcePropre),s+=parseFloat(this.liquidation.paieEtat),document.querySelectorAll('input[type="checkbox"]').forEach(function(r,l){r.hasAttribute("data-paie-etat")&&r.checked&&(n+=parseFloat(r.getAttribute("data-paie-etat")),s+=parseFloat(r.getAttribute("data-paie-etat"))),r.hasAttribute("data-ressource-propre")&&r.checked&&(e+=parseFloat(r.getAttribute("data-ressource-propre")),s+=parseFloat(r.getAttribute("data-ressource-propre")))}),this.totalConsommationPaieEtat=n.toFixed(2),this.totalConsommationRessourcePropre=e.toFixed(2),this.totalConsommation=s.toFixed(2),this.alertDotation=(this.dotation.paieEtat<this.totalConsommationPaieEtat||this.dotation.ressourcePropre<this.totalConsommationRessourcePropre)&&this.dotation.total>0},totalPayable(n){let e=0;return n.forEach((s,v)=>{s.centreCout.code!=""&&(s.missionId!=""||s.serviceRefId!=""?s.domaineFonctionnel.code!=""&&(e+=s.heuresAPayer):e+=s.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalNonPayable(n){let e=0;return n.forEach((s,v)=>{(s.centreCout.code==""||(s.missionId!=""||s.serviceRefId!="")&&s.domaineFonctionnel.code=="")&&(e+=s.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePaieEtat(n){let e=0;return n.forEach((s,v)=>{s.centreCout.typeRessourceCode=="paie-etat"&&(e+=s.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePropre(n){let e=0;return n.forEach((s,v)=>{s.centreCout.typeRessourceCode=="ressources-propres"&&(e+=s.heuresAPayer)}),e.toLocaleString("fr-FR",{maximumFractionDigits:2})},dispatchDatas(n){this.vacataires=[],this.permanents=[],this.etudiants=[],this.autres=[],this.intervenants=[],console.log(n);for(const[e,s]of Object.entries(n))switch(s.datasIntervenant.typeIntervenant){case"Vacataire":this.vacataires.push(s),this.intervenants.push(s);break;case"Intervenant permanent":this.permanents.push(s),this.intervenants.push(s);break;case"Étudiant":this.etudiants.push(s),this.intervenants.push(s);break;default:this.autres.push(s),this.intervenants.push(s)}},toggleCheckbox(n){let e=Array.from(document.getElementsByClassName(n.target.className));n.target.checked?e.forEach(function(s,v){s.checked=!0}):e.forEach(function(s,v){s.checked=!1}),this.refreshTotalConsommation()},urlIntervenant(n){return unicaenVue.url("intervenant/code::intervenantCode/mise-en-paiement/demande",{intervenantCode:n.datasIntervenant.code})},formattedHETD(n){return Util.formattedHeures(n,!1)}}},hp={class:"card text-dark bg-light"},fp={class:"card-body"},bp={id:"formRechercheDemandeMiseEnPaiement",action:"",method:"post"},vp={class:"mb-3"},_p=["value"],gp={class:"mb-3"},yp=["disabled"],xp={key:0},Cp={key:0,class:"alert alert-danger",role:"alert"},Vp={class:"table table-bordered caption-top"},Sp={class:"fw-bold"},Pp={class:"fw-bold"},kp={id:"dmep",class:"accordion"},Ap={id:"formProcessDemandeMiseEnPaiement",action:"",method:"post"},Dp={key:0,class:"accordion-item"},Tp={id:"dmep-permanents-heading",class:"accordion-header"},Ep={"aria-controls":"dmep-permanents-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-permanents-collapse","data-bs-toggle":"collapse",type:"button"},Mp={id:"dmep-permanents-collapse","aria-labelledby":"dmep-permanents-heading",class:"accordion-collapse collapse show"},Up={class:"accordion-body"},Fp={class:"table"},Rp={scope:"col"},Ip=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],wp=["href"],Hp=["title"],Lp={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Np={key:1,class:"accordion-item"},jp={id:"dmep-vacataires-heading",class:"accordion-header"},Op={"aria-controls":"dmep-vacataires-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-vacataires-collapse","data-bs-toggle":"collapse",type:"button"},qp={id:"dmep-vacataires-collapse","aria-labelledby":"dmep-vacataires-heading",class:"accordion-collapse collapse show"},zp={class:"accordion-body"},Bp={class:"table"},Gp=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],$p=["href"],Jp=["title"],Yp={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Qp={key:2,class:"accordion-item"},Wp={id:"dmep-etudiants-heading",class:"accordion-header"},Xp={"aria-controls":"dmep-etudiants-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-etudiants-collapse","data-bs-toggle":"collapse",type:"button"},Kp={id:"dmep-etudiants-collapse","aria-labelledby":"dmep-etudiants-heading",class:"accordion-collapse collapse show"},Zp={class:"accordion-body"},eh={class:"table"},th=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],nh=["href"],sh=["title"],rh={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},ih={key:3,class:"accordion-item"},lh={id:"dmep-autres-heading",class:"accordion-header"},ah={"aria-controls":"dmep-autres-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-autres-collapse","data-bs-toggle":"collapse",type:"button"},oh={id:"dmep-autres-collapse","aria-labelledby":"dmep-autres-heading",class:"accordion-collapse collapse show"},uh={class:"accordion-body"},dh={class:"table"},mh=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],ch=["href"],ph=["title"],hh={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},fh=["value"],bh={key:4,class:"mt-3"},vh=["disabled"],_h=["href"];function gh(n,e,s,v,r,l){return i(),a(g,null,[e[31]||(e[31]=t("h1",null,"Demande de mise en paiement par lots",-1)),t("div",hp,[e[14]||(e[14]=t("div",{class:"card-header text-uppercase fw-bold"}," Recherchez des heures en attente de demande de mise en paiement : ",-1)),t("div",fp,[t("form",bp,[t("div",vp,[e[11]||(e[11]=t("label",{class:"form-label",for:"modele"},"Choisissez une structure ",-1)),e[12]||(e[12]=f("  ")),_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=u=>r.selectedStructure=u),class:"form-select",name:"structure"},[(i(!0),a(g,null,x(s.structures,u=>(i(),a("option",{value:u.id},d(u.libelle),9,_p))),256))],512),[[R,r.selectedStructure]])]),t("div",gp,[e[13]||(e[13]=t("button",{id:"btn-rdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[t("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),f("  Veuillez patienter... ")],-1)),t("button",{id:"btn-rdmep",disabled:!r.selectedStructure,class:"btn btn-primary",type:"button",onClick:e[1]||(e[1]=(...u)=>l.findDemandeMiseEnPaiement&&l.findDemandeMiseEnPaiement(...u))}," Lancer la recherche ",8,yp)])])])]),e[32]||(e[32]=t("div",{class:"alert alert-info",role:"alert"},[f(" Seules les HETD "),t("strong",null,"(hors référentiel)"),f(" avec des centres de coûts pré-paramètrés peuvent bénéficier d'une demande de mise en paiement automatisées. Pour les autres, il faudra passer sur chaque fiches intervenant pour faire les demandes en sélectionnant le centre de coût manuellement. ")],-1)),l.haveDotation?(i(),a("div",xp,[r.alertDotation?(i(),a("div",Cp," Attention vous dépassez vos dotations, vous ne pourrez pas lancer les demandes de mise en paiement par lot. Veuillez ajuster votre sélection d'intervenants pour faire les demandes de mise en paiement. ")):c("",!0),t("table",Vp,[e[17]||(e[17]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-bold",scope:"col"},"Budget"),t("th",{class:"fw-bold",scope:"col"},"Paie etat"),t("th",{class:"fw-bold",scope:"col"},"Ressource propre"),t("th",{class:"fw-bold",scope:"col"},"Total")])],-1)),t("tbody",null,[t("tr",null,[e[15]||(e[15]=t("td",null,"Dotation",-1)),t("td",null,d(l.formattedHETD(this.dotation.paieEtat))+" HETD",1),t("td",null,d(l.formattedHETD(this.dotation.ressourcePropre))+" HETD",1),t("td",Sp,d(l.formattedHETD(this.dotation.total))+" HETD",1)]),t("tr",null,[e[16]||(e[16]=t("td",null,"Consommation",-1)),t("td",null,[t("span",{class:A(l.alertPaieEtat)},d(l.formattedHETD(this.totalConsommationPaieEtat))+" HETD",3)]),t("td",null,[t("span",{class:A(l.alertRessourcePropre)},d(l.formattedHETD(this.totalConsommationRessourcePropre))+" HETD",3)]),t("td",Pp,d(l.formattedHETD(this.totalConsommation))+" HETD",1)])])])])):c("",!0),t("div",kp,[t("form",Ap,[this.permanents.length>0?(i(),a("div",Dp,[t("h2",Tp,[t("button",Ep,d(this.permanents.length)+" Permanent(s) ",1)]),t("div",Mp,[t("div",Up,[t("table",Fp,[t("thead",null,[t("tr",null,[t("th",Rp,[t("input",{id:"allPermanents",checked:"checked",class:"checkbox-permanent",name:"allPermanents",type:"checkbox",onClick:e[2]||(e[2]=(...u)=>l.toggleCheckbox&&l.toggleCheckbox(...u))})]),e[18]||(e[18]=t("th",{scope:"col"},"Intervenant",-1)),e[19]||(e[19]=t("th",null,"HETD payables",-1)),e[20]||(e[20]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(i(!0),a(g,null,x(this.permanents,u=>(i(),a("tr",null,[t("td",null,[t("input",{id:"permanent-"+u.datasIntervenant.id,"data-paie-etat":l.totalRessourcePaieEtat(u.heures),"data-ressource-propre":l.totalRessourcePropre(u.heures),disabled:l.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:l.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-permanent",type:"checkbox",onChange:e[3]||(e[3]=p=>l.refreshTotalConsommation())},null,40,Ip)]),t("td",null,[t("a",{href:l.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,wp)]),t("td",null,[t("span",{title:l.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+l.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(l.totalPayable(u.heures))+" h",9,Hp)]),t("td",null,[t("span",Lp,d(l.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):c("",!0),this.vacataires.length>0?(i(),a("div",Np,[t("h2",jp,[t("button",Op,d(this.vacataires.length)+" Vacataire(s) ",1)]),t("div",qp,[t("div",zp,[t("table",Bp,[t("thead",null,[t("tr",null,[t("th",null,[t("input",{id:"allVacataire",checked:"checked",class:"checkbox-vacataire",name:"allVacataire",type:"checkbox",onClick:e[4]||(e[4]=(...u)=>l.toggleCheckbox&&l.toggleCheckbox(...u))})]),e[21]||(e[21]=t("th",null,"Intervenant",-1)),e[22]||(e[22]=t("th",null,"HETD payables",-1)),e[23]||(e[23]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(i(!0),a(g,null,x(this.vacataires,u=>(i(),a("tr",null,[t("td",null,[t("input",{id:"vacataire-"+u.datasIntervenant.id,"data-paie-etat":l.totalRessourcePaieEtat(u.heures),"data-ressource-propre":l.totalRessourcePropre(u.heures),disabled:l.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:l.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-vacataire",type:"checkbox",onChange:e[5]||(e[5]=p=>l.refreshTotalConsommation())},null,40,Gp)]),t("td",null,[t("a",{href:l.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,$p)]),t("td",null,[t("span",{title:l.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+l.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(l.totalPayable(u.heures))+" h",9,Jp)]),t("td",null,[t("span",Yp,d(l.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):c("",!0),this.etudiants.length>0?(i(),a("div",Qp,[t("h2",Wp,[t("button",Xp,d(this.etudiants.length)+" Etudiant(s) ",1)]),t("div",Kp,[t("div",Zp,[t("table",eh,[t("thead",null,[t("tr",null,[t("th",null,[t("input",{id:"allEtudiants",checked:"checked",class:"checkbox-etudiant",name:"allEtudiants",type:"checkbox",onClick:e[6]||(e[6]=(...u)=>l.toggleCheckbox&&l.toggleCheckbox(...u))})]),e[24]||(e[24]=t("th",null,"Intervenant",-1)),e[25]||(e[25]=t("th",null,"HETD payables",-1)),e[26]||(e[26]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(i(!0),a(g,null,x(this.etudiants,u=>(i(),a("tr",null,[t("td",null,[t("input",{id:"etudiant-"+u.datasIntervenant.id,"data-paie-etat":l.totalRessourcePaieEtat(u.heures),"data-ressource-propre":l.totalRessourcePropre(u.heures),disabled:l.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:l.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-etudiant",type:"checkbox",onChange:e[7]||(e[7]=p=>l.refreshTotalConsommation())},null,40,th)]),t("td",null,[t("a",{href:l.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,nh)]),t("td",null,[t("span",{title:l.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+l.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(l.totalPayable(u.heures))+" h",9,sh)]),t("td",null,[t("span",rh,d(l.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):c("",!0),this.autres.length>0?(i(),a("div",ih,[t("h2",lh,[t("button",ah,d(this.autres.length)+" Autre(s) ",1)]),t("div",oh,[t("div",uh,[t("table",dh,[t("thead",null,[t("tr",null,[t("th",null,[t("input",{id:"allAutres",checked:"checked",class:"checkbox-autre",name:"allAutres",type:"checkbox",onClick:e[8]||(e[8]=(...u)=>l.toggleCheckbox&&l.toggleCheckbox(...u))})]),e[27]||(e[27]=t("th",null,"Intervenant",-1)),e[28]||(e[28]=t("th",null,"HETD payables",-1)),e[29]||(e[29]=t("th",null,"HETD non payables",-1))])]),t("tbody",null,[(i(!0),a(g,null,x(this.etudiants,u=>(i(),a("tr",null,[t("td",null,[t("input",{id:"autre-"+u.datasIntervenant.id,"data-paie-etat":l.totalRessourcePaieEtat(u.heures),"data-ressource-propre":l.totalRessourcePropre(u.heures),disabled:l.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:l.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-autre",type:"checkbox",onChange:e[9]||(e[9]=p=>l.refreshTotalConsommation())},null,40,mh)]),t("td",null,[t("a",{href:l.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,ch)]),t("td",null,[t("span",{title:l.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+l.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(l.totalPayable(u.heures))+" h",9,ph)]),t("td",null,[t("span",hh,d(l.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):c("",!0),t("input",{value:r.selectedStructure,name:"selectedStructure",type:"hidden"},null,8,fh),this.intervenants.length>0?(i(),a("div",bh,[e[30]||(e[30]=t("button",{id:"btn-pdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[t("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),f("  Veuillez patienter... ")],-1)),t("button",{id:"btn-pdmep",disabled:this.alertDotation,class:"btn btn-primary",type:"button",onClick:e[10]||(e[10]=(...u)=>l.processDemandeMiseEnPaiement&&l.processDemandeMiseEnPaiement(...u))}," Enregistrer les demandes de paiement ",8,vh),this.canMiseEnPaiement?(i(),a("a",{key:0,id:"btn-mep",href:this.urlMiseEnPaiement,class:"ms-2 btn btn-secondary"}," Aller au mise en paiement ",8,_h)):c("",!0)])):c("",!0)])])],64)}const yh=S(pp,[["render",gh]]),xh=Object.freeze(Object.defineProperty({__proto__:null,default:yh},Symbol.toStringTag,{value:"Module"})),Ch={components:{},props:{parametres:{type:Array,required:!0},servicesAPayer:{type:Array,required:!0}}},Vh={class:"table table-bordered table-condensed table-extra-condensed"},Sh={class:"card"},Ph={class:"card-header"},kh={class:"badge bg-primary"},Ah={class:"card-body"},Dh={class:"row lap"},Th={class:"col-md-6"},Eh={class:"table table-bordered table-xs"},Mh={key:0,rowspan:"2"},Uh={key:1,rowspan:"2"},Fh={key:0},Rh=["title"],Ih={key:1},wh=["title"],Hh={class:"col-md-6"},Lh={class:"table table-bordered table-xs"},Nh=["title"],jh=["title"],Oh={key:0},qh={class:"badge bg-info"},zh={key:0,class:"row"},Bh={class:"col-md-6"},Gh={class:"table table-bordered table-xs"},$h=["title"],Jh=["title"];function Yh(n,e,s,v,r,l){return i(),a(g,null,[e[10]||(e[10]=t("h2",null,"Paramètres généraux ou bien selon le statut",-1)),t("table",Vh,[e[0]||(e[0]=t("tr",null,[t("th",null,"Paramètre général"),t("th",null,"Valeur")],-1)),(i(!0),a(g,null,x(s.parametres,(u,p)=>(i(),a("tr",{key:p},[t("th",null,d(p),1),t("td",null,d(u),1)]))),128))]),e[11]||(e[11]=t("h2",null,"Services à payer",-1)),(i(!0),a(g,null,x(s.servicesAPayer,(u,p)=>(i(),a("div",{key:p},[t("div",Sh,[t("div",Ph,[t("span",kh,d(u.type),1),f(" "+d(u.libelle),1)]),t("div",Ah,[t("ul",null,[(i(!0),a(g,null,x(u.parametres,(m,o)=>(i(),a("li",{key:o},d(o)+" : "+d(m),1))),128))]),(i(!0),a(g,null,x(u.laps,m=>(i(),a("div",Dh,[t("div",Th,[e[4]||(e[4]=t("h6",null,"Heures à payer",-1)),t("table",Eh,[t("thead",null,[t("tr",null,[u.type!="Référentiel"?(i(),a("th",Mh,"Volume horaire")):(i(),a("th",Uh,"Volumes horaires")),e[1]||(e[1]=t("th",{colspan:"2"},"Taux de rému.",-1)),e[2]||(e[2]=t("th",{colspan:"3"},"Heures",-1))]),e[3]||(e[3]=t("tr",null,[t("th",null,"Nom"),t("th",null,"Valeur"),t("th",null,"Total"),t("th",null,"AA"),t("th",null,"AC")],-1))]),t("tbody",null,[t("tr",null,[u.type!="Référentiel"?(i(),a("td",Fh,[t("abbr",{class:"badge bg-secondary",title:m.volumeHoraireHisto},d(m.volumeHoraireId),9,Rh),f(" "+d(m.volumeHoraire),1)])):(i(),a("td",Ih,[(i(!0),a(g,null,x(m.volumeHoraireId,o=>(i(),a("div",null,[t("abbr",{class:"badge bg-secondary",title:o.HISTO},d(o.ID),9,wh),f(" "+d(o.HEURES)+"h ",1)]))),256))])),t("td",null,d(m.tauxRemu),1),t("td",null,d(m.tauxValeur)+"€",1),t("td",null,d(m.heures),1),t("td",null,d(m.heuresAA),1),t("td",null,d(m.heuresAC),1)])])])]),t("div",Hh,[e[6]||(e[6]=t("h6",null,[t("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),f(" correspondantes")],-1)),t("table",Lh,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",{rowspan:"2"},"Id"),t("th",{rowspan:"2"},"Centre de coûts"),t("th",{colspan:"2"},"Période"),t("th",{colspan:"3"},"Heures")]),t("tr",null,[t("th",null,"Mois"),t("th",null,"Date"),t("th",null,"Total"),t("th",null,"AA"),t("th",null,"AC")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(m.misesEnPaiement,o=>(i(),a("tr",{key:o.id},[t("td",null,[t("abbr",{class:"badge bg-secondary",title:"Nombre d'heures total concernées : "+o.heuresTotal+`
Domaine fonctionnel : `+o.domaineFonctionnel+`
`+o.historique},d(o.id),9,Nh)]),t("td",null,[t("abbr",{title:o.centreCoutLibelle},d(o.centreCoutCode),9,jh)]),t("td",null,d(o.periodePaiement),1),t("td",null,d(o.date),1),t("td",null,d(o.heures),1),t("td",null,d(o.heuresAA),1),t("td",null,d(o.heuresAC),1)]))),128))])]),m.heuresRestantes!="0,00"?(i(),a("div",Oh,[t("span",qh,d(m.heuresRestantes)+"h n'ont pas été demandées en paiement",1)])):c("",!0)])]))),256)),u.misesEnPaiement&&u.misesEnPaiement.length>0?(i(),a("div",zh,[e[9]||(e[9]=t("div",{class:"col-md-6"},null,-1)),t("div",Bh,[e[8]||(e[8]=t("h6",null,[t("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),f(" en trop")],-1)),t("table",Gh,[e[7]||(e[7]=t("thead",{class:"bg-danger"},[t("tr",null,[t("th",{rowspan:"2"},"Id"),t("th",{rowspan:"2"},"Centre de coûts"),t("th",{colspan:"2"},"Période"),t("th",{rowspan:"2"},"Heures")]),t("tr",null,[t("th",null,"Mois"),t("th",null,"Date")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(u.misesEnPaiement,m=>(i(),a("tr",{key:m.id},[t("td",null,[t("abbr",{class:"badge bg-danger",title:"Domaine fonctionnel : "+m.domaineFonctionnel+`
`+m.historique},d(m.id),9,$h)]),t("td",null,[t("abbr",{title:m.centreCoutLibelle},d(m.centreCoutCode),9,Jh)]),t("td",null,d(m.periodePaiement),1),t("td",null,d(m.date),1),t("td",null,d(m.heures),1)]))),128))])])])])):c("",!0)])])]))),128))],64)}const Qh=S(Ch,[["render",Yh],["__scopeId","data-v-d4a24889"]]),Wh=Object.freeze(Object.defineProperty({__proto__:null,default:Qh},Symbol.toStringTag,{value:"Module"})),Xh={props:{canImportPec:{type:Boolean,required:!1}},data(){return{selectedFile:null,importUrl:unicaenVue.url("paiement/import-numero-pec"),fileErrors:null,intervenantMissing:null,messageErrors:null,messageConfirm:null}},mounted(){},methods:{handleFileUpload(n){this.selectedFile=n.target.files[0],this.fileErrors=null,this.intervenantMissing=null,this.messageErrors=null,this.messageConfirm=null,document.getElementById("btn-import").disabled=!1},importFile(n){n.preventDefault(),this.messageErrors=null,this.messageConfirm=null;let e=document.getElementById("btn-import"),s=document.getElementById("btn-import-inprogress");s.classList.remove("d-none"),e.classList.add("d-none"),e.disabled=!0;let v=document.getElementById("formImport"),r=new FormData(v);unicaenVue.axios.post(this.importUrl,r,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{let u=l.data;this.fileErrors=u.file,this.intervenantMissing=u.intervenant,u.message.length!=0?this.messageErrors=u.message:this.messageConfirm="Importation des numéros de prise en charge réalisée avec succés !",e.disabled=!1,s.classList.add("d-none"),e.classList.remove("d-none")}).catch(l=>{console.error("Error uploading")})}}},Kh={class:"card text-dark bg-light"},Zh={class:"card-body"},ef={key:0,class:"alert alert-danger",role:"alert"},tf={key:1,class:"alert alert-success",role:"alert"},nf={id:"formImport",action:"",enctype:"multipart/form-data",method:"post"},sf={class:"mb-3"},rf={class:"mb-3"},lf={key:0,id:"fileErrors",class:"card text-dark bg-light"},af={class:"card-body"},of={key:0},uf={key:1};function df(n,e,s,v,r,l){return i(),a(g,null,[t("div",Kh,[e[7]||(e[7]=t("div",{class:"card-header text-uppercase fw-bold"}," Importation des numéros de prise en charge ",-1)),t("div",Zh,[this.messageErrors?(i(),a("div",ef,d(this.messageErrors),1)):c("",!0),this.messageConfirm?(i(),a("div",tf,d(this.messageConfirm),1)):c("",!0),t("form",nf,[e[5]||(e[5]=t("p",{class:"fs-9 text"},[f(" Vous pouvez utiliser le modèle directement extrait de winpaie "),t("strong",null,"(format .xlsx ou .ods)"),f(" ou créer votre modèle générique de classeur "),t("strong",null,"(format .xlsx ou .ods)"),f(" incluant 3 colonnes : insee,numero pec, nom. ")],-1)),t("div",sf,[e[2]||(e[2]=t("label",{class:"form-label",for:"importFile"},"Choisissez le fichier à importer :",-1)),e[3]||(e[3]=f("  ")),t("input",{class:"form-control",name:"importFile",type:"file",onChange:e[0]||(e[0]=(...u)=>l.handleFileUpload&&l.handleFileUpload(...u))},null,32)]),e[6]||(e[6]=J('<div class="mb-3"><label class="form-label" for="modele">Choisissez le modèle d&#39;import :</label>  <select id="modeleImport" class="form-select" name="modeleImport"><option value="winpaie">Winpaie</option><option value="generic">Generique (Modèle à 3 colonnes)</option></select></div>',1)),t("div",rf,[e[4]||(e[4]=t("button",{id:"btn-import-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[t("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),f("  Veuillez patienter... ")],-1)),t("button",{id:"btn-import",class:"btn btn-primary",disabled:"",type:"button",onClick:e[1]||(e[1]=(...u)=>l.importFile&&l.importFile(...u))}," Importer les numéros de prise en charge ")])])])]),this.fileErrors||this.intervenantMissing?(i(),a("div",lf,[e[10]||(e[10]=t("div",{class:"card-header text-uppercase fw-bold"}," Rapport de chargement du fichier ",-1)),t("div",af,[this.fileErrors.length!=0?(i(),a("div",of,[e[8]||(e[8]=t("p",null,"Listes des intervenants du fichier dont le numéro INSEE n'est pas valide : ",-1)),t("ul",null,[(i(!0),a(g,null,x(this.fileErrors,u=>(i(),a("li",null,d(),1))),256))])])):c("",!0),this.intervenantMissing.length!=0?(i(),a("div",uf,[e[9]||(e[9]=t("p",null,"Listes des intervenants présents dans le fichier mais non trouvés dans OSE : ",-1)),t("ul",null,[(i(!0),a(g,null,x(this.intervenantMissing,u=>(i(),a("li",null,d(u),1))),256))])])):c("",!0)])])):c("",!0)],64)}const mf=S(Xh,[["render",df]]),cf=Object.freeze(Object.defineProperty({__proto__:null,default:mf},Symbol.toStringTag,{value:"Module"})),pf={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(n){modAjax(n.target,e=>{this.$emit("refreshListe")})},ajoutValeur(n){modAjax(n.target,e=>{this.$emit("refreshListe")})},saisieValeur(n){n.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:n.currentTarget.dataset.id}),modAjax(n.currentTarget,e=>{this.$emit("refreshListe")})},refreshListe(n){this.$emit("refreshListe")},supprimer(n){popConfirm(n.target,e=>{this.$emit("refreshListe")})},supprimerValeur(n){n.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:n.currentTarget.dataset.id}),popConfirm(n.currentTarget,e=>{this.$emit("refreshListe")})},refresh(n){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:n.id})).then(e=>{this.$emit("refresh",e.data)})}}},hf={class:"card-header"},ff={style:{display:"inline"}},bf={class:"float-end"},vf=["href"],_f=["href"],gf={class:"card-body"},yf={key:0},xf={class:""},Cf={class:"row align-items-start"},Vf={class:"col-md-6"},Sf={class:"col"},Pf=["data-id"],kf=["data-id"],Af=["href"],Df={key:1,class:"row"},Tf={class:"col-md-7"},Ef={class:"row align-items-start"},Mf={class:"col-md-8"},Uf={class:"col-md-auto"},Ff=["data-id"],Rf=["data-id"],If=["href"],wf={class:"col"},Hf={key:0},Lf={key:0};function Nf(n,e,s,v,r,l){const u=w,p=E("u-heures"),m=H,o=E("taux",!0);return i(),a(g,null,[t("div",{class:A(["card",{"ms-5":s.taux.tauxRemu}])},[t("div",hf,[t("h3",ff,d(s.taux.libelle)+" ("+d(s.taux.code)+")",1),t("div",bf,[s.taux.canEdit?(i(),a("a",{key:0,href:r.saisieUrl,class:"btn btn-primary",onClick:e[0]||(e[0]=k((...C)=>l.saisie&&l.saisie(...C),["prevent"]))},[h(u,{name:"pen-to-square"}),e[8]||(e[8]=f(" Modifier"))],8,vf)):c("",!0),e[10]||(e[10]=f("   ")),s.taux.canDelete?(i(),a("a",{key:1,href:r.supprimerUrl,class:"btn btn-danger",onClick:e[1]||(e[1]=k((...C)=>l.supprimer&&l.supprimer(...C),["prevent"]))},[h(u,{name:"trash-can"}),e[9]||(e[9]=f(" Supprimer"))],8,_f)):c("",!0)])]),t("div",gf,[s.taux.tauxRemu?c("",!0):(i(),a("div",yf,[e[14]||(e[14]=f(" Modification :")),e[15]||(e[15]=t("br",null,null,-1)),t("ul",null,[(i(!0),a(g,null,x(s.taux.tauxRemuValeurs,C=>(i(),a("div",{key:C.id},[t("li",xf,[t("div",Cf,[t("div",Vf,[h(p,{valeur:C.valeur},null,8,["valeur"]),e[11]||(e[11]=f("€/h à partir du ")),h(m,{value:C.dateEffet},null,8,["value"])]),t("div",Sf,[s.taux.canEdit?(i(),a("a",{key:0,class:"text-primary",onClick:e[2]||(e[2]=k((...b)=>l.saisieValeur&&l.saisieValeur(...b),["prevent"])),"data-id":C.id},[h(u,{name:"pen-to-square"})],8,Pf)):c("",!0),e[12]||(e[12]=f("   ")),s.taux.canEdit?(i(),a("a",{key:1,class:"text-primary",onClick:e[3]||(e[3]=k((...b)=>l.supprimerValeur&&l.supprimerValeur(...b),["prevent"])),"data-id":C.id},[h(u,{name:"trash-can"})],8,kf)):c("",!0)])])])]))),128))]),s.taux.canEdit?(i(),a("a",{key:0,href:r.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:e[4]||(e[4]=k((...C)=>l.ajoutValeur&&l.ajoutValeur(...C),["prevent"]))},[h(u,{name:"plus"}),e[13]||(e[13]=f(" Ajouter une valeur "))],8,Af)):c("",!0)])),s.taux.tauxRemu?(i(),a("div",Df,[t("div",Tf,[e[19]||(e[19]=f(" Modification :")),e[20]||(e[20]=t("br",null,null,-1)),t("ul",null,[(i(!0),a(g,null,x(s.taux.tauxRemuValeurs,C=>(i(),a("div",null,[t("li",null,[t("div",Ef,[t("div",Mf,[e[16]||(e[16]=f(" Coéfficient de ")),h(p,{valeur:C.valeur},null,8,["valeur"]),e[17]||(e[17]=f(" à partir du ")),h(m,{value:C.dateEffet},null,8,["value"])]),t("div",Uf,[s.taux.canEdit?(i(),a("a",{key:0,class:"text-primary",onClick:e[5]||(e[5]=k((...b)=>l.saisieValeur&&l.saisieValeur(...b),["prevent"])),"data-id":C.id},[h(u,{name:"pen-to-square"})],8,Ff)):c("",!0),e[18]||(e[18]=f("   ")),s.taux.canEdit?(i(),a("a",{key:1,class:"text-primary",onClick:e[6]||(e[6]=k((...b)=>l.supprimerValeur&&l.supprimerValeur(...b),["prevent"])),"data-id":C.id},[h(u,{name:"trash-can"})],8,Rf)):c("",!0)])])])]))),256))]),s.taux.canEdit?(i(),a("a",{key:0,href:r.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:e[7]||(e[7]=k((...C)=>l.ajoutValeur&&l.ajoutValeur(...C),["prevent"]))},[h(u,{name:"plus"})],8,If)):c("",!0)]),t("div",wf,[f(" Valeurs calculées (indexées sur le taux "+d(s.taux.tauxRemu.libelle)+") : ",1),t("ul",null,[(i(!0),a(g,null,x(s.taux.tauxRemuValeursIndex,C=>(i(),a("div",null,[t("li",null,[h(p,{valeur:C.valeur},null,8,["valeur"]),e[21]||(e[21]=f("€/h à partir du ")),h(m,{value:C.date},null,8,["value"])])]))),256))]),e[22]||(e[22]=t("br",null,null,-1))])])):c("",!0)])],2),s.taux.tauxRemu?c("",!0):(i(),a("div",Hf,[(i(!0),a(g,null,x(s.listeTaux,C=>(i(),a("div",{key:C},[C.tauxRemu&&C.tauxRemu.id===s.taux.id?(i(),a("div",Lf,[(i(),M(o,{onSupprimer:l.supprimer,onRefreshListe:l.refreshListe,key:s.taux.id,taux:C,listeTaux:s.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):c("",!0)]))),128))]))],64)}const me=S(pf,[["render",Nf]]),jf=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"})),Of={components:{taux:me},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(n){modAjax(n.currentTarget,e=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(n){let e=Util.json.indexById(this.listeTaux,n.id);this.listeTaux[e]=n},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(n=>{this.listeTaux=n.data})}}},qf=["href"];function zf(n,e,s,v,r,l){const u=E("taux");return i(),a(g,null,[(i(!0),a(g,null,x(r.listeTaux,p=>(i(),a("div",null,[p.tauxRemu?c("",!0):(i(),M(u,{onSupprimer:l.supprimer,onRefreshListe:l.refreshListe,key:p.id,taux:p,listeTaux:r.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),s.canEditTaux?(i(),a("a",{key:0,class:"btn btn-primary",href:r.ajoutUrl,onClick:e[0]||(e[0]=k((...p)=>l.ajout&&l.ajout(...p),["prevent"]))},"Ajout d'un nouveau taux",8,qf)):c("",!0)],64)}const Bf=S(Of,[["render",zf]]),Gf=Object.freeze(Object.defineProperty({__proto__:null,default:Bf},Symbol.toStringTag,{value:"Module"})),$f={name:"listeContrat",data(){return{dataUrl:unicaenVue.url("signature/data-contrat"),lines:[]}},methods:{contratUrl(n){return unicaenVue.url("intervenant/:intervenant/contrat",{intervenant:n})},getDocumentUrl(n){return unicaenVue.url("signature/:signature/get-document",{signature:n})},updateSignatureUrl(n){return unicaenVue.url("signature/:signature/update-signature",{signature:n})}}},Jf=["href"],Yf=["href"],Qf=["href"];function Wf(n,e,s,v,r,l){const u=H,p=Y;return i(),a(g,null,[e[7]||(e[7]=t("h1",{class:"page-header"},"Liste des signatures électroniques de contrat",-1)),h(p,{ref:"signatures",modelValue:r.lines,"onUpdate:modelValue":e[0]||(e[0]=m=>r.lines=m),"data-url":this.dataUrl},{default:T(()=>[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",{column:"ID_SIGNATURE"},"Id"),t("th",{column:"NOM"},"Nom"),t("th",{column:"PRENOM"},"Prénom"),t("th",{column:"DATE_CREATION_SIGNATURE_ELECTRONIQUE"},"Date signature électronique"),t("th",{column:"STATUT_SIGNATURE_ELECTRONIQUE"},"Statut"),t("th",null," ")])],-1)),t("tbody",null,[(i(!0),a(g,null,x(r.lines,(m,o)=>(i(),a("tr",{key:o},[t("td",null,d(m.ID_SIGNATURE),1),t("td",null,d(m.NOM),1),t("td",null,d(m.PRENOM),1),t("td",null,[h(u,{value:m.DATE_CREATION_SIGNATURE_ELECTRONIQUE},null,8,["value"])]),t("td",null,d(m.STATUT_SIGNATURE_ELECTRONIQUE),1),t("td",null,[t("a",{href:l.getDocumentUrl(m.ID_SIGNATURE),class:"btn btn-info"},e[1]||(e[1]=[t("i",{class:"fas fa-download"},null,-1)]),8,Jf),e[4]||(e[4]=f("   ")),t("a",{href:l.contratUrl(m.ID_INTERVENANT),class:"btn btn-info"},e[2]||(e[2]=[t("i",{class:"fas fa-eye"},null,-1)]),8,Yf),e[5]||(e[5]=f("   ")),t("a",{href:l.updateSignatureUrl(m.ID_SIGNATURE),class:"btn btn-info"},e[3]||(e[3]=[t("i",{class:"fas fa-rotate"},null,-1)]),8,Qf)])]))),128))])]),_:1},8,["modelValue","data-url"])],64)}const Xf=S($f,[["render",Wf]]),Kf=Object.freeze(Object.defineProperty({__proto__:null,default:Xf},Symbol.toStringTag,{value:"Module"})),Zf={UHeures:"Application/UI/UHeures",UInputFloat:"Application/UI/UInputFloat",Utilisateur:"Application/Utilisateur"};function e1(n,e){const s={};e===void 0&&(e={});for(const l in n){let p=l.slice(2,-4).replaceAll("/","");s[p]=n[l].default}function v(l){let u=_e({template:l.innerHTML,components:s});if(e.beforeMount!==void 0&&e.beforeMount(u),e.autoloads!==void 0)for(const p in e.autoloads){let m=e.autoloads[p].replaceAll("/","");u.component(p,s[m])}u.use(ge({components:!0,directives:!0})),u.mount(l),e.afterMount!==void 0&&e.afterMount(u)}for(const l of document.getElementsByClassName("vue-app"))v(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList"){for(const p of u.addedNodes)if(p.nodeType===Node.ELEMENT_NODE){const m=p.querySelectorAll?p.querySelectorAll(".vue-app"):[];for(const o of m)v(o);p.classList.contains("vue-app")&&v(p)}}}).observe(document.body,{childList:!0,subtree:!0})}const t1={init:e1},n1=Object.assign({"./Application/Connexion.vue":Le,"./Application/UI/UHeures.vue":ze,"./Application/UI/UInputFloat.vue":Ye,"./Application/Utilisateur.vue":Ze,"./Employeur/ListeEmployeur.vue":pt,"./Formule/Administration/Details.vue":yt,"./Formule/Administration/Formulator.vue":Mt,"./Formule/Administration/Index.vue":en,"./Formule/Details.vue":Ls,"./Formule/DetailsHetd.vue":Yn,"./Formule/DetailsHetds.vue":Xn,"./Formule/DetailsServiceEnseignement.vue":mn,"./Formule/DetailsServiceReferentiel.vue":bn,"./Formule/DetailsVolumeHoraireEnseignement.vue":Mn,"./Formule/DetailsVolumeHoraireReferentiel.vue":Bn,"./Formule/Test/Index.vue":Ys,"./Formule/Test/Test.vue":zi,"./Formule/TotauxHetd.vue":Qi,"./Intervenant/Recherche.vue":ol,"./Lieu/Structure.vue":Rl,"./Lieu/StructuresAdmin.vue":jl,"./Mission/Liste.vue":Wa,"./Mission/ListeCandidatures.vue":_o,"./Mission/ListeOffreEmploi.vue":bu,"./Mission/ListePrime.vue":ad,"./Mission/Mission.vue":Ga,"./Mission/OffreEmploi.vue":ou,"./Mission/Prime.vue":Zu,"./Mission/Suivi.vue":Od,"./Mission/SuiviEvent.vue":Hd,"./Paiement/DemandeMiseEnPaiement.vue":lp,"./Paiement/DemandeMiseEnPaiementLot.vue":xh,"./Paiement/DemandeMiseEnPaiementStructure.vue":ep,"./Paiement/DetailsCalculs.vue":Wh,"./Paiement/ImportNumeroPec.vue":cf,"./Paiement/ListeTaux.vue":Gf,"./Paiement/Taux.vue":jf,"./Signature/ListeContrat.vue":Kf}),s1={autoloads:Zf};t1.init(n1,s1);
