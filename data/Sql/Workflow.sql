DECLARE
  intervenant_id NUMERIC DEFAULT 548;
BEGIN
  DBMS_OUTPUT.ENABLE(1000000); 
  ose_test.debug_enabled := true;


--ose_pj.update_intervenant(intervenant_id);
--OSE_FORMULE.CALCULER(intervenant_id);
OSE_WORKFLOW.CALCULER(intervenant_id);
--OSE_WORKFLOW.CALCULER_TOUT;

END;
/






BEGIN

DELETE FROM TBL_AGREMENT;
DELETE FROM TBL_CLOTURE_REALISE;
DELETE FROM TBL_CONTRAT;
DELETE FROM TBL_DOSSIER;
DELETE FROM TBL_PAIEMENT;
DELETE FROM TBL_PIECE_JOINTE;
DELETE FROM TBL_PIECE_JOINTE_DEMANDE;
DELETE FROM TBL_PIECE_JOINTE_FOURNIE;
DELETE FROM TBL_SERVICE;
DELETE FROM TBL_SERVICE_REFERENTIEL;
DELETE FROM TBL_SERVICE_SAISIE;
DELETE FROM TBL_WORKFLOW;

END;
/

      SELECT COUNT(*) LIGNES, 'TBL_AGREMENT'             TBL FROM TBL_AGREMENT
UNION SELECT COUNT(*) LIGNES, 'TBL_CLOTURE_REALISE'      TBL FROM TBL_CLOTURE_REALISE
UNION SELECT COUNT(*) LIGNES, 'TBL_CONTRAT'              TBL FROM TBL_CONTRAT
UNION SELECT COUNT(*) LIGNES, 'TBL_DOSSIER'              TBL FROM TBL_DOSSIER
UNION SELECT COUNT(*) LIGNES, 'TBL_PAIEMENT'             TBL FROM TBL_PAIEMENT
UNION SELECT COUNT(*) LIGNES, 'TBL_PIECE_JOINTE'         TBL FROM TBL_PIECE_JOINTE
UNION SELECT COUNT(*) LIGNES, 'TBL_PIECE_JOINTE_DEMANDE' TBL FROM TBL_PIECE_JOINTE_DEMANDE
UNION SELECT COUNT(*) LIGNES, 'TBL_PIECE_JOINTE_FOURNIE' TBL FROM TBL_PIECE_JOINTE_FOURNIE
UNION SELECT COUNT(*) LIGNES, 'TBL_SERVICE'              TBL FROM TBL_SERVICE
UNION SELECT COUNT(*) LIGNES, 'TBL_SERVICE_REFERENTIEL'  TBL FROM TBL_SERVICE_REFERENTIEL
UNION SELECT COUNT(*) LIGNES, 'TBL_SERVICE_SAISIE'       TBL FROM TBL_SERVICE_SAISIE
UNION SELECT COUNT(*) LIGNES, 'TBL_WORKFLOW'             TBL FROM TBL_WORKFLOW
;




delete from WF_ETAPE_DEP;




INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'PJ_SAISIE'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'DONNEES_PERSO_SAISIE'), -- etape précédente
  0,-- locale
  1,-- complete
  0,-- partielle
  1 -- integrale
);
  
INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'PJ_VALIDATION'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'PJ_SAISIE'), -- etape précédente
  0,-- locale
  1,-- complete
  0,-- partielle
  1 -- integrale
);  
  
INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'DONNEES_PERSO_VALIDATION'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'DONNEES_PERSO_SAISIE'), -- etape précédente
  0,-- locale
  1,-- complete
  0,-- partielle
  1 -- integrale
); 
  
INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'SERVICE_VALIDATION'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'PJ_VALIDATION'), -- etape précédente
  1,-- locale
  1,-- complete
  0,-- partielle
  1 -- integrale
);   
  
INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'SERVICE_VALIDATION'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'DONNEES_PERSO_VALIDATION'), -- etape précédente
  0,-- locale
  1,-- complete
  0,-- partielle
  1 -- integrale
);   
  
INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'SERVICE_VALIDATION'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'SERVICE_SAISIE'), -- etape précédente
  1,-- locale
  0,-- complete
  1,-- partielle
  1 -- integrale
);  
  
INSERT INTO WF_ETAPE_DEP (ETAPE_SUIV_ID, ETAPE_PREC_ID, LOCALE, COMPLETE, PARTIELLE, INTEGRALE ) VALUES (
  (SELECT id FROM wf_etape WHERE code = 'REFERENTIEL_VALIDATION'), -- etape suivante
  (SELECT id FROM wf_etape WHERE code = 'SERVICE_SAISIE'), -- etape précédente
  1,-- locale
  0,-- complete
  1,-- partielle
  1 -- integrale
);  
  
  
  
  
  

