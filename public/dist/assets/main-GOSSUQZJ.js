import{c as o,a as e,n as M,t as d,b as p,d as h,e as _,w as U,F as y,f as _e,o as a,r as C,g as v,v as pe,h as T,i as D,p as O,j as q,B as ee,k as W,U as re,l as ie,m as fe,q as P,s as te,u as F,x as g,y as R,z as J,A as X,C as be,D as ve,E as ge,G as ye,_ as xe}from"./vendor-CBqQR21d.js";const S=(t,n)=>{const s=t.__vccOpts||t;for(const[b,i]of n)s[b]=i;return s},Ce={name:"Connexion",props:{data:Object},data(){return{identity:"",currentRoleId:null,selectedStructures:{}}},mounted(){this.currentRoleId=this.data.roleId;for(let t in this.data.roles)this.selectedStructures[t]=-1;this.selectedStructures[this.currentRoleId]=this.data.structureId??-1},methods:{userProfileChange(t){let n=this.selectedStructures[t];n==-1&&(n=null),t!=this.currentRoleId&&(this.currentRoleId=t),document.body.classList.add("wait-cursor"),unicaenVue.axios.post(this.selectionProfilUrl,{role:t,structure:n}).then(s=>{window.location.href=unicaenVue.url("")})}},computed:{roleIcon(){return this.data.usurpationEnCours?"fa fa-theater-masks":"fa fa-user"},roleContent(){return"coucou!!!"},connexionUrl(){return this.data.connecte?unicaenVue.url("auth/deconnexion"):unicaenVue.url("auth/connexion")},connexionTitle(){return this.data.connecte?"Supprime les informations de connexion":"Affiche le formulaire d'authentification"},connexionContent(){return this.data.connecte?"Déconnexion":"Connexion"},startUsurpationUrl(){return unicaenVue.url("utilisateur/usurper-identite")},stopUsurpationUrl(){return unicaenVue.url("utilisateur/stopper-usurpation")},selectionProfilUrl(){return unicaenVue.url("utilisateur/selectionner-profil")}}},Y=t=>(O("data-v-c9651cce"),t=t(),q(),t),Ve={key:0,class:"navbar-link",id:"user-current-info",href:"#"},Se={id:"user-status"},Pe=Y(()=>e("span",{class:"caret"}," ",-1)),ke={id:"user-status-name"},Ae={key:1},Ee=["href","title"],Me=Y(()=>e("div",null,[e("strong",null,"Profil utilisateur :")],-1)),De={method:"POST",class:"user-profile-select-form"},Ue=["value","onClick"],Te=["onUpdate:modelValue","onChange"],Fe=Y(()=>e("option",{value:"-1"},"- toutes structures -",-1)),Re=["value"],Ie={key:0},we=["action"],$e=Y(()=>e("div",null,[e("strong",null,"Usurpation d'identité :")],-1)),Le={class:"mb-2"},He={class:"mb-2"},Ne=["disabled"],je={key:1};function Oe(t,n,s,b,i,r){const u=ee,m=_e;return a(),o(y,null,[s.data.connecte?(a(),o("a",Ve,[e("span",Se,[e("span",{class:M(r.roleIcon)},null,2),Pe,e("span",ke,[e("strong",null,d(s.data.utilisateurNom),1),p(", "+d(s.data.roleNom),1)])])])):h("",!0),s.data.connecte?(a(),o("span",Ae,"|")):h("",!0),e("a",{class:"navbar-link user-connection",href:r.connexionUrl,title:r.connexionUrl},d(r.connexionContent),9,Ee),_(m,{click:!0,"close-on-hide":!0,delay:{show:0,hide:0},"boundary-padding":{top:t.navHeight},target:"user-current-info"},{title:U(()=>[p("Utilisateur connecté à l'application")]),default:U(()=>[Me,e("div",null,[e("form",De,[(a(!0),o(y,null,C(s.data.roles,(c,l)=>(a(),o("div",{key:l,class:"radio"},[e("label",null,[v(e("input",{type:"radio",name:"role",class:"user-profile-select-input",title:"Cliquez pour changer de profil courant",value:l,onClick:x=>r.userProfileChange(l),"onUpdate:modelValue":n[0]||(n[0]=x=>i.currentRoleId=x)},null,8,Ue),[[pe,i.currentRoleId]]),p(d(c.libelle),1)]),p("  "),s.data.roles[l].peutChangerStructure?v((a(),o("select",{key:0,class:"user-profile-select-input-structure","onUpdate:modelValue":x=>i.selectedStructures[l]=x,onChange:x=>r.userProfileChange(l),title:"Cliquez pour sélectionner la structure associée au profil Administrateur"},[Fe,(a(!0),o(y,null,C(s.data.structures,(x,f)=>(a(),o("option",{key:f,value:f},d(x),9,Re))),128))],40,Te)),[[T,i.selectedStructures[l]]]):h("",!0)]))),128))])]),s.data.usurpationEnabled&&!s.data.usurpationEnCours?(a(),o("div",Ie,[e("form",{action:r.startUsurpationUrl},[$e,e("div",Le,[v(e("input",{type:"text",name:"identity","onUpdate:modelValue":n[1]||(n[1]=c=>i.identity=c),class:"user-usurpation-input form-control",placeholder:"Identifiant utilisateur",value:""},null,512),[[D,i.identity]])]),e("div",He,[e("input",{type:"submit",name:"submit",disabled:!i.identity,class:"user-usurpation-submit btn btn-danger form-control",value:"Usurper"},null,8,Ne)])],8,we)])):h("",!0),s.data.usurpationEnabled&&s.data.usurpationEnCours?(a(),o("div",je,[_(u,{variant:"danger",href:r.stopUsurpationUrl},{default:U(()=>[p("Stopper l'usurpation")]),_:1},8,["href"])])):h("",!0)]),_:1},8,["boundary-padding"])],64)}const qe=S(Ce,[["render",Oe],["__scopeId","data-v-c9651cce"]]),ze=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"})),Be={props:{valeur:{required:!0,type:Number}},computed:{affichage:function(){return Util.formattedHeures(this.valeur,!0)}}},Ge=["innerHTML"];function Je(t,n,s,b,i,r){return a(),o("span",{class:"heures",innerHTML:r.affichage},null,8,Ge)}const Ye=S(Be,[["render",Je]]),Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),We={name:"UInputFloat",props:{modelValue:{},isPourc:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},class:{type:String,required:!1,default:""},fraction:{type:Boolean,required:!1,default:!1},maximumDigits:{required:!1,default:8}},data(){return{fractions:{.333333:"1/3",.166667:"1/6",.142857:"1/7",.111111:"1/9",.666667:"2/3",.285714:"2/7",.222222:"2/9",.428571:"3/7",1.333333:"4/3",.571429:"4/7",.444444:"4/9",1.666667:"5/3",.833333:"5/6",.714286:"5/7",.555556:"5/9",.857143:"6/7",2.333333:"7/3",1.166667:"7/6",.777778:"7/9",2.666667:"8/3",1.142857:"8/7",.888889:"8/9",1.285714:"9/7"},inError:!1}},emits:["update:modelValue"],computed:{value:{get(){let t=this.modelValue;return this.isPourc&&(t*=100),this.floatToString(t)},set(t){const n=/^-?\d*\.?\d+$/;if(this.inError=t!==void 0&&t!==""&&!n.test(t.replace("/","").replace(",","").replace(".","")),!this.inError){let s=this.stringToFloat(t);this.isPourc&&(s/=100),(s===void 0||!isNaN(s)&&isFinite(s))&&this.$emit("update:modelValue",s)}}},cclass(){let t=this.class;return this.inError&&(t+=" is-invalid"),t}},methods:{floatToString(t){if(t==null)return;const n=Math.round(t*1e6)/1e6;if(this.fraction&&this.fractions[n]!==void 0)return this.fractions[n];var s="fr",b={minimumFractionDigits:0,maximumFractionDigits:this.maximumDigits,useGrouping:!1},i=new Intl.NumberFormat(s,b);return i.format(t)},stringToFloat(t){if(!(t===null||t===""||t===void 0))return t.indexOf("/")!==-1?(t=t.split("/"),t=Util.stringToFloat(t[0])/Util.stringToFloat(t[1])):t=parseFloat(t.replace(",",".")),t}},mounted(){}},Xe=["disabled"];function Ze(t,n,s,b,i,r){return v((a(),o("input",{"onUpdate:modelValue":n[0]||(n[0]=u=>r.value=u),disabled:s.disabled,ref:"inputFloat",class:M(r.cclass)},null,10,Xe)),[[D,r.value]])}const Ke=S(We,[["render",Ze],["__scopeId","data-v-29c90e6d"]]),et=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"})),tt={name:"Utilisateur",props:{nom:String,mail:String}},nt=["href"];function st(t,n,s,b,i,r){return a(),o("a",{href:`mailto:${s.mail}`},d(s.nom),9,nt)}const rt=S(tt,[["render",st]]),it=Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})),at={name:"UTableAjax",emits:["update:modelValue"],props:{modelValue:{required:!0},id:{required:!1,type:String},size:{required:!1,default:10},count:{required:!1},search:{required:!1},dataUrl:{required:!0,type:String}},data(){return{page:1,pageSizes:[10,25,50,100,"Tous"],defaultSize:10,dSize:this.size,dCount:this.count,dSearch:this.search,searchTimer:null,columns:{},loading:!1,orderCol:void 0,orderDir:"asc"}},computed:{cSize(){return isNaN(this.dSize)?9999999999999:this.dSize},storageIdentifier(){return"UTableAjax-"+this.id+"-"+window.location.href},elStart(){return isNaN(this.dSize)?1:(this.page-1)*this.dSize+1},elEnd(){return isNaN(this.dCount)?(this.page-1)*this.dSize+this.dSize:isNaN(this.dSize)?this.dCount:Math.min(this.dCount,(this.page-1)*this.dSize+this.dSize)}},watch:{dSize(t){localStorage.setItem(this.storageIdentifier,t),this.getData()},dSearch(t){const n=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.page>1?this.page=1:n.getData()},500)},page(t){this.getData()}},methods:{getData(){unicaenVue.axios.post(this.dataUrl,{page:this.page,size:this.dSize,elStart:this.elStart,elEnd:this.elEnd,search:this.dSearch,orderCol:this.orderCol,orderDir:this.orderDir}).then(t=>{let n=t.data;this.dCount=n.count,this.$emit("update:modelValue",n.data)})},orderBy(t){const n=this.columns[t];for(let b in this.columns)b!=t&&(this.columns[b].classList.contains("sorting_asc")&&this.columns[b].classList.remove("sorting_asc"),this.columns[b].classList.contains("sorting_desc")&&this.columns[b].classList.remove("sorting_desc"),console.log(b));let s="asc";n.classList.contains("sorting_asc")?(s="desc",n.classList.remove("sorting_asc"),n.classList.add("sorting_desc")):(n.classList.contains("sorting_desc")&&n.classList.remove("sorting_desc"),n.classList.add("sorting_asc")),this.orderCol=t,this.orderDir=s,this.getData()}},mounted(){this.dSize=parseInt(localStorage.getItem(this.storageIdentifier))||this.defaultSize,this.page=1,this.dSize=this.size,this.dCount=this.count;const t=this.$refs.tableRef,n=this;t&&t.querySelectorAll("th[column]").forEach(b=>{Array.from(b.attributes).forEach(i=>{i.name=="column"&&(this.columns[i.value]=b,b.dataset.column=i.value,b.onclick=function(){n.orderBy(this.dataset.column)},b.removeAttribute(i.name),b.classList.add("sorting"))})}),this.getData()}},ot={class:"dt-bootstrap5"},lt=["value"],ut={class:"float-end"},dt={class:"table table-bordered dataTable mb-2",ref:"tableRef"},ct={class:"dataTables_paginate paging_simple_numbers"};function mt(t,n,s,b,i,r){const u=re,m=ie,c=fe;return a(),o("div",ot,[_(m,null,{default:U(()=>[_(u,null,{default:U(()=>[p(" Afficher "),e("label",null,[v(e("select",{"onUpdate:modelValue":n[0]||(n[0]=l=>i.dSize=l),class:"form-select form-select-sm"},[(a(!0),o(y,null,C(i.pageSizes,l=>(a(),o("option",{key:l,value:l},d(l),9,lt))),128))],512),[[T,i.dSize]])]),p(" éléments ")]),_:1}),_(u,null,{default:U(()=>[e("div",ut,[p(" Rechercher : "),e("label",null,[v(e("input",{"onUpdate:modelValue":n[1]||(n[1]=l=>i.dSearch=l),class:"form-control form-inline form-control-sm"},null,512),[[D,i.dSearch]])])])]),_:1})]),_:1}),e("table",dt,[W(t.$slots,"default")],512),_(m,null,{default:U(()=>[_(u,null,{default:U(()=>[p("Affichage de l'élément "+d(r.elStart)+" à "+d(r.elEnd)+" sur "+d(i.dCount)+" éléments",1)]),_:1}),_(u,null,{default:U(()=>[e("div",ct,[_(c,{align:"end",page:i.page,modelValue:i.page,"onUpdate:modelValue":n[2]||(n[2]=l=>i.page=l),"total-rows":i.dCount,"per-page":r.cSize,"last-number":"true",firstNumber:"true","prev-text":"Précédent","next-text":"Suivant"},null,8,["page","modelValue","total-rows","per-page"])])]),_:1})]),_:1})])}const ne=S(at,[["render",mt]]),ht={name:"listeEmployeur",data(){return{dataUrl:unicaenVue.url("employeur/get-data"),lines:[]}},methods:{saisie(t){modAjax(t.currentTarget,n=>{this.$refs.employeurs.getData()})},editUrl(t){return unicaenVue.url("employeur/saisie/:id",{id:t})}}},_t=e("h1",{class:"page-header"},"Gestion des employeurs",-1),pt=e("thead",null,[e("tr",null,[e("th",{column:"ID"},"Id"),e("th",{column:"RAISON_SOCIALE"},"Raison sociale"),e("th",{column:"NOM_COMMERCIAL"},"Nom commercial"),e("th",null,"Siren"),e("th",null," ")])],-1),ft={key:0},bt=["href"],vt={key:1};function gt(t,n,s,b,i,r){const u=ne;return a(),o(y,null,[_t,_(u,{ref:"employeurs",modelValue:i.lines,"onUpdate:modelValue":n[1]||(n[1]=m=>i.lines=m),"data-url":this.dataUrl},{default:U(()=>[pt,e("tbody",null,[(a(!0),o(y,null,C(i.lines,(m,c)=>(a(),o("tr",{key:c},[e("td",null,d(m.ID),1),e("td",null,d(m.RAISON_SOCIALE),1),e("td",null,d(m.NOM_COMMERCIAL),1),e("td",null,d(m.SIREN),1),m.IMPORTABLE==0?(a(),o("td",ft,[m.IMPORTABLE==0?(a(),o("a",{key:0,href:r.editUrl(m.ID),onClick:n[0]||(n[0]=P((...l)=>r.saisie&&r.saisie(...l),["prevent"]))},"Modifier",8,bt)):h("",!0)])):h("",!0),m.IMPORTABLE==1?(a(),o("td",vt," NON MODIFIABLE ")):h("",!0)]))),128))])]),_:1},8,["modelValue","data-url"])],64)}const yt=S(ht,[["render",gt]]),xt=Object.freeze(Object.defineProperty({__proto__:null,default:yt},Symbol.toStringTag,{value:"Module"})),Ct={name:"Details",components:{},props:{formule:{type:Object},phpClass:{type:String}},methods:{indexUrl(){return unicaenVue.url("formule/administration")}}},Vt=["innerHTML"],St={class:"mb-2"},Pt=["href"],kt=e("i",{class:"fas fa-rotate-left"},null,-1);function At(t,n,s,b,i,r){return a(),o(y,null,[e("h1",null,"Code source de "+d(s.formule.code),1),e("div",{innerHTML:s.phpClass,class:"code"},null,8,Vt),e("div",St,[e("a",{class:"btn btn-secondary",href:this.indexUrl()},[kt,p(" Retour à l'administration des formules")],8,Pt)])],64)}const Et=S(Ct,[["render",At]]),Mt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Dt={name:"Formulator",components:{},props:{phpClass:{type:String},error:{type:String}},methods:{indexUrl(){return unicaenVue.url("formule/administration")}}},Ut=e("h1",null,"Formulator",-1),Tt={class:"mb-2"},Ft=["href"],Rt=e("i",{class:"fas fa-rotate-left"},null,-1),It={key:0},wt={class:"alert alert-danger"},$t={key:1},Lt=e("div",{class:"alert alert-success"},"Formule bien intégrée",-1),Ht=[Lt],Nt={key:2},jt=e("h3",null,"Code généré :",-1),Ot=["innerHTML"];function qt(t,n,s,b,i,r){return a(),o(y,null,[Ut,e("div",Tt,[e("a",{class:"btn btn-secondary",href:this.indexUrl()},[Rt,p(" Retour à l'administration des formules")],8,Ft)]),s.error?(a(),o("div",It,[e("div",wt,d(s.error),1)])):(a(),o("div",$t,Ht)),s.phpClass?(a(),o("div",Nt,[jt,e("div",{innerHTML:s.phpClass},null,8,Ot)])):h("",!0),p(" "+d(s.error),1)],64)}const zt=S(Dt,[["render",qt]]),Bt=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"})),Gt={name:"Index",components:{},props:{formules:{required:!0,type:Array},canEdit:{required:!0,type:Boolean}},methods:{telechargementUrl(t){return unicaenVue.url("formule/administration/telecharger-tableur/"+t)},televersementUrl(){return unicaenVue.url("formule/administration/televerser-tableur")},detailsUrl(t){return unicaenVue.url("formule/administration/details/"+t)}}},E=t=>(O("data-v-ba77464f"),t=t(),q(),t),Jt=E(()=>e("h1",null,"Formules de calcul",-1)),Yt={class:"table table-bordered table-hover table-sort"},Qt=E(()=>e("thead",null,[e("tr",null,[e("th",null,"Libellé"),e("th",null,"Paramètres"),e("th",null,"Règle de délégation"),e("th",null,"Ressources")])],-1)),Wt=["title"],Xt=E(()=>e("br",null,null,-1)),Zt={key:0,class:"cartridge"},Kt=E(()=>e("span",null,"intervenant",-1)),en=E(()=>e("span",null,"param1",-1)),tn={key:1,class:"cartridge"},nn=E(()=>e("span",null,"intervenant",-1)),sn=E(()=>e("span",null,"param2",-1)),rn={key:2,class:"cartridge"},an=E(()=>e("span",null,"intervenant",-1)),on=E(()=>e("span",null,"param3",-1)),ln={key:3,class:"cartridge"},un=E(()=>e("span",null,"intervenant",-1)),dn=E(()=>e("span",null,"param4",-1)),cn={key:4,class:"cartridge"},mn=E(()=>e("span",null,"intervenant",-1)),hn=E(()=>e("span",null,"param5",-1)),_n={key:5,class:"cartridge"},pn=E(()=>e("span",null,"volume horaire",-1)),fn=E(()=>e("span",null,"param1",-1)),bn={key:6,class:"cartridge"},vn=E(()=>e("span",null,"volume horaire",-1)),gn=E(()=>e("span",null,"param2",-1)),yn={key:7,class:"cartridge"},xn=E(()=>e("span",null,"volume horaire",-1)),Cn=E(()=>e("span",null,"param3",-1)),Vn={key:8,class:"cartridge"},Sn=E(()=>e("span",null,"volume horaire",-1)),Pn=E(()=>e("span",null,"param4",-1)),kn={key:9,class:"cartridge"},An=E(()=>e("span",null,"volume horaire",-1)),En=E(()=>e("span",null,"param5",-1)),Mn={key:0},Dn={key:1},Un=["href"],Tn=E(()=>e("i",{class:"fas fa-table-cells"},null,-1)),Fn=E(()=>e("br",null,null,-1)),Rn=["href"],In=E(()=>e("i",{class:"fas fa-table-cells"},null,-1)),wn=E(()=>e("br",null,null,-1)),$n={key:0,class:"card bg-warning"},Ln=E(()=>e("div",{class:"card-header"},[e("h3",null,"Création/Modification d'une formule à partir d'un tableur")],-1)),Hn={class:"card-body"},Nn=E(()=>e("div",{class:"alert alert-warning"},[e("span",{class:"icon iconly icon-attention"}),e("strong",null,"Attention :"),p(" cette opération peut avoir un impact déterminant sur le calcul de vos heures complémentaires et par extension sur tous vos paiements. En outre, le fichier doit être bâti selon un modèle bien précis. Vous êtes invités à ne téléverser que des tableurs préparés ou validés par l'équipe OSE. ")],-1)),jn=["action"],On=te('<div class="form-group mb-3" data-v-ba77464f><label for="formule-name" data-v-ba77464f>Feuille de calcul (format Excel ou Calc)</label><input class="form-control" id="formule-fichier" type="file" name="fichier" data-v-ba77464f></div><div class="form-group" data-v-ba77464f><button type="submit" class="btn btn-primary" data-v-ba77464f>Ajout/Modification à partir d&#39;un tableur</button></div>',2),qn=[On];function zn(t,n,s,b,i,r){return a(),o(y,null,[Jt,e("table",Yt,[Qt,e("tbody",null,[(a(!0),o(y,null,C(s.formules,u=>(a(),o("tr",{key:t.id,class:M({desactivee:!u.active}),title:u.active?"":"Cette formule est désactivée"},[e("td",null,[p(d(u.libelle),1),Xt,e("i",null,d(u.code),1)]),e("td",null,[u.iParam1Libelle?(a(),o("div",Zt,[Kt,en,p(" "+d(u.iParam1Libelle),1)])):h("",!0),u.iParam2Libelle?(a(),o("div",tn,[nn,sn,p(" "+d(u.iParam2Libelle),1)])):h("",!0),u.iParam3Libelle?(a(),o("div",rn,[an,on,p(" "+d(u.iParam3Libelle),1)])):h("",!0),u.iParam4Libelle?(a(),o("div",ln,[un,dn,p(" "+d(u.iParam4Libelle),1)])):h("",!0),u.iParam5Libelle?(a(),o("div",cn,[mn,hn,p(" "+d(u.iParam5Libelle),1)])):h("",!0),u.vhParam1Libelle?(a(),o("div",_n,[pn,fn,p(" "+d(u.vhParam1Libelle),1)])):h("",!0),u.vhParam2Libelle?(a(),o("div",bn,[vn,gn,p(" "+d(u.vhParam2Libelle),1)])):h("",!0),u.vhParam3Libelle?(a(),o("div",yn,[xn,Cn,p(" "+d(u.vhParam3Libelle),1)])):h("",!0),u.vhParam4Libelle?(a(),o("div",Vn,[Sn,Pn,p(" "+d(u.vhParam4Libelle),1)])):h("",!0),u.vhParam5Libelle?(a(),o("div",kn,[An,En,p(" "+d(u.vhParam5Libelle),1)])):h("",!0)]),u.delegationAnnee?(a(),o("td",Mn,[p("Avant "+d(u.delegationAnnee)+"/"+d(u.delegationAnnee+1)+", utilise ",1),e("i",null,d(u.delegationFormule),1)])):(a(),o("td",Dn)),e("td",null,[e("a",{href:this.telechargementUrl(u.id)},[Tn,p(" tableur")],8,Un),Fn,this.canEdit?(a(),o("a",{key:0,href:this.detailsUrl(u.id)},[In,p(" code PHP")],8,Rn)):h("",!0)])],10,Wt))),128))])]),wn,this.canEdit?(a(),o("div",$n,[Ln,e("div",Hn,[Nn,e("form",{method:"post",enctype:"multipart/form-data",action:this.televersementUrl()},qn,8,jn)])])):h("",!0)],64)}const Bn=S(Gt,[["render",zn],["__scopeId","data-v-ba77464f"]]),Gn=Object.freeze(Object.defineProperty({__proto__:null,default:Bn},Symbol.toStringTag,{value:"Module"})),Jn={name:"Details",components:{},props:{intervenant:{type:Number},typesVolumesHoraires:{type:Object}},data(){return{data:{},typeVolumeHoraire:null,etatVolumeHoraire:null}},mounted(){if(this.countChoix()==1){for(let t in this.typesVolumesHoraires){this.typeVolumeHoraire=t;for(let n in this.typesVolumesHoraires[t].etats)this.etatVolumeHoraire=n}this.load(this.typeVolumeHoraire,this.etatVolumeHoraire)}},methods:{load(t,n){this.typeVolumeHoraire=t,this.etatVolumeHoraire=n;const s={intervenant:this.intervenant,typeVolumeHoraire:this.typeVolumeHoraire,etatVolumeHoraire:this.etatVolumeHoraire};unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/formule/details-data/:typeVolumeHoraire/:etatVolumeHoraire",s)).then(b=>{this.data=b.data})},dataUrl(){},countChoix(){let t=0;for(let n in this.typesVolumesHoraires)for(let s in this.typesVolumesHoraires[n].etats)t++;return t}},computed:{listeTypes(){let t={};for(let n in this.typesVolumesHoraires)t[n]=this.typesVolumesHoraires[n].libelle;return t},listeEtats(){let t={};for(let s in this.typesVolumesHoraires)for(let b in this.typesVolumesHoraires[s].etats)t[b]=this.typesVolumesHoraires[s].etats[b];return Object.keys(t).sort((s,b)=>s-b).reduce((s,b)=>(s[b]=t[b],s),{})}}},Yn={key:0},Qn={class:"d-flex justify-content-center align-items-center"},Wn={class:"table table-borderless table-xs"},Xn={key:0},Zn=["onClick"],Kn={key:0,class:"alert alert-info"},es={key:1},ts={key:2};function ss(t,n,s,b,i,r){return a(),o(y,null,[r.countChoix()>1?(a(),o("div",Yn,[e("div",Qn,[e("div",null,[e("table",Wn,[(a(!0),o(y,null,C(r.listeTypes,(u,m)=>(a(),o("tr",{key:m},[(a(!0),o(y,null,C(r.listeEtats,(c,l)=>(a(),o("td",{key:l},[s.typesVolumesHoraires[m].etats[l]?(a(),o("div",Xn,[e("a",{class:M({"btn btn-outline-secondary btn-choixtevh":!0,active:!(m==i.typeVolumeHoraire&&l==i.etatVolumeHoraire)}),onClick:x=>r.load(m,l)},d(u)+" "+d(c),11,Zn)])):h("",!0)]))),128))]))),128))])])]),i.typeVolumeHoraire?h("",!0):(a(),o("div",Kn,"Veuillez cliquer sur un des boutons ci-dessus pour afficher de détail de calcul des HETD"))])):(a(),o("div",es,[e("h2",null,d(r.listeTypes[i.typeVolumeHoraire])+" "+d(r.listeEtats[i.etatVolumeHoraire]),1)])),Object.keys(this.data).length>0?(a(),o("div",ts,[e("pre",null,d(i.data),1)])):h("",!0)],64)}const rs=S(Jn,[["render",ss],["__scopeId","data-v-0bbb0800"]]),is=Object.freeze(Object.defineProperty({__proto__:null,default:rs},Symbol.toStringTag,{value:"Module"})),as={data(){return{dataUrl:unicaenVue.url("formule-test/data"),lines:[]}},methods:{addUrl(){return unicaenVue.url("formule-test/saisir")},editUrl(t){return unicaenVue.url("formule-test/saisir/:id",{id:t})},deleteUrl(t){return unicaenVue.url("formule-test/supprimer/:id",{id:t})},importUrl(){return unicaenVue.url("formule-test/import")},supprimerTest(t){return popConfirm(t.currentTarget,n=>{this.$refs.testsFormules.getData()}),!1}}},os=e("h1",{class:"page-header"},"Page de tests de formule de calcul des HETD",-1),ls=e("thead",null,[e("tr",null,[e("th",{column:"ID"},"Id"),e("th",{column:"LIBELLE"},"Libellé"),e("th",{column:"FORMULE"},"Formule"),e("th",{column:"ANNEE"},"Année"),e("th",null," ")])],-1),us={style:{width:"1%","white-space":"nowrap"}},ds=["href"],cs=e("i",{class:"fas fa-pencil"},null,-1),ms=[cs],hs=["href"],_s=e("i",{class:"fas fa-trash-can"},null,-1),ps=[_s],fs=e("br",null,null,-1),bs=e("br",null,null,-1),vs={class:"card bg-warning"},gs=e("div",{class:"card-header"},[e("h3",null,"Import d'un nouveau test à partir d'un tableur")],-1),ys={class:"card-body"},xs=["action"],Cs=te('<div class="form-group mb-3"><label for="formule-name">Feuille de calcul (format Excel ou Calc)</label><input class="form-control" id="formule-fichier" type="file" name="fichier"></div><div class="form-group"><button type="submit" class="btn btn-primary">Import d&#39;un test à partir d&#39;un tableur</button></div>',2),Vs=[Cs];function Ss(t,n,s,b,i,r){const u=ne,m=ee;return a(),o(y,null,[os,_(u,{"data-url":this.dataUrl,modelValue:i.lines,"onUpdate:modelValue":n[1]||(n[1]=c=>i.lines=c),ref:"testsFormules"},{default:U(()=>[ls,e("tbody",null,[(a(!0),o(y,null,C(i.lines,(c,l)=>(a(),o("tr",{key:l},[e("td",null,d(c.ID),1),e("td",null,d(c.LIBELLE),1),e("td",null,d(c.FORMULE),1),e("td",null,d(c.ANNEE),1),e("td",us,[e("a",{href:r.editUrl(c.ID),title:"Modification du test de formule"},ms,8,ds),p("   "),e("a",{href:r.deleteUrl(c.ID),title:"Suppression du test de formule","data-content":"Êtes-vous sur de vouloir supprimer ce test ?","data-title":"Suppression du test de formule",onClick:n[0]||(n[0]=P((...x)=>r.supprimerTest&&r.supprimerTest(...x),["prevent"]))},ps,8,hs)])]))),128))])]),_:1},8,["data-url","modelValue"]),_(m,{variant:"primary",href:r.addUrl()},{default:U(()=>[p("Ajout d'un nouveau test")]),_:1},8,["href"]),fs,bs,e("div",vs,[gs,e("div",ys,[e("form",{method:"post",enctype:"multipart/form-data",action:this.importUrl()},Vs,8,xs)])])],64)}const Ps=S(as,[["render",Ss]]),ks=Object.freeze(Object.defineProperty({__proto__:null,default:Ps},Symbol.toStringTag,{value:"Module"})),As={props:{id:{type:Number},formules:{type:Object},annees:{type:Object},typesIntervenants:{type:Object},typesVolumesHoraires:{type:Object},etatsVolumesHoraires:{type:Object},defaultFormule:{type:Number}},data(){return{indexUrl:unicaenVue.url("formule-test"),dataUrl:unicaenVue.url("formule-test/data"),tauxAutre1Visibility:!0,tauxAutre2Visibility:!1,tauxAutre3Visibility:!1,tauxAutre4Visibility:!1,tauxAutre5Visibility:!1,resMode:"hetd",debug:{},intervenant:{formule:void 0,tauxCmServiceDu:1.5,tauxCmServiceCompl:1.5,tauxTpServiceDu:1,tauxTpServiceCompl:.6666666666667},volumesHoraires:[],formule:{iParam1Libelle:void 0,iParam2Libelle:void 0,iParam3Libelle:void 0,iParam4Libelle:void 0,iParam5Libelle:void 0,vhParam1Libelle:void 0,vhParam2Libelle:void 0,vhParam3Libelle:void 0,vhParam4Libelle:void 0,vhParam5Libelle:void 0},structures:{},typesIntervention:["CM","TD","TP",void 0,void 0,void 0,void 0,void 0,"Référentiel"]}},watch:{"intervenant.tauxAutre1Code"(t){this.tauxAutre2Visibility=t||this.intervenant.tauxAutre1Code||this.intervenant.tauxAutre2ServiceDu||this.intervenant.tauxAutre2ServiceCompl,this.typesIntervention[3]=t},"intervenant.tauxAutre2Code"(t){this.tauxAutre3Visibility=t||this.intervenant.tauxAutre2Code||this.intervenant.tauxAutre3ServiceDu||this.intervenant.tauxAutre3ServiceCompl,this.typesIntervention[4]=t},"intervenant.tauxAutre3Code"(t){this.tauxAutre4Visibility=t||this.intervenant.tauxAutre3Code||this.intervenant.tauxAutre4ServiceDu||this.intervenant.tauxAutre4ServiceCompl,this.typesIntervention[5]=t},"intervenant.tauxAutre4Code"(t){this.tauxAutre5Visibility=t||this.intervenant.tauxAutre4Code||this.intervenant.tauxAutre5ServiceDu||this.intervenant.tauxAutre5ServiceCompl,this.typesIntervention[6]=t},"intervenant.tauxAutre5Code"(t){this.typesIntervention[7]=t},"intervenant.formule"(t){t&&(this.formule=this.formules[t])}},computed:{filteredTypesIntervention(){let t=Object.values(this.typesIntervention).filter(n=>n);return t.unshift(""),t},vhParamCount(){let t=0;for(let n=1;n<6;n++)this.formule["vhParam"+n+"Libelle"]&&t++;return t}},methods:{charger(){unicaenVue.axios.get(unicaenVue.url("formule-test/saisir-data/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0})).then(t=>{this.intervenant=this.dropTauxNonUtilises(t.data.intervenant),this.volumesHoraires=t.data.volumesHoraires,this.debug={},this.addVolumeHoraire(),this.updateStructures()})},enregistrer(){unicaenVue.axios.post(unicaenVue.url("formule-test/enregistrer/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0}),{intervenant:this.intervenant,volumesHoraires:this.volumesHoraires}).then(t=>{this.intervenant=this.dropTauxNonUtilises(t.data.intervenant),this.volumesHoraires=t.data.volumesHoraires,t.data.debug?this.debug=t.data.debug:this.debug={},this.addVolumeHoraire(),this.updateStructures()})},calculer(){unicaenVue.axios.post(unicaenVue.url("formule-test/enregistrer/:id",{id:this.id?this.id:this.intervenant.id?this.intervenant.id:0}),{intervenant:this.intervenant,volumesHoraires:this.volumesHoraires,simpleCalcul:!0}).then(t=>{this.intervenant=this.dropTauxNonUtilises(t.data.intervenant),this.volumesHoraires=t.data.volumesHoraires,t.data.debug?this.debug=t.data.debug:this.debug={},this.addVolumeHoraire(),this.updateStructures()})},exporter:function(){const t={intervenant:this.intervenant,volumesHoraires:this.volumesHoraires},n=this.intervenant.libelle;var s=document.createElement("a"),b=new Blob([JSON.stringify(t)],{type:"text/json"});s.href=window.URL.createObjectURL(b),s.download="Test de formule "+n+".json",s.click()},exporterCsv:function(){let t=`Structure;Compte dans le service statutaire;Heures non payables;Type d’intervention;Taux FI;Taux FA;Taux FC;Modulation service dû;Modulation service compl.;Param 1;Param 2;Param 3;Param 4;Param 5;Heures;Service FI;Service FA;Service FC;Service Référentiel;HC FI;HC FA;HC FC;HC Référentiel;Primes;Non payable FI;Non payable FA;Non payable FC;Non payable Référentiel
`;for(const i in this.volumesHoraires){const r=this.volumesHoraires[i];t+=(r.structureCode?r.structureCode:"")+";"+(r.serviceStatutaire?"Oui":"Non")+";"+(r.nonPayable?"Oui":"Non")+";"+(r.referentiel?"Référentiel":r.typeInterventionCode?r.typeInterventionCode:"")+";"+(r.tauxFi?r.tauxFi.toLocaleString("fr-FR"):"")+";"+(r.tauxFa?r.tauxFa.toLocaleString("fr-FR"):"")+";"+(r.tauxFc?r.tauxFc.toLocaleString("fr-FR"):"")+";"+(r.ponderationServiceDu?r.ponderationServiceDu.toLocaleString("fr-FR"):"")+";"+(r.ponderationServiceCompl?r.ponderationServiceCompl.toLocaleString("fr-FR"):"")+";"+(r.param1?r.param1:"")+";"+(r.param2?r.param2:"")+";"+(r.param3?r.param3:"")+";"+(r.param4?r.param4:"")+";"+(r.param5?r.param5:"")+";"+(r.heures?r.heures.toLocaleString("fr-FR"):"")+";"+(r.heuresServiceFi?r.heuresServiceFi.toLocaleString("fr-FR"):"")+";"+(r.heuresServiceFa?r.heuresServiceFa.toLocaleString("fr-FR"):"")+";"+(r.heuresServiceFc?r.heuresServiceFc.toLocaleString("fr-FR"):"")+";"+(r.heuresServiceReferentiel?r.heuresServiceReferentiel.toLocaleString("fr-FR"):"")+";"+(r.heuresComplFi?r.heuresComplFi.toLocaleString("fr-FR"):"")+";"+(r.heuresComplFa?r.heuresComplFa.toLocaleString("fr-FR"):"")+";"+(r.heuresComplFc?r.heuresComplFc.toLocaleString("fr-FR"):"")+";"+(r.heuresComplReferentiel?r.heuresComplReferentiel.toLocaleString("fr-FR"):"")+";"+(r.heuresPrimes?r.heuresPrimes.toLocaleString("fr-FR"):"")+";"+(r.heuresNonPayableFi?r.heuresNonPayableFi.toLocaleString("fr-FR"):"")+";"+(r.heuresNonPayableFa?r.heuresNonPayableFa.toLocaleString("fr-FR"):"")+";"+(r.heuresNonPayableFc?r.heuresNonPayableFc.toLocaleString("fr-FR"):"")+";"+(r.heuresNonPayableReferentiel?r.heuresNonPayableReferentiel.toLocaleString("fr-FR"):"")+`;
`}const n=this.intervenant.libelle;var s=document.createElement("a"),b=new Blob([t],{type:"text/csv"});s.href=window.URL.createObjectURL(b),s.download="Test de formule "+n+".csv",s.click()},importer:function(t){const n=t.target.files[0];if(!n.type.match("application/json")){console.error("Le fichier n'est pas de type JSON.");return}const s=new FileReader;s.onload=b=>{try{const i=JSON.parse(b.target.result);this.intervenant=i.intervenant,this.volumesHoraires=i.volumesHoraires,this.updateStructures()}catch(i){console.error("Erreur lors de l'analyse du contenu JSON :",i)}},s.readAsText(n)},dropTauxNonUtilises(t){return t.tauxAutre1Code||(t.tauxAutre1ServiceDu=void 0,t.tauxAutre1ServiceCompl=void 0),t.tauxAutre2Code||(t.tauxAutre2ServiceDu=void 0,t.tauxAutre2ServiceCompl=void 0),t.tauxAutre3Code||(t.tauxAutre3ServiceDu=void 0,t.tauxAutre3ServiceCompl=void 0),t.tauxAutre4Code||(t.tauxAutre4ServiceDu=void 0,t.tauxAutre4ServiceCompl=void 0),t.tauxAutre5Code||(t.tauxAutre5ServiceDu=void 0,t.tauxAutre5ServiceCompl=void 0),t},updateStructures(){let t={"":""};this.intervenant.structureCode&&(t[this.intervenant.structureCode]=this.intervenant.structureCode);for(let n in this.volumesHoraires){const s=this.volumesHoraires[n].structureCode;s&&(t[s]=s)}t.__UNIV__="Université (établissement)",t.__EXTERIEUR__="Extérieur (autre établissement)",t.__new_structure__="- Ajout d'une nouvelle structure -",this.structures=t},selectStructure(t){if(t.target.value=="__new_structure__"&&this.addStructure(t.target),t.target.dataset.variable!="intervenant"){const n=parseInt(t.target.dataset.variable);n==this.lastVolumeHoraireIndex()&&this.volumesHoraires[n].structureCode&&this.addVolumeHoraire()}},majTauxFi(t){const n=t.target.dataset.variable;this.volumesHoraires[n].tauxFi=1-this.volumesHoraires[n].tauxFa-this.volumesHoraires[n].tauxFc},lastVolumeHoraireIndex(){return this.volumesHoraires.length==0?-1:parseInt(Object.keys(this.volumesHoraires).pop())},addVolumeHoraire(){this.volumesHoraires.push({structureCode:null,typeInterventionCode:null,tauxFi:1,tauxFa:0,tauxFc:0,ponderationServiceDu:1,ponderationServiceCompl:1,serviceStatutaire:!0,heures:null})},addStructure(t){const n=prompt("Ajout d'une nouvelle structure");this.structures[n]=n,setTimeout(()=>{const s=t.dataset.variable;s=="intervenant"?this.intervenant.structureCode=n:this.volumesHoraires[s].structureCode=n},200)}},mounted(){this.charger()}},V=t=>(O("data-v-3894f4a0"),t=t(),q(),t),Es=V(()=>e("h1",{class:"page-header"},"Modification d'un test de formule",-1)),Ms={class:"row"},Ds={class:"col-md-6"},Us=V(()=>e("h2",null,"Intervenant",-1)),Ts={class:"table table-xs table-bordered fti"},Fs=V(()=>e("th",null,"Libellé",-1)),Rs={class:"saisie"},Is=V(()=>e("th",null,"Formule",-1)),ws={class:"saisie"},$s=["value"],Ls=V(()=>e("th",null,"Année",-1)),Hs={class:"saisie"},Ns=["value"],js=V(()=>e("th",null,"Type",-1)),Os={class:"saisie"},qs=["value"],zs=V(()=>e("th",null,"Structure",-1)),Bs={class:"saisie"},Gs=["value"],Js=V(()=>e("th",null,"Type de volume horaire",-1)),Ys={class:"saisie"},Qs=["value"],Ws=V(()=>e("th",null,"État de volume horaire",-1)),Xs={class:"saisie"},Zs=["value"],Ks=V(()=>e("th",null,"Heures de service statutaire",-1)),er={class:"saisie"},tr=V(()=>e("th",null,"Heures de service modifié",-1)),nr={class:"saisie"},sr=V(()=>e("th",null,"Dépassement de service dû sans HC",-1)),rr={class:"saisie"},ir=V(()=>e("option",{value:!0},"Oui",-1)),ar=V(()=>e("option",{value:!1},"Non",-1)),or=[ir,ar],lr={class:"i-param i-param-1"},ur={class:"i-param"},dr={class:"saisie"},cr={class:"i-param i-param-2"},mr={class:"i-param"},hr={class:"saisie"},_r={class:"i-param i-param-3"},pr={class:"i-param"},fr={class:"saisie"},br={class:"i-param i-param-4"},vr={class:"i-param"},gr={class:"saisie"},yr={class:"i-param i-param-5"},xr={class:"i-param"},Cr={class:"saisie"},Vr={class:"actions"},Sr={class:"row mb-4"},Pr={class:"col-md-6"},kr={class:"col-md-6"},Ar={class:"row mb-4"},Er={class:"col-md-6"},Mr={class:"col-md-6"},Dr={for:"importbtn"},Ur=V(()=>e("span",{class:"btn btn-secondary"},"Téléverser un jeu de données",-1)),Tr={class:"row"},Fr={class:"col-md-6"},Rr={class:"col-md-5"},Ir=V(()=>e("h2",null,"Types d'intervention (HETD)",-1)),wr={class:"types-interventions"},$r={class:"table table-bordered table-xs"},Lr=V(()=>e("tr",null,[e("th"),e("th",{colspan:"3"},"Standards"),e("th",{colspan:"5"},"Personnalisés")],-1)),Hr=V(()=>e("th",{style:{width:"20%"}},null,-1)),Nr=V(()=>e("th",{style:{width:"5%"}},"CM",-1)),jr=V(()=>e("th",{style:{width:"5%"}},"TD",-1)),Or=V(()=>e("th",{style:{width:"5%"}},"TP",-1)),qr={style:{width:"10%"}},zr={style:{width:"10%"}},Br={style:{width:"10%"}},Gr={style:{width:"10%"}},Jr={style:{width:"10%"}},Yr=V(()=>e("th",null,"En service",-1)),Qr={class:"saisie"},Wr=V(()=>e("td",null,"1",-1)),Xr={class:"saisie"},Zr={class:"saisie"},Kr={class:"saisie"},ei={class:"saisie"},ti={class:"saisie"},ni={class:"saisie"},si=V(()=>e("th",null,"Au-delà du service",-1)),ri={class:"saisie"},ii=V(()=>e("td",null,"1",-1)),ai={class:"saisie"},oi={class:"saisie"},li={class:"saisie"},ui={class:"saisie"},di={class:"saisie"},ci={class:"saisie"},mi=V(()=>e("h2",null,"Résultat",-1)),hi={class:"table table-xs table-bordered resultats"},_i=V(()=>e("th",{colspan:"2"},"Service dû",-1)),pi=V(()=>e("th",{rowspan:"4"},"Service",-1)),fi=V(()=>e("th",null,"FI",-1)),bi=V(()=>e("th",null,"FA",-1)),vi=V(()=>e("th",null,"FC",-1)),gi=V(()=>e("th",null,"Référentiel",-1)),yi=V(()=>e("th",{colspan:"2"},"Total service dû assuré",-1)),xi=V(()=>e("th",{rowspan:"4"},"Heures compl.",-1)),Ci=V(()=>e("th",null,"FI",-1)),Vi=V(()=>e("th",null,"FA",-1)),Si=V(()=>e("th",null,"FC",-1)),Pi=V(()=>e("th",null,"Référentiel",-1)),ki=V(()=>e("th",{colspan:"2"},"Total heures compl. à payer",-1)),Ai=V(()=>e("th",{colspan:"2"},"Primes",-1)),Ei=V(()=>e("th",{rowspan:"4"},"Heures non payables",-1)),Mi=V(()=>e("th",null,"FI",-1)),Di=V(()=>e("th",null,"FA",-1)),Ui=V(()=>e("th",null,"FC",-1)),Ti=V(()=>e("th",null,"Référentiel",-1)),Fi=V(()=>e("th",{colspan:"2"},"Total heures non payables",-1)),Ri=V(()=>e("h2",null,"Heures effectuées (A saisir de manière chronologique)",-1)),Ii={class:"table table-bordered table-xs table-hover fvh"},wi=V(()=>e("th",{rowspan:"3"},null,-1)),$i=["colspan"],Li=V(()=>e("th",{rowspan:"3",class:"spacer"}," ",-1)),Hi={colspan:"13"},Ni=V(()=>e("option",{value:"attendu"},"Résultats attendus (en HETD)",-1)),ji=V(()=>e("option",{value:"hetd",selected:"selected"},"Résultats calculés (en HETD)",-1)),Oi=V(()=>e("option",{value:"debug"},"Informations de débogage",-1)),qi=[Ni,ji,Oi],zi=V(()=>e("th",{rowspan:"2",style:{"min-width":"10em"}},"Structure",-1)),Bi=V(()=>e("th",{rowspan:"2"},"Compte dans le service statutaire",-1)),Gi=V(()=>e("th",{rowspan:"2",style:{"min-width":"5em"}},"Type d'intervention",-1)),Ji=V(()=>e("th",{colspan:"3"},"Répartition",-1)),Yi=V(()=>e("th",{colspan:"2"},"Modulation",-1)),Qi=["colspan"],Wi=V(()=>e("th",{rowspan:"2"},"Heures",-1)),Xi={colspan:"4"},Zi={colspan:"4"},Ki={rowspan:"2"},ea={colspan:"4"},ta={colspan:"4"},na={colspan:"4"},sa={rowspan:"2"},ra={colspan:"4"},ia={rowspan:"2"},aa=V(()=>e("th",null,"Fi",-1)),oa=V(()=>e("th",null,"Fa",-1)),la=V(()=>e("th",null,"Fc",-1)),ua=V(()=>e("th",null,"Service dû",-1)),da=V(()=>e("th",null,"Service compl.",-1)),ca=["onUpdate:modelValue","data-variable"],ma=["value"],ha=["onUpdate:modelValue"],_a=V(()=>e("option",{value:!0},"Oui",-1)),pa=V(()=>e("option",{value:!1},"Non",-1)),fa=[_a,pa],ba=["onUpdate:modelValue"],va=["value"],ga=V(()=>e("span",{class:"pourc"},"%",-1)),ya=V(()=>e("span",{class:"pourc"},"%",-1)),xa=V(()=>e("span",{class:"pourc"},"%",-1)),Ca=V(()=>e("span",{class:"pourc"},"%",-1)),Va=V(()=>e("span",{class:"pourc"},"%",-1)),Sa=["onUpdate:modelValue"],Pa=["onUpdate:modelValue"],ka=["onUpdate:modelValue"],Aa=["onUpdate:modelValue"],Ea=["onUpdate:modelValue"],Ma=V(()=>e("td",{class:"spacer"},null,-1)),Da={class:"debug-td"},Ua={key:0},Ta={class:"debug-cell"},Fa={class:"debug-val"},Ra={key:0},Ia=V(()=>e("h4",null,"Débogage : calculs globaux",-1)),wa={class:"debug-cell"},$a={class:"debug-val"},La=["href"],Ha=V(()=>e("i",{class:"fas fa-rotate-left","aria-hidden":"true"},null,-1));function Na(t,n,s,b,i,r){const u=F("u-input-float"),m=ee,c=F("u-heures");return a(),o(y,null,[Es,e("div",Ms,[e("div",Ds,[Us,e("table",Ts,[e("tr",null,[Fs,e("td",Rs,[v(e("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>i.intervenant.libelle=l),class:"dinput"},null,512),[[D,i.intervenant.libelle]])])]),e("tr",null,[Is,e("td",ws,[v(e("select",{"onUpdate:modelValue":n[1]||(n[1]=l=>i.intervenant.formule=l),class:"dinput"},[(a(!0),o(y,null,C(s.formules,l=>(a(),o("option",{value:l.id},d(l.libelle),9,$s))),256))],512),[[T,i.intervenant.formule]])])]),e("tr",null,[Ls,e("td",Hs,[v(e("select",{"onUpdate:modelValue":n[2]||(n[2]=l=>i.intervenant.annee=l),class:"dinput"},[(a(!0),o(y,null,C(s.annees,l=>(a(),o("option",{value:l.id},d(l.libelle),9,Ns))),256))],512),[[T,i.intervenant.annee]])])]),e("tr",null,[js,e("td",Os,[v(e("select",{"onUpdate:modelValue":n[3]||(n[3]=l=>i.intervenant.typeIntervenant=l),class:"dinput"},[(a(!0),o(y,null,C(s.typesIntervenants,l=>(a(),o("option",{value:l.id},d(l.libelle),9,qs))),256))],512),[[T,i.intervenant.typeIntervenant]])])]),e("tr",null,[zs,e("td",Bs,[v(e("select",{"onUpdate:modelValue":n[4]||(n[4]=l=>i.intervenant.structureCode=l),"data-variable":"intervenant",class:"dinput",onChange:n[5]||(n[5]=(...l)=>r.selectStructure&&r.selectStructure(...l))},[(a(!0),o(y,null,C(i.structures,(l,x)=>(a(),o("option",{value:x,key:x},d(l),9,Gs))),128))],544),[[T,i.intervenant.structureCode]])])]),e("tr",null,[Js,e("td",Ys,[v(e("select",{"onUpdate:modelValue":n[6]||(n[6]=l=>i.intervenant.typeVolumeHoraire=l),class:"dinput"},[(a(!0),o(y,null,C(s.typesVolumesHoraires,l=>(a(),o("option",{value:l.id},d(l.libelle),9,Qs))),256))],512),[[T,i.intervenant.typeVolumeHoraire]])])]),e("tr",null,[Ws,e("td",Xs,[v(e("select",{"onUpdate:modelValue":n[7]||(n[7]=l=>i.intervenant.etatVolumeHoraire=l),class:"dinput"},[(a(!0),o(y,null,C(s.etatsVolumesHoraires,l=>(a(),o("option",{value:l.id},d(l.libelle),9,Zs))),256))],512),[[T,i.intervenant.etatVolumeHoraire]])])]),e("tr",null,[Ks,e("td",er,[_(u,{modelValue:i.intervenant.heuresServiceStatutaire,"onUpdate:modelValue":n[8]||(n[8]=l=>i.intervenant.heuresServiceStatutaire=l),class:"dinput"},null,8,["modelValue"])])]),e("tr",null,[tr,e("td",nr,[_(u,{modelValue:i.intervenant.heuresServiceModifie,"onUpdate:modelValue":n[9]||(n[9]=l=>i.intervenant.heuresServiceModifie=l),class:"dinput"},null,8,["modelValue"])])]),e("tr",null,[sr,e("td",rr,[v(e("select",{"onUpdate:modelValue":n[10]||(n[10]=l=>i.intervenant.depassementServiceDuSansHC=l),class:"dinput"},or,512),[[T,i.intervenant.depassementServiceDuSansHC]])])]),v(e("tr",lr,[e("th",ur,d(i.formule.iParam1Libelle),1),e("td",dr,[v(e("input",{"onUpdate:modelValue":n[11]||(n[11]=l=>i.intervenant.param1=l),class:"dinput"},null,512),[[D,i.intervenant.param1]])])],512),[[g,i.formule.iParam1Libelle]]),v(e("tr",cr,[e("th",mr,d(i.formule.iParam2Libelle),1),e("td",hr,[v(e("input",{"onUpdate:modelValue":n[12]||(n[12]=l=>i.intervenant.param2=l),class:"dinput"},null,512),[[D,i.intervenant.param2]])])],512),[[g,i.formule.iParam2Libelle]]),v(e("tr",_r,[e("th",pr,d(i.formule.iParam3Libelle),1),e("td",fr,[v(e("input",{"onUpdate:modelValue":n[13]||(n[13]=l=>i.intervenant.param3=l),class:"dinput"},null,512),[[D,i.intervenant.param3]])])],512),[[g,i.formule.iParam3Libelle]]),v(e("tr",br,[e("th",vr,d(i.formule.iParam4Libelle),1),e("td",gr,[v(e("input",{"onUpdate:modelValue":n[14]||(n[14]=l=>i.intervenant.param4=l),class:"dinput"},null,512),[[D,i.intervenant.param4]])])],512),[[g,i.formule.iParam4Libelle]]),v(e("tr",yr,[e("th",xr,d(i.formule.iParam5Libelle),1),e("td",Cr,[v(e("input",{"onUpdate:modelValue":n[15]||(n[15]=l=>i.intervenant.param5=l),class:"dinput"},null,512),[[D,i.intervenant.param5]])])],512),[[g,i.formule.iParam5Libelle]])]),e("div",Vr,[e("div",Sr,[e("div",Pr,[_(m,{variant:"primary",onClick:r.enregistrer},{default:U(()=>[p("Enregistrer les données")]),_:1},8,["onClick"])]),e("div",kr,[_(m,{variant:"secondary",onClick:r.calculer},{default:U(()=>[p("Calculer les HETD")]),_:1},8,["onClick"])])]),e("div",Ar,[e("div",Er,[e("button",{class:"exporter btn btn-secondary",onClick:n[16]||(n[16]=(...l)=>r.exporter&&r.exporter(...l))},"Télécharger les données")]),e("div",Mr,[e("label",Dr,[Ur,e("input",{type:"file",id:"importbtn",class:"importer",onChange:n[17]||(n[17]=(...l)=>r.importer&&r.importer(...l))},null,32)])])]),e("div",Tr,[e("div",Fr,[e("button",{class:"exporter btn btn-secondary",onClick:n[18]||(n[18]=(...l)=>r.exporterCsv&&r.exporterCsv(...l))},"Télécharger les données en CSV ")])])])]),e("div",Rr,[Ir,e("div",wr,[e("table",$r,[Lr,e("tr",null,[Hr,Nr,jr,Or,v(e("th",qr,[v(e("input",{"onUpdate:modelValue":n[19]||(n[19]=l=>i.intervenant.tauxAutre1Code=l),class:"dinput"},null,512),[[D,i.intervenant.tauxAutre1Code]])],512),[[g,i.tauxAutre1Visibility]]),v(e("th",zr,[v(e("input",{"onUpdate:modelValue":n[20]||(n[20]=l=>i.intervenant.tauxAutre2Code=l),class:"dinput"},null,512),[[D,i.intervenant.tauxAutre2Code]])],512),[[g,i.tauxAutre2Visibility]]),v(e("th",Br,[v(e("input",{"onUpdate:modelValue":n[21]||(n[21]=l=>i.intervenant.tauxAutre3Code=l),class:"dinput"},null,512),[[D,i.intervenant.tauxAutre3Code]])],512),[[g,i.tauxAutre3Visibility]]),v(e("th",Gr,[v(e("input",{"onUpdate:modelValue":n[22]||(n[22]=l=>i.intervenant.tauxAutre4Code=l),class:"dinput"},null,512),[[D,i.intervenant.tauxAutre4Code]])],512),[[g,i.tauxAutre4Visibility]]),v(e("th",Jr,[v(e("input",{"onUpdate:modelValue":n[23]||(n[23]=l=>i.intervenant.tauxAutre5Code=l),class:"dinput"},null,512),[[D,i.intervenant.tauxAutre5Code]])],512),[[g,i.tauxAutre5Visibility]])]),e("tr",null,[Yr,e("td",Qr,[_(u,{modelValue:i.intervenant.tauxCmServiceDu,"onUpdate:modelValue":n[24]||(n[24]=l=>i.intervenant.tauxCmServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])]),Wr,e("td",Xr,[_(u,{modelValue:i.intervenant.tauxTpServiceDu,"onUpdate:modelValue":n[25]||(n[25]=l=>i.intervenant.tauxTpServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])]),v(e("td",Zr,[_(u,{modelValue:i.intervenant.tauxAutre1ServiceDu,"onUpdate:modelValue":n[26]||(n[26]=l=>i.intervenant.tauxAutre1ServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre1Visibility]]),v(e("td",Kr,[_(u,{modelValue:i.intervenant.tauxAutre2ServiceDu,"onUpdate:modelValue":n[27]||(n[27]=l=>i.intervenant.tauxAutre2ServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre2Visibility]]),v(e("td",ei,[_(u,{modelValue:i.intervenant.tauxAutre3ServiceDu,"onUpdate:modelValue":n[28]||(n[28]=l=>i.intervenant.tauxAutre3ServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre3Visibility]]),v(e("td",ti,[_(u,{modelValue:i.intervenant.tauxAutre4ServiceDu,"onUpdate:modelValue":n[29]||(n[29]=l=>i.intervenant.tauxAutre4ServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre4Visibility]]),v(e("td",ni,[_(u,{modelValue:i.intervenant.tauxAutre5ServiceDu,"onUpdate:modelValue":n[30]||(n[30]=l=>i.intervenant.tauxAutre5ServiceDu=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre5Visibility]])]),e("tr",null,[si,e("td",ri,[_(u,{modelValue:i.intervenant.tauxCmServiceCompl,"onUpdate:modelValue":n[31]||(n[31]=l=>i.intervenant.tauxCmServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])]),ii,e("td",ai,[_(u,{modelValue:i.intervenant.tauxTpServiceCompl,"onUpdate:modelValue":n[32]||(n[32]=l=>i.intervenant.tauxTpServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])]),v(e("td",oi,[_(u,{modelValue:i.intervenant.tauxAutre1ServiceCompl,"onUpdate:modelValue":n[33]||(n[33]=l=>i.intervenant.tauxAutre1ServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre1Visibility]]),v(e("td",li,[_(u,{modelValue:i.intervenant.tauxAutre2ServiceCompl,"onUpdate:modelValue":n[34]||(n[34]=l=>i.intervenant.tauxAutre2ServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre2Visibility]]),v(e("td",ui,[_(u,{modelValue:i.intervenant.tauxAutre3ServiceCompl,"onUpdate:modelValue":n[35]||(n[35]=l=>i.intervenant.tauxAutre3ServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre3Visibility]]),v(e("td",di,[_(u,{modelValue:i.intervenant.tauxAutre4ServiceCompl,"onUpdate:modelValue":n[36]||(n[36]=l=>i.intervenant.tauxAutre4ServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre4Visibility]]),v(e("td",ci,[_(u,{modelValue:i.intervenant.tauxAutre5ServiceCompl,"onUpdate:modelValue":n[37]||(n[37]=l=>i.intervenant.tauxAutre5ServiceCompl=l),fraction:!0,class:"dinput"},null,8,["modelValue"])],512),[[g,i.tauxAutre5Visibility]])])])]),mi,e("table",hi,[e("tr",null,[_i,e("td",null,[_(c,{valeur:i.intervenant.serviceDu??NaN},null,8,["valeur"])])]),e("tr",null,[pi,fi,e("td",null,[_(c,{valeur:i.intervenant.heuresServiceFi??NaN},null,8,["valeur"])])]),e("tr",null,[bi,e("td",null,[_(c,{valeur:i.intervenant.heuresServiceFa??NaN},null,8,["valeur"])])]),e("tr",null,[vi,e("td",null,[_(c,{valeur:i.intervenant.heuresServiceFc??NaN},null,8,["valeur"])])]),e("tr",null,[gi,e("td",null,[_(c,{valeur:i.intervenant.heuresServiceReferentiel??NaN},null,8,["valeur"])])]),e("tr",null,[yi,e("td",null,[_(c,{valeur:i.intervenant.heuresService??NaN},null,8,["valeur"])])]),e("tr",null,[xi,Ci,e("td",null,[_(c,{valeur:i.intervenant.heuresComplFi??NaN},null,8,["valeur"])])]),e("tr",null,[Vi,e("td",null,[_(c,{valeur:i.intervenant.heuresComplFa??NaN},null,8,["valeur"])])]),e("tr",null,[Si,e("td",null,[_(c,{valeur:i.intervenant.heuresComplFc??NaN},null,8,["valeur"])])]),e("tr",null,[Pi,e("td",null,[_(c,{valeur:i.intervenant.heuresComplReferentiel??NaN},null,8,["valeur"])])]),e("tr",null,[ki,e("td",null,[_(c,{valeur:i.intervenant.heuresCompl??NaN},null,8,["valeur"])])]),e("tr",null,[Ai,e("td",null,[_(c,{valeur:i.intervenant.heuresPrimes??NaN},null,8,["valeur"])])]),e("tr",null,[Ei,Mi,e("td",null,[_(c,{valeur:i.intervenant.heuresNonPayableFi??NaN},null,8,["valeur"])])]),e("tr",null,[Di,e("td",null,[_(c,{valeur:i.intervenant.heuresNonPayableFa??NaN},null,8,["valeur"])])]),e("tr",null,[Ui,e("td",null,[_(c,{valeur:i.intervenant.heuresNonPayableFc??NaN},null,8,["valeur"])])]),e("tr",null,[Ti,e("td",null,[_(c,{valeur:i.intervenant.heuresNonPayableReferentiel??NaN},null,8,["valeur"])])]),e("tr",null,[Fi,e("td",null,[_(c,{valeur:i.intervenant.heuresNonPayable??NaN},null,8,["valeur"])])])])]),Ri,e("table",Ii,[e("thead",null,[e("tr",null,[wi,e("th",{colspan:9+r.vhParamCount,class:"vh-donnees"},"Données",8,$i),Li,e("th",Hi,[v(e("select",{"onUpdate:modelValue":n[38]||(n[38]=l=>i.resMode=l),class:"form-select res-mode"},qi,512),[[T,i.resMode]])])]),e("tr",null,[zi,Bi,Gi,Ji,Yi,v(e("th",{colspan:r.vhParamCount},"Paramètres",8,Qi),[[g,r.vhParamCount>0]]),Wi,v(e("th",Xi,"Service",512),[[g,i.resMode=="attendu"]]),v(e("th",Zi,"Heures compl.",512),[[g,i.resMode=="attendu"]]),v(e("th",Ki,"Primes",512),[[g,i.resMode=="attendu"]]),v(e("th",ea,"Heures non payables",512),[[g,i.resMode=="attendu"]]),v(e("th",ta,"Service",512),[[g,i.resMode=="hetd"]]),v(e("th",na,"Heures compl.",512),[[g,i.resMode=="hetd"]]),v(e("th",sa,"Primes",512),[[g,i.resMode=="hetd"]]),v(e("th",ra,"Heures non payables",512),[[g,i.resMode=="hetd"]]),v(e("th",ia,"Informations de débogage",512),[[g,i.resMode=="debug"]])]),e("tr",null,[aa,oa,la,ua,da,(a(),o(y,null,C([1,2,3,4,5],l=>v(e("th",{key:l},d(i.formule["vhParam"+l+"Libelle"]),1),[[g,i.formule["vhParam"+l+"Libelle"]]])),64)),v(e("th",null,"Fi",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fa",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fc",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Référentiel",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fi",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fa",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fc",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Référentiel",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fi",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fa",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fc",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Référentiel",512),[[g,i.resMode=="attendu"]]),v(e("th",null,"Fi",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fa",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fc",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Référentiel",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fi",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fa",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fc",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Référentiel",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fi",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fa",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Fc",512),[[g,i.resMode=="hetd"]]),v(e("th",null,"Référentiel",512),[[g,i.resMode=="hetd"]])])]),e("tbody",null,[(a(!0),o(y,null,C(i.volumesHoraires,(l,x)=>(a(),o("tr",{key:x},[e("th",null,d(x+1),1),e("td",null,[v(e("select",{"onUpdate:modelValue":f=>l.structureCode=f,"data-variable":x,class:"dinput",onChange:n[39]||(n[39]=(...f)=>r.selectStructure&&r.selectStructure(...f))},[(a(!0),o(y,null,C(i.structures,(f,A)=>(a(),o("option",{value:A,key:A},d(f),9,ma))),128))],40,ca),[[T,l.structureCode]])]),e("td",null,[v(e("select",{"onUpdate:modelValue":f=>l.serviceStatutaire=f,class:"dinput"},fa,8,ha),[[T,l.serviceStatutaire],[g,l.structureCode]])]),e("td",null,[v(e("select",{"onUpdate:modelValue":f=>l.typeInterventionCode=f,class:"dinput"},[(a(!0),o(y,null,C(r.filteredTypesIntervention,f=>(a(),o("option",{value:f,key:f},d(f),9,va))),128))],8,ba),[[T,l.typeInterventionCode],[g,l.structureCode]])]),e("td",null,[v(e("div",null,[_(u,{modelValue:l.tauxFi,"onUpdate:modelValue":f=>l.tauxFi=f,"is-pourc":"",class:"doutput",readonly:"",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),ga],512),[[g,!["",null,"Référentiel"].includes(l.typeInterventionCode)]])]),e("td",null,[v(e("div",null,[_(u,{modelValue:l.tauxFa,"onUpdate:modelValue":f=>l.tauxFa=f,"is-pourc":"",class:"dinput","data-variable":x,onChange:r.majTauxFi,style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue","data-variable","onChange"]),ya],512),[[g,!["",null,"Référentiel"].includes(l.typeInterventionCode)]])]),e("td",null,[v(e("div",null,[_(u,{modelValue:l.tauxFc,"onUpdate:modelValue":f=>l.tauxFc=f,"is-pourc":"",class:"dinput","data-variable":x,onChange:r.majTauxFi,style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue","data-variable","onChange"]),xa],512),[[g,!["",null,"Référentiel"].includes(l.typeInterventionCode)]])]),e("td",null,[v(e("div",null,[_(u,{modelValue:l.ponderationServiceDu,"onUpdate:modelValue":f=>l.ponderationServiceDu=f,"is-pourc":"",class:"dinput",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),Ca],512),[[g,!["",null,"Référentiel"].includes(l.typeInterventionCode)]])]),e("td",null,[v(e("div",null,[_(u,{modelValue:l.ponderationServiceCompl,"onUpdate:modelValue":f=>l.ponderationServiceCompl=f,"is-pourc":"",class:"dinput",style:{width:"3em"}},null,8,["modelValue","onUpdate:modelValue"]),Va],512),[[g,!["",null,"Référentiel"].includes(l.typeInterventionCode)]])]),v(e("td",null,[v(e("input",{"onUpdate:modelValue":f=>l.param1=f,class:"dinput"},null,8,Sa),[[D,l.param1],[g,l.structureCode]])],512),[[g,i.formule.vhParam1Libelle]]),v(e("td",null,[v(e("input",{"onUpdate:modelValue":f=>l.param2=f,class:"dinput"},null,8,Pa),[[D,l.param2],[g,l.structureCode]])],512),[[g,i.formule.vhParam2Libelle]]),v(e("td",null,[v(e("input",{"onUpdate:modelValue":f=>l.param3=f,class:"dinput"},null,8,ka),[[D,l.param3],[g,l.structureCode]])],512),[[g,i.formule.vhParam3Libelle]]),v(e("td",null,[v(e("input",{"onUpdate:modelValue":f=>l.param4=f,class:"dinput"},null,8,Aa),[[D,l.param4],[g,l.structureCode]])],512),[[g,i.formule.vhParam4Libelle]]),v(e("td",null,[v(e("input",{"onUpdate:modelValue":f=>l.param5=f,class:"dinput"},null,8,Ea),[[D,l.param5],[g,l.structureCode]])],512),[[g,i.formule.vhParam5Libelle]]),e("td",null,[v(_(u,{modelValue:l.heures,"onUpdate:modelValue":f=>l.heures=f,class:"dinput",onChange:r.calculer},null,8,["modelValue","onUpdate:modelValue","onChange"]),[[g,!["",null].includes(l.typeInterventionCode)]])]),Ma,v(e("td",null,[_(u,{modelValue:l.heuresAttenduesServiceFi,"onUpdate:modelValue":f=>l.heuresAttenduesServiceFi=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesServiceFa,"onUpdate:modelValue":f=>l.heuresAttenduesServiceFa=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesServiceFc,"onUpdate:modelValue":f=>l.heuresAttenduesServiceFc=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesServiceReferentiel,"onUpdate:modelValue":f=>l.heuresAttenduesServiceReferentiel=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesComplFi,"onUpdate:modelValue":f=>l.heuresAttenduesComplFi=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesComplFa,"onUpdate:modelValue":f=>l.heuresAttenduesComplFa=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesComplFc,"onUpdate:modelValue":f=>l.heuresAttenduesComplFc=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesComplReferentiel,"onUpdate:modelValue":f=>l.heuresAttenduesComplReferentiel=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesPrimes,"onUpdate:modelValue":f=>l.heuresAttenduesPrimes=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesNonPayableFi,"onUpdate:modelValue":f=>l.heuresAttenduesNonPayableFi=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesNonPayableFa,"onUpdate:modelValue":f=>l.heuresAttenduesNonPayableFa=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesNonPayableFc,"onUpdate:modelValue":f=>l.heuresAttenduesNonPayableFc=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresAttenduesNonPayableReferentiel,"onUpdate:modelValue":f=>l.heuresAttenduesNonPayableReferentiel=f,"maximum-digits":"2",class:"dinput"},null,8,["modelValue","onUpdate:modelValue"])],512),[[g,i.resMode=="attendu"]]),v(e("td",null,[_(u,{modelValue:l.heuresServiceFi,"onUpdate:modelValue":f=>l.heuresServiceFi=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesServiceFi!=null&&Math.round(l.heuresAttenduesServiceFi*100)!=Math.round(l.heuresServiceFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresServiceFa,"onUpdate:modelValue":f=>l.heuresServiceFa=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesServiceFa!=null&&Math.round(l.heuresAttenduesServiceFa*100)!=Math.round(l.heuresServiceFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresServiceFc,"onUpdate:modelValue":f=>l.heuresServiceFc=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesServiceFc!=null&&Math.round(l.heuresAttenduesServiceFc*100)!=Math.round(l.heuresServiceFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresServiceReferentiel,"onUpdate:modelValue":f=>l.heuresServiceReferentiel=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesServiceReferentiel!=null&&Math.round(l.heuresAttenduesServiceReferentiel*100)!=Math.round(l.heuresServiceReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresComplFi,"onUpdate:modelValue":f=>l.heuresComplFi=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesComplFi!=null&&Math.round(l.heuresAttenduesComplFi*100)!=Math.round(l.heuresComplFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresComplFa,"onUpdate:modelValue":f=>l.heuresComplFa=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesComplFa!=null&&Math.round(l.heuresAttenduesComplFa*100)!=Math.round(l.heuresComplFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresComplFc,"onUpdate:modelValue":f=>l.heuresComplFc=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesComplFc!=null&&Math.round(l.heuresAttenduesComplFc*100)!=Math.round(l.heuresComplFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresComplReferentiel,"onUpdate:modelValue":f=>l.heuresComplReferentiel=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesComplReferentiel!=null&&Math.round(l.heuresAttenduesComplReferentiel*100)!=Math.round(l.heuresComplReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresPrimes,"onUpdate:modelValue":f=>l.heuresPrimes=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesPrimes!=null&&Math.round(l.heuresAttenduesPrimes*100)!=Math.round(l.heuresPrimes*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresNonPayableFi,"onUpdate:modelValue":f=>l.heuresNonPayableFi=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesNonPayableFi!=null&&Math.round(l.heuresAttenduesNonPayableFi*100)!=Math.round(l.heuresNonPayableFi*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresNonPayableFa,"onUpdate:modelValue":f=>l.heuresNonPayableFa=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesNonPayableFa!=null&&Math.round(l.heuresAttenduesNonPayableFa*100)!=Math.round(l.heuresNonPayableFa*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresNonPayableFc,"onUpdate:modelValue":f=>l.heuresNonPayableFc=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesNonPayableFc!=null&&Math.round(l.heuresAttenduesNonPayableFc*100)!=Math.round(l.heuresNonPayableFc*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",null,[_(u,{modelValue:l.heuresNonPayableReferentiel,"onUpdate:modelValue":f=>l.heuresNonPayableReferentiel=f,"maximum-digits":"2",tabindex:"-1",readonly:"",class:M({doutput:!0,"bg-danger":l.heuresAttenduesNonPayableReferentiel!=null&&Math.round(l.heuresAttenduesNonPayableReferentiel*100)!=Math.round(l.heuresNonPayableReferentiel*100)})},null,8,["modelValue","onUpdate:modelValue","class"])],512),[[g,i.resMode=="hetd"]]),v(e("td",Da,[i.debug.vh&&i.debug.vh[x]?(a(),o("div",Ua,[(a(!0),o(y,null,C(i.debug.vh[x],(f,A)=>(a(),o("span",Ta,[p(d(A)+" ",1),e("span",Fa,d(Math.round(f*100)/100),1)]))),256)),p("  ")])):h("",!0)],512),[[g,i.resMode=="debug"]])]))),128))])]),i.resMode=="debug"&&i.debug.global?(a(),o("div",Ra,[Ia,(a(!0),o(y,null,C(i.debug.global,(l,x)=>(a(),o("span",wa,[p(d(x)+" ",1),e("span",$a,d(Math.round(l*100)/100),1)]))),256)),p("  ")])):h("",!0),e("div",null,[e("a",{class:"btn btn-secondary",href:i.indexUrl},[Ha,p(" Retour à la liste des formules")],8,La)])])],64)}const ja=S(As,[["render",Na],["__scopeId","data-v-3894f4a0"]]),Oa=Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"})),qa={name:"TotauxHetd",props:{intervenant:{type:Number},typeVolumeHoraire:{type:Number}},data(){return{data:{types:[]},serviceLigne:""}},mounted(){this.load(),window.addEventListener("Formule/TotauxHetd.refresh",t=>{this.load()})},methods:{load(){unicaenVue.axios.get(unicaenVue.url("intervenant/formule-totaux-hetd/:intervenant/:typeVolumeHoraire",{intervenant:this.intervenant,typeVolumeHoraire:this.typeVolumeHoraire})).then(t=>{this.data=t.data.data,this.data.serviceStatutaire>0&&(this.data.serviceDu!=this.data.serviceStatutaire?this.serviceLigne="* "+this.data.serviceDu+"h de service dû en tenant compte des modifications de service":this.serviceLigne="* "+this.data.serviceStatutaire+"h de service statutaire")})},tradType(t){switch(t){case"fi":return"FI";case"fa":return"FA";case"fc":return"FC";case"enseignement":return"Enseignement";case"referentiel":return"Référentiel";case"total":return"Total";default:return t}},tradCategorie(t){switch(t){case"service":return"Service*";case"compl":return"Heures complémentaires";case"payable":return"Heures";case"non-payable":return"Non payable";case"primes":return"Primes";case"total":return"Total";default:return t}}}},se=t=>(O("data-v-f852d328"),t=t(),q(),t),za=se(()=>e("h2",null,"Totaux en heures équivalent TD",-1)),Ba={class:"table table-bordered"},Ga=se(()=>e("th",null," ",-1)),Ja=["colspan"],Ya=se(()=>e("br",null,null,-1));function Qa(t,n,s,b,i,r){const u=F("u-heures"),m=re,c=ie;return a(),o(y,null,[i.data.types.length>0?(a(),R(c,{key:0},{default:U(()=>[_(m,{cols:"6"},{default:U(()=>[za,e("table",Ba,[e("tr",null,[Ga,(a(!0),o(y,null,C(i.data.types,l=>(a(),o("th",{key:l},d(r.tradType(l)),1))),128))]),(a(!0),o(y,null,C(i.data.heures,(l,x)=>(a(),o("tr",{key:x},[e("th",null,d(r.tradCategorie(x)),1),x!=="primes"?(a(!0),o(y,{key:0},C(l,(f,A)=>(a(),o("td",{class:"nombre",key:A},[_(u,{valeur:f},null,8,["valeur"])]))),128)):(a(),o("td",{key:1,class:"nombre",colspan:l.length},[_(u,{valeur:i.data.heures.primes.total},null,8,["valeur"])],8,Ja))]))),128))]),p(" "+d(i.serviceLigne),1)]),_:1})]),_:1})):h("",!0),Ya],64)}const Wa=S(qa,[["render",Qa],["__scopeId","data-v-f852d328"]]),Xa=Object.freeze(Object.defineProperty({__proto__:null,default:Wa},Symbol.toStringTag,{value:"Module"})),Za={name:"UDate",props:{value:{required:!1,type:[String,Date]},format:{required:!1,type:String}},mounted(){this.formatted=this.formatage(this.value)},data(){return{formatted:void 0}},watch:{value:function(t){this.formatted=this.formatage(t)}},methods:{formatage(t){if(t===void 0)return;let n=new Date(t);const s=n.getFullYear(),b=(n.getMonth()+1).toString().padStart(2,"0"),i=n.getDate().toString().padStart(2,"0"),r=n.getHours().toString().padStart(2,"0"),u=n.getMinutes().toString().padStart(2,"0"),m=n.getSeconds().toString().padStart(2,"0");switch(this.format){case"datetime":return`${i}/${b}/${s} à ${r}:${u}`;case"time":return`${r}:${u}:${m}`}return`${i}/${b}/${s}`}}};function Ka(t,n,s,b,i,r){return d(i.formatted)}const z=S(Za,[["render",Ka]]),eo={name:"Recherche",data(){return{searchTerm:"",noResult:0,intervenants:[],checkedTypes:["vacataire","permanent","etudiant"]}},mixins:[Util],methods:{rechercher:function(t){this.searchTerm=t.currentTarget.value,this.searchTerm==""&&(this.noResult=0),this.searchTerm!=""&&this.reload()},urlFiche(t){return unicaenVue.url("intervenant/code:"+t+"/voir")},reload(){var t=document.getElementById("term");t.focus(),this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{unicaenVue.axios.post(unicaenVue.url("intervenant/recherche-json"),{term:this.searchTerm}).then(n=>{let s=n.data,b=[];for(const i in s){if(s[i].typeIntervenantCode=="E"&&this.checkedTypes.includes("vacataire")){b.push(s[i]);continue}if(s[i].typeIntervenantCode=="P"&&this.checkedTypes.includes("permanent")){b.push(s[i]);continue}if(s[i].typeIntervenantCode=="S"&&this.checkedTypes.includes("etudiant")){b.push(s[i]);continue}}this.intervenants=b,this.intervenants.length==0?this.noResult=1:this.noResult=0}).catch(n=>{console.log(n.message)})},800)}}},to=e("h3",null,"Saisissez le nom suivi éventuellement du prénom (2 lettres minimum)",-1),no={class:"intervenant-recherche"},so={class:"critere"},ro=e("br",null,null,-1),io=e("span",{class:"fw-bold"},"Types d'intervenant : ",-1),ao=e("br",null,null,-1),oo={key:0,class:"table table-bordered table-hover"},lo=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),uo=["title"],co={style:{}},mo=["href"],ho=e("i",{class:"fas fa-eye"},null,-1),_o={key:1,class:"table table-bordered table-hover"},po=e("thead",null,[e("tr",null,[e("th",{style:{width:"90px"}}),e("th",null,"Civilité"),e("th",null,"Nom"),e("th",null,"Prenom"),e("th",null,"Structure"),e("th",null,"Statut"),e("th",null,"Date de naissance"),e("th",null,"N° Personnel")])],-1),fo=e("tbody",null,[e("tr",null,[e("td",{colspan:"8",style:{"text-align":"center"}},"Aucun intervenant trouvé")])],-1),bo=[po,fo];function vo(t,n,s,b,i,r){const u=z;return a(),o(y,null,[to,e("div",no,[e("div",so,[e("div",null,[e("input",{id:"term",autofocus:"",class:"form-control input",placeholder:"votre recherche...",type:"text",onKeyup:n[0]||(n[0]=(...m)=>r.rechercher&&r.rechercher(...m))},null,32),ro]),e("div",null,[io,v(e("input",{"onUpdate:modelValue":n[1]||(n[1]=m=>i.checkedTypes=m),checked:"checked",name:"type[]",type:"checkbox",value:"permanent",onChange:n[2]||(n[2]=m=>r.reload())},null,544),[[J,i.checkedTypes]]),p(" Permanent "),v(e("input",{"onUpdate:modelValue":n[3]||(n[3]=m=>i.checkedTypes=m),checked:"checked",name:"type[]",type:"checkbox",value:"vacataire",onChange:n[4]||(n[4]=m=>r.reload())},null,544),[[J,i.checkedTypes]]),p(" Vacataire "),v(e("input",{"onUpdate:modelValue":n[5]||(n[5]=m=>i.checkedTypes=m),checked:"checked",name:"type[]",type:"checkbox",value:"etudiant",onChange:n[6]||(n[6]=m=>r.reload())},null,544),[[J,i.checkedTypes]]),p(" Etudiant ")]),ao])]),i.intervenants.length>0?(a(),o("table",oo,[lo,e("tbody",null,[(a(!0),o(y,null,C(i.intervenants,(m,c)=>(a(),o("tr",{class:M({"bg-danger":m.destruction!==null}),title:m.destruction!==null?"Fiche historisé":""},[e("td",co,[e("a",{href:r.urlFiche(m.code)},[ho,p(" Fiche")],8,mo)]),e("td",null,d(m.civilite),1),e("td",null,d(m.nom),1),e("td",null,d(m.prenom),1),e("td",null,d(m.structure),1),e("td",null,d(m.statut),1),e("td",null,[_(u,{value:m["date-naissance"]},null,8,["value"])]),e("td",null,d(m["numero-personnel"]),1)],10,uo))),256))])])):h("",!0),i.intervenants.length==0&&i.noResult==1?(a(),o("table",_o,bo)):h("",!0)],64)}const go=S(eo,[["render",vo]]),yo=Object.freeze(Object.defineProperty({__proto__:null,default:go},Symbol.toStringTag,{value:"Module"})),xo={name:"Structure",props:{structure:{required:!0}},data(){return{saisieUrl:unicaenVue.url("structure/voir/:structure",{structure:this.structure.id})+"?tab=edition",deleteUrl:unicaenVue.url("structure/delete/:structure",{structure:this.structure.id}),liste:this.$parent.liste}},computed:{hasSousStructures:function(){return Object.keys(this.structure.structures).length>0}},methods:{saisie(t){modAjax(t.currentTarget,n=>{this.refresh()})},supprimer(t){popConfirm(t.currentTarget,n=>{this.refresh()})},refresh(){this.liste.reload()}}},N=t=>(O("data-v-046af32d"),t=t(),q(),t),Co={class:"accordion-item"},Vo={class:"accordion-header"},So=["aria-controls","data-bs-target"],Po=["href"],ko=N(()=>e("i",{class:"fas fa-pen-to-square"},null,-1)),Ao=[ko],Eo=["href"],Mo=N(()=>e("i",{class:"fas fa-trash-can"},null,-1)),Do=[Mo],Uo=["id"],To={class:"accordion-body"},Fo={class:"row"},Ro=N(()=>e("div",{class:"col-md-5"},[e("strong",null,"Code"),p(" :")],-1)),Io={class:"col-md-5"},wo={class:"row"},$o=N(()=>e("div",{class:"col-md-5"},[e("strong",null,"Source"),p(" :")],-1)),Lo={class:"col-md-5"},Ho={class:"row"},No=N(()=>e("div",{class:"col-md-5"},[e("strong",null,"Composante d'enseignement"),p(" :")],-1)),jo={class:"col-md-5"},Oo={key:0,class:"fas fa-check text-success"},qo={key:1,class:"fas fa-xmark text-danger"},zo={class:"row"},Bo=N(()=>e("div",{class:"col-md-5"},[e("strong",null,"Affichage de l'adresse sur le contrat de travail"),p(" :")],-1)),Go={class:"col-md-5"},Jo={key:0,class:"fas fa-check text-success"},Yo={key:1,class:"fas fa-xmark text-danger"},Qo={class:"row"},Wo=N(()=>e("div",{class:"col-md-5"},[e("strong",null,"Adresse"),p(" :")],-1)),Xo={class:"col-md-5"},Zo={key:0,class:"sous-structures"},Ko=N(()=>e("h4",null,"Sous-structures",-1)),el={class:"accordion"};function tl(t,n,s,b,i,r){const u=F("structure",!0);return a(),o("div",Co,[e("h2",Vo,[e("button",{"aria-controls":s.structure.id,"data-bs-target":`#str${s.structure.id}`,"aria-expanded":"true",class:"accordion-button","data-bs-toggle":"collapse",type:"button"},[s.structure.canEdit?(a(),o("a",{key:0,href:i.saisieUrl,class:"btn btn-primary btn-sm",title:"Modifier la structure",onClick:n[0]||(n[0]=P((...m)=>r.saisie&&r.saisie(...m),["prevent"]))},Ao,8,Po)):h("",!0),s.structure.canDelete?(a(),o("a",{key:1,href:i.deleteUrl,class:"btn btn-danger btn-sm","data-content":"Êtes-vous sûr de vouloir supprimer la structure ?","data-title":"Suppression de la structure",title:"Supprimer la structure",onClick:n[1]||(n[1]=P((...m)=>r.supprimer&&r.supprimer(...m),["prevent"]))},Do,8,Eo)):h("",!0),p("   "+d(s.structure.libelleLong)+" ("+d(s.structure.libelleCourt)+") ",1)],8,So)]),e("div",{id:`str${s.structure.id}`,class:"accordion-collapse collapse show"},[e("div",To,[e("div",Fo,[Ro,e("div",Io,d(s.structure.code),1)]),e("div",wo,[$o,e("div",Lo,d(s.structure.source.libelle),1)]),e("div",Ho,[No,e("div",jo,[s.structure.enseignement?(a(),o("i",Oo)):s.structure.enseignement?h("",!0):(a(),o("i",qo))])]),e("div",zo,[Bo,e("div",Go,[s.structure.affAdresseContrat?(a(),o("i",Jo)):s.structure.affAdresseContrat?h("",!0):(a(),o("i",Yo))])]),e("div",Qo,[Wo,e("div",Xo,[e("pre",null,d(s.structure.adresse),1)])]),r.hasSousStructures?(a(),o("div",Zo,[Ko,e("div",el,[(a(!0),o(y,null,C(s.structure.structures,m=>(a(),R(u,{key:m.id,structure:m,onRefresh:r.refresh},null,8,["structure","onRefresh"]))),128))])])):h("",!0)])],8,Uo)])}const ae=S(xo,[["render",tl],["__scopeId","data-v-046af32d"]]),nl=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"})),sl={components:{structure:ae},props:{canAdd:{type:Boolean,required:!0}},data(){return{structures:[],ajoutUrl:unicaenVue.url("structure/saisie"),liste:this}},mounted(){this.reload()},methods:{ajout(t){modAjax(t.currentTarget,n=>{console.log("coucou"),this.reload()})},reload(){unicaenVue.axios.get(unicaenVue.url("structure/liste")).then(t=>{this.structures=t.data})}}},rl=e("h1",null,"Administration des structures",-1),il={class:"accordion"},al=["href"],ol=e("i",{class:"fas fa-pen-to-square"},null,-1);function ll(t,n,s,b,i,r){const u=F("structure");return a(),o(y,null,[rl,e("div",il,[(a(!0),o(y,null,C(i.structures,m=>(a(),R(u,{key:m.id,structure:m},null,8,["structure"]))),128))]),s.canAdd?(a(),o("a",{key:0,class:"btn btn-primary",href:i.ajoutUrl,onClick:n[0]||(n[0]=P((...m)=>r.ajout&&r.ajout(...m),["prevent"])),title:"Ajouter une structure"},[ol,p(" Ajouter une structure ")],8,al)):h("",!0)],64)}const ul=S(sl,[["render",ll]]),dl=Object.freeze(Object.defineProperty({__proto__:null,default:ul},Symbol.toStringTag,{value:"Module"})),cl={name:"UModal",props:{id:{required:!0,type:String},title:{required:!0,type:String}}},ml=["id"],hl={class:"modal-dialog"},_l={class:"modal-content"},pl={class:"modal-header"},fl={class:"modal-title"},bl=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),vl={class:"modal-body"},gl={class:"modal-footer"},yl=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Fermer",-1);function xl(t,n,s,b,i,r){return a(),o("div",{class:"modal fade",id:s.id,tabindex:"-1","aria-hidden":"true"},[e("div",hl,[e("div",_l,[e("div",pl,[e("h5",fl,d(s.title),1),bl]),e("div",vl,[W(t.$slots,"body")]),e("div",gl,[W(t.$slots,"footer"),yl])])])],8,ml)}const Cl=S(cl,[["render",xl]]),Vl={name:"UIcon",props:{name:{required:!0,type:String},variant:{required:!1,type:String},rotate:{required:!1,type:String},id:{required:!1,type:String}}},Sl=["id"];function Pl(t,n,s,b,i,r){return a(),o("i",{class:M(`fas fa-${s.name} text-${s.variant} fa-rotate-${s.rotate}`),id:`${s.id}`},null,10,Sl)}const j=S(Vl,[["render",Pl]]),kl={name:"Mission",props:{mission:{required:!0}},data(){return{validationText:this.calcValidation(this.mission.validation),saisieUrl:unicaenVue.url("mission/saisie/:mission",{mission:this.mission.id}),validerUrl:unicaenVue.url("mission/valider/:mission",{mission:this.mission.id}),devaliderUrl:unicaenVue.url("mission/devalider/:mission",{mission:this.mission.id}),supprimerUrl:unicaenVue.url("mission/supprimer/:mission",{mission:this.mission.id})}},watch:{"mission.validation"(t){this.validationText=this.calcValidation(t)}},computed:{heuresLib:function(){return this.mission.heures===null||this.mission.heures===0?"Aucune heure saisie":this.mission.heures==this.mission.heuresValidees?Util.formattedHeures(this.mission.heures)+" heures (validées)":this.mission.heuresValidees==0?Util.formattedHeures(this.mission.heures)+" heures (non validées)":'<span class="bg-info">'+Util.formattedHeures(this.mission.heures)+"</span> heures ("+Util.formattedHeures(this.mission.heuresValidees)+" validées)"}},methods:{calcValidation(t){return t===null?"A valider":t.id===null?"Autovalidée":"Validation du "+Util.dateToString(t.histoCreation)+" par "},saisie(t){modAjax(t.currentTarget,n=>{this.refresh()})},supprimer(t){popConfirm(t.currentTarget,n=>{this.$emit("supprimer",this.mission)})},valider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},devalider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},volumeHoraireSupprimer(t){t.currentTarget.href=unicaenVue.url("mission/volume-horaire/supprimer/:missionVolumeHoraire",{missionVolumeHoraire:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},volumeHoraireValider(t){t.currentTarget.href=unicaenVue.url("mission/volume-horaire/valider/:missionVolumeHoraire",{missionVolumeHoraire:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},volumeHoraireDevalider(t){t.currentTarget.href=unicaenVue.url("mission/volume-horaire/devalider/:missionVolumeHoraire",{missionVolumeHoraire:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},refresh(){unicaenVue.axios.get(unicaenVue.url("mission/get/:mission",{mission:this.mission.id})).then(t=>{this.$emit("refresh",t.data)})}}},L=t=>(O("data-v-1735108d"),t=t(),q(),t),Al=["id"],El={class:"card-header card-header-h3"},Ml={key:0},Dl={class:"float-end"},Ul={key:1},Tl={key:2},Fl={class:"float-end"},Rl={class:"card-body"},Il={class:"row"},wl={class:"col-md-8"},$l={class:"row"},Ll={class:"col-md-12"},Hl=L(()=>e("label",{class:"form-label"},"Composante en charge du suivi",-1)),Nl={class:"form-control"},jl={class:"row"},Ol={class:"col-md-6"},ql=L(()=>e("label",{class:"form-label"},"Taux de rémunération",-1)),zl={class:"form-control"},Bl={class:"col-md-6"},Gl=L(()=>e("label",{class:"form-label"},"Taux majoré (dimanches/jours fériés)",-1)),Jl={class:"form-control"},Yl={class:"col-md-7"},Ql=L(()=>e("label",{class:"form-label"},"Nombre d'heures prévisionnelles",-1)),Wl={class:"input-group mb-3"},Xl=["innerHTML"],Zl=["data-bs-target"],Kl={key:0,class:"col-md-5"},eu=L(()=>e("label",{class:"form-label"},"Heures de formation prévues",-1)),tu={class:"form-control"},nu={class:"row"},su={class:"col-md-12"},ru=L(()=>e("label",{class:"form-label"},"Descriptif de la mission",-1)),iu={class:"form-control"},au={key:0,class:"row"},ou={class:"col-md-12"},lu=L(()=>e("label",{class:"form-label"},"Etudiants suivis",-1)),uu={class:"form-control"},du=L(()=>e("div",{class:"row"},[e("div",{class:"col-md-12"}," ")],-1)),cu={class:"row"},mu={class:"col-md-12"},hu=["href"],_u=["href"],pu=["href"],fu=["href"],bu={class:"col-md-4"},vu=L(()=>e("div",null,[e("label",{class:"form-label"},"Suivi")],-1)),gu={class:"table table-bordered table-condensed"},yu=L(()=>e("thead",null,[e("tr",null,[e("th",null,"Heures"),e("th",null,"Statut"),e("th",null,"Actions")])],-1)),xu={style:{"text-align":"right"}},Cu=L(()=>e("br",null,null,-1)),Vu={key:0},Su=["data-id"],Pu=["data-id"],ku=["data-id"];function Au(t,n,s,b,i,r){const u=z,m=j,c=F("utilisateur"),l=F("u-heures"),x=Cl;return a(),o(y,null,[e("div",{id:s.mission.id,class:M([{"bg-success":s.mission.valide,"bg-default":!s.mission.valide},"card"])},[e("form",{onSubmit:n[4]||(n[4]=P((...f)=>t.submitForm&&t.submitForm(...f),["prevent"]))},[e("div",El,[s.mission.libelleMission?(a(),o("h5",Ml,[p(d(s.mission.libelleMission)+" ",1),e("span",Dl,[p("Du "),_(u,{value:s.mission.dateDebut},null,8,["value"]),p(" au "),_(u,{value:s.mission.dateFin},null,8,["value"])])])):h("",!0),s.mission.libelleMission?(a(),o("h6",Ul,d(s.mission.typeMission.libelle),1)):h("",!0),s.mission.libelleMission?h("",!0):(a(),o("h5",Tl,[p(d(s.mission.typeMission.libelle)+" ",1),e("span",Fl,[p("Du "),_(u,{value:s.mission.dateDebut},null,8,["value"]),p(" au "),_(u,{value:s.mission.dateFin},null,8,["value"])])]))]),e("div",Rl,[e("div",Il,[e("div",wl,[e("div",$l,[e("div",Ll,[Hl,e("div",Nl,d(s.mission.structure.libelle),1)])]),e("div",jl,[e("div",Ol,[ql,e("div",zl,d(s.mission.tauxRemu?s.mission.tauxRemu.libelle:null),1)]),e("div",Bl,[Gl,e("div",Jl,d(s.mission.tauxRemuMajore?s.mission.tauxRemuMajore.libelle:s.mission.tauxRemu?"Idem ("+s.mission.tauxRemu.libelle+")":null),1)]),e("div",Yl,[Ql,e("div",Wl,[e("div",{class:"form-control",innerHTML:r.heuresLib},null,8,Xl),e("button",{"data-bs-target":`#details-${s.mission.id}`,class:"input-group-btn btn btn-secondary","data-bs-toggle":"modal"}," Détails ",8,Zl)])]),s.mission.typeMission.besoinFormation?(a(),o("div",Kl,[eu,e("div",tu,d(s.mission.heuresFormation),1)])):h("",!0)]),e("div",nu,[e("div",su,[ru,e("div",iu,d(s.mission.description),1)])]),s.mission.typeMission.accompagnementEtudiants?(a(),o("div",au,[e("div",ou,[lu,e("div",uu,[e("pre",null,d(s.mission.etudiantsSuivis),1)])])])):h("",!0),du,e("div",cu,[e("div",mu,[s.mission.canSaisie?(a(),o("a",{key:0,href:i.saisieUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=P((...f)=>r.saisie&&r.saisie(...f),["prevent"]))},"Modifier",8,hu)):h("",!0),s.mission.canValider?(a(),o("a",{key:1,href:i.validerUrl,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider la mission ?","data-title":"Validation de la mission",onClick:n[1]||(n[1]=P((...f)=>r.valider&&r.valider(...f),["prevent"]))},"Valider",8,_u)):h("",!0),s.mission.canDevalider?(a(),o("a",{key:2,href:i.devaliderUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider la mission ?","data-title":"Dévalidation de la mission",onClick:n[2]||(n[2]=P((...f)=>r.devalider&&r.devalider(...f),["prevent"]))},"Dévalider",8,pu)):h("",!0),s.mission.canSupprimer?(a(),o("a",{key:3,href:i.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer la mission ?","data-title":"Suppression de la mission",onClick:n[3]||(n[3]=P((...f)=>r.supprimer&&r.supprimer(...f),["prevent"]))},"Supprimer",8,fu)):h("",!0)])])]),e("div",bu,[vu,e("div",null,[_(m,{name:"thumbs-up",variant:"success"}),p(" Créé le "),_(u,{value:s.mission.histoCreation},null,8,["value"]),p(" par "),_(c,{mail:s.mission.histoCreateur.email,nom:s.mission.histoCreateur.displayName},null,8,["mail","nom"])]),e("div",null,[_(m,{name:s.mission.valide?"thumbs-up":"thumbs-down",variant:s.mission.valide?"success":"info"},null,8,["name","variant"]),p(" "+d(i.validationText)+" ",1),s.mission.validation&&s.mission.validation.histoCreateur?(a(),R(c,{key:0,mail:s.mission.validation.histoCreateur.email,nom:s.mission.validation.histoCreateur.displayName},null,8,["mail","nom"])):h("",!0)]),e("div",null,[_(m,{name:s.mission.contrat?"thumbs-up":"thumbs-down",variant:s.mission.contrat?"success":"info"},null,8,["name","variant"]),p(" "+d(s.mission.contrat?"Contrat établi":"Pas de contrat"),1)]),e("div",null,d(s.mission.heuresRealisees)+" heure"+d(s.mission.heuresRealisees<2?"":"s")+" réalisée"+d(s.mission.heuresRealisees<2?"":"s"),1)])])])],32)],10,Al),_(x,{id:`details-${s.mission.id}`,title:"Détail des heures prévisionnelles"},{body:U(()=>[e("table",gu,[yu,e("tbody",null,[(a(!0),o(y,null,C(s.mission.volumesHorairesPrevus,f=>(a(),o("tr",{key:f.id},[e("td",xu,[_(l,{valeur:f.heures},null,8,["valeur"])]),e("td",null,[_(m,{name:"thumbs-up",variant:"success"}),p(" Saisi par "),_(c,{mail:f.histoCreateur.email,nom:f.histoCreateur.displayName},null,8,["mail","nom"]),p(" le "),_(u,{value:f.histoCreation},null,8,["value"]),Cu,_(m,{name:f.valide?"thumbs-up":"thumbs-down",variant:f.valide?"success":"info"},null,8,["name","variant"]),p(" "+d(f.validation&&f.validation.id==null?"Autovalidé":f.validation?"":"à valider")+" ",1),f.validation&&f.validation.histoCreateur?(a(),o("span",Vu,[p(" Validé par "),_(c,{mail:f.validation.histoCreateur.email,nom:f.validation.histoCreateur.displayName},null,8,["mail","nom"]),p(" le "),_(u,{value:f.validation.histoCreation},null,8,["value"])])):h("",!0)]),e("td",null,[f.canValider?(a(),o("a",{key:0,"data-id":f.id,class:"btn btn-secondary","data-content":"Êtes-vous sur de vouloir valider ce volume horaire ?","data-title":"Validation du volume horaire",onClick:n[5]||(n[5]=P((...A)=>r.volumeHoraireValider&&r.volumeHoraireValider(...A),["prevent"]))},"Valider",8,Su)):h("",!0),f.canDevalider?(a(),o("a",{key:1,"data-id":f.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir dévalider ce volume horaire ?","data-title":"Dévalidation du volume horaire",onClick:n[6]||(n[6]=P((...A)=>r.volumeHoraireDevalider&&r.volumeHoraireDevalider(...A),["prevent"]))},"Dévalider",8,Pu)):h("",!0),f.canSupprimer?(a(),o("a",{key:2,"data-id":f.id,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer le volume horaire ?","data-title":"Suppression du volume horaire",onClick:n[7]||(n[7]=P((...A)=>r.volumeHoraireSupprimer&&r.volumeHoraireSupprimer(...A),["prevent"]))},"Supprimer",8,ku)):h("",!0)])]))),128))])])]),footer:U(()=>[]),_:1},8,["id"])],64)}const oe=S(kl,[["render",Au],["__scopeId","data-v-1735108d"]]),Eu=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),Mu={components:{mission:oe},props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},data(){return{missions:[],isMounted:!1,ajoutUrl:unicaenVue.url("mission/ajout/:intervenant",{intervenant:this.intervenant})}},mounted(){this.reload()},methods:{ajout(t){modAjax(t.currentTarget,n=>{this.reload()})},supprimer(t){this.reload()},refresh(t){let n=Util.json.indexById(this.missions,t.id);this.missions[n]=t,this.refreshPlafonds()},reload(){unicaenVue.axios.get(unicaenVue.url("mission/liste/:intervenant",{intervenant:this.intervenant})).then(t=>{this.missions=t.data,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?($(".plafonds").refresh(),$("#sidebar").refresh()):this.isMounted=!0}}},Du=["href"];function Uu(t,n,s,b,i,r){const u=F("mission");return a(),o(y,null,[(a(!0),o(y,null,C(i.missions,m=>(a(),R(u,{onSupprimer:r.supprimer,onRefresh:r.refresh,key:m.id,mission:m},null,8,["onSupprimer","onRefresh","mission"]))),128)),s.canAddMission?(a(),o("a",{key:0,class:"btn btn-primary",href:i.ajoutUrl,onClick:n[0]||(n[0]=P((...m)=>r.ajout&&r.ajout(...m),["prevent"]))},"Ajout d'une nouvelle mission",8,Du)):h("",!0)],64)}const Tu=S(Mu,[["render",Uu]]),Fu=Object.freeze(Object.defineProperty({__proto__:null,default:Tu},Symbol.toStringTag,{value:"Module"})),Ru={name:"ListeCandidatures.vue",props:{intervenant:{required:!0},canValiderCandidature:{type:Boolean,required:!1},canRefuserCandidature:{type:Boolean,required:!1},renseignerDonneesPersonnelles:{type:Boolean,required:!1}},data(){return{candidatures:[],urlListeOffre:unicaenVue.url("offre-emploi")}},mounted(){this.reload()},computed:{urlDonneesPersonnelles:function(){return unicaenVue.url("intervenant/:intervenant/dossier",{intervenant:this.intervenant})}},methods:{reload(){unicaenVue.axios.get(unicaenVue.url("intervenant/:intervenant/get-candidatures",{intervenant:this.intervenant})).then(t=>{this.candidatures=t.data})},validerCandidature(t){modAjax(t.currentTarget,n=>{this.reload()})},refuserCandidature(t){popConfirm(t.target,n=>{this.reload()})},urlOffre(t){return unicaenVue.url("offre-emploi/detail/:offre",{offre:t.offre.id})},urlAccepterCandidature:function(t){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:t.id})},urlRefuserCandidature:function(t){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:t.id})}}},Iu={key:0,class:"alert alert-primary",role:"alert"},wu=["href"],$u={class:"table table-bordered"},Lu=e("th",null,"Offre d'emploi",-1),Hu=e("th",null,"Composante",-1),Nu=e("th",null,"Etat",-1),ju=e("th",null,"Date commission",-1),Ou={key:0},qu={key:0},zu={key:0,colspan:"5",style:{"text-align":"center"}},Bu={style:{"text-align":"center"}},Gu=["href"],Ju={style:{"text-align":"center"}},Yu={style:{"text-align":"center"}},Qu={key:0,class:"badge rounded-pill bg-success"},Wu={key:1,class:"badge rounded-pill bg-danger"},Xu={key:2,class:"badge rounded-pill bg-warning"},Zu={key:0,style:{"text-align":"center"}},Ku=["href"],ed=e("i",{class:"fa-solid fa-check"},null,-1),td=[ed],nd=["href"],sd=e("i",{class:"fa-sharp fa-solid fa-xmark"},null,-1),rd=[sd],id=["href"];function ad(t,n,s,b,i,r){const u=z,m=j;return a(),o("div",null,[this.renseignerDonneesPersonnelles?(a(),o("div",Iu,[p(" Afin que vos candidatures soient étudiées, veuillez compléter "),e("a",{href:this.urlDonneesPersonnelles},"vos données personnelles",8,wu),p(" et fournir les pièces justificatives qui vous seront demandées. ")])):h("",!0),e("table",$u,[e("thead",null,[e("tr",null,[Lu,Hu,Nu,ju,s.canValiderCandidature||s.canRefuserCandidature?(a(),o("th",Ou,"Action")):h("",!0)])]),e("tbody",null,[i.candidatures.length==0?(a(),o("tr",qu,[s.canValiderCandidature?(a(),o("td",zu,"Aucune candidature")):h("",!0)])):h("",!0),(a(!0),o(y,null,C(i.candidatures,c=>(a(),o("tr",{key:c.id},[e("td",Bu,[e("a",{href:r.urlOffre(c)},d(c.offre.titre),9,Gu)]),e("td",Ju,d(c.offre.structure.libelleCourt),1),e("td",Yu,[c.validation?(a(),o("span",Qu,"Acceptée par "+d(c.validation.histoCreateur.displayName),1)):h("",!0),!c.validation&&c.motif!==null?(a(),o("span",Wu,d(c.motif),1)):h("",!0),!c.validation&&c.motif===null?(a(),o("span",Xu,"En attente d'acceptation")):h("",!0)]),e("td",null,[c.dateCommission?(a(),R(u,{key:0,value:c.dateCommission},null,8,["value"])):h("",!0)]),this.canValiderCandidature||this.canRefuserCandidature?(a(),o("td",Zu,[!c.validation&&this.canValiderCandidature?(a(),o("a",{key:0,href:r.urlAccepterCandidature(c),class:"btn btn-success","data-content":"Êtes vous sûr de vouloir accepter cette candidature ?","data-title":"Accepter la candidature",style:{color:"white"},title:"Accepter la candidature",onClick:n[0]||(n[0]=P((...l)=>r.validerCandidature&&r.validerCandidature(...l),["prevent"]))},td,8,Ku)):h("",!0),p("  "),this.canRefuserCandidature?(a(),o("a",{key:1,href:r.urlRefuserCandidature(c),class:"btn btn-danger","data-content":"Êtes vous sûr de vouloir refuser cette candidature ?","data-title":"Refuser la candidature",style:{color:"white"},title:"Refuser la candidature",onClick:n[1]||(n[1]=P((...l)=>r.refuserCandidature&&r.refuserCandidature(...l),["prevent"]))},rd,8,nd)):h("",!0)])):h("",!0)]))),128))])]),e("a",{href:i.urlListeOffre,class:"btn btn-primary",title:"Voir les offres d'emploi"},[_(m,{name:"eye"}),p(" Voir toutes les offres d'emploi ")],8,id),p("  ")])}const od=S(Ru,[["render",ad]]),ld=Object.freeze(Object.defineProperty({__proto__:null,default:od},Symbol.toStringTag,{value:"Module"})),ud={name:"OffreEmploi.vue",props:{offre:{required:!0},utilisateur:{required:!1},extended:{type:Boolean,required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},decretText:{type:String,required:!1}},data(){return{saisirUrl:unicaenVue.url("offre-emploi/saisir/:offre",{offre:this.offre.id}),supprimerUrl:unicaenVue.url("offre-emploi/supprimer/:offre",{offre:this.offre.id}),validerUrl:unicaenVue.url("offre-emploi/valider/:offre",{offre:this.offre.id}),devaliderUrl:unicaenVue.url("offre-emploi/devalider/:offre",{offre:this.offre.id}),consulterUrl:unicaenVue.url("offre-emploi/detail/:offre",{offre:this.offre.id}),offreEmploiUrl:unicaenVue.url("offre-emploi"),postulerUrl:unicaenVue.url("offre-emploi/postuler/:id",{id:this.offre.id}),decret:!1}},computed:{isCandidat:function(){return!1},shortDesc:function(){if(!this.offre.description)return"";let t=this.offre.description.substr(0,200);return this.offre.description.length>200&&(t+="..."),t},descriptionHtml:function(){return this.offre.description?this.offre.description.replace(/(?:\r\n|\r|\n)/g,"<br />"):""},connectionLink:function(){let t="auth/connexion?redirect="+window.location.href;return unicaenVue.url(t)}},mounted(){this.decretText||(this.decret=!0)},methods:{saisir(t){modAjax(t.target,n=>{this.refresh()})},urlVoir:function(t){return unicaenVue.url("intervenant/:code/voir",{code:"code:"+t.intervenant.code})},urlVoirCandidature:function(t){return unicaenVue.url("intervenant/:code/candidature",{code:"code:"+t.intervenant.code})},urlAccepterCandidature:function(t){return unicaenVue.url("offre-emploi/accepter-candidature/:id",{id:t.id})},urlRefuserCandidature:function(t){return unicaenVue.url("offre-emploi/refuser-candidature/:id",{id:t.id})},refresh(){unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.offre.id})).then(t=>{this.$emit("refresh",t.data)})},supprimer(t){popConfirm(t.target,n=>{this.$emit("supprimer",this.offre)})},postuler(t){popConfirm(t.target,n=>{this.$emit("postuler",this.offre)})},valider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},devalider(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},validerCandidature(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})},refuserCandidature(t){popConfirm(t.currentTarget,n=>{this.$emit("refresh",n.data)})}}},dd={key:0,class:"col"},cd={class:"card h-100"},md={class:"card-header"},hd={class:"badge rounded-pill bg-info"},_d={key:0,class:"badge rounded-pill bg-success"},pd={key:1,class:"badge rounded-pill bg-warning"},fd={class:"card-body"},bd={class:"bg-light",style:{padding:"5px"}},vd=e("b",null,"Créée le : ",-1),gd=e("br",null,null,-1),yd=e("b",null,"Période à pourvoir : ",-1),xd=e("br",null,null,-1),Cd=e("b",null,"Demandée par la composante :",-1),Vd=e("br",null,null,-1),Sd=e("b",null,"Type de mission :",-1),Pd={class:"card-footer"},kd={class:"d-grid gap-2 d-md-flex justify-content-md-end"},Ad=["href"],Ed={key:1},Md={class:"page-header"},Dd={key:0,class:"alert alert-primary d-flex align-items-center",role:"alert"},Ud=e("i",{class:"fa-solid fa-user"},null,-1),Td={class:"ms-2"},Fd=["href"],Rd={key:1,class:"alert alert-primary d-flex align-items-center",role:"alert"},Id=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),wd=e("div",{class:"ms-2"}," Vous n'avez pas les droits pour postuler à cette offre, merci de contacter votre administration de rattachement. ",-1),$d=[Id,wd],Ld={key:2,class:"alert alert-primary d-flex align-items-center",role:"alert"},Hd=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),Nd=e("div",{class:"ms-2"}," Vous avez déjà postulé à cette offre. ",-1),jd=[Hd,Nd],Od={class:"bg-light",style:{padding:"10px"}},qd=e("b",null,"Créée le : ",-1),zd=e("br",null,null,-1),Bd=e("b",null,"Période à pourvoir : ",-1),Gd=e("br",null,null,-1),Jd=e("b",null,"Date limite de candidature :",-1),Yd=e("br",null,null,-1),Qd=e("b",null,"Demandé par la composante :",-1),Wd=e("br",null,null,-1),Xd=e("b",null,"Type de mission :",-1),Zd=e("br",null,null,-1),Kd=e("b",null,"Nombre d'heures pour la mission :",-1),ec=e("br",null,null,-1),tc=e("b",null,"Nombre de postes à pourvoir :",-1),nc=e("br",null,null,-1),sc=["innerHTML"],rc={key:3,class:"alert alert-info"},ic=["innerHTML"],ac=e("br",null,null,-1),oc={key:4},lc=e("h5",null,[e("strong",null,"Liste des candidats :")],-1),uc={class:"table table-bordered"},dc=e("th",null,"Intervenant",-1),cc=e("th",null,"Etat",-1),mc={key:0},hc={key:0},_c={key:0,colspan:"4",style:{"text-align":"center"}},pc={key:1,colspan:"3",style:{"text-align":"center"}},fc=["href"],bc={key:0,class:"badge rounded-pill bg-success"},vc={key:1,class:"badge rounded-pill bg-danger"},gc={key:2,class:"badge rounded-pill bg-warning"},yc={key:0},xc=["href"],Cc={class:"mt-5"},Vc=["href"],Sc=["href"],Pc=["href"],kc=["href"],Ac=["href"],Ec=["href"];function Mc(t,n,s,b,i,r){const u=z,m=j;return a(),o(y,null,[this.extended?h("",!0):(a(),o("div",dd,[e("div",cd,[e("div",md,[e("h4",null,d(s.offre.titre),1),e("span",hd,d(s.offre.nombreHeures)+" heure(s)",1),p("   "),s.offre.validation?(a(),o("span",_d,[p("Validée le "),_(u,{value:s.offre.validation.histoCreation},null,8,["value"]),p(" par "+d(s.offre.validation.histoCreateur.displayName),1)])):h("",!0),s.offre.validation?h("",!0):(a(),o("span",pd," En attente de validation par la DRH")),p("  ")]),e("div",fd,[e("p",bd,[vd,_(u,{value:s.offre.histoCreation},null,8,["value"]),p(" par "+d(s.offre.histoCreateur.displayName),1),gd,yd,p("du "),_(u,{value:s.offre.dateDebut},null,8,["value"]),p(" au "),_(u,{value:s.offre.dateFin},null,8,["value"]),xd,Cd,p(" "+d(s.offre.structure.libelleCourt)+" ",1),Vd,Sd,p(" "+d(s.offre.typeMission.libelle),1)]),p(" "+d(r.shortDesc),1)]),e("div",Pd,[e("div",kd,[e("a",{href:i.consulterUrl,class:"btn btn-primary",title:"Consulter "},[_(m,{name:"eye"}),p(" Voir ")],8,Ad)])])])])),this.extended?(a(),o("div",Ed,[e("h1",Md,d(s.offre.titre),1),this.utilisateur?h("",!0):(a(),o("div",Dd,[Ud,e("div",Td,[p(" Vous devez "),e("a",{href:r.connectionLink,class:"text-decoration-underline alert-link"},"être identifé",8,Fd),p(" pour pouvoir postuler. ")])])),!s.offre.canPostuler&&this.utilisateur?(a(),o("div",Rd,$d)):h("",!0),r.isCandidat&&this.utilisateur?(a(),o("div",Ld,jd)):h("",!0),e("p",Od,[qd,_(u,{value:s.offre.histoCreation},null,8,["value"]),p(" par "+d(s.offre.histoCreateur.displayName),1),zd,Bd,p("du "),_(u,{value:s.offre.dateDebut},null,8,["value"]),p(" au "),_(u,{value:s.offre.dateFin},null,8,["value"]),Gd,Jd,_(u,{value:s.offre.dateLimite},null,8,["value"]),Yd,Qd,p(" "+d(s.offre.structure.libelleCourt)+" ",1),Wd,Xd,p(" "+d(s.offre.typeMission.libelle)+" ",1),Zd,Kd,p(" "+d(s.offre.nombreHeures)+" heure(s) ",1),ec,tc,p(" "+d(s.offre.nombrePostes)+" poste(s) ",1),nc]),e("p",{innerHTML:this.descriptionHtml},null,8,sc),this.decretText?(a(),o("p",rc,[v(e("input",{id:"decret","onUpdate:modelValue":n[0]||(n[0]=c=>i.decret=c),name:"decret",type:"checkbox"},null,512),[[J,i.decret]]),p("  "),e("span",{innerHTML:this.decretText},null,8,ic)])):h("",!0),ac,this.canVoirCandidature?(a(),o("div",oc,[lc,e("table",uc,[e("thead",null,[e("tr",null,[dc,cc,s.canValiderCandidature?(a(),o("th",mc,"Action")):h("",!0)])]),e("tbody",null,[s.offre.candidatures.length==0?(a(),o("tr",hc,[s.canValiderCandidature?(a(),o("td",_c,"Aucune candidature")):h("",!0),s.canValiderCandidature?h("",!0):(a(),o("td",pc,"Aucune candidature"))])):h("",!0),(a(!0),o(y,null,C(s.offre.candidatures,c=>(a(),o("tr",null,[e("td",null,[e("a",{href:r.urlVoir(c)},d(c.intervenant.prenom+" "+c.intervenant.nomUsuel),9,fc)]),e("td",null,[c.validation?(a(),o("span",bc,[p("Acceptée le "),_(u,{value:c.validation.histoCreation},null,8,["value"]),p(" par "+d(c.validation.histoCreateur.displayName),1)])):h("",!0),!c.validation&&c.motif!==null?(a(),o("span",vc,d(c.motif),1)):h("",!0),!c.validation&&c.motif===null?(a(),o("span",gc,"En attente d'acceptation")):h("",!0)]),this.canValiderCandidature?(a(),o("td",yc,[e("a",{href:r.urlVoirCandidature(c),class:"btn btn-primary",title:"Consulter "},[_(m,{name:"eye"}),p(" Voir ")],8,xc)])):h("",!0)]))),256))])])])):h("",!0),e("div",Cc,[e("a",{href:i.offreEmploiUrl,class:"btn btn-secondary"},"Retour aux offres",8,Vc),p("  "),this.canPostuler?(a(),o("a",{key:0,class:M([i.decret?"":"disabled","btn btn-primary"]),href:i.postulerUrl,"data-bs-original-title":"Vous devez être connecté pour postuler","data-bs-placement":"top","data-bs-toggle":"tooltip"},"Postuler",10,Sc)):h("",!0),p("  "),s.offre.canModifier?(a(),o("a",{key:1,href:i.saisirUrl,class:"btn btn-primary",title:"Modifier",onClick:n[1]||(n[1]=P((...c)=>r.saisir&&r.saisir(...c),["prevent"]))},[_(m,{name:"pen-to-square"}),p(" Modifier ")],8,Pc)):h("",!0),p("  "),s.offre.validation&&s.offre.canValider?(a(),o("a",{key:2,href:i.devaliderUrl,class:"btn btn-danger",title:"Devalider",onClick:n[2]||(n[2]=P((...c)=>r.devalider&&r.devalider(...c),["prevent"]))},[_(m,{name:"thumbs-down"}),p(" Devalider ")],8,kc)):h("",!0),p("  "),!s.offre.validation&&s.offre.canValider?(a(),o("a",{key:3,href:i.validerUrl,class:"btn btn-success",title:"Valider",onClick:n[3]||(n[3]=P((...c)=>r.valider&&r.valider(...c),["prevent"]))},[_(m,{name:"thumbs-up"}),p(" Valider ")],8,Ac)):h("",!0),p("  "),s.offre.canSupprimer?(a(),o("a",{key:4,href:i.supprimerUrl,class:"btn btn-danger","data-content":"Êtes-vous sur de vouloir supprimer l'offre ?","data-title":"Suppression de l'offre",title:"Supprimer",onClick:n[4]||(n[4]=P((...c)=>r.supprimer&&r.supprimer(...c),["prevent"]))},[_(m,{name:"trash"}),p(" Supprimer ")],8,Ec)):h("",!0)])])):h("",!0)],64)}const le=S(ud,[["render",Mc]]),Dc=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"})),Uc={components:{offreEmploi:le},props:{id:{type:Number,required:!1},utilisateur:{required:!1},canModifier:{type:Boolean,required:!1},canPostuler:{type:Boolean,required:!1},canValider:{type:Boolean,required:!1},canVoirCandidature:{type:Boolean,required:!1},canValiderCandidature:{type:Boolean,required:!1},canSupprimer:{type:Boolean,required:!1}},data(){return{offres:[],ajoutUrl:unicaenVue.url("offre-emploi/saisir")}},mounted(){this.reload()},computed:{extended:function(){return!!this.id}},methods:{ajout(t){modAjax(t.target,n=>{this.reload()})},supprimer(){window.location.href=unicaenVue.url("offre-emploi")},refresh(t){let n=Util.json.indexById(this.offres,t.id);this.offres[n]=t},reload(){this.id?unicaenVue.axios.get(unicaenVue.url("offre-emploi/get/:offreEmploi",{offreEmploi:this.id})).then(t=>{this.offres=[t.data]}):unicaenVue.axios.get(unicaenVue.url("offre-emploi/liste")).then(t=>{this.offres=t.data})}}},Tc={key:0,class:"row row-cols-1 row-cols-md-2 g-4 mb-3"},Fc={key:1},Rc=["href"],Ic={key:2};function wc(t,n,s,b,i,r){const u=F("offreEmploi");return a(),o(y,null,[r.extended?h("",!0):(a(),o("div",Tc,[(a(!0),o(y,null,C(i.offres,m=>(a(),R(u,{key:m.id,canModifier:this.canModifier,canSupprimer:this.canSupprimer,canValider:this.canValider,canVoirCandidature:this.canVoirCandidature,offre:m,decretText:m.decretText,onRefresh:r.refresh,onSupprimer:r.supprimer},null,8,["canModifier","canSupprimer","canValider","canVoirCandidature","offre","decretText","onRefresh","onSupprimer"]))),128))])),r.extended?h("",!0):(a(),o("div",Fc,[this.canModifier?(a(),o("a",{key:0,href:i.ajoutUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=P((...m)=>r.ajout&&r.ajout(...m),["prevent"]))},"Ajouter une nouvelle offre",8,Rc)):h("",!0)])),r.extended?(a(),o("div",Ic,[(a(!0),o(y,null,C(i.offres,m=>(a(),R(u,{key:m.id,canModifier:this.canModifier,canPostuler:this.canPostuler,canSupprimer:this.canSupprimer,canValider:this.canValider,canValiderCandidature:this.canValiderCandidature,canVoirCandidature:this.canVoirCandidature,decretText:m.decretText,extended:r.extended,offre:m,utilisateur:this.utilisateur,onRefresh:r.refresh,onSupprimer:r.supprimer},null,8,["canModifier","canPostuler","canSupprimer","canValider","canValiderCandidature","canVoirCandidature","decretText","extended","offre","utilisateur","onRefresh","onSupprimer"]))),128))])):h("",!0)],64)}const $c=S(Uc,[["render",wc]]),Lc=Object.freeze(Object.defineProperty({__proto__:null,default:$c},Symbol.toStringTag,{value:"Module"})),Hc={name:"Prime.vue",props:{prime:{required:!0},numero:{required:!1},intervenant:{required:!0},canGerer:{type:Boolean,required:!1}},data(){return{declarationUrl:unicaenVue.url("prime/:intervenant/declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerUrl:unicaenVue.url("prime/:intervenant/supprimer-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),validerUrl:unicaenVue.url("prime/:intervenant/valider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),devaliderUrl:unicaenVue.url("prime/:intervenant/devalider-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),telechargerUrl:unicaenVue.url("prime/:intervenant/telecharger-declaration-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),refuserUrl:unicaenVue.url("prime/:intervenant/refuser-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id}),modifierPrimeUrl:unicaenVue.url("prime/:intervenant/saisie/:prime",{intervenant:this.intervenant,prime:this.prime.id}),supprimerPrimeUrl:unicaenVue.url("prime/:intervenant/supprimer-prime/:prime",{intervenant:this.intervenant,prime:this.prime.id})}},computed:{},methods:{supprimer(t){popConfirm(t.target,n=>{this.$emit("reload")})},valider(t){popConfirm(t.target,n=>{this.$emit("reload")})},devalider(t){popConfirm(t.target,n=>{this.$emit("reload")})},refuser(){unicaenVue.axios.post(this.refuserUrl).then(t=>{this.$emit("reload")})},modifierPrime(t){modAjax(t.currentTarget,n=>{this.$emit("reload")})},supprimerPrime(t){popConfirm(t.target,n=>{this.$emit("reload")})}}},Nc={key:0},jc=e("br",null,null,-1),Oc=e("u",null,"Mission(s) concernée(s)",-1),qc={key:0},zc=["action"],Bc={class:"card-body"},Gc={class:"row"},Jc={key:0,class:"col-md-6"},Yc={class:"card text-dark bg-light"},Qc=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),Wc={class:"card-body"},Xc=e("p",{class:"card-text"},[p(" Pour "),e("b",null,"bénéficier de votre indemnité de fin de contrat"),p(", vous devez déposer une déclaration sur l'honneur ("),e("a",{href:""},"exemple"),p(") signée précisant que vous ne débutez pas d'autre contrat dans la fonction au publique à la suite de ces missions. ")],-1),Zc=["disabled"],Kc={class:"card-footer d-grid gap-2"},em=["disabled"],tm={key:1,class:"col-md-6"},nm={class:"card text-dark bg-light"},sm=e("div",{class:"card-header"}," Dépôt de votre déclaration sur l'honneur ",-1),rm={class:"card-body"},im=e("p",{class:"card-text"},"Vous pouvez télécharger votre déclaration sur l'honneur ci-dessous : ",-1),am=["href"],om={class:"card-footer",style:{"text-align":"right"}},lm=["href"],um=["href"],dm=["href"],cm={class:"col-md-6"},mm={key:0},hm=["checked","disabled"],_m=e("b",null,"je déclare ne pas pouvoir bénéficier d'une indemnité",-1),pm=e("br",null,null,-1),fm=e("br",null,null,-1),bm=e("div",null,[e("label",{class:"form-label"},"Suivi de la déclaration : ")],-1),vm={key:0},gm={key:1},ym={key:2},xm={key:3},Cm={key:4},Vm={key:5},Sm={key:6},Pm={class:"row"},km={class:"col-md-12"},Am={class:"float-end"},Em=["href"],Mm=["href"];function Dm(t,n,s,b,i,r){const u=z,m=j;return a(),o("div",{class:M([{"bg-success":s.prime.validation,"bg-default":!s.prime.validation&&!s.prime.dateRefus,"bg-danger":s.prime.dateRefus},"card"])},[e("div",{class:M([{"text-white":s.prime.dateRefus},"card-header card-header-h3"])},[s.prime.id?(a(),o("h5",Nc,[p(" Indemnité de fin de contrat N°"+d(s.numero+1),1),jc])):h("",!0),e("div",null,[Oc,p(" : "),(a(!0),o(y,null,C(s.prime.missions,(c,l)=>(a(),o("span",null,[p(d(c.typeMission.libelle)+" (Pour "+d(c.structure.libelleCourt)+" du ",1),_(u,{value:c.dateDebut},null,8,["value"]),p(" au "),_(u,{value:c.dateFin},null,8,["value"]),p(") "),l!=s.prime.missions.length-1?(a(),o("span",qc,", ")):h("",!0)]))),256))])],2),e("form",{action:i.declarationUrl,enctype:"multipart/form-data",method:"post"},[e("div",Bc,[e("div",Gc,[s.prime.declaration?h("",!0):(a(),o("div",Jc,[e("div",Yc,[Qc,e("div",Wc,[Xc,e("input",{ref:"file",disabled:!!s.prime.dateRefus,name:"files[]",type:"file"},null,8,Zc)]),e("div",Kc,[e("input",{disabled:!!s.prime.dateRefus,class:"btn btn-primary",type:"submit",value:"Envoyer"},null,8,em)])])])),s.prime.declaration?(a(),o("div",tm,[e("div",nm,[sm,e("div",rm,[im,e("a",{href:i.telechargerUrl},d(s.prime.declaration.nom),9,am)]),e("div",om,[s.prime.declaration&&!s.prime.validation&&!s.prime.dateRefus?(a(),o("a",{key:0,href:i.supprimerUrl,class:"btn btn-danger",title:"Supprimer",onClick:n[0]||(n[0]=P((...c)=>r.supprimer&&r.supprimer(...c),["prevent"]))}," Supprimer ",8,lm)):h("",!0),p("  "),s.prime.declaration&&!s.prime.validation&&this.canGerer&&!s.prime.dateRefus?(a(),o("a",{key:1,href:i.validerUrl,class:"btn btn-success",title:"Valider",onClick:n[1]||(n[1]=P((...c)=>r.valider&&r.valider(...c),["prevent"]))}," Valider ",8,um)):h("",!0),p("  "),s.prime.declaration&&s.prime.validation&&this.canGerer&&!s.prime.dateRefus?(a(),o("a",{key:2,href:i.devaliderUrl,class:"btn btn-danger d-grid gap-2",title:"Dévalider",onClick:n[2]||(n[2]=P((...c)=>r.devalider&&r.devalider(...c),["prevent"]))}," Dévalider ",8,dm)):h("",!0),p("  ")])])])):h("",!0),e("div",cm,[s.prime.validation?h("",!0):(a(),o("div",mm,[e("input",{checked:s.prime.dateRefus,disabled:s.prime.validation,name:"prime",type:"checkbox",onChange:n[3]||(n[3]=(...c)=>r.refuser&&r.refuser(...c))},null,40,hm),p("  Ou en cochant cette case, "),_m,p(" de fin de contrat en raison du démarrage d'un nouveau contrat au sein de la fonction publique à la suite de ces missions. "),pm,fm])),e("div",null,[bm,s.prime.dateRefus?(a(),o("div",vm,[_(m,{name:"thumbs-down",variant:"danger"}),p(" Indemnité refusée le "),_(u,{value:s.prime.dateRefus},null,8,["value"])])):h("",!0),s.prime.declaration&&!s.prime.dateRefus?(a(),o("div",gm,[_(m,{name:"thumbs-up",variant:"success"}),p(" Déclaration déposée le "),_(u,{value:s.prime.declaration.histoCreation},null,8,["value"]),p(" par "+d(s.prime.declaration.histoCreateur.displayName),1)])):h("",!0),!s.prime.declaration&&!s.prime.dateRefus?(a(),o("div",ym,[_(m,{name:"thumbs-down",variant:"info"}),p(" Aucune déclaration déposée ")])):h("",!0),s.prime.validation&&!s.prime.dateRefus?(a(),o("div",xm,[_(m,{name:"thumbs-up",variant:"success"}),p(" Déclaration validée le "),_(u,{value:s.prime.validation.histoCreation},null,8,["value"]),p(" par "+d(s.prime.validation.histoCreateur.displayName),1)])):h("",!0),!s.prime.validation&&!s.prime.dateRefus?(a(),o("div",Cm,[_(m,{name:"thumbs-down",variant:"info"}),p(" Aucune déclaration validée ")])):h("",!0),s.prime.validation&&!s.prime.dateRefus?(a(),o("div",Vm,[_(m,{name:"euro-sign",variant:"success"}),p(" Intervenant éligible à une indemnité de fin de contrat ")])):h("",!0),s.prime.dateRefus?(a(),o("div",Sm,[_(m,{name:"euro-sign",variant:"info"}),p(" Intervenant non éligible à une indemnité de fin de contrat ")])):h("",!0)])])]),e("div",Pm,[e("div",km,[e("span",Am,[!s.prime.validation&&!s.prime.dateRefus&&this.canGerer?(a(),o("a",{key:0,href:i.modifierPrimeUrl,class:"btn btn-primary",onClick:n[4]||(n[4]=P((...c)=>r.modifierPrime&&r.modifierPrime(...c),["prevent"]))},"Modifier",8,Em)):h("",!0),p("   "),!s.prime.validation&&!s.prime.dateRefus&&this.canGerer?(a(),o("a",{key:1,href:i.supprimerPrimeUrl,class:"btn btn-danger",onClick:n[5]||(n[5]=P((...c)=>r.supprimerPrime&&r.supprimerPrime(...c),["prevent"]))},"Supprimer",8,Mm)):h("",!0)])])])])],8,zc)],2)}const ue=S(Hc,[["render",Dm]]),Um=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),Tm={components:{prime:ue},props:{intervenant:{type:Number,required:!0},numero:{type:Number,required:!1},missionsWithoutPrime:{type:Number,required:!1},canGerer:{type:Boolean,required:!1}},data(){return{load:!1,primes:[],ajoutUrl:unicaenVue.url("prime/:intervenant/saisie/",{intervenant:this.intervenant})}},mounted(){this.reload(),console.log(this.primes.length)},methods:{ajout(t){modAjax(t.currentTarget,n=>{this.reload()})},reload(){this.load=!1,this.primes=[],unicaenVue.axios.get(unicaenVue.url("prime/:intervenant/liste",{intervenant:this.intervenant})).then(t=>{this.primes=t.data,this.load=!0})}}},Fm={key:0,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},Rm=e("br",null,null,-1),Im=e("br",null,null,-1),wm={key:1,class:"text-secondary text-center fs-6",style:{"text-align":"center"}},$m=e("br",null,null,-1),Lm=e("br",null,null,-1),Hm={key:2},Nm=["href"];function jm(t,n,s,b,i,r){const u=F("prime");return a(),o(y,null,[(a(!0),o(y,null,C(i.primes,(m,c)=>(a(),R(u,{canGerer:s.canGerer,intervenant:this.intervenant,numero:c,prime:m,onReload:r.reload},null,8,["canGerer","intervenant","numero","prime","onReload"]))),256)),i.load?h("",!0):(a(),o("div",Fm,[p(" Chargement en cours..."),Rm,Im])),i.primes.length==0&&i.load?(a(),o("div",wm,[p(" Aucune indemnité de fin de contrat actuellement..."),$m,Lm])):h("",!0),this.missionsWithoutPrime>0&&this.canGerer?(a(),o("div",Hm,[e("a",{href:i.ajoutUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=P((...m)=>r.ajout&&r.ajout(...m),["prevent"]))},"Créer une nouvelle indemnité",8,Nm)])):h("",!0)],64)}const Om=S(Tm,[["render",jm]]),qm=Object.freeze(Object.defineProperty({__proto__:null,default:Om},Symbol.toStringTag,{value:"Module"})),zm={name:"UCalendar",props:{date:{type:Date,required:!0},events:{type:Array,required:!0},canAddEvent:{type:Boolean,required:!0,default:!0},addDateDebut:{type:String,required:!1},addDateFin:{type:String,required:!1}},data(){const t=new Date(this.date);return{mois:t.getMonth()+1,annee:t.getFullYear()}},computed:{listeJours(){const t=new Date(this.date);t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(t.getDate()-1);let n=t.getDate();return Array.from({length:n},(s,b)=>b+1)}},watch:{date:function(t,n){const s=new Date(this.date);this.mois=s.getMonth()+1,this.annee=s.getFullYear()},mois:function(t,n){const s=new Date(this.date);s.setMonth(t-1),this.$emit("changeDate",s)},annee:function(t,n){const s=new Date(this.date);s.setFullYear(t),this.$emit("changeDate",s)}},methods:{nomJour(t){const n=new Date(this.date);return n.setDate(t),n.toLocaleString("fr-FR",{weekday:"short"})},listeMois(){let t=[];const n=new Date;for(let s=1;s<=12;s++){n.setMonth(s-1);let b=n.toLocaleString("fr-FR",{month:"long"});t.push({id:s,libelle:b})}return t},listeAnnees(){const n=new Date().getFullYear(),s=1;let b=[];for(let i=n-s;i<=n+s;i++)b.push(i);return b},canAdd(t){if(!this.canAddEvent)return!1;let n=this.addDateDebut;n===void 0?n=new Date("2000-01-01"):n==="now"?n=new Date:n=new Date(n);let s=this.addDateFin;s===void 0?s=new Date("2500-01-01"):s==="now"?s=new Date:s=new Date(s);let b=new Date(this.date);return b.setDate(t),n=this.isoDateOnly(n),s=this.isoDateOnly(s),b=this.isoDateOnly(b),!(b<n||b>s)},addEvent(t){const n=new Date(this.date);n.setDate(t.currentTarget.dataset.jour),this.$emit("addEvent",n,t)},prevMois(){const t=new Date(this.date);t.setMonth(t.getMonth()-1),this.$emit("changeDate",t)},nextMois(){const t=new Date(this.date);t.setMonth(t.getMonth()+1),this.$emit("changeDate",t)},eventsByJour(t){const n=new Date(this.date);let s={};for(let b in this.events){let i=this.events[b];i.date.getFullYear()===n.getFullYear()&&i.date.getMonth()+1===n.getMonth()+1&&i.date.getDate()===t&&(s[b]=i)}return s},isoDateOnly(t){const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),b=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${b}`}}},Bm={class:"calendar"},Gm={class:"recherche"},Jm={class:"recherche btn-group"},Ym=["value"],Qm=["value"],Wm={class:"table table-bordered table-hover table-sm"},Xm=["data-jour"],Zm={class:"nom-jour"},Km={class:"numero-jour"},eh={class:"num-jour badge bg-secondary rounded-circle"},th={key:0},nh=["data-jour"];function sh(t,n,s,b,i,r){const u=j;return a(),o("div",Bm,[e("div",Gm,[e("div",Jm,[e("button",{class:"btn btn-light",id:"prevMois",onClick:n[0]||(n[0]=(...m)=>r.prevMois&&r.prevMois(...m)),title:"Mois précédant"},[_(u,{name:"chevron-left"})]),v(e("select",{class:"form-select btn btn-light",id:"otherMois","onUpdate:modelValue":n[1]||(n[1]=m=>i.mois=m)},[(a(!0),o(y,null,C(r.listeMois(),m=>(a(),o("option",{value:m.id},d(m.libelle),9,Ym))),256))],512),[[T,i.mois]]),v(e("select",{class:"form-select btn btn-light",id:"otherAnnee","onUpdate:modelValue":n[2]||(n[2]=m=>i.annee=m)},[(a(!0),o(y,null,C(r.listeAnnees(),m=>(a(),o("option",{value:m},d(m),9,Qm))),256))],512),[[T,i.annee]]),e("button",{class:"btn btn-light",id:"nextMois",onClick:n[3]||(n[3]=(...m)=>r.nextMois&&r.nextMois(...m)),title:"Mois suivant"},[_(u,{name:"chevron-right"})])])]),e("table",Wm,[(a(!0),o(y,null,C(r.listeJours,m=>(a(),o("tr",{"data-jour":m},[e("th",Zm,d(r.nomJour(m)),1),e("th",Km,[e("div",eh,d(m<10?"0"+m.toString():m),1)]),e("td",null,[(a(!0),o(y,null,C(r.eventsByJour(m),(c,l)=>(a(),o("div",{class:"event",style:X("border-color:"+c.color+";background-color:"+c.bgcolor),key:l},[(a(),R(be(c.component),{event:c},null,8,["event"]))],4))),128)),r.canAdd(m)?(a(),o("div",th,[e("button",{onClick:n[4]||(n[4]=(...c)=>r.addEvent&&r.addEvent(...c)),"data-jour":m,class:"btn btn-light btn-sm"},[_(u,{name:"plus"}),p(" Nouvel événement ")],8,nh)])):h("",!0)])],8,Xm))),256))])])}const rh=S(zm,[["render",sh],["__scopeId","data-v-0606e4c1"]]),ih={name:"SuiviEvent",props:{event:{type:Object,required:!0}},data(){return{suivi:this.$parent.$parent,modifierUrl:unicaenVue.url("mission/suivi/modifier/:id",{id:this.event.id}),supprimerUrl:unicaenVue.url("mission/suivi/supprimer/:id",{id:this.event.id}),validerUrl:unicaenVue.url("mission/suivi/valider/:id",{id:this.event.id}),devaliderUrl:unicaenVue.url("mission/suivi/devalider/:id",{id:this.event.id})}},computed:{heureDebut(){return this.event.heureDebut.toString().replace(":","h")},heureFin(){return this.event.heureFin.toString().replace(":","h")},heures(){return Util.floatToString(this.event.heures)}},methods:{modifier(t){modAjax(t.currentTarget,n=>{this.suivi.refresh()})},supprimer(t){popConfirm(t.currentTarget,n=>{this.suivi.refresh()})},valider(t){unicaenVue.axios.get(this.validerUrl).then(n=>{this.suivi.refresh()})},devalider(t){popConfirm(t.currentTarget,n=>{this.suivi.refresh()})}}},ah={class:"event-content"},oh={class:"mission"},lh={key:0,class:"badge bg-success"},uh={class:"horaires"},dh={key:0,class:"badge bg-secondary"},ch={key:0,class:"description"},mh={class:"event-actions"},hh={class:"btn-group btn-group-sm"},_h=["data-url"],ph=["data-url"],fh=["data-url"],bh=["data-url"];function vh(t,n,s,b,i,r){const u=j;return a(),o(y,null,[e("div",ah,[e("p",oh,[p(d(s.event.mission.libelleCourt)+" ",1),s.event.valide?(a(),o("span",lh,"Validé")):h("",!0)]),e("p",uh,[p(" de "+d(r.heureDebut)+" à "+d(r.heureFin)+", soit "+d(r.heures)+" heure"+d(r.heures<2?"":"s")+" ",1),s.event.formation?(a(),o("span",dh,"En formation")):h("",!0)]),s.event.description?(a(),o("p",ch,d(s.event.description),1)):h("",!0)]),e("div",mh,[e("div",hh,[s.event.canEdit?(a(),o("button",{key:0,class:"btn btn-light",onClick:n[0]||(n[0]=(...m)=>r.modifier&&r.modifier(...m)),title:"Modifier le suivi","data-url":i.modifierUrl},[_(u,{name:"pen-to-square"})],8,_h)):h("",!0),s.event.canValider?(a(),o("button",{key:1,class:"btn btn-light",onClick:n[1]||(n[1]=(...m)=>r.valider&&r.valider(...m)),title:"Valider le suivi","data-url":i.validerUrl},[_(u,{name:"check",class:"text-success"})],8,ph)):h("",!0),s.event.canDevalider?(a(),o("button",{key:2,class:"btn btn-light",onClick:n[2]||(n[2]=(...m)=>r.devalider&&r.devalider(...m)),title:"Dévalider le suivi","data-url":i.devaliderUrl,"data-content":"Voulez-vous vraiment dévalider ce suivi ?"},[_(u,{name:"xmark",class:"text-danger"})],8,fh)):h("",!0),s.event.canSupprimer?(a(),o("button",{key:3,class:"btn btn-light",onClick:n[3]||(n[3]=(...m)=>r.supprimer&&r.supprimer(...m)),title:"Supprimer le suivi","data-url":i.supprimerUrl,"data-content":"Voulez-vous vraiment supprimer ce suivi ?"},[_(u,{name:"trash-can",class:"text-danger"})],8,bh)):h("",!0)])])],64)}const de=S(ih,[["render",vh],["__scopeId","data-v-17cb1f29"]]),gh=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"})),yh={name:"Suivi",props:{intervenant:{type:Number,required:!0},canAddMission:{type:Boolean,required:!0}},mounted(){this.refresh()},data(){return{date:new Date,isMounted:!1,suivi:[]}},methods:{changeDate(t){this.date=t},ajouter(t,n){const s={intervenant:this.intervenant,date:t.toISOString().slice(0,10)};n.currentTarget.dataset.url=unicaenVue.url("mission/suivi/ajout/:intervenant/:date",s),modAjax(n.currentTarget,b=>{this.refresh()})},refresh(){const t=["#e74c3c","#8e44ad","#3498db","#1abc9c","#2ecc71","#f1c40f","#e67e22","#d35400"];let n=0,s=[];unicaenVue.axios.get(unicaenVue.url("mission/suivi/liste/:intervenant",{intervenant:this.intervenant})).then(b=>{let i=[];for(let r in b.data){let u=b.data[r];s[u.mission.id]===void 0&&(s[u.mission.id]=t[n],n++),u.valide&&(u.bgcolor="#d0eddb"),u.color=s[u.mission.id],u.component=ve(de),u.date=new Date(u.date),u.intervenant=this.intervenant,i.push(u)}this.suivi=i,this.refreshPlafonds()})},refreshPlafonds(){this.isMounted?$(".plafonds").refresh():this.isMounted=!0}}};function xh(t,n,s,b,i,r){const u=rh;return a(),R(u,{date:i.date,onChangeDate:r.changeDate,onAddEvent:r.ajouter,"can-add-event":s.canAddMission,addDateFin:"now",events:i.suivi},null,8,["date","onChangeDate","onAddEvent","can-add-event","events"])}const Ch=S(yh,[["render",xh]]),Vh=Object.freeze(Object.defineProperty({__proto__:null,default:Ch},Symbol.toStringTag,{value:"Module"})),Sh={name:"DemandeMiseEnPaiementStructure",props:{datas:{required:!0},intervenant:{required:!0}},data(){return{dotationPaieEtat:this.datas.budget.dotation.paieEtat,dotationRessourcesPropres:this.datas.budget.dotation.ressourcePropre,consommationPaieEtat:this.datas.budget.liquidation.paieEtat,consommationRessourcesPropres:this.datas.budget.liquidation.ressourcePropre}},watch:{datas:function(){this.dotationPaieEtat=this.datas.budget.dotation.paieEtat,this.dotationRessourcesPropres=this.datas.budget.dotation.ressourcePropre,this.consommationPaieEtat=this.datas.budget.liquidation.paieEtat,this.consommationRessourcesPropres=this.datas.budget.liquidation.ressourcePropre}},computed:{pourcentagePaieEtat(){return Math.round(this.consommationPaieEtat/this.dotationPaieEtat*100)},pourcentageRessourcePropre(){return Math.round(this.consommationRessourcesPropres/this.dotationRessourcesPropres*100)},bgPaieEtat(){return Math.round(this.consommationPaieEtat/this.dotationPaieEtat*100)>100?"bg-warning":"bg-success"},bgRessourcesPropres(){return Math.round(this.consommationRessourcesPropres/this.dotationRessourcesPropres*100)>100?"bg-warning":"bg-success"}},methods:{heuresStatutToString(t){if(t.heuresAPayer==t.heuresPayees&&t.heuresAPayer>0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-success">Paiement effectué</span>';if(t.heuresAPayer==t.heuresDemandees)return'<span style="font-size:12px;line-height:20px;" class="badge bg-secondary text-dark">Paiement demandé</span>';if(t.heuresDemandees==0)return'<span style="font-size:12px;line-height:20px;" class="badge bg-light text-dark">A payer</span>';if(Number(t.heuresPayees)>Number(t.heuresAPayer)){let n=t.heuresPayees-t.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement effectué - '+parseFloat(n.toFixed(2))+" hetd(s) payées en trop. </span>"}if(Number(t.heuresDemandees)>Number(t.heuresAPayer)){let n=t.heuresDemandees-t.heuresAPayer;return'<span style="font-size:12px;line-height:20px;" class="badge bg-danger"><i class="fa-solid fa-triangle-exclamation"></i> Paiement demandé - '+parseFloat(n.toFixed(2))+" hetd(s) demandées en trop. </span></span>"}return"indetermine"},supprimerDemandeMiseEnPaiement(t){this.btnState("remove-"+t,"disabled"),unicaenVue.axios.get(unicaenVue.url("paiement/:intervenant/supprimer-demande/:dmep",{intervenant:this.intervenant,dmep:t})).then(n=>{this.$emit("refresh")}).catch(n=>{this.$emit("refresh")})},disabledPaiement(t){return t.missionId!=""||t.formuleResServiceRefId!=""?!(t.centreCoutId&&t.domaineFonctionnel):!1},enabledPaiement(t,n){if(n=="mission"){let s=document.getElementById("add-"+t),b=document.getElementById("centreCout-"+t).value,i=document.getElementById("domaineFonctionnel-"+t).value;b!=""&&i!=""?s.disabled=!1:s.disabled=!0}},ajouterDemandeMiseEnPaiement(t){this.btnState("add-"+t,"disabled");let n={animation:!0,delay:15e3,autohide:!0},s=document.getElementById("heures-"+t),b=document.getElementById("centreCout-"+t),i=document.getElementById("domaineFonctionnel-"+t),r=Number(s.value),u=Number(s.getAttribute("max")),m=i?i.value:"",c=s.hasAttribute("data-type-heures-id")?s.getAttribute("data-type-heures-id"):"",l=s.hasAttribute("data-service-id")?s.getAttribute("data-service-id"):"",x=s.hasAttribute("data-service-referentiel-id")?s.getAttribute("data-service-referentiel-id"):"",f=s.hasAttribute("data-mission-id")?s.getAttribute("data-mission-id"):"",A=b.value,k=b.options[b.selectedIndex].getAttribute("data-ressources-propres"),G=b.options[b.selectedIndex].getAttribute("data-paie-etat");if(A=="")return unicaenVue.flashMessenger.toast("Vous devez sélectionner un centre de coût pour demander la mise en paiement de ces heures","error",n),this.btnResetState(),!1;if(r>0&&r>u)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible, vous demandez "+r+" hetd(s) alors que vous pouvez demander maximum "+u+" hetd(s)","error",n),this.btnResetState(),!1;if(G==1&&this.dotationPaieEtat>0&&this.dotationPaieEtat-(this.consommationPaieEtat+r)<=0)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible manque de dotation 'paie etat' pour ces heures","error",n),this.btnResetState(),!1;if(k==1&&this.dotationRessourcesPropres>0&&this.dotationRessourcesPropres-(this.consommationRessourcesPropres+r)<=0)return unicaenVue.flashMessenger.toast("Demande de mise en paiement impossible manque de dotation 'ressources propres' pour ces heures","error",n),this.btnResetState(),!1;var H=[];let w={heures:r,centreCoutId:A,typeHeuresId:c,serviceId:l,serviceReferentielId:x,domaineFonctionnelId:m,missionId:f,structureId:this.datas.id};H.push(w),unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),H).then(B=>{this.$emit("refresh")}).catch(B=>{this.$emit("refresh"),console.error(B)})},demanderToutesLesHeuresEnPaiement(t,n){this.btnState("add-all-"+t,"disabled");let s=[],i=document.getElementById("demande-mise-en-paiement-"+t).getElementsByTagName("tr");for(var r=0;r<i.length;r++)if(i[r].getElementsByTagName("input").length>0&&i[r].classList.contains("detailHeure")){let u=i[r].getElementsByTagName("input")[0],m=i[r].getElementsByTagName("select")[0],c=i[r].getElementsByTagName("select")[1],l=Number(u.value),x=Number(u.getAttribute("max"));if(l<=0||l>x)console.warn("Le nombre d'heures demandées en paiement n'est pas situé entre le max et min possible.");else{let f=m.value,A=u.hasAttribute("data-type-heures-id")?u.getAttribute("data-type-heures-id"):"",k=u.hasAttribute("data-mission-id")?u.getAttribute("data-mission-id"):"",G=u.hasAttribute("data-service-id")?u.getAttribute("data-service-id"):"",H=u.hasAttribute("data-service-referentiel-id")?u.getAttribute("data-service-referentiel-id"):"",w=c?c.value:"",B={heures:l,centreCoutId:f,typeHeuresId:A,serviceId:G,serviceReferentielId:H,domaineFonctionnelId:w,missionId:k,structureId:this.datas.id};s.push(B)}}unicaenVue.axios.post(unicaenVue.url("paiement/:intervenant/ajouter-demandes",{intervenant:this.intervenant}),s).then(u=>{this.$emit("refresh")}).catch(u=>{this.$emit("refresh")})},filtrerCentresCouts(t,n){let s=[];for(var b in t){let i=b,r=[];t[b].forEach(function(u,m){u[n]==1&&r.push(u)}),r.length!=0&&s.push({group:i,child:r})}return s},notValueCentreCoutValue(t,n){return this.filtrerCentresCouts(t,n).length!=0?"Choisir un centre de coût":"Aucun centre de coût disponible demande de paiement impossible"},totalHeure(t){let n=0;for(var s in t)n+=Number(t[s].heuresAPayer);return parseFloat(n.toFixed(2))},shorten(t,n=20){if(t.length>n){var s='<span title="'+t+'"';return s+='data-bs-placement="top" data-bs-toggle="tooltip">',s+=t.substring(0,n)+"...",s+="</span>",s}else return t},btnState(t,n){let s=document.getElementById(t);return s?(n=="enabled"&&(s.disabled=!1,s.querySelector("#waiting").style.display="none",s.querySelector("#action").style.display="inline-block"),n=="disabled"&&(s.disabled=!0,s.querySelector("#waiting").style.display="inline-block",s.querySelector("#action").style.display="none"),!0):!1},formatDate(t,n){return Util.dateToString(t)}}},Ph=["id"],kh=["id"],Ah=["aria-controls","data-bs-target"],Eh=["id","aria-labelledby"],Mh={class:"accordion-body"},Dh={key:0},Uh=e("div",{class:"cartridge gray bordered",style:{"padding-bottom":"5px","margin-bottom":"20px"}},[e("span",null,"Budget")],-1),Th={class:"container"},Fh={class:"table table-bordered caption-top"},Rh=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"fw-bold",scope:"col"},"Paie état"),e("th",{class:"fw-bold",scope:"col"},"Ressources propres")])],-1),Ih={style:{width:"50%"}},wh={key:0,class:"text-center progress position-relative bg-secondary",style:{height:"30px"}},$h={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},Lh=["aria-valuemax","aria-valuenow","title"],Hh={key:1,class:"text-center"},Nh={style:{width:"50%"}},jh={key:0,class:"progress position-relative bg-secondary",style:{height:"30px"}},Oh={class:"position-absolute top-50 start-50 translate-middle",style:{color:"white"}},qh=["aria-valuemax","aria-valuenow","title"],zh={key:1,class:"text-center"},Bh={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},Gh=e("span",null,"Enseignement",-1),Jh=["innerHTML"],Yh={class:"container"},Qh={class:"row"},Wh={class:"col-12"},Xh={class:"table mt-3 table-bordered"},Zh={class:"table-light"},Kh={colspan:"2"},e_={colspan:"2"},t_={class:"table table-sm"},n_=e("thead",null,[e("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"Heures"),e("th",{scope:"col",style:{width:"40%","font-size":"12px"}},"Centre de coûts"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"État"),e("th",{style:{width:"15%","font-size":"12px"}})],-1),s_={class:"detailHeure"},r_={key:0,style:{width:"20%"}},i_=["title"],a_={class:"number number-positif"},o_=["title"],l_={class:"number number-positif"},u_={key:1,style:{width:"20%"}},d_={class:"input-group col-1"},c_=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],m_=e("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1),h_={key:2},__=["id"],p_={value:""},f_=["label"],b_=["data-paie-etat","data-ressources-propres","selected","value"],v_=["innerHTML"],g_=["innerHTML"],y_={style:{"font-size":"12px"}},x_={key:0},C_=["id","onClick"],V_={key:1},S_=["id","onClick"],P_={class:"table-light"},k_=e("th",{scope:"row"},"Total heures à payer",-1),A_={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},E_=e("span",null,"Référentiel",-1),M_={class:"container"},D_={class:"row"},U_={class:"col-12"},T_={class:"table mt-3 table-bordered"},F_={colspan:"2"},R_={class:"table table-sm"},I_=e("thead",null,[e("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de coûts"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel "),e("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"État"),e("th",{style:{width:"15%","font-size":"12px"}})],-1),w_={class:"detailHeure"},$_={key:0,style:{width:"20%"}},L_=["title"],H_={class:"number number-positif"},N_=["title"],j_={class:"number number-positif"},O_={key:1,style:{width:"20%"}},q_={class:"input-group col-1"},z_=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],B_=e("span",{class:"input-group-text",style:{"font-size":"12px"}},"hetd(s)",-1),G_={key:2},J_=["id"],Y_={value:""},Q_=["label"],W_=["data-paie-etat","data-ressources-propres","selected","value"],X_=["innerHTML"],Z_={key:4},K_=["id"],ep=e("option",{value:""},"Aucun domaine fonctionnel",-1),tp=["selected","value"],np={key:5},sp=["innerHTML"],rp={style:{"font-size":"12px"}},ip={key:0},ap=["id","onClick"],op={key:1},lp=["id","onClick"],up={class:"table-light"},dp=e("th",{scope:"row"},"Total",-1),cp={class:"cartridge gray bordered",style:{"padding-bottom":"5px"}},mp=e("span",null,"Mission",-1),hp={class:"container"},_p={class:"row"},pp={class:"col-12"},fp={class:"table mt-3 table-bordered"},bp={colspan:"2"},vp={class:"table table-sm"},gp=e("thead",null,[e("th",{scope:"col",style:{width:"10%","font-size":"12px"}},"Heures"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Centre de coûts"),e("th",{scope:"col",style:{width:"25%","font-size":"12px"}},"Domaine fonctionnel "),e("th",{scope:"col",style:{width:"20%","font-size":"12px"}},"État"),e("th",{style:{width:"15%","font-size":"12px"}})],-1),yp={class:"detailHeure"},xp={key:0,style:{width:"20%"}},Cp=["title"],Vp={class:"number number-positif"},Sp=["title"],Pp={class:"number number-positif"},kp={key:1,style:{width:"20%"}},Ap={class:"input-group col-1"},Ep=["id","data-domaine-fonctionnel-id","data-mission-id","data-service-id","data-service-referentiel-id","data-type-heures-id","max","value"],Mp=e("span",{class:"input-group-text",style:{"font-size":"12px"}},"heure(s)",-1),Dp={key:2},Up=["id","onChange"],Tp={value:""},Fp=["label"],Rp=["data-paie-etat","data-ressources-propres","selected","value"],Ip=["innerHTML"],wp={key:4},$p=["id","onChange"],Lp=e("option",{value:""},"Aucun domaine fonctionnel",-1),Hp=["selected","value"],Np={key:5},jp=["innerHTML"],Op={style:{"font-size":"12px"}},qp={key:0},zp=["id","onClick"],Bp={key:1},Gp=["id","onClick"],Jp={class:"table-light"},Yp=e("th",{scope:"row"},"Total",-1),Qp={style:{"background-color":"#fbfbfb",padding:"10px","padding-right":"40px","text-align":"right"}},Wp=["id"];function Xp(t,n,s,b,i,r){const u=j;return a(),o("div",{id:"demande-mise-en-paiement-"+s.datas.code,class:"accordion-item"},[e("h2",{id:"dmep-heading-"+s.datas.code,class:"accordion-header"},[e("button",{"aria-controls":"dmep-collapse-"+s.datas.code,"data-bs-target":"#dmep-collapse-"+s.datas.code,"aria-expanded":"true",class:"accordion-button bg-light","data-bs-toggle":"collapse",type:"button"},d(s.datas.code+" - "+s.datas.libelle),9,Ah)],8,kh),e("div",{id:"dmep-collapse-"+s.datas.code,"aria-labelledby":"dmep-heading-"+s.datas.code,class:"accordion-collapse collapse show"},[e("div",Mh,[this.dotationPaieEtat+i.dotationRessourcesPropres>0?(a(),o("div",Dh,[Uh,e("div",Th,[e("table",Fh,[Rh,e("tbody",null,[e("tr",null,[e("td",Ih,[this.dotationPaieEtat>0?(a(),o("div",wh,[e("span",$h,d(this.consommationPaieEtat+" sur "+this.dotationPaieEtat)+" HETD",1),e("div",{"aria-valuemax":this.dotationPaieEtat,"aria-valuenow":this.consommationPaieEtat,class:M("progress-bar progress-bar-striped "+this.bgPaieEtat),style:X("width:"+this.pourcentagePaieEtat+"%;"),title:this.pourcentagePaieEtat+"%","aria-valuemin":"0",role:"progressbar"},null,14,Lh)])):h("",!0),this.dotationPaieEtat==0?(a(),o("div",Hh," Aucune dotation paie état ")):h("",!0)]),e("td",Nh,[this.dotationRessourcesPropres>0?(a(),o("div",jh,[e("span",Oh,d(this.consommationRessourcesPropres+" sur "+this.dotationRessourcesPropres)+" HETD",1),e("div",{"aria-valuemax":this.dotationRessourcesPropres,"aria-valuenow":this.consommationRessourcesPropres,class:M("progress-bar progress-bar-striped "+this.bgRessourcesPropres),style:X("width:"+this.pourcentageRessourcePropre+"%;"),title:this.pourcentageRessourcePropre+"%","aria-valuemin":"0",role:"progressbar"},null,14,qh)])):h("",!0),this.dotationRessourcesPropres==0?(a(),o("div",zh," Aucune dotation ressources propres ")):h("",!0)])])])])])])):h("",!0),(a(!0),o(y,null,C(s.datas.etapes,(m,c)=>(a(),o("div",null,[(a(!0),o(y,null,C(m.enseignements,(l,x)=>(a(),o("div",null,[e("div",Bh,[Gh,e("span",{innerHTML:r.shorten(m.libelle,50)},null,8,Jh),e("span",null,d(l.libelle),1)]),e("div",Yh,[e("div",Qh,[(a(!0),o(y,null,C(l.typeHeure,(f,A)=>(a(),o("div",Wh,[e("table",Xh,[e("thead",Zh,[e("tr",null,[e("th",Kh,d(f.libelle),1)])]),e("tbody",null,[e("tr",null,[e("td",e_,[e("table",t_,[n_,e("tbody",null,[(a(!0),o(y,null,C(f.heures,(k,G)=>(a(),o("tr",s_,[k.heuresDemandees!=0?(a(),o("td",r_,[k.datePaiement?(a(),o("abbr",{key:0,title:"Payé en "+k.periodeLibelle+" le "+r.formatDate(k.datePaiement)},[e("span",a_,d(Number(k.heuresPayees))+" hetd(s)",1)],8,i_)):h("",!0),k.datePaiement?h("",!0):(a(),o("abbr",{key:1,title:"Demandé le "+r.formatDate(k.dateDemande)},[e("span",l_,d(Number(k.heuresDemandees))+" hetd(s)",1)],8,o_))])):h("",!0),k.heuresDemandees==0?(a(),o("td",u_,[e("div",d_,[e("input",{id:"heures-"+c+"-"+x+"-"+A,"data-domaine-fonctionnel-id":k.domaineFonctionnelId,"data-mission-id":k.missionId,"data-service-id":k.serviceId,"data-service-referentiel-id":k.serviceReferentielId,"data-type-heures-id":k.typeHeureId,max:k.heuresAPayer,value:k.heuresAPayer,class:"form-control form-control-sm",min:"0",type:"number"},null,8,c_),m_])])):h("",!0),k.heuresDemandees==0?(a(),o("td",h_,[e("select",{id:"centreCout-"+c+"-"+x+"-"+A,class:"selectpicker","data-live-search":"true",name:"centreCout"},[e("option",p_,d(r.notValueCentreCoutValue(s.datas.centreCoutPaiement,k.typeHeureCode)),1),(a(!0),o(y,null,C(r.filtrerCentresCouts(s.datas.centreCoutPaiement,k.typeHeureCode),H=>(a(),o("optgroup",{key:H.group,label:H.group},[(a(!0),o(y,null,C(H.child,w=>(a(),o("option",{key:w.value,"data-paie-etat":w.paieEtat,"data-ressources-propres":w.ressourcesPropres,selected:w.centreCoutId==k.centreCout.centreCoutId,value:w.centreCoutId},d(w.centreCoutCode+" - "+w.centreCoutLibelle),9,b_))),128))],8,f_))),128))],8,__)])):h("",!0),k.heuresDemandees!=0?(a(),o("td",{key:3,innerHTML:r.shorten(k.centreCout.code+" - "+k.centreCout.libelle,30)},null,8,v_)):h("",!0),e("td",{innerHTML:r.heuresStatutToString(k)},null,8,g_),e("td",y_,[k.heuresPayees==0&&k.heuresDemandees>0?(a(),o("span",x_,[e("button",{id:"remove-"+k.mepId,class:"btn btn-danger",type:"button",onClick:H=>this.supprimerDemandeMiseEnPaiement(k.mepId)},[_(u,{id:"action",name:"trash",style:{color:"white"}}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,C_)])):h("",!0),k.heuresDemandees==0?(a(),o("span",V_,[e("button",{id:"add-"+c+"-"+x+"-"+A,class:"btn btn-primary",type:"button",onClick:H=>this.ajouterDemandeMiseEnPaiement(c+"-"+x+"-"+A)},[_(u,{id:"action",name:"plus"}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,S_)])):h("",!0)])]))),256))])])])])]),e("tfoot",null,[e("tr",P_,[k_,e("td",null,d(r.totalHeure(f.heures))+" hetd(s)",1)])])])]))),256))])])]))),256))]))),256)),(a(!0),o(y,null,C(s.datas.fonctionsReferentiels,(m,c)=>(a(),o("div",null,[e("div",A_,[E_,e("span",null,d(m.libelle),1)]),e("div",M_,[e("div",D_,[e("div",U_,[e("table",T_,[e("tbody",null,[e("tr",null,[e("td",F_,[e("table",R_,[I_,e("tbody",null,[(a(!0),o(y,null,C(m.heures,(l,x)=>(a(),o("tr",w_,[l.heuresDemandees!=0?(a(),o("td",$_,[l.datePaiement?(a(),o("abbr",{key:0,title:"Payé en "+l.periodeLibelle+" le "+r.formatDate(l.datePaiement)},[e("span",H_,d(Number(l.heuresPayees))+" hetd(s)",1)],8,L_)):h("",!0),l.datePaiement?h("",!0):(a(),o("abbr",{key:1,title:"Demandé le "+r.formatDate(l.dateDemande)},[e("span",j_,d(Number(l.heuresDemandees))+" hetd(s)",1)],8,N_))])):h("",!0),l.heuresDemandees==0?(a(),o("td",O_,[e("div",q_,[e("input",{id:"heures-"+c,"data-domaine-fonctionnel-id":l.domaineFonctionnelId,"data-mission-id":l.missionId,"data-service-id":l.serviceId,"data-service-referentiel-id":l.serviceReferentielId,"data-type-heures-id":l.typeHeureId,max:l.heuresAPayer,value:l.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,z_),B_])])):h("",!0),l.heuresDemandees==0?(a(),o("td",G_,[e("select",{id:"centreCout-"+c,class:"selectpicker","data-live-search":"true",name:"centreCout"},[e("option",Y_,d(r.notValueCentreCoutValue(s.datas.centreCoutPaiement,l.typeHeureCode)),1),(a(!0),o(y,null,C(r.filtrerCentresCouts(s.datas.centreCoutPaiement,"referentiel"),f=>(a(),o("optgroup",{key:f.group,label:f.group},[(a(!0),o(y,null,C(f.child,A=>(a(),o("option",{key:A.value,"data-paie-etat":A.paieEtat,"data-ressources-propres":A.ressourcesPropres,selected:A.centreCoutId==l.centreCout.centreCoutId,value:A.centreCoutId},d(A.centreCoutCode+" - "+A.centreCoutLibelle),9,W_))),128))],8,Q_))),128))],8,J_)])):h("",!0),l.heuresDemandees!=0?(a(),o("td",{key:3,innerHTML:r.shorten(l.centreCout.code+" - "+l.centreCout.libelle,20)},null,8,X_)):h("",!0),l.heuresDemandees==0?(a(),o("td",Z_,[e("select",{id:"domaineFonctionnel-"+c,class:"selectpicker","data-live-search":"true",name:"centreCout"},[ep,(a(!0),o(y,null,C(s.datas.domaineFonctionnelPaiement,f=>(a(),o("option",{selected:f.domaineFonctionnelId==l.domaineFonctionnel.domaineFonctionnelId,value:f.domaineFonctionnelId},d(f.domaineFonctionnelLibelle),9,tp))),256))],8,K_)])):h("",!0),l.heuresDemandees!=0?(a(),o("td",np,d(l.domaineFonctionnel.libelle),1)):h("",!0),e("td",{innerHTML:r.heuresStatutToString(l)},null,8,sp),e("td",rp,[l.heuresPayees==0&&l.heuresDemandees>0?(a(),o("span",ip,[e("button",{id:"remove-"+l.mepId,class:"btn btn-danger",type:"button",onClick:f=>this.supprimerDemandeMiseEnPaiement(l.mepId)},[_(u,{id:"action",name:"trash",style:{color:"white"}}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,ap)])):h("",!0),l.heuresDemandees==0?(a(),o("span",op,[e("button",{id:"add-"+c,class:"btn btn-primary",type:"button",onClick:f=>this.ajouterDemandeMiseEnPaiement(c)},[_(u,{id:"action",name:"plus"}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,lp)])):h("",!0)])]))),256))])])])])]),e("tfoot",null,[e("tr",up,[dp,e("td",null,d(r.totalHeure(m.heures))+" hetd(s)",1)])])])])])])]))),256)),(a(!0),o(y,null,C(s.datas.missions,m=>(a(),o("div",null,[e("div",cp,[mp,e("span",null,d(m.libelle),1)]),e("div",hp,[e("div",_p,[e("div",pp,[e("table",fp,[e("tbody",null,[e("tr",null,[e("td",bp,[e("table",vp,[gp,e("tbody",null,[(a(!0),o(y,null,C(m.heures,(c,l)=>(a(),o("tr",yp,[c.heuresDemandees!=0?(a(),o("td",xp,[c.datePaiement?(a(),o("abbr",{key:0,title:"Payé en "+c.periodeLibelle+" le "+r.formatDate(c.datePaiement)},[e("span",Vp,d(Number(c.heuresPayees))+" heure(s)",1)],8,Cp)):h("",!0),c.datePaiement?h("",!0):(a(),o("abbr",{key:1,title:"Demandé le "+r.formatDate(c.dateDemande)},[e("span",Pp,d(Number(c.heuresDemandees))+" heure(s)",1)],8,Sp))])):h("",!0),c.heuresDemandees==0?(a(),o("td",kp,[e("div",Ap,[e("input",{id:"heures-"+m.missionId,"data-domaine-fonctionnel-id":c.domaineFonctionnelId,"data-mission-id":c.missionId,"data-service-id":c.serviceId,"data-service-referentiel-id":c.serviceReferentielId,"data-type-heures-id":c.typeHeureId,max:c.heuresAPayer,value:c.heuresAPayer,class:"form-control form-control-sm",min:"0",style:{width:"40px"},type:"number"},null,8,Ep),Mp])])):h("",!0),c.heuresDemandees==0?(a(),o("td",Dp,[e("select",{id:"centreCout-"+m.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:x=>r.enabledPaiement(m.missionId,"mission")},[e("option",Tp,d(r.notValueCentreCoutValue(s.datas.centreCoutPaiement,c.typeHeureCode)),1),(a(!0),o(y,null,C(r.filtrerCentresCouts(s.datas.centreCoutPaiement,"mission"),x=>(a(),o("optgroup",{key:x.group,label:x.group},[(a(!0),o(y,null,C(x.child,f=>(a(),o("option",{key:f.value,"data-paie-etat":f.paieEtat,"data-ressources-propres":f.ressourcesPropres,selected:f.centreCoutId==c.centreCout.centreCoutId,value:f.centreCoutId},d(f.centreCoutCode+" - "+f.centreCoutLibelle),9,Rp))),128))],8,Fp))),128))],40,Up)])):h("",!0),c.heuresDemandees!=0?(a(),o("td",{key:3,innerHTML:r.shorten(c.centreCout.code+" - "+c.centreCout.libelle,20)},null,8,Ip)):h("",!0),c.heuresDemandees==0?(a(),o("td",wp,[e("select",{id:"domaineFonctionnel-"+m.missionId,class:"selectpicker","data-live-search":"true",name:"centreCout",onChange:x=>r.enabledPaiement(m.missionId,"mission")},[Lp,(a(!0),o(y,null,C(s.datas.domaineFonctionnelPaiement,x=>(a(),o("option",{selected:x.domaineFonctionnelId==c.domaineFonctionnel.domaineFonctionnelId,value:x.domaineFonctionnelId},d(x.domaineFonctionnelLibelle),9,Hp))),256))],40,$p)])):h("",!0),c.heuresDemandees!=0?(a(),o("td",Np,d(c.domaineFonctionnel.libelle),1)):h("",!0),e("td",{innerHTML:r.heuresStatutToString(c)},null,8,jp),e("td",Op,[c.heuresPayees==0&&c.heuresDemandees>0?(a(),o("span",qp,[e("button",{id:"remove-"+c.mepId,class:"btn btn-danger",type:"button",onClick:x=>this.supprimerDemandeMiseEnPaiement(c.mepId)},[_(u,{id:"action",name:"trash",style:{color:"white"}}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{color:"white",display:"none"}})],8,zp)])):h("",!0),c.heuresDemandees==0?(a(),o("span",Bp,[e("button",{id:"add-"+m.missionId,class:"btn btn-primary",type:"button",onClick:x=>this.ajouterDemandeMiseEnPaiement(m.missionId)},[_(u,{id:"action",name:"plus"}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}})],8,Gp)])):h("",!0)])]))),256))])])])])]),e("tfoot",null,[e("tr",Jp,[Yp,e("td",null,d(r.totalHeure(m.heures))+" heure(s)",1)])])])])])])]))),256))]),e("div",Qp,[e("button",{id:"add-all-"+s.datas.code,class:"btn btn-primary",type:"button",onClick:n[0]||(n[0]=m=>r.demanderToutesLesHeuresEnPaiement(s.datas.code,s.datas.libelle))},[_(u,{id:"action",name:"square-plus",style:{color:"white"}}),_(u,{id:"waiting",name:"spin",rotate:"right",style:{display:"none"}}),p(" DEMANDER TOUS LES PAIEMENTS POUR "+d(s.datas.libelleCourt),1)],8,Wp)])],8,Eh)],8,Ph)}const ce=S(Sh,[["render",Xp]]),Zp=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"})),Kp={name:"DemandeMiseEnPaiement",components:{DemandeMiseEnPaiementStructure:ce},props:{intervenant:{required:!1}},data(){return{datasDemandesMiseEnPaiement:null,urlGetDemandesMiseEnPaiement:unicaenVue.url("intervenant/:intervenant/mise-en-paiement/get-demandes-mise-en-paiement",{intervenant:this.intervenant})}},methods:{getDemandesMiseEnPaiement(){unicaenVue.axios.get(this.urlGetDemandesMiseEnPaiement).then(t=>{this.datasDemandesMiseEnPaiement=t.data}).then(t=>{this.btnResetState()}).catch(t=>{this.btnResetState(),console.error(t)})},btnResetState(){Array.from(document.querySelectorAll('[id^="remove-"]')).forEach(b=>{b.disabled=!1,b.querySelector("#waiting").style.display="none",b.querySelector("#action").style.display="inline-block"}),Array.from(document.querySelectorAll('[id^="add-"]')).forEach(b=>{b.disabled=!1,b.querySelector("#waiting").style.display="none",b.querySelector("#action").style.display="inline-block"}),Array.from(document.querySelectorAll('[id^="add-all"]')).forEach(b=>{b.disabled=!1,b.querySelector("#waiting").style.display="none",b.querySelector("#action").style.display="inline-block"})}},mounted(){this.getDemandesMiseEnPaiement()},updated(){$(".selectpicker").selectpicker("render");var t=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));t.map(function(n){return new bootstrap.Tooltip(n)})}},ef={key:0,class:"text-center"},tf=e("div",{class:"mt-5 spinner-border spinner-border-sm",role:"status"},[e("span",{class:"visually-hidden"},"Chargement des demandes de mise en paiement en cours...")],-1),nf={id:"accordionPanelsStayOpenExample",class:"accordion"};function sf(t,n,s,b,i,r){const u=F("demande-mise-en-paiement-structure");return a(),o(y,null,[this.datasDemandesMiseEnPaiement?h("",!0):(a(),o("div",ef,[tf,p(" Chargement des demandes de mise en paiement en cours... ")])),e("div",nf,[(a(!0),o(y,null,C(i.datasDemandesMiseEnPaiement,(m,c)=>(a(),R(u,{datas:m,intervenant:s.intervenant,onRefresh:r.getDemandesMiseEnPaiement},null,8,["datas","intervenant","onRefresh"]))),256))])],64)}const rf=S(Kp,[["render",sf]]),af=Object.freeze(Object.defineProperty({__proto__:null,default:rf},Symbol.toStringTag,{value:"Module"}));function of(t){for(let n in t)for(let s in t[n])me(t[n][s],n)}function lf(){let t=document.getElementById("unicaen-vue-toast-container");return t||(t=document.createElement("div"),t.id="unicaen-vue-toast-container",t.classList.add("toast-container","position-fixed","top-0","end-0","p-3"),document.body.appendChild(t)),t}function uf(t){return t=df(t),t=cf(t),t}function df(t){const n=document.createElement("div");n.innerHTML=t;const s=n.querySelector(".alert");return s?s.innerHTML:n.innerHTML}function cf(t){const n=document.createElement("div");return n.innerHTML=t,n.querySelectorAll("i.fas").forEach(b=>b.style.display="none"),n.innerHTML}function me(t,n,s=null){const b={info:"bg-info",success:"bg-success",warning:"bg-warning",error:"bg-danger"},i={info:"info-circle",success:"check-circle",warning:"exclamation-circle",error:"exclamation-triangle"},r=document.createElement("button");r.classList.add("btn-close","btn-close-white","h5"),r.style.float="right",r.setAttribute("data-bs-dismiss","toast"),r.setAttribute("aria-label","Close");const u=document.createElement("i");u.classList.add("icon","fas",`fa-${i[n]}`),u.style.float="left",u.style.fontSize="26pt",u.style.paddingLeft=".4rem",u.style.marginTop=".4rem",u.style.paddingRight="1rem";const m=document.createElement("div");m.classList.add("toast-body"),m.innerHTML=uf(t);const c=document.createElement("div");c.appendChild(r),c.appendChild(u),c.appendChild(m);const l=document.createElement("div");l.classList.add("toast","text-white",b[n]?b[n]:"bg-secondary"),l.setAttribute("role","alert"),l.setAttribute("aria-live","assertive"),l.setAttribute("aria-atomic","true"),n==="error"&&t.length>500&&l.setAttribute("style","width:700px"),l.appendChild(c),lf().appendChild(l),s==null&&(s={animation:!0,delay:n==="warning"?15e3:5e3,autohide:n!=="error"}),new bootstrap.Toast(l,s).show()}const Z={toast:me,toasts:of};let Q={...ge};Q.interceptors.request.use(t=>{if(t.submitter){let n=t.msg?t.msg:"Action en cours";t.popover!=null&&t.popover.dispose(),t.popover=new bootstrap.Popover(t.submitter,{content:`<div class="spinner-border text-primary" role="status">
  <span class="visually-hidden">Loading...</span>
</div> `+n,html:!0,trigger:"focus"}),t.popover.show()}return t});Q.interceptors.response.use(t=>{if(t.messages=t.data.messages,t.data=t.data.data,t.hasErrors=!!(t.messages&&t.messages.error&&t.messages.error.length>0),t.config.popover){var n=t.config.popover;let s="";for(ns in t.messages)for(mid in t.messages[ns])s+='<div class="alert fade show alert-'+(ns=="error"?"danger":ns)+'" role="alert">'+t.messages[ns][mid]+"</div>";s?(n._config.content=s,n.setContent(),setTimeout(()=>{n.dispose()},5e3)):n.dispose()}return t.messages&&Z.toasts(t.messages),t},t=>{let n=t.response.data;t.response.status==403?n="<h4>403 - Accès interdit</h4><br />Vous n'êtes pas autorisé(e) à faire cette action.":n=t.response.data,Z.toast(n,"error")});Q.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const mf={uvAxios:Q},K={axios:mf.uvAxios,flashMessenger:Z,url:(t,n,s)=>{let b=window.__unicaenVueBaseUrl;if(n)for(let r in n)t=t.replace(`:${r}`,n[r]);let i=s?K.encodeUrlQueryParam(s):null;return b+t+(i?`?${i}`:"")},encodeUrlQueryParam:(t,n)=>{var s=[];for(var b in t)if(t.hasOwnProperty(b)){var i=t[b],r=n?n+"["+encodeURIComponent(b)+"]":encodeURIComponent(b);if(typeof i=="object"&&i!==null)s.push(K.encodeUrlQueryParam(i,r));else{var u=encodeURIComponent(i);s.push(r+"="+u)}}return s.join("&")}};window.unicaenVue=K;const hf={name:"DemandeMiseEnPaiementLot.vue",props:{structures:{type:Array,required:!0},canMiseEnPaiement:{type:Boolean,required:!0}},data(){return{selectedStructure:null,urlRechercheDemandeMiseEnPaiement:unicaenVue.url("paiement/demande-mise-en-paiement-lot"),urlProcessDemandeMiseEnPaiement:unicaenVue.url("paiement/process-demande-mise-en-paiement-lot"),urlMiseEnPaiement:unicaenVue.url("paiement/etat-demande-paiement"),permanents:[],vacataires:[],etudiants:[],autres:[],intervenants:[],dotation:!1,liquidation:null,totalConsommationPaieEtat:0,totalConsommationRessourcePropre:0,totalConsommation:0,alertDotation:!1}},computed:{haveDotation(){return this.dotation?this.dotation.total>0:!1},alertPaieEtat(){return this.dotation.paieEtat<this.totalConsommationPaieEtat?"text-danger fw-bold":""},alertRessourcePropre(){return this.dotation.ressourcePropre<this.totalConsommationRessourcePropre?"text-danger fw-bold":""}},methods:{findDemandeMiseEnPaiement(t){this.totalConsommationRessourcePropre=0,this.totalConsommationPaieEtat=0,this.dotation=null,this.liquidation=null;let n=document.getElementById("formRechercheDemandeMiseEnPaiement"),s=new FormData(n),b=document.getElementById("btn-rdmep"),i=document.getElementById("btn-rdmep-inprogress");i.classList.remove("d-none"),b.classList.add("d-none"),b.disabled=!0,unicaenVue.axios.post(this.urlRechercheDemandeMiseEnPaiement,s,{}).then(r=>{this.dispatchDatas(r.data),b.disabled=!1,i.classList.add("d-none"),b.classList.remove("d-none"),document.querySelectorAll('input[type="checkbox"]').forEach(function(m,c){m.checked=!0}),unicaenVue.axios.get(unicaenVue.url("budget/get-budget-structure/:structure",{structure:this.selectedStructure})).then(m=>{let c=m.data;this.dotation=c.dotation,this.liquidation=c.liquidation,this.refreshTotalConsommation()})}).catch(r=>{console.error(r)})},processDemandeMiseEnPaiement(t){let n=document.getElementById("formProcessDemandeMiseEnPaiement"),s=new FormData(n);if(this.dotation.paieEtat>=this.totalConsommationPaieEtat&&this.dotation.ressourcePropre>=this.totalConsommationRessourcePropre||!this.haveDotation){let b=document.getElementById("btn-pdmep"),i=document.getElementById("btn-pdmep-inprogress");i.classList.remove("d-none"),b.classList.add("d-none"),b.disabled=!0,unicaenVue.axios.post(this.urlProcessDemandeMiseEnPaiement,s,{}).then(r=>{this.findDemandeMiseEnPaiement(),b.disabled=!1,i.classList.add("d-none"),b.classList.remove("d-none")}).catch(r=>{console.error("Error process dmep")})}},refreshTotalConsommation(){let t=0,n=0,s=0;t=parseFloat(this.liquidation.paieEtat),n=parseFloat(this.liquidation.ressourcePropre),s+=parseFloat(this.liquidation.ressourcePropre),s+=parseFloat(this.liquidation.paieEtat),document.querySelectorAll('input[type="checkbox"]').forEach(function(i,r){i.hasAttribute("data-paie-etat")&&i.checked&&(t+=parseFloat(i.getAttribute("data-paie-etat")),s+=parseFloat(i.getAttribute("data-paie-etat"))),i.hasAttribute("data-ressource-propre")&&i.checked&&(n+=parseFloat(i.getAttribute("data-ressource-propre")),s+=parseFloat(i.getAttribute("data-ressource-propre")))}),this.totalConsommationPaieEtat=t.toFixed(2),this.totalConsommationRessourcePropre=n.toFixed(2),this.totalConsommation=s.toFixed(2),this.alertDotation=(this.dotation.paieEtat<this.totalConsommationPaieEtat||this.dotation.ressourcePropre<this.totalConsommationRessourcePropre)&&this.dotation.total>0},totalPayable(t){let n=0;return t.forEach((s,b)=>{s.centreCout.code!=""&&(s.missionId!=""||s.serviceRefId!=""?s.domaineFonctionnel.code!=""&&(n+=s.heuresAPayer):n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalNonPayable(t){let n=0;return t.forEach((s,b)=>{(s.centreCout.code==""||(s.missionId!=""||s.serviceRefId!="")&&s.domaineFonctionnel.code=="")&&(n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePaieEtat(t){let n=0;return t.forEach((s,b)=>{s.centreCout.typeRessourceCode=="paie-etat"&&(n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},totalRessourcePropre(t){let n=0;return t.forEach((s,b)=>{s.centreCout.typeRessourceCode=="ressources-propres"&&(n+=s.heuresAPayer)}),n.toLocaleString("fr-FR",{maximumFractionDigits:2})},dispatchDatas(t){this.vacataires=[],this.permanents=[],this.etudiants=[],this.autres=[],this.intervenants=[],console.log(t);for(const[n,s]of Object.entries(t))switch(s.datasIntervenant.typeIntervenant){case"Vacataire":this.vacataires.push(s),this.intervenants.push(s);break;case"Intervenant permanent":this.permanents.push(s),this.intervenants.push(s);break;case"Étudiant":this.etudiants.push(s),this.intervenants.push(s);break;default:this.autres.push(s),this.intervenants.push(s)}},toggleCheckbox(t){let n=Array.from(document.getElementsByClassName(t.target.className));t.target.checked?n.forEach(function(s,b){s.checked=!0}):n.forEach(function(s,b){s.checked=!1}),this.refreshTotalConsommation()},urlIntervenant(t){return unicaenVue.url("intervenant/code::intervenantCode/mise-en-paiement/demande",{intervenantCode:t.datasIntervenant.code})},formattedHETD(t){return Util.formattedHeures(t,!1)}}},_f=e("h1",null,"Demande de mise en paiement par lots",-1),pf={class:"card text-dark bg-light"},ff=e("div",{class:"card-header text-uppercase fw-bold"}," Recherchez des heures en attente de demande de mise en paiement : ",-1),bf={class:"card-body"},vf={id:"formRechercheDemandeMiseEnPaiement",action:"",method:"post"},gf={class:"mb-3"},yf=e("label",{class:"form-label",for:"modele"},"Choisissez une structure ",-1),xf=["value"],Cf={class:"mb-3"},Vf=e("button",{id:"btn-rdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),p("  Veuillez patienter... ")],-1),Sf=["disabled"],Pf=e("div",{class:"alert alert-info",role:"alert"},[p(" Seules les HETD "),e("strong",null,"(hors référentiel)"),p(" avec des centres de coûts pré-paramètrés peuvent bénéficier d'une demande de mise en paiement automatisées. Pour les autres, il faudra passer sur chaque fiches intervenant pour faire les demandes en sélectionnant le centre de coût manuellement. ")],-1),kf={key:0},Af={key:0,class:"alert alert-danger",role:"alert"},Ef={class:"table table-bordered caption-top"},Mf=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"fw-bold",scope:"col"},"Budget"),e("th",{class:"fw-bold",scope:"col"},"Paie etat"),e("th",{class:"fw-bold",scope:"col"},"Ressource propre"),e("th",{class:"fw-bold",scope:"col"},"Total")])],-1),Df=e("td",null,"Dotation",-1),Uf={class:"fw-bold"},Tf=e("td",null,"Consommation",-1),Ff={class:"fw-bold"},Rf={id:"dmep",class:"accordion"},If={id:"formProcessDemandeMiseEnPaiement",action:"",method:"post"},wf={key:0,class:"accordion-item"},$f={id:"dmep-permanents-heading",class:"accordion-header"},Lf={"aria-controls":"dmep-permanents-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-permanents-collapse","data-bs-toggle":"collapse",type:"button"},Hf={id:"dmep-permanents-collapse","aria-labelledby":"dmep-permanents-heading",class:"accordion-collapse collapse show"},Nf={class:"accordion-body"},jf={class:"table"},Of={scope:"col"},qf=e("th",{scope:"col"},"Intervenant",-1),zf=e("th",null,"HETD payables",-1),Bf=e("th",null,"HETD non payables",-1),Gf=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],Jf=["href"],Yf=["title"],Qf={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Wf={key:1,class:"accordion-item"},Xf={id:"dmep-vacataires-heading",class:"accordion-header"},Zf={"aria-controls":"dmep-vacataires-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-vacataires-collapse","data-bs-toggle":"collapse",type:"button"},Kf={id:"dmep-vacataires-collapse","aria-labelledby":"dmep-vacataires-heading",class:"accordion-collapse collapse show"},eb={class:"accordion-body"},tb={class:"table"},nb=e("th",null,"Intervenant",-1),sb=e("th",null,"HETD payables",-1),rb=e("th",null,"HETD non payables",-1),ib=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],ab=["href"],ob=["title"],lb={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},ub={key:2,class:"accordion-item"},db={id:"dmep-etudiants-heading",class:"accordion-header"},cb={"aria-controls":"dmep-etudiants-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-etudiants-collapse","data-bs-toggle":"collapse",type:"button"},mb={id:"dmep-etudiants-collapse","aria-labelledby":"dmep-etudiants-heading",class:"accordion-collapse collapse show"},hb={class:"accordion-body"},_b={class:"table"},pb=e("th",null,"Intervenant",-1),fb=e("th",null,"HETD payables",-1),bb=e("th",null,"HETD non payables",-1),vb=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],gb=["href"],yb=["title"],xb={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Cb={key:3,class:"accordion-item"},Vb={id:"dmep-autres-heading",class:"accordion-header"},Sb={"aria-controls":"dmep-autres-collapse","aria-expanded":"true",class:"accordion-button","data-bs-target":"#dmep-autres-collapse","data-bs-toggle":"collapse",type:"button"},Pb={id:"dmep-autres-collapse","aria-labelledby":"dmep-autres-heading",class:"accordion-collapse collapse show"},kb={class:"accordion-body"},Ab={class:"table"},Eb=e("th",null,"Intervenant",-1),Mb=e("th",null,"HETD payables",-1),Db=e("th",null,"HETD non payables",-1),Ub=["id","data-paie-etat","data-ressource-propre","disabled","name","title"],Tb=["href"],Fb=["title"],Rb={style:{"text-decoration":"underline dotted",cursor:"help"},title:"Manque un centre de coût et/ou un domaine fonctionnel"},Ib=["value"],wb={key:4,class:"mt-3"},$b=e("button",{id:"btn-pdmep-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),p("  Veuillez patienter... ")],-1),Lb=["disabled"],Hb=["href"];function Nb(t,n,s,b,i,r){return a(),o(y,null,[_f,e("div",pf,[ff,e("div",bf,[e("form",vf,[e("div",gf,[yf,p("  "),v(e("select",{"onUpdate:modelValue":n[0]||(n[0]=u=>i.selectedStructure=u),class:"form-select",name:"structure"},[(a(!0),o(y,null,C(s.structures,u=>(a(),o("option",{value:u.id},d(u.libelle),9,xf))),256))],512),[[T,i.selectedStructure]])]),e("div",Cf,[Vf,e("button",{id:"btn-rdmep",disabled:!i.selectedStructure,class:"btn btn-primary",type:"button",onClick:n[1]||(n[1]=(...u)=>r.findDemandeMiseEnPaiement&&r.findDemandeMiseEnPaiement(...u))}," Lancer la recherche ",8,Sf)])])])]),Pf,r.haveDotation?(a(),o("div",kf,[i.alertDotation?(a(),o("div",Af," Attention vous dépassez vos dotations, vous ne pourrez pas lancer les demandes de mise en paiement par lot. Veuillez ajuster votre sélection d'intervenants pour faire les demandes de mise en paiement. ")):h("",!0),e("table",Ef,[Mf,e("tbody",null,[e("tr",null,[Df,e("td",null,d(r.formattedHETD(this.dotation.paieEtat))+" HETD",1),e("td",null,d(r.formattedHETD(this.dotation.ressourcePropre))+" HETD",1),e("td",Uf,d(r.formattedHETD(this.dotation.total))+" HETD",1)]),e("tr",null,[Tf,e("td",null,[e("span",{class:M(r.alertPaieEtat)},d(r.formattedHETD(this.totalConsommationPaieEtat))+" HETD",3)]),e("td",null,[e("span",{class:M(r.alertRessourcePropre)},d(r.formattedHETD(this.totalConsommationRessourcePropre))+" HETD",3)]),e("td",Ff,d(r.formattedHETD(this.totalConsommation))+" HETD",1)])])])])):h("",!0),e("div",Rf,[e("form",If,[this.permanents.length>0?(a(),o("div",wf,[e("h2",$f,[e("button",Lf,d(this.permanents.length)+" Permanent(s) ",1)]),e("div",Hf,[e("div",Nf,[e("table",jf,[e("thead",null,[e("tr",null,[e("th",Of,[e("input",{id:"allPermanents",checked:"checked",class:"checkbox-permanent",name:"allPermanents",type:"checkbox",onClick:n[2]||(n[2]=(...u)=>r.toggleCheckbox&&r.toggleCheckbox(...u))})]),qf,zf,Bf])]),e("tbody",null,[(a(!0),o(y,null,C(this.permanents,u=>(a(),o("tr",null,[e("td",null,[e("input",{id:"permanent-"+u.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(u.heures),"data-ressource-propre":r.totalRessourcePropre(u.heures),disabled:r.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:r.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-permanent",type:"checkbox",onChange:n[3]||(n[3]=m=>r.refreshTotalConsommation())},null,40,Gf)]),e("td",null,[e("a",{href:r.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,Jf)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+r.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(r.totalPayable(u.heures))+" h",9,Yf)]),e("td",null,[e("span",Qf,d(r.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.vacataires.length>0?(a(),o("div",Wf,[e("h2",Xf,[e("button",Zf,d(this.vacataires.length)+" Vacataire(s) ",1)]),e("div",Kf,[e("div",eb,[e("table",tb,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allVacataire",checked:"checked",class:"checkbox-vacataire",name:"allVacataire",type:"checkbox",onClick:n[4]||(n[4]=(...u)=>r.toggleCheckbox&&r.toggleCheckbox(...u))})]),nb,sb,rb])]),e("tbody",null,[(a(!0),o(y,null,C(this.vacataires,u=>(a(),o("tr",null,[e("td",null,[e("input",{id:"vacataire-"+u.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(u.heures),"data-ressource-propre":r.totalRessourcePropre(u.heures),disabled:r.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:r.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-vacataire",type:"checkbox",onChange:n[5]||(n[5]=m=>r.refreshTotalConsommation())},null,40,ib)]),e("td",null,[e("a",{href:r.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,ab)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+r.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(r.totalPayable(u.heures))+" h",9,ob)]),e("td",null,[e("span",lb,d(r.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.etudiants.length>0?(a(),o("div",ub,[e("h2",db,[e("button",cb,d(this.etudiants.length)+" Etudiant(s) ",1)]),e("div",mb,[e("div",hb,[e("table",_b,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allEtudiants",checked:"checked",class:"checkbox-etudiant",name:"allEtudiants",type:"checkbox",onClick:n[6]||(n[6]=(...u)=>r.toggleCheckbox&&r.toggleCheckbox(...u))})]),pb,fb,bb])]),e("tbody",null,[(a(!0),o(y,null,C(this.etudiants,u=>(a(),o("tr",null,[e("td",null,[e("input",{id:"etudiant-"+u.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(u.heures),"data-ressource-propre":r.totalRessourcePropre(u.heures),disabled:r.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:r.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-etudiant",type:"checkbox",onChange:n[7]||(n[7]=m=>r.refreshTotalConsommation())},null,40,vb)]),e("td",null,[e("a",{href:r.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,gb)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+r.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(r.totalPayable(u.heures))+" h",9,yb)]),e("td",null,[e("span",xb,d(r.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),this.autres.length>0?(a(),o("div",Cb,[e("h2",Vb,[e("button",Sb,d(this.autres.length)+" Autre(s) ",1)]),e("div",Pb,[e("div",kb,[e("table",Ab,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{id:"allAutres",checked:"checked",class:"checkbox-autre",name:"allAutres",type:"checkbox",onClick:n[8]||(n[8]=(...u)=>r.toggleCheckbox&&r.toggleCheckbox(...u))})]),Eb,Mb,Db])]),e("tbody",null,[(a(!0),o(y,null,C(this.etudiants,u=>(a(),o("tr",null,[e("td",null,[e("input",{id:"autre-"+u.datasIntervenant.id,"data-paie-etat":r.totalRessourcePaieEtat(u.heures),"data-ressource-propre":r.totalRessourcePropre(u.heures),disabled:r.totalPayable(u.heures)==0,name:"intervenant["+u.datasIntervenant.id+"]",title:r.totalPayable(u.heures)==0?"Aucune heure pré-paramétrée avec un centre de coût ne peut bénéficier d'une demande de mise en paiement":"",checked:"checked",class:"checkbox-autre",type:"checkbox",onChange:n[9]||(n[9]=m=>r.refreshTotalConsommation())},null,40,Ub)]),e("td",null,[e("a",{href:r.urlIntervenant(u),target:"_blank"},d(u.datasIntervenant.nom_usuel.toUpperCase()+" "+u.datasIntervenant.prenom),9,Tb)]),e("td",null,[e("span",{title:r.totalRessourcePaieEtat(u.heures)+" HETD en paie état / "+r.totalRessourcePropre(u.heures)+" HETD en ressource propre",style:{"text-decoration":"underline dotted",cursor:"help"}},d(r.totalPayable(u.heures))+" h",9,Fb)]),e("td",null,[e("span",Rb,d(r.totalNonPayable(u.heures))+" h",1)])]))),256))])])])])])):h("",!0),e("input",{value:i.selectedStructure,name:"selectedStructure",type:"hidden"},null,8,Ib),this.intervenants.length>0?(a(),o("div",wb,[$b,e("button",{id:"btn-pdmep",disabled:this.alertDotation,class:"btn btn-primary",type:"button",onClick:n[10]||(n[10]=(...u)=>r.processDemandeMiseEnPaiement&&r.processDemandeMiseEnPaiement(...u))}," Enregistrer les demandes de paiement ",8,Lb),this.canMiseEnPaiement?(a(),o("a",{key:0,id:"btn-mep",href:this.urlMiseEnPaiement,class:"ms-2 btn btn-secondary"}," Aller au mise en paiement ",8,Hb)):h("",!0)])):h("",!0)])])],64)}const jb=S(hf,[["render",Nb]]),Ob=Object.freeze(Object.defineProperty({__proto__:null,default:jb},Symbol.toStringTag,{value:"Module"})),qb={components:{},props:{parametres:{type:Array,required:!0},servicesAPayer:{type:Array,required:!0}}},I=t=>(O("data-v-d4a24889"),t=t(),q(),t),zb=I(()=>e("h2",null,"Paramètres généraux ou bien selon le statut",-1)),Bb={class:"table table-bordered table-condensed table-extra-condensed"},Gb=I(()=>e("tr",null,[e("th",null,"Paramètre général"),e("th",null,"Valeur")],-1)),Jb=I(()=>e("h2",null,"Services à payer",-1)),Yb={class:"card"},Qb={class:"card-header"},Wb={class:"badge bg-primary"},Xb={class:"card-body"},Zb={class:"row lap"},Kb={class:"col-md-6"},e1=I(()=>e("h6",null,"Heures à payer",-1)),t1={class:"table table-bordered table-xs"},n1={key:0,rowspan:"2"},s1={key:1,rowspan:"2"},r1=I(()=>e("th",{colspan:"2"},"Taux de rému.",-1)),i1=I(()=>e("th",{colspan:"3"},"Heures",-1)),a1=I(()=>e("tr",null,[e("th",null,"Nom"),e("th",null,"Valeur"),e("th",null,"Total"),e("th",null,"AA"),e("th",null,"AC")],-1)),o1={key:0},l1=["title"],u1={key:1},d1=["title"],c1={class:"col-md-6"},m1=I(()=>e("h6",null,[e("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),p(" correspondantes")],-1)),h1={class:"table table-bordered table-xs"},_1=I(()=>e("thead",null,[e("tr",null,[e("th",{rowspan:"2"},"Id"),e("th",{rowspan:"2"},"Centre de coûts"),e("th",{colspan:"2"},"Période"),e("th",{colspan:"3"},"Heures")]),e("tr",null,[e("th",null,"Mois"),e("th",null,"Date"),e("th",null,"Total"),e("th",null,"AA"),e("th",null,"AC")])],-1)),p1=["title"],f1=["title"],b1={key:0},v1={class:"badge bg-info"},g1={key:0,class:"row"},y1=I(()=>e("div",{class:"col-md-6"},null,-1)),x1={class:"col-md-6"},C1=I(()=>e("h6",null,[e("abbr",{title:"Les demandes de mise en paiement n'ont pas de période ni de date de paiement associées, contrairement aux mises en paiement"},"(Demandes de) Mises en paiement"),p(" en trop")],-1)),V1={class:"table table-bordered table-xs"},S1=I(()=>e("thead",{class:"bg-danger"},[e("tr",null,[e("th",{rowspan:"2"},"Id"),e("th",{rowspan:"2"},"Centre de coûts"),e("th",{colspan:"2"},"Période"),e("th",{rowspan:"2"},"Heures")]),e("tr",null,[e("th",null,"Mois"),e("th",null,"Date")])],-1)),P1=["title"],k1=["title"];function A1(t,n,s,b,i,r){return a(),o(y,null,[zb,e("table",Bb,[Gb,(a(!0),o(y,null,C(s.parametres,(u,m)=>(a(),o("tr",{key:m},[e("th",null,d(m),1),e("td",null,d(u),1)]))),128))]),Jb,(a(!0),o(y,null,C(s.servicesAPayer,(u,m)=>(a(),o("div",{key:m},[e("div",Yb,[e("div",Qb,[e("span",Wb,d(u.type),1),p(" "+d(u.libelle),1)]),e("div",Xb,[e("ul",null,[(a(!0),o(y,null,C(u.parametres,(c,l)=>(a(),o("li",{key:l},d(l)+" : "+d(c),1))),128))]),(a(!0),o(y,null,C(u.laps,c=>(a(),o("div",Zb,[e("div",Kb,[e1,e("table",t1,[e("thead",null,[e("tr",null,[u.type!="Référentiel"?(a(),o("th",n1,"Volume horaire")):(a(),o("th",s1,"Volumes horaires")),r1,i1]),a1]),e("tbody",null,[e("tr",null,[u.type!="Référentiel"?(a(),o("td",o1,[e("abbr",{class:"badge bg-secondary",title:c.volumeHoraireHisto},d(c.volumeHoraireId),9,l1),p(" "+d(c.volumeHoraire),1)])):(a(),o("td",u1,[(a(!0),o(y,null,C(c.volumeHoraireId,l=>(a(),o("div",null,[e("abbr",{class:"badge bg-secondary",title:l.HISTO},d(l.ID),9,d1),p(" "+d(l.HEURES)+"h ",1)]))),256))])),e("td",null,d(c.tauxRemu),1),e("td",null,d(c.tauxValeur)+"€",1),e("td",null,d(c.heures),1),e("td",null,d(c.heuresAA),1),e("td",null,d(c.heuresAC),1)])])])]),e("div",c1,[m1,e("table",h1,[_1,e("tbody",null,[(a(!0),o(y,null,C(c.misesEnPaiement,l=>(a(),o("tr",{key:l.id},[e("td",null,[e("abbr",{class:"badge bg-secondary",title:"Nombre d'heures total concernées : "+l.heuresTotal+`
Domaine fonctionnel : `+l.domaineFonctionnel+`
`+l.historique},d(l.id),9,p1)]),e("td",null,[e("abbr",{title:l.centreCoutLibelle},d(l.centreCoutCode),9,f1)]),e("td",null,d(l.periodePaiement),1),e("td",null,d(l.date),1),e("td",null,d(l.heures),1),e("td",null,d(l.heuresAA),1),e("td",null,d(l.heuresAC),1)]))),128))])]),c.heuresRestantes!="0,00"?(a(),o("div",b1,[e("span",v1,d(c.heuresRestantes)+"h n'ont pas été demandées en paiement",1)])):h("",!0)])]))),256)),u.misesEnPaiement&&u.misesEnPaiement.length>0?(a(),o("div",g1,[y1,e("div",x1,[C1,e("table",V1,[S1,e("tbody",null,[(a(!0),o(y,null,C(u.misesEnPaiement,c=>(a(),o("tr",{key:c.id},[e("td",null,[e("abbr",{class:"badge bg-danger",title:"Domaine fonctionnel : "+c.domaineFonctionnel+`
`+c.historique},d(c.id),9,P1)]),e("td",null,[e("abbr",{title:c.centreCoutLibelle},d(c.centreCoutCode),9,k1)]),e("td",null,d(c.periodePaiement),1),e("td",null,d(c.date),1),e("td",null,d(c.heures),1)]))),128))])])])])):h("",!0)])])]))),128))],64)}const E1=S(qb,[["render",A1],["__scopeId","data-v-d4a24889"]]),M1=Object.freeze(Object.defineProperty({__proto__:null,default:E1},Symbol.toStringTag,{value:"Module"})),D1={props:{canImportPec:{type:Boolean,required:!1}},data(){return{selectedFile:null,importUrl:unicaenVue.url("paiement/import-numero-pec"),fileErrors:null,intervenantMissing:null,messageErrors:null,messageConfirm:null}},mounted(){},methods:{handleFileUpload(t){this.selectedFile=t.target.files[0],this.fileErrors=null,this.intervenantMissing=null,this.messageErrors=null,this.messageConfirm=null,document.getElementById("btn-import").disabled=!1},importFile(t){t.preventDefault(),this.messageErrors=null,this.messageConfirm=null;let n=document.getElementById("btn-import"),s=document.getElementById("btn-import-inprogress");s.classList.remove("d-none"),n.classList.add("d-none"),n.disabled=!0;let b=document.getElementById("formImport"),i=new FormData(b);unicaenVue.axios.post(this.importUrl,i,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{let u=r.data;this.fileErrors=u.file,this.intervenantMissing=u.intervenant,u.message.length!=0?this.messageErrors=u.message:this.messageConfirm="Importation des numéros de prise en charge réalisée avec succés !",n.disabled=!1,s.classList.add("d-none"),n.classList.remove("d-none")}).catch(r=>{console.error("Error uploading")})}}},U1={class:"card text-dark bg-light"},T1=e("div",{class:"card-header text-uppercase fw-bold"}," Importation des numéros de prise en charge ",-1),F1={class:"card-body"},R1={key:0,class:"alert alert-danger",role:"alert"},I1={key:1,class:"alert alert-success",role:"alert"},w1={id:"formImport",action:"",enctype:"multipart/form-data",method:"post"},$1=e("p",{class:"fs-9 text"},[p(" Vous pouvez utiliser le modèle directement extrait de winpaie "),e("strong",null,"(format .xlsx ou .ods)"),p(" ou créer votre modèle générique de classeur "),e("strong",null,"(format .xlsx ou .ods)"),p(" incluant 3 colonnes : insee,numero pec, nom. ")],-1),L1={class:"mb-3"},H1=e("label",{class:"form-label",for:"importFile"},"Choisissez le fichier à importer :",-1),N1=te('<div class="mb-3"><label class="form-label" for="modele">Choisissez le modèle d&#39;import :</label>  <select id="modeleImport" class="form-select" name="modeleImport"><option value="winpaie">Winpaie</option><option value="generic">Generique (Modèle à 3 colonnes)</option></select></div>',1),j1={class:"mb-3"},O1=e("button",{id:"btn-import-inprogress",class:"btn btn-primary d-none",disabled:"",type:"button"},[e("span",{id:"spinner","aria-hidden":"true",class:"spinner-border spinner-border-sm",role:"status"}),p("  Veuillez patienter... ")],-1),q1={key:0,id:"fileErrors",class:"card text-dark bg-light"},z1=e("div",{class:"card-header text-uppercase fw-bold"}," Rapport de chargement du fichier ",-1),B1={class:"card-body"},G1={key:0},J1=e("p",null,"Listes des intervenants du fichier dont le numéro INSEE n'est pas valide : ",-1),Y1={key:1},Q1=e("p",null,"Listes des intervenants présents dans le fichier mais non trouvés dans OSE : ",-1);function W1(t,n,s,b,i,r){return a(),o(y,null,[e("div",U1,[T1,e("div",F1,[this.messageErrors?(a(),o("div",R1,d(this.messageErrors),1)):h("",!0),this.messageConfirm?(a(),o("div",I1,d(this.messageConfirm),1)):h("",!0),e("form",w1,[$1,e("div",L1,[H1,p("  "),e("input",{class:"form-control",name:"importFile",type:"file",onChange:n[0]||(n[0]=(...u)=>r.handleFileUpload&&r.handleFileUpload(...u))},null,32)]),N1,e("div",j1,[O1,e("button",{id:"btn-import",class:"btn btn-primary",disabled:"",type:"button",onClick:n[1]||(n[1]=(...u)=>r.importFile&&r.importFile(...u))}," Importer les numéros de prise en charge ")])])])]),this.fileErrors||this.intervenantMissing?(a(),o("div",q1,[z1,e("div",B1,[this.fileErrors.length!=0?(a(),o("div",G1,[J1,e("ul",null,[(a(!0),o(y,null,C(this.fileErrors,u=>(a(),o("li",null,d(),1))),256))])])):h("",!0),this.intervenantMissing.length!=0?(a(),o("div",Y1,[Q1,e("ul",null,[(a(!0),o(y,null,C(this.intervenantMissing,u=>(a(),o("li",null,d(u),1))),256))])])):h("",!0)])])):h("",!0)],64)}const X1=S(D1,[["render",W1]]),Z1=Object.freeze(Object.defineProperty({__proto__:null,default:X1},Symbol.toStringTag,{value:"Module"})),K1={name:"Taux",props:{taux:{required:!0},listeTaux:{required:!0}},data(){return{saisieUrl:unicaenVue.url("taux/saisir/:tauxRemu",{tauxRemu:this.taux.id}),supprimerUrl:unicaenVue.url("taux/supprimer/:tauxRemu",{tauxRemu:this.taux.id}),ajoutValeurUrl:unicaenVue.url("taux/saisir-valeur/:tauxRemu",{tauxRemu:this.taux.id})}},methods:{saisie(t){modAjax(t.target,n=>{this.$emit("refreshListe")})},ajoutValeur(t){modAjax(t.target,n=>{this.$emit("refreshListe")})},saisieValeur(t){t.currentTarget.href=unicaenVue.url("taux/saisir-valeur/:tauxRemu/:tauxRemuValeur",{tauxRemu:this.taux.id,tauxRemuValeur:t.currentTarget.dataset.id}),modAjax(t.currentTarget,n=>{this.$emit("refreshListe")})},refreshListe(t){this.$emit("refreshListe")},supprimer(t){popConfirm(t.target,n=>{this.$emit("refreshListe")})},supprimerValeur(t){t.currentTarget.href=unicaenVue.url("taux/supprimer-valeur/:tauxRemuValeur",{tauxRemuValeur:t.currentTarget.dataset.id}),popConfirm(t.currentTarget,n=>{this.$emit("refreshListe")})},refresh(t){unicaenVue.axios.get(unicaenVue.url("taux/get/:tauxRemu",{tauxRemu:t.id})).then(n=>{this.$emit("refresh",n.data)})}}},ev={class:"card-header"},tv={style:{display:"inline"}},nv={class:"float-end"},sv=["href"],rv=["href"],iv={class:"card-body"},av={key:0},ov=e("br",null,null,-1),lv={class:""},uv={class:"row align-items-start"},dv={class:"col-md-6"},cv={class:"col"},mv=["data-id"],hv=["data-id"],_v=["href"],pv={key:1,class:"row"},fv={class:"col-md-7"},bv=e("br",null,null,-1),vv={class:"row align-items-start"},gv={class:"col-md-8"},yv={class:"col-md-auto"},xv=["data-id"],Cv=["data-id"],Vv=["href"],Sv={class:"col"},Pv=e("br",null,null,-1),kv={key:0},Av={key:0};function Ev(t,n,s,b,i,r){const u=j,m=F("u-heures"),c=z,l=F("taux",!0);return a(),o(y,null,[e("div",{class:M(["card",{"ms-5":s.taux.tauxRemu}])},[e("div",ev,[e("h3",tv,d(s.taux.libelle)+" ("+d(s.taux.code)+")",1),e("div",nv,[s.taux.canEdit?(a(),o("a",{key:0,href:i.saisieUrl,class:"btn btn-primary",onClick:n[0]||(n[0]=P((...x)=>r.saisie&&r.saisie(...x),["prevent"]))},[_(u,{name:"pen-to-square"}),p(" Modifier")],8,sv)):h("",!0),p("   "),s.taux.canDelete?(a(),o("a",{key:1,href:i.supprimerUrl,class:"btn btn-danger",onClick:n[1]||(n[1]=P((...x)=>r.supprimer&&r.supprimer(...x),["prevent"]))},[_(u,{name:"trash-can"}),p(" Supprimer")],8,rv)):h("",!0)])]),e("div",iv,[s.taux.tauxRemu?h("",!0):(a(),o("div",av,[p(" Modification :"),ov,e("ul",null,[(a(!0),o(y,null,C(s.taux.tauxRemuValeurs,x=>(a(),o("div",{key:x.id},[e("li",lv,[e("div",uv,[e("div",dv,[_(m,{valeur:x.valeur},null,8,["valeur"]),p("€/h à partir du "),_(c,{value:x.dateEffet},null,8,["value"])]),e("div",cv,[s.taux.canEdit?(a(),o("a",{key:0,class:"text-primary",onClick:n[2]||(n[2]=P((...f)=>r.saisieValeur&&r.saisieValeur(...f),["prevent"])),"data-id":x.id},[_(u,{name:"pen-to-square"})],8,mv)):h("",!0),p("   "),s.taux.canEdit?(a(),o("a",{key:1,class:"text-primary",onClick:n[3]||(n[3]=P((...f)=>r.supprimerValeur&&r.supprimerValeur(...f),["prevent"])),"data-id":x.id},[_(u,{name:"trash-can"})],8,hv)):h("",!0)])])])]))),128))]),s.taux.canEdit?(a(),o("a",{key:0,href:i.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:n[4]||(n[4]=P((...x)=>r.ajoutValeur&&r.ajoutValeur(...x),["prevent"]))},[_(u,{name:"plus"}),p(" Ajouter une valeur ")],8,_v)):h("",!0)])),s.taux.tauxRemu?(a(),o("div",pv,[e("div",fv,[p(" Modification :"),bv,e("ul",null,[(a(!0),o(y,null,C(s.taux.tauxRemuValeurs,x=>(a(),o("div",null,[e("li",null,[e("div",vv,[e("div",gv,[p(" Coéfficient de "),_(m,{valeur:x.valeur},null,8,["valeur"]),p(" à partir du "),_(c,{value:x.dateEffet},null,8,["value"])]),e("div",yv,[s.taux.canEdit?(a(),o("a",{key:0,class:"text-primary",onClick:n[5]||(n[5]=P((...f)=>r.saisieValeur&&r.saisieValeur(...f),["prevent"])),"data-id":x.id},[_(u,{name:"pen-to-square"})],8,xv)):h("",!0),p("   "),s.taux.canEdit?(a(),o("a",{key:1,class:"text-primary",onClick:n[6]||(n[6]=P((...f)=>r.supprimerValeur&&r.supprimerValeur(...f),["prevent"])),"data-id":x.id},[_(u,{name:"trash-can"})],8,Cv)):h("",!0)])])])]))),256))]),s.taux.canEdit?(a(),o("a",{key:0,href:i.ajoutValeurUrl,class:"btn btn-primary btn-sm",onClick:n[7]||(n[7]=P((...x)=>r.ajoutValeur&&r.ajoutValeur(...x),["prevent"]))},[_(u,{name:"plus"})],8,Vv)):h("",!0)]),e("div",Sv,[p(" Valeurs calculées (indexées sur le taux "+d(s.taux.tauxRemu.libelle)+") : ",1),e("ul",null,[(a(!0),o(y,null,C(s.taux.tauxRemuValeursIndex,x=>(a(),o("div",null,[e("li",null,[_(m,{valeur:x.valeur},null,8,["valeur"]),p("€/h à partir du "),_(c,{value:x.date},null,8,["value"])])]))),256))]),Pv])])):h("",!0)])],2),s.taux.tauxRemu?h("",!0):(a(),o("div",kv,[(a(!0),o(y,null,C(s.listeTaux,x=>(a(),o("div",{key:x},[x.tauxRemu&&x.tauxRemu.id===s.taux.id?(a(),o("div",Av,[(a(),R(l,{onSupprimer:r.supprimer,onRefreshListe:r.refreshListe,key:s.taux.id,taux:x,listeTaux:s.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))])):h("",!0)]))),128))]))],64)}const he=S(K1,[["render",Ev]]),Mv=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"})),Dv={components:{taux:he},props:{canEditTaux:{type:Boolean,required:!0}},data(){return{listeTaux:[],ajoutUrl:unicaenVue.url("taux/saisir")}},mounted(){this.reload()},methods:{ajout(t){modAjax(t.currentTarget,n=>{this.reload()})},supprimer(){this.reload()},refreshListe(){this.reload()},refresh(t){let n=Util.json.indexById(this.listeTaux,t.id);this.listeTaux[n]=t},reload(){unicaenVue.axios.get(unicaenVue.url("taux/liste-taux")).then(t=>{this.listeTaux=t.data})}}},Uv=["href"];function Tv(t,n,s,b,i,r){const u=F("taux");return a(),o(y,null,[(a(!0),o(y,null,C(i.listeTaux,m=>(a(),o("div",null,[m.tauxRemu?h("",!0):(a(),R(u,{onSupprimer:r.supprimer,onRefreshListe:r.refreshListe,key:m.id,taux:m,listeTaux:i.listeTaux},null,8,["onSupprimer","onRefreshListe","taux","listeTaux"]))]))),256)),s.canEditTaux?(a(),o("a",{key:0,class:"btn btn-primary",href:i.ajoutUrl,onClick:n[0]||(n[0]=P((...m)=>r.ajout&&r.ajout(...m),["prevent"]))},"Ajout d'un nouveau taux",8,Uv)):h("",!0)],64)}const Fv=S(Dv,[["render",Tv]]),Rv=Object.freeze(Object.defineProperty({__proto__:null,default:Fv},Symbol.toStringTag,{value:"Module"})),Iv={name:"listeContrat",data(){return{dataUrl:unicaenVue.url("signature/data-contrat"),lines:[]}},methods:{contratUrl(t){return unicaenVue.url("intervenant/:intervenant/contrat",{intervenant:t})},getDocumentUrl(t){return unicaenVue.url("signature/:signature/get-document",{signature:t})},updateSignatureUrl(t){return unicaenVue.url("signature/:signature/update-signature",{signature:t})}}},wv=e("h1",{class:"page-header"},"Liste des signatures électroniques de contrat",-1),$v=e("thead",null,[e("tr",null,[e("th",{column:"ID_SIGNATURE"},"Id"),e("th",{column:"NOM"},"Nom"),e("th",{column:"PRENOM"},"Prénom"),e("th",{column:"DATE_CREATION_SIGNATURE_ELECTRONIQUE"},"Date signature électronique"),e("th",{column:"STATUT_SIGNATURE_ELECTRONIQUE"},"Statut"),e("th",null," ")])],-1),Lv=["href"],Hv=e("i",{class:"fas fa-download"},null,-1),Nv=[Hv],jv=["href"],Ov=e("i",{class:"fas fa-eye"},null,-1),qv=[Ov],zv=["href"],Bv=e("i",{class:"fas fa-rotate"},null,-1),Gv=[Bv];function Jv(t,n,s,b,i,r){const u=z,m=ne;return a(),o(y,null,[wv,_(m,{ref:"signatures",modelValue:i.lines,"onUpdate:modelValue":n[0]||(n[0]=c=>i.lines=c),"data-url":this.dataUrl},{default:U(()=>[$v,e("tbody",null,[(a(!0),o(y,null,C(i.lines,(c,l)=>(a(),o("tr",{key:l},[e("td",null,d(c.ID_SIGNATURE),1),e("td",null,d(c.NOM),1),e("td",null,d(c.PRENOM),1),e("td",null,[_(u,{value:c.DATE_CREATION_SIGNATURE_ELECTRONIQUE},null,8,["value"])]),e("td",null,d(c.STATUT_SIGNATURE_ELECTRONIQUE),1),e("td",null,[e("a",{href:r.getDocumentUrl(c.ID_SIGNATURE),class:"btn btn-info"},Nv,8,Lv),p("   "),e("a",{href:r.contratUrl(c.ID_INTERVENANT),class:"btn btn-info"},qv,8,jv),p("   "),e("a",{href:r.updateSignatureUrl(c.ID_SIGNATURE),class:"btn btn-info"},Gv,8,zv)])]))),128))])]),_:1},8,["modelValue","data-url"])],64)}const Yv=S(Iv,[["render",Jv]]),Qv=Object.freeze(Object.defineProperty({__proto__:null,default:Yv},Symbol.toStringTag,{value:"Module"})),Wv={UHeures:"Application/UI/UHeures",UInputFloat:"Application/UI/UInputFloat",Utilisateur:"Application/Utilisateur"};function Xv(t,n){const s={};n===void 0&&(n={});for(const r in t){let m=r.slice(2,-4).replaceAll("/","");s[m]=t[r].default}function b(r){let u=ye({template:r.innerHTML,components:s});if(n.beforeMount!==void 0&&n.beforeMount(u),n.autoloads!==void 0)for(const m in n.autoloads){let c=n.autoloads[m].replaceAll("/","");u.component(m,s[c])}u.use(xe({components:!0,directives:!0})),u.mount(r),n.afterMount!==void 0&&n.afterMount(u)}for(const r of document.getElementsByClassName("vue-app"))b(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList"){for(const m of u.addedNodes)if(m.nodeType===Node.ELEMENT_NODE){const c=m.querySelectorAll?m.querySelectorAll(".vue-app"):[];for(const l of c)b(l);m.classList.contains("vue-app")&&b(m)}}}).observe(document.body,{childList:!0,subtree:!0})}const Zv={init:Xv},Kv=Object.assign({"./Application/Connexion.vue":ze,"./Application/UI/UHeures.vue":Qe,"./Application/UI/UInputFloat.vue":et,"./Application/Utilisateur.vue":it,"./Employeur/ListeEmployeur.vue":xt,"./Formule/Administration/Details.vue":Mt,"./Formule/Administration/Formulator.vue":Bt,"./Formule/Administration/Index.vue":Gn,"./Formule/Details.vue":is,"./Formule/Test/Index.vue":ks,"./Formule/Test/Test.vue":Oa,"./Formule/TotauxHetd.vue":Xa,"./Intervenant/Recherche.vue":yo,"./Lieu/Structure.vue":nl,"./Lieu/StructuresAdmin.vue":dl,"./Mission/Liste.vue":Fu,"./Mission/ListeCandidatures.vue":ld,"./Mission/ListeOffreEmploi.vue":Lc,"./Mission/ListePrime.vue":qm,"./Mission/Mission.vue":Eu,"./Mission/OffreEmploi.vue":Dc,"./Mission/Prime.vue":Um,"./Mission/Suivi.vue":Vh,"./Mission/SuiviEvent.vue":gh,"./Paiement/DemandeMiseEnPaiement.vue":af,"./Paiement/DemandeMiseEnPaiementLot.vue":Ob,"./Paiement/DemandeMiseEnPaiementStructure.vue":Zp,"./Paiement/DetailsCalculs.vue":M1,"./Paiement/ImportNumeroPec.vue":Z1,"./Paiement/ListeTaux.vue":Rv,"./Paiement/Taux.vue":Mv,"./Signature/ListeContrat.vue":Qv}),eg={autoloads:Wv};Zv.init(Kv,eg);
